/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={878:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"/*!\n * Quill Editor v2.0.0-rc.2\n * https://quilljs.com\n * Copyright (c) 2017-2024, Slab\n * Copyright (c) 2014, Jason Chen\n * Copyright (c) 2013, salesforce.com\n */\n.ql-container{box-sizing:border-box;font-family:Helvetica,Arial,sans-serif;font-size:13px;height:100%;margin:0;position:relative}.ql-container.ql-disabled .ql-tooltip{visibility:hidden}.ql-container:not(.ql-disabled) li[data-list=checked] > .ql-ui,.ql-container:not(.ql-disabled) li[data-list=unchecked] > .ql-ui{cursor:pointer}.ql-clipboard{left:-100000px;height:1px;overflow-y:hidden;position:absolute;top:50%}.ql-clipboard p{margin:0;padding:0}.ql-editor{box-sizing:border-box;counter-reset:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9;line-height:1.42;height:100%;outline:none;overflow-y:auto;padding:12px 15px;tab-size:4;-moz-tab-size:4;text-align:left;white-space:pre-wrap;word-wrap:break-word}.ql-editor > *{cursor:text}.ql-editor p,.ql-editor ol,.ql-editor pre,.ql-editor blockquote,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{margin:0;padding:0}@supports (counter-set:none){.ql-editor p,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{counter-set:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor p,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{counter-reset:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor table{border-collapse:collapse}.ql-editor td{border:1px solid #000;padding:2px 5px}.ql-editor ol{padding-left:1.5em}.ql-editor li{list-style-type:none;padding-left:1.5em;position:relative}.ql-editor li > .ql-ui:before{display:inline-block;margin-left:-1.5em;margin-right:.3em;text-align:right;white-space:nowrap;width:1.2em}.ql-editor li[data-list=checked] > .ql-ui,.ql-editor li[data-list=unchecked] > .ql-ui{color:#777}.ql-editor li[data-list=bullet] > .ql-ui:before{content:'\\2022'}.ql-editor li[data-list=checked] > .ql-ui:before{content:'\\2611'}.ql-editor li[data-list=unchecked] > .ql-ui:before{content:'\\2610'}@supports (counter-set:none){.ql-editor li[data-list]{counter-set:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list]{counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered]{counter-increment:list-0}.ql-editor li[data-list=ordered] > .ql-ui:before{content:counter(list-0, decimal) '. '}.ql-editor li[data-list=ordered].ql-indent-1{counter-increment:list-1}.ql-editor li[data-list=ordered].ql-indent-1 > .ql-ui:before{content:counter(list-1, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-1{counter-set:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-1{counter-reset:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-2{counter-increment:list-2}.ql-editor li[data-list=ordered].ql-indent-2 > .ql-ui:before{content:counter(list-2, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-2{counter-set:list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-2{counter-reset:list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-3{counter-increment:list-3}.ql-editor li[data-list=ordered].ql-indent-3 > .ql-ui:before{content:counter(list-3, decimal) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-3{counter-set:list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-3{counter-reset:list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-4{counter-increment:list-4}.ql-editor li[data-list=ordered].ql-indent-4 > .ql-ui:before{content:counter(list-4, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-4{counter-set:list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-4{counter-reset:list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-5{counter-increment:list-5}.ql-editor li[data-list=ordered].ql-indent-5 > .ql-ui:before{content:counter(list-5, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-5{counter-set:list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-5{counter-reset:list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-6{counter-increment:list-6}.ql-editor li[data-list=ordered].ql-indent-6 > .ql-ui:before{content:counter(list-6, decimal) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-6{counter-set:list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-6{counter-reset:list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-7{counter-increment:list-7}.ql-editor li[data-list=ordered].ql-indent-7 > .ql-ui:before{content:counter(list-7, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-7{counter-set:list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-7{counter-reset:list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-8{counter-increment:list-8}.ql-editor li[data-list=ordered].ql-indent-8 > .ql-ui:before{content:counter(list-8, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-8{counter-set:list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-8{counter-reset:list-9}}.ql-editor li[data-list=ordered].ql-indent-9{counter-increment:list-9}.ql-editor li[data-list=ordered].ql-indent-9 > .ql-ui:before{content:counter(list-9, decimal) '. '}.ql-editor .ql-indent-1:not(.ql-direction-rtl){padding-left:3em}.ql-editor li.ql-indent-1:not(.ql-direction-rtl){padding-left:4.5em}.ql-editor .ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:3em}.ql-editor li.ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:4.5em}.ql-editor .ql-indent-2:not(.ql-direction-rtl){padding-left:6em}.ql-editor li.ql-indent-2:not(.ql-direction-rtl){padding-left:7.5em}.ql-editor .ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:6em}.ql-editor li.ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:7.5em}.ql-editor .ql-indent-3:not(.ql-direction-rtl){padding-left:9em}.ql-editor li.ql-indent-3:not(.ql-direction-rtl){padding-left:10.5em}.ql-editor .ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:9em}.ql-editor li.ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:10.5em}.ql-editor .ql-indent-4:not(.ql-direction-rtl){padding-left:12em}.ql-editor li.ql-indent-4:not(.ql-direction-rtl){padding-left:13.5em}.ql-editor .ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:12em}.ql-editor li.ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:13.5em}.ql-editor .ql-indent-5:not(.ql-direction-rtl){padding-left:15em}.ql-editor li.ql-indent-5:not(.ql-direction-rtl){padding-left:16.5em}.ql-editor .ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:15em}.ql-editor li.ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:16.5em}.ql-editor .ql-indent-6:not(.ql-direction-rtl){padding-left:18em}.ql-editor li.ql-indent-6:not(.ql-direction-rtl){padding-left:19.5em}.ql-editor .ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:18em}.ql-editor li.ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:19.5em}.ql-editor .ql-indent-7:not(.ql-direction-rtl){padding-left:21em}.ql-editor li.ql-indent-7:not(.ql-direction-rtl){padding-left:22.5em}.ql-editor .ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:21em}.ql-editor li.ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:22.5em}.ql-editor .ql-indent-8:not(.ql-direction-rtl){padding-left:24em}.ql-editor li.ql-indent-8:not(.ql-direction-rtl){padding-left:25.5em}.ql-editor .ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:24em}.ql-editor li.ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:25.5em}.ql-editor .ql-indent-9:not(.ql-direction-rtl){padding-left:27em}.ql-editor li.ql-indent-9:not(.ql-direction-rtl){padding-left:28.5em}.ql-editor .ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:27em}.ql-editor li.ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:28.5em}.ql-editor li.ql-direction-rtl{padding-right:1.5em}.ql-editor li.ql-direction-rtl > .ql-ui:before{margin-left:.3em;margin-right:-1.5em;text-align:left}.ql-editor table{table-layout:fixed;width:100%}.ql-editor table td{outline:none}.ql-editor .ql-code-block-container{font-family:monospace}.ql-editor .ql-video{display:block;max-width:100%}.ql-editor .ql-video.ql-align-center{margin:0 auto}.ql-editor .ql-video.ql-align-right{margin:0 0 0 auto}.ql-editor .ql-bg-black{background-color:#000}.ql-editor .ql-bg-red{background-color:#e60000}.ql-editor .ql-bg-orange{background-color:#f90}.ql-editor .ql-bg-yellow{background-color:#ff0}.ql-editor .ql-bg-green{background-color:#008a00}.ql-editor .ql-bg-blue{background-color:#06c}.ql-editor .ql-bg-purple{background-color:#93f}.ql-editor .ql-color-white{color:#fff}.ql-editor .ql-color-red{color:#e60000}.ql-editor .ql-color-orange{color:#f90}.ql-editor .ql-color-yellow{color:#ff0}.ql-editor .ql-color-green{color:#008a00}.ql-editor .ql-color-blue{color:#06c}.ql-editor .ql-color-purple{color:#93f}.ql-editor .ql-font-serif{font-family:Georgia,Times New Roman,serif}.ql-editor .ql-font-monospace{font-family:Monaco,Courier New,monospace}.ql-editor .ql-size-small{font-size:.75em}.ql-editor .ql-size-large{font-size:1.5em}.ql-editor .ql-size-huge{font-size:2.5em}.ql-editor .ql-direction-rtl{direction:rtl;text-align:inherit}.ql-editor .ql-align-center{text-align:center}.ql-editor .ql-align-justify{text-align:justify}.ql-editor .ql-align-right{text-align:right}.ql-editor .ql-ui{position:absolute}.ql-editor.ql-blank::before{color:rgba(0,0,0,0.6);content:attr(data-placeholder);font-style:italic;left:15px;pointer-events:none;position:absolute;right:15px}.ql-snow.ql-toolbar:after,.ql-snow .ql-toolbar:after{clear:both;content:'';display:table}.ql-snow.ql-toolbar button,.ql-snow .ql-toolbar button{background:none;border:none;cursor:pointer;display:inline-block;float:left;height:24px;padding:3px 5px;width:28px}.ql-snow.ql-toolbar button svg,.ql-snow .ql-toolbar button svg{float:left;height:100%}.ql-snow.ql-toolbar button:active:hover,.ql-snow .ql-toolbar button:active:hover{outline:none}.ql-snow.ql-toolbar input.ql-image[type=file],.ql-snow .ql-toolbar input.ql-image[type=file]{display:none}.ql-snow.ql-toolbar button:hover,.ql-snow .ql-toolbar button:hover,.ql-snow.ql-toolbar button:focus,.ql-snow .ql-toolbar button:focus,.ql-snow.ql-toolbar button.ql-active,.ql-snow .ql-toolbar button.ql-active,.ql-snow.ql-toolbar .ql-picker-label:hover,.ql-snow .ql-toolbar .ql-picker-label:hover,.ql-snow.ql-toolbar .ql-picker-label.ql-active,.ql-snow .ql-toolbar .ql-picker-label.ql-active,.ql-snow.ql-toolbar .ql-picker-item:hover,.ql-snow .ql-toolbar .ql-picker-item:hover,.ql-snow.ql-toolbar .ql-picker-item.ql-selected,.ql-snow .ql-toolbar .ql-picker-item.ql-selected{color:#06c}.ql-snow.ql-toolbar button:hover .ql-fill,.ql-snow .ql-toolbar button:hover .ql-fill,.ql-snow.ql-toolbar button:focus .ql-fill,.ql-snow .ql-toolbar button:focus .ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow.ql-toolbar button:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill{fill:#06c}.ql-snow.ql-toolbar button:hover .ql-stroke,.ql-snow .ql-toolbar button:hover .ql-stroke,.ql-snow.ql-toolbar button:focus .ql-stroke,.ql-snow .ql-toolbar button:focus .ql-stroke,.ql-snow.ql-toolbar button.ql-active .ql-stroke,.ql-snow .ql-toolbar button.ql-active .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow.ql-toolbar button:hover .ql-stroke-miter,.ql-snow .ql-toolbar button:hover .ql-stroke-miter,.ql-snow.ql-toolbar button:focus .ql-stroke-miter,.ql-snow .ql-toolbar button:focus .ql-stroke-miter,.ql-snow.ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter{stroke:#06c}@media (pointer:coarse){.ql-snow.ql-toolbar button:hover:not(.ql-active),.ql-snow .ql-toolbar button:hover:not(.ql-active){color:#444}.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill{fill:#444}.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter{stroke:#444}}.ql-snow{box-sizing:border-box}.ql-snow *{box-sizing:border-box}.ql-snow .ql-hidden{display:none}.ql-snow .ql-out-bottom,.ql-snow .ql-out-top{visibility:hidden}.ql-snow .ql-tooltip{position:absolute;transform:translateY(10px)}.ql-snow .ql-tooltip a{cursor:pointer;text-decoration:none}.ql-snow .ql-tooltip.ql-flip{transform:translateY(-10px)}.ql-snow .ql-formats{display:inline-block;vertical-align:middle}.ql-snow .ql-formats:after{clear:both;content:'';display:table}.ql-snow .ql-stroke{fill:none;stroke:#444;stroke-linecap:round;stroke-linejoin:round;stroke-width:2}.ql-snow .ql-stroke-miter{fill:none;stroke:#444;stroke-miterlimit:10;stroke-width:2}.ql-snow .ql-fill,.ql-snow .ql-stroke.ql-fill{fill:#444}.ql-snow .ql-empty{fill:none}.ql-snow .ql-even{fill-rule:evenodd}.ql-snow .ql-thin,.ql-snow .ql-stroke.ql-thin{stroke-width:1}.ql-snow .ql-transparent{opacity:.4}.ql-snow .ql-direction svg:last-child{display:none}.ql-snow .ql-direction.ql-active svg:last-child{display:inline}.ql-snow .ql-direction.ql-active svg:first-child{display:none}.ql-snow .ql-editor h1{font-size:2em}.ql-snow .ql-editor h2{font-size:1.5em}.ql-snow .ql-editor h3{font-size:1.17em}.ql-snow .ql-editor h4{font-size:1em}.ql-snow .ql-editor h5{font-size:.83em}.ql-snow .ql-editor h6{font-size:.67em}.ql-snow .ql-editor a{text-decoration:underline}.ql-snow .ql-editor blockquote{border-left:4px solid #ccc;margin-bottom:5px;margin-top:5px;padding-left:16px}.ql-snow .ql-editor code,.ql-snow .ql-editor .ql-code-block-container{background-color:#f0f0f0;border-radius:3px}.ql-snow .ql-editor .ql-code-block-container{margin-bottom:5px;margin-top:5px;padding:5px 10px}.ql-snow .ql-editor code{font-size:85%;padding:2px 4px}.ql-snow .ql-editor .ql-code-block-container{background-color:#23241f;color:#f8f8f2;overflow:visible}.ql-snow .ql-editor img{max-width:100%}.ql-snow .ql-picker{color:#444;display:inline-block;float:left;font-size:14px;font-weight:500;height:24px;position:relative;vertical-align:middle}.ql-snow .ql-picker-label{cursor:pointer;display:inline-block;height:100%;padding-left:8px;padding-right:2px;position:relative;width:100%}.ql-snow .ql-picker-label::before{display:inline-block;line-height:22px}.ql-snow .ql-picker-options{background-color:#fff;display:none;min-width:100%;padding:4px 8px;position:absolute;white-space:nowrap}.ql-snow .ql-picker-options .ql-picker-item{cursor:pointer;display:block;padding-bottom:5px;padding-top:5px}.ql-snow .ql-picker.ql-expanded .ql-picker-label{color:#ccc;z-index:2}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-fill{fill:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-stroke{stroke:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-options{display:block;margin-top:-1px;top:100%;z-index:1}.ql-snow .ql-color-picker,.ql-snow .ql-icon-picker{width:28px}.ql-snow .ql-color-picker .ql-picker-label,.ql-snow .ql-icon-picker .ql-picker-label{padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-label svg,.ql-snow .ql-icon-picker .ql-picker-label svg{right:4px}.ql-snow .ql-icon-picker .ql-picker-options{padding:4px 0}.ql-snow .ql-icon-picker .ql-picker-item{height:24px;width:24px;padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-options{padding:3px 5px;width:152px}.ql-snow .ql-color-picker .ql-picker-item{border:1px solid transparent;float:left;height:16px;margin:2px;padding:0;width:16px}.ql-snow .ql-picker:not(.ql-color-picker):not(.ql-icon-picker) svg{position:absolute;margin-top:-9px;right:0;top:50%;width:18px}.ql-snow .ql-picker.ql-header .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-font .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-label]:not([data-label=''])::before{content:attr(data-label)}.ql-snow .ql-picker.ql-header{width:98px}.ql-snow .ql-picker.ql-header .ql-picker-label::before,.ql-snow .ql-picker.ql-header .ql-picker-item::before{content:'Normal'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"1\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before{content:'Heading 1'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"2\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before{content:'Heading 2'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"3\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before{content:'Heading 3'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"4\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before{content:'Heading 4'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"5\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before{content:'Heading 5'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"6\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before{content:'Heading 6'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before{font-size:2em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before{font-size:1.5em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before{font-size:1.17em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before{font-size:1em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before{font-size:.83em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before{font-size:.67em}.ql-snow .ql-picker.ql-font{width:108px}.ql-snow .ql-picker.ql-font .ql-picker-label::before,.ql-snow .ql-picker.ql-font .ql-picker-item::before{content:'Sans Serif'}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=serif]::before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before{content:'Serif'}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=monospace]::before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before{content:'Monospace'}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before{font-family:Georgia,Times New Roman,serif}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before{font-family:Monaco,Courier New,monospace}.ql-snow .ql-picker.ql-size{width:98px}.ql-snow .ql-picker.ql-size .ql-picker-label::before,.ql-snow .ql-picker.ql-size .ql-picker-item::before{content:'Normal'}.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=small]::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before{content:'Small'}.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=large]::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before{content:'Large'}.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=huge]::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before{content:'Huge'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before{font-size:10px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before{font-size:18px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before{font-size:32px}.ql-snow .ql-color-picker.ql-background .ql-picker-item{background-color:#fff}.ql-snow .ql-color-picker.ql-color .ql-picker-item{background-color:#000}.ql-code-block-container{position:relative}.ql-code-block-container .ql-ui{right:5px;top:5px}.ql-toolbar.ql-snow{border:1px solid #ccc;box-sizing:border-box;font-family:'Helvetica Neue','Helvetica','Arial',sans-serif;padding:8px}.ql-toolbar.ql-snow .ql-formats{margin-right:15px}.ql-toolbar.ql-snow .ql-picker-label{border:1px solid transparent}.ql-toolbar.ql-snow .ql-picker-options{border:1px solid transparent;box-shadow:rgba(0,0,0,0.2) 0 2px 8px}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-label{border-color:#ccc}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-options{border-color:#ccc}.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item.ql-selected,.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item:hover{border-color:#000}.ql-toolbar.ql-snow + .ql-container.ql-snow{border-top:0}.ql-snow .ql-tooltip{background-color:#fff;border:1px solid #ccc;box-shadow:0 0 5px #ddd;color:#444;padding:5px 12px;white-space:nowrap}.ql-snow .ql-tooltip::before{content:\"Visit URL:\";line-height:26px;margin-right:8px}.ql-snow .ql-tooltip input[type=text]{display:none;border:1px solid #ccc;font-size:13px;height:26px;margin:0;padding:3px 5px;width:170px}.ql-snow .ql-tooltip a.ql-preview{display:inline-block;max-width:200px;overflow-x:hidden;text-overflow:ellipsis;vertical-align:top}.ql-snow .ql-tooltip a.ql-action::after{border-right:1px solid #ccc;content:'Edit';margin-left:16px;padding-right:8px}.ql-snow .ql-tooltip a.ql-remove::before{content:'Remove';margin-left:8px}.ql-snow .ql-tooltip a{line-height:26px}.ql-snow .ql-tooltip.ql-editing a.ql-preview,.ql-snow .ql-tooltip.ql-editing a.ql-remove{display:none}.ql-snow .ql-tooltip.ql-editing input[type=text]{display:inline-block}.ql-snow .ql-tooltip.ql-editing a.ql-action::after{border-right:0;content:'Save';padding-right:0}.ql-snow .ql-tooltip[data-mode=link]::before{content:\"Enter link:\"}.ql-snow .ql-tooltip[data-mode=formula]::before{content:\"Enter formula:\"}.ql-snow .ql-tooltip[data-mode=video]::before{content:\"Enter video:\"}.ql-snow a{color:#06c}.ql-container.ql-snow{border:1px solid #ccc}",""]);const a=o},497:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".grid-sizer,\n.note-card {\n  width: 25%;\n  padding: 0.5rem;\n}\n\n@media only screen and (max-width: 375px) {\n  .grid-sizer,\n  .note-card {\n    width: 100%;\n  }\n}\n\n@media only screen and (min-width: 376px) and (max-width: 768px) {\n  .grid-sizer,\n  .note-card {\n    width: 50%;\n  }\n}\n\n#input-note-title {\n  color: var(--primary-text-color);\n}\n\n/*///////////////////////// TEXT FORMATTING /////////////////////////*/\n\n.note-text h1 {\n  font-size: 26px;\n  line-height: 37px;\n  font-weight: 400;\n  color: var(--primary-text-color);\n}\n\n.note-text h2 {\n  font-size: 20px;\n  line-height: 28px;\n  font-weight: 400;\n  color: var(--primary-text-color);\n}\n\n.note-text p,\nli {\n  color: var(--primary-text-color);\n}\n\n.note-text ul > li::before {\n  content: '\\2022';\n  display: inline-block;\n  margin-left: -1.5em;\n  margin-right: 0.3em;\n  text-align: right;\n  white-space: nowrap;\n  width: 1.2em;\n}\n\n.note-text ul {\n  list-style-type: none;\n}\n\n.note-text blockquote {\n  border-left: 3px solid #fff;\n  font-style: italic;\n  margin-top: 10px;\n  margin-bottom: 10px;\n  padding-left: 16px;\n}\n\n.note-text > pre,\n.note-text > .ql-code-block {\n  font-size: 1rem;\n  border-radius: 3px;\n  font-family: monospace;\n  background-color: #23241f;\n  color: #f8f8f2;\n  margin-bottom: 5px;\n  margin-top: 5px;\n  padding: 5px 10px;\n}\n",""]);const a=o},410:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".ql-container {\n  font-family: 'Inter', Helvetica, Arial, sans-serif, 'Apple Color Emoji',\n    'Segoe UI Emoji', 'Segoe UI Symbol';\n  display: flex;\n  flex-direction: column-reverse;\n}\n\n.ql-editor {\n  min-height: 300px;\n  max-height: 55vh;\n  border-radius: 5px;\n  padding: 15px 12px;\n}\n\n.ql-toolbar {\n  border-radius: 0 0 5px 5px;\n  border: 0;\n}\n\n.ql-editor.ql-blank::before {\n  left: 12px;\n  font-size: 1rem;\n}\n\n.ql-bubble .ql-tooltip {\n  background-color: #000;\n}\n.ql-bubble .ql-tooltip:not(.ql-flip) .ql-tooltip-arrow {\n  border-bottom: 6px solid #000;\n}\n\n.ql-snow .ql-picker.ql-expanded .ql-picker-options {\n  top: unset;\n  bottom: 100%;\n}\n\n/*///////////////////////// TEXT FORMATTING /////////////////////////*/\n\n.ql-snow .ql-editor h1 {\n  font-size: 26px;\n  line-height: 37px;\n  font-weight: 400;\n  color: var(--primary-text-color);\n}\n\n.ql-snow .ql-editor h2 {\n  font-size: 20px;\n  line-height: 28px;\n  font-weight: 400;\n  color: var(--primary-text-color);\n}\n\n.ql-snow .ql-editor p,\nli,\nblockquote {\n  font-size: 1rem;\n  color: var(--primary-text-color);\n}\n\n.ql-code-block {\n  font-size: 1rem;\n}\n\n.ql-editor ol {\n  padding-left: 1rem;\n}\n\n.ql-snow .ql-editor blockquote {\n  border-left: 3px solid #fff;\n  font-style: italic;\n  margin-top: 10px;\n  margin-bottom: 10px;\n  padding-left: 16px;\n}\n\n.ql-container.ql-snow {\n  border: 1px solid #fff;\n}\n.ql-toolbar.ql-snow {\n  border: 1px solid #fff;\n}\n",""]);const a=o},523:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,":root {\n  --primary-text-color: #1f1f1f;\n}\n\n* {\n  -webkit-tap-highlight-color: transparent;\n}\n\n*:focus {\n  outline: none;\n}\n\nbody {\n  font-family: 'Inter', Helvetica, Arial, sans-serif, 'Apple Color Emoji',\n    'Segoe UI Emoji', 'Segoe UI Symbol';\n  overflow-y: scroll; /* Show scrollbars */\n}\n\n.dot-bg {\n  --dot-bg: white;\n  --dot-color: #999;\n  --dot-size: 1px;\n  --dot-space: 1rem;\n  background: linear-gradient(\n        90deg,\n        var(--dot-bg) calc(var(--dot-space) - var(--dot-size)),\n        transparent 1%\n      )\n      center / var(--dot-space) var(--dot-space),\n    linear-gradient(\n        var(--dot-bg) calc(var(--dot-space) - var(--dot-size)),\n        transparent 1%\n      )\n      center / var(--dot-space) var(--dot-space),\n    var(--dot-color);\n}\n\nnav {\n  background-color: white;\n  padding: 0 1rem;\n}\n\nnav > div {\n  display: flex;\n  padding: 1rem 0;\n  border-bottom: 1px solid #ccc;\n  border-top: 1px solid transparent;\n  color: var(--primary-text-color);\n}\n\n.user-details-container {\n  margin-left: auto;\n  display: flex;\n}\n#user-profile-photo {\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n  overflow: hidden;\n}\n\n#menu-container {\n  padding: 1rem;\n  display: flex;\n}\n\n#btn-open-newnote-modal {\n  margin-left: auto;\n}\n\n.notes-container {\n  margin: 0 auto;\n  margin: 0.5rem;\n}\n\n.note-content {\n  padding: 1rem;\n  border-radius: 5px;\n  box-shadow: 0px 2px 1px -1px rgba(0, 0, 0, 0.2),\n    0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12);\n  transition: all 0.2s ease-in-out;\n}\n\n.note-content:hover {\n  transform: scale(1.03);\n  box-shadow: 0px 3px 3px -2px rgba(0, 0, 0, 0.2),\n    0px 3px 4px 0px rgba(0, 0, 0, 0.14), 0px 1px 8px 0px rgba(0, 0, 0, 0.12);\n}\n\n.note-title {\n  font-weight: 500;\n  line-height: 2rem;\n  display: -webkit-box;\n  -webkit-line-clamp: 4;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  color: var(--primary-text-color);\n}\n\n.note-content small {\n  color: rgba(0, 0, 0, 0.6);\n  font-size: 12px;\n  line-height: 20px;\n}\n\n.note-text {\n  display: -webkit-box;\n  -webkit-line-clamp: 12;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  margin-top: 1rem;\n}\n\n.btn-delete-card {\n  background-color: transparent;\n  color: #000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  float: right;\n  margin-right: -0.5rem;\n  margin-top: -0.5rem;\n  width: 30px;\n  height: 30px;\n  border-radius: 15px;\n  border: 0;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n}\n\n.btn-delete-card:hover {\n  background-color: #ff6961;\n  color: white;\n}\n\n.grid-sizer,\n.note-card {\n  width: 25%;\n  padding: 0.5rem;\n  position: relative;\n}\n\n#dialog-sign-in[open] {\n  overflow: visible;\n  margin: auto;\n  border: 0;\n  padding: 1.5rem;\n  width: 340px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  border-radius: 5px;\n  box-shadow: 0px 2px 1px -1px rgba(0, 0, 0, 0.2),\n    0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12);\n}\n\n#dialog-sign-in > h3 {\n  margin-bottom: 0.5rem;\n}\n\n#dialog-sign-in > button:last-child {\n  margin: 0.5rem 0 0 0;\n}\n\n#btn-open-newnote-modal-mobile {\n  visibility: hidden;\n  border-radius: 100%;\n  background-color: black;\n  color: white;\n  border: 0;\n  height: 50px;\n  width: 50px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.2rem;\n  align-self: flex-end;\n}\n\n@media only screen and (max-width: 375px) {\n  .grid-sizer,\n  .note-card {\n    width: 100%;\n  }\n  .notes-container {\n    padding-bottom: 5.2rem;\n  }\n  #btn-open-newnote-modal {\n    display: none;\n  }\n\n  #btn-open-newnote-modal-mobile {\n    visibility: visible;\n  }\n}\n\n@media only screen and (min-width: 376px) and (max-width: 768px) {\n  .grid-sizer,\n  .note-card {\n    width: 50%;\n  }\n\n  .notes-container {\n    padding-bottom: 5.2rem;\n  }\n\n  #btn-open-newnote-modal {\n    display: none;\n  }\n  #btn-open-newnote-modal-mobile {\n    visibility: visible;\n  }\n}\n\n#dialog-note-form {\n  overflow: visible;\n  margin: auto;\n  border: 0;\n  background-color: transparent;\n  padding: 1.5rem;\n  max-width: 100%;\n  max-height: 100%;\n}\n\n#dialog-note-form[open] {\n  animation: fade-in-from-bottom 0.3s;\n}\n\n#form-container {\n  max-width: 720px;\n  border-radius: 5px;\n  padding: 1.5rem;\n  background-color: #ffd966;\n  box-shadow: 0px 0px 15px -3px rgba(0, 0, 0, 0.1);\n}\n\ndialog::backdrop {\n  background-color: rgba(0, 0, 0, 0.391);\n}\n\n#dialog-note-form[open]::backdrop {\n  /* background-color: rgba(0, 0, 0, 0.391); */\n  animation: backdrop-fade 0.3s;\n  animation-fill-mode: forwards;\n}\n\n@keyframes backdrop-fade {\n  from {\n    background: transparent;\n  }\n  to {\n    background: rgba(0, 0, 0, 0.391);\n  }\n}\n\n#input-note-text {\n  border-bottom: 0;\n  display: flex;\n}\n\n#input-note-title {\n  width: 100%;\n  background-color: transparent;\n  border: 1px solid #fff;\n  border-bottom: 0;\n  padding: 15px 12px;\n  font-size: 26px;\n  line-height: 37px;\n  border-radius: 5px 5px 0 0;\n}\n\n#btn-save-note {\n  width: fit-content;\n  margin: auto;\n}\n\n.form-separator {\n  border-left: 1px solid #fff;\n  border-right: 1px solid #fff;\n  padding: 0 12px;\n}\n\n.form-separator > hr {\n  height: 1px;\n  border: 0;\n  background-color: #fff;\n}\n\n.btn-primary {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 40px;\n  border-radius: 20px;\n  padding: 0 30px;\n  border: 0;\n  cursor: pointer;\n  transition: all 0.1s ease-in-out;\n}\n\n.btn-primary:hover {\n  background-color: black;\n  color: white;\n}\n\n.btn-delete-card > ion-icon {\n  pointer-events: none;\n  --ionicon-stroke-width: 2rem;\n}\n\nbutton > ion-icon {\n  pointer-events: none;\n  --ionicon-stroke-width: 1.3rem;\n}\n\n#loginStatus {\n  display: flex;\n  align-items: center;\n}\n\n.btn-color-filter {\n  background-color: #ff6961;\n  border: 0;\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n  cursor: pointer;\n}\n\n#btn-color-popover {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid white;\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n  cursor: pointer;\n  transition: all 0.1s ease-in-out;\n}\n\n#dialog-button-options {\n  display: flex;\n  align-items: center;\n  padding-top: 1.5rem;\n  position: relative;\n}\n\n#popover-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 10;\n  background-color: transparent;\n  visibility: hidden;\n}\n\n#popover-overlay.active {\n  visibility: visible;\n}\n\n#popover-dialog {\n  display: inline-flex;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n  position: absolute;\n  bottom: 50px;\n  background-color: white;\n  box-shadow: 0px 3px 3px -2px rgba(0, 0, 0, 0.2),\n    0px 3px 4px 0px rgba(0, 0, 0, 0.14), 0px 1px 8px 0px rgba(0, 0, 0, 0.12);\n  border-radius: 5px;\n  z-index: 11;\n  visibility: hidden;\n  padding: 0.5rem;\n  max-width: 11.5rem;\n}\n\n#popover-dialog.active {\n  visibility: visible;\n}\n\n.btn-color-option {\n  border: 0;\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n  margin: 0.5rem;\n  cursor: pointer;\n}\n\n.btn-color-menu-option {\n  opacity: 0;\n  border: 0;\n  width: 40px;\n  height: auto;\n  aspect-ratio: 1/1;\n  border-radius: 20px;\n  margin-right: 1rem;\n  cursor: pointer;\n}\n.btn-color-menu-option:last-child {\n  margin-right: 0;\n}\n\n.btn-action-menu-option {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border: 0;\n  padding: 0 20px;\n  height: 40px;\n  border-radius: 20px;\n  cursor: pointer;\n}\n\n#colors-menu {\n  display: flex;\n  max-width: 100%;\n}\n\n#actions-menu {\n  display: flex;\n  max-width: 100%;\n}\n\n@keyframes fade-in-from-bottom {\n  from {\n    opacity: 0;\n    transform: translateY(3ch);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes fade-in- {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n#btn-user-actions {\n  border: 0;\n  background-color: transparent;\n  padding: 0;\n  margin: 0;\n  cursor: pointer;\n}\n\n#dialog-sign-out {\n  position: absolute;\n  left: auto;\n  top: 4.6rem;\n  padding: 1rem;\n  border: 0;\n  min-width: 260px;\n  border-radius: 5px;\n  box-shadow: 0px 2px 1px -1px rgba(0, 0, 0, 0.2),\n    0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12);\n}\n\n#dialog-sign-out[open] {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n}\n#dialog-sign-out::backdrop {\n  background-color: transparent;\n}\n\n.floating-btn-container {\n  background-color: transparent;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: flex-end;\n  padding-bottom: 1rem;\n  padding-right: 0.82rem;\n  --_viewport-margin: 0.5vmin;\n  position: fixed;\n  z-index: var(--layer-1);\n  inset-block: auto var(--_viewport-margin);\n  inset-inline: auto var(--_viewport-margin);\n}\n\n.note-readable-date {\n  font-size: 14px;\n}\n\n.btn-sign-in {\n  background-color: #f2f2f2;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 40px;\n  border-radius: 20px;\n  padding: 0 20px;\n  border: 0;\n  cursor: pointer;\n  position: relative;\n  width: 100%;\n}\n\n.btn-sign-in:hover {\n  background-color: #000;\n  color: #fff;\n}\n\n.btn-sign-in > ion-icon {\n  position: absolute;\n  left: 1rem;\n}\n",""]);const a=o},430:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"/*\n  Josh's Custom CSS Reset\n  https://www.joshwcomeau.com/css/custom-css-reset/\n*/\n*,\n*::before,\n*::after {\n  box-sizing: border-box;\n}\n* {\n  margin: 0;\n}\nhtml,\nbody {\n  height: 100%;\n}\nbody {\n  line-height: 1.5;\n  -webkit-font-smoothing: antialiased;\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif,\n    'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';\n}\nimg,\npicture,\nvideo,\ncanvas,\nsvg {\n  display: block;\n  max-width: 100%;\n}\ninput,\nbutton,\ntextarea,\nselect {\n  font: inherit;\n}\np,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  overflow-wrap: break-word;\n}\n#root,\n#__next {\n  isolation: isolate;\n}\n",""]);const a=o},314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);i&&o[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},601:t=>{"use strict";t.exports=function(t){return t[1]}},786:(t,e,n)=>{var i,r;!function(s,o){"use strict";void 0===(r="function"==typeof(i=o)?i.call(e,n,e,t):i)||(t.exports=r)}(window,(function(){"use strict";var t=function(){var t=window.Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],n=0;n<e.length;n++){var i=e[n]+"MatchesSelector";if(t[i])return i}}();return function(e,n){return e[t](n)}}))},137:function(t,e,n){var i,r;"undefined"!=typeof window&&window,void 0===(r="function"==typeof(i=function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var n=this._events=this._events||{},i=n[t]=n[t]||[];return-1==i.indexOf(e)&&i.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var n=this._onceEvents=this._onceEvents||{};return(n[t]=n[t]||{})[e]=!0,this}},e.off=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){var i=n.indexOf(e);return-1!=i&&n.splice(i,1),this}},e.emitEvent=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){n=n.slice(0),e=e||[];for(var i=this._onceEvents&&this._onceEvents[t],r=0;r<n.length;r++){var s=n[r];i&&i[s]&&(this.off(t,s),delete i[s]),s.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t})?i.call(e,n,e,t):i)||(t.exports=r)},606:t=>{var e=-1,n=1,i=0;function r(t,g,m,y,v){if(t===g)return t?[[i,t]]:[];if(null!=m){var w=function(t,e,n){var i="number"==typeof n?{index:n,length:0}:n.oldRange,r="number"==typeof n?null:n.newRange,s=t.length,o=e.length;if(0===i.length&&(null===r||0===r.length)){var a=i.index,l=t.slice(0,a),c=t.slice(a),u=r?r.index:null,h=a+o-s;if((null===u||u===h)&&!(h<0||h>o)){var d=e.slice(0,h);if((g=e.slice(h))===c){var f=Math.min(a,h);if((y=l.slice(0,f))===(w=d.slice(0,f)))return b(y,l.slice(f),d.slice(f),c)}}if(null===u||u===a){var p=a,g=(d=e.slice(0,p),e.slice(p));if(d===l){var m=Math.min(s-p,o-p);if((v=c.slice(c.length-m))===(E=g.slice(g.length-m)))return b(l,c.slice(0,c.length-m),g.slice(0,g.length-m),v)}}}if(i.length>0&&r&&0===r.length){var y=t.slice(0,i.index),v=t.slice(i.index+i.length);if(!(o<(f=y.length)+(m=v.length))){var w=e.slice(0,f),E=e.slice(o-m);if(y===w&&v===E)return b(y,t.slice(f,s-m),e.slice(f,o-m),v)}}return null}(t,g,m);if(w)return w}var E=o(t,g),_=t.substring(0,E);E=l(t=t.substring(E),g=g.substring(E));var q=t.substring(t.length-E),k=function(t,a){var c;if(!t)return[[n,a]];if(!a)return[[e,t]];var u=t.length>a.length?t:a,h=t.length>a.length?a:t,d=u.indexOf(h);if(-1!==d)return c=[[n,u.substring(0,d)],[i,h],[n,u.substring(d+h.length)]],t.length>a.length&&(c[0][0]=c[2][0]=e),c;if(1===h.length)return[[e,t],[n,a]];var f=function(t,e){var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;function r(t,e,n){for(var i,r,s,a,c=t.substring(n,n+Math.floor(t.length/4)),u=-1,h="";-1!==(u=e.indexOf(c,u+1));){var d=o(t.substring(n),e.substring(u)),f=l(t.substring(0,n),e.substring(0,u));h.length<f+d&&(h=e.substring(u-f,u)+e.substring(u,u+d),i=t.substring(0,n-f),r=t.substring(n+d),s=e.substring(0,u-f),a=e.substring(u+d))}return 2*h.length>=t.length?[i,r,s,a,h]:null}var s,a,c,u,h,d=r(n,i,Math.ceil(n.length/4)),f=r(n,i,Math.ceil(n.length/2));return d||f?(s=f?d&&d[4].length>f[4].length?d:f:d,t.length>e.length?(a=s[0],c=s[1],u=s[2],h=s[3]):(u=s[0],h=s[1],a=s[2],c=s[3]),[a,c,u,h,s[4]]):null}(t,a);if(f){var p=f[0],g=f[1],m=f[2],y=f[3],v=f[4],b=r(p,m),w=r(g,y);return b.concat([[i,v]],w)}return function(t,i){for(var r=t.length,o=i.length,a=Math.ceil((r+o)/2),l=a,c=2*a,u=new Array(c),h=new Array(c),d=0;d<c;d++)u[d]=-1,h[d]=-1;u[l+1]=0,h[l+1]=0;for(var f=r-o,p=f%2!=0,g=0,m=0,y=0,v=0,b=0;b<a;b++){for(var w=-b+g;w<=b-m;w+=2){for(var E=l+w,_=(I=w===-b||w!==b&&u[E-1]<u[E+1]?u[E+1]:u[E-1]+1)-w;I<r&&_<o&&t.charAt(I)===i.charAt(_);)I++,_++;if(u[E]=I,I>r)m+=2;else if(_>o)g+=2;else if(p&&(T=l+f-w)>=0&&T<c&&-1!==h[T]&&I>=(k=r-h[T]))return s(t,i,I,_)}for(var q=-b+y;q<=b-v;q+=2){for(var k,T=l+q,x=(k=q===-b||q!==b&&h[T-1]<h[T+1]?h[T+1]:h[T-1]+1)-q;k<r&&x<o&&t.charAt(r-k-1)===i.charAt(o-x-1);)k++,x++;if(h[T]=k,k>r)v+=2;else if(x>o)y+=2;else if(!p){var I;if((E=l+f-q)>=0&&E<c&&-1!==u[E])if(_=l+(I=u[E])-E,I>=(k=r-k))return s(t,i,I,_)}}}return[[e,t],[n,i]]}(t,a)}(t=t.substring(0,t.length-E),g=g.substring(0,g.length-E));return _&&k.unshift([i,_]),q&&k.push([i,q]),p(k,v),y&&function(t){for(var r=!1,s=[],o=0,g=null,m=0,y=0,v=0,b=0,w=0;m<t.length;)t[m][0]==i?(s[o++]=m,y=b,v=w,b=0,w=0,g=t[m][1]):(t[m][0]==n?b+=t[m][1].length:w+=t[m][1].length,g&&g.length<=Math.max(y,v)&&g.length<=Math.max(b,w)&&(t.splice(s[o-1],0,[e,g]),t[s[o-1]+1][0]=n,o--,m=--o>0?s[o-1]:-1,y=0,v=0,b=0,w=0,g=null,r=!0)),m++;for(r&&p(t),function(t){function e(t,e){if(!t||!e)return 6;var n=t.charAt(t.length-1),i=e.charAt(0),r=n.match(c),s=i.match(c),o=r&&n.match(u),a=s&&i.match(u),l=o&&n.match(h),p=a&&i.match(h),g=l&&t.match(d),m=p&&e.match(f);return g||m?5:l||p?4:r&&!o&&a?3:o||a?2:r||s?1:0}for(var n=1;n<t.length-1;){if(t[n-1][0]==i&&t[n+1][0]==i){var r=t[n-1][1],s=t[n][1],o=t[n+1][1],a=l(r,s);if(a){var p=s.substring(s.length-a);r=r.substring(0,r.length-a),s=p+s.substring(0,s.length-a),o=p+o}for(var g=r,m=s,y=o,v=e(r,s)+e(s,o);s.charAt(0)===o.charAt(0);){r+=s.charAt(0),s=s.substring(1)+o.charAt(0),o=o.substring(1);var b=e(r,s)+e(s,o);b>=v&&(v=b,g=r,m=s,y=o)}t[n-1][1]!=g&&(g?t[n-1][1]=g:(t.splice(n-1,1),n--),t[n][1]=m,y?t[n+1][1]=y:(t.splice(n+1,1),n--))}n++}}(t),m=1;m<t.length;){if(t[m-1][0]==e&&t[m][0]==n){var E=t[m-1][1],_=t[m][1],q=a(E,_),k=a(_,E);q>=k?(q>=E.length/2||q>=_.length/2)&&(t.splice(m,0,[i,_.substring(0,q)]),t[m-1][1]=E.substring(0,E.length-q),t[m+1][1]=_.substring(q),m++):(k>=E.length/2||k>=_.length/2)&&(t.splice(m,0,[i,E.substring(0,k)]),t[m-1][0]=n,t[m-1][1]=_.substring(0,_.length-k),t[m+1][0]=e,t[m+1][1]=E.substring(k),m++),m++}m++}}(k),k}function s(t,e,n,i){var s=t.substring(0,n),o=e.substring(0,i),a=t.substring(n),l=e.substring(i),c=r(s,o),u=r(a,l);return c.concat(u)}function o(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(s,r)==e.substring(s,r)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return g(t.charCodeAt(r-1))&&r--,r}function a(t,e){var n=t.length,i=e.length;if(0==n||0==i)return 0;n>i?t=t.substring(n-i):n<i&&(e=e.substring(0,n));var r=Math.min(n,i);if(t==e)return r;for(var s=0,o=1;;){var a=t.substring(r-o),l=e.indexOf(a);if(-1==l)return s;o+=l,0!=l&&t.substring(r-o)!=e.substring(0,o)||(s=o,o++)}}function l(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(t.length-r,t.length-s)==e.substring(e.length-r,e.length-s)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return m(t.charCodeAt(t.length-r))&&r--,r}var c=/[^a-zA-Z0-9]/,u=/\s/,h=/[\r\n]/,d=/\n\r?\n$/,f=/^\r?\n\r?\n/;function p(t,r){t.push([i,""]);for(var s,a=0,c=0,u=0,h="",d="";a<t.length;)if(a<t.length-1&&!t[a][1])t.splice(a,1);else switch(t[a][0]){case n:u++,d+=t[a][1],a++;break;case e:c++,h+=t[a][1],a++;break;case i:var f=a-u-c-1;if(r){if(f>=0&&v(t[f][1])){var g=t[f][1].slice(-1);if(t[f][1]=t[f][1].slice(0,-1),h=g+h,d=g+d,!t[f][1]){t.splice(f,1),a--;var m=f-1;t[m]&&t[m][0]===n&&(u++,d=t[m][1]+d,m--),t[m]&&t[m][0]===e&&(c++,h=t[m][1]+h,m--),f=m}}y(t[a][1])&&(g=t[a][1].charAt(0),t[a][1]=t[a][1].slice(1),h+=g,d+=g)}if(a<t.length-1&&!t[a][1]){t.splice(a,1);break}if(h.length>0||d.length>0){h.length>0&&d.length>0&&(0!==(s=o(d,h))&&(f>=0?t[f][1]+=d.substring(0,s):(t.splice(0,0,[i,d.substring(0,s)]),a++),d=d.substring(s),h=h.substring(s)),0!==(s=l(d,h))&&(t[a][1]=d.substring(d.length-s)+t[a][1],d=d.substring(0,d.length-s),h=h.substring(0,h.length-s)));var b=u+c;0===h.length&&0===d.length?(t.splice(a-b,b),a-=b):0===h.length?(t.splice(a-b,b,[n,d]),a=a-b+1):0===d.length?(t.splice(a-b,b,[e,h]),a=a-b+1):(t.splice(a-b,b,[e,h],[n,d]),a=a-b+2)}0!==a&&t[a-1][0]===i?(t[a-1][1]+=t[a][1],t.splice(a,1)):a++,u=0,c=0,h="",d=""}""===t[t.length-1][1]&&t.pop();var w=!1;for(a=1;a<t.length-1;)t[a-1][0]===i&&t[a+1][0]===i&&(t[a][1].substring(t[a][1].length-t[a-1][1].length)===t[a-1][1]?(t[a][1]=t[a-1][1]+t[a][1].substring(0,t[a][1].length-t[a-1][1].length),t[a+1][1]=t[a-1][1]+t[a+1][1],t.splice(a-1,1),w=!0):t[a][1].substring(0,t[a+1][1].length)==t[a+1][1]&&(t[a-1][1]+=t[a+1][1],t[a][1]=t[a][1].substring(t[a+1][1].length)+t[a+1][1],t.splice(a+1,1),w=!0)),a++;w&&p(t,r)}function g(t){return t>=55296&&t<=56319}function m(t){return t>=56320&&t<=57343}function y(t){return m(t.charCodeAt(0))}function v(t){return g(t.charCodeAt(t.length-1))}function b(t,r,s,o){return v(t)||y(o)?null:function(t){for(var e=[],n=0;n<t.length;n++)t[n][1].length>0&&e.push(t[n]);return e}([[i,t],[e,r],[n,s],[i,o]])}function w(t,e,n,i){return r(t,e,n,i,!0)}w.INSERT=n,w.DELETE=e,w.EQUAL=i,t.exports=w},977:(t,e,n)=>{var i,r;!function(s,o){i=[n(786)],r=function(t){return function(t,e){"use strict";var n={extend:function(t,e){for(var n in e)t[n]=e[n];return t},modulo:function(t,e){return(t%e+e)%e}},i=Array.prototype.slice;n.makeArray=function(t){return Array.isArray(t)?t:null==t?[]:"object"==typeof t&&"number"==typeof t.length?i.call(t):[t]},n.removeFrom=function(t,e){var n=t.indexOf(e);-1!=n&&t.splice(n,1)},n.getParent=function(t,n){for(;t.parentNode&&t!=document.body;)if(t=t.parentNode,e(t,n))return t},n.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},n.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},n.filterFindElements=function(t,i){t=n.makeArray(t);var r=[];return t.forEach((function(t){if(t instanceof HTMLElement)if(i){e(t,i)&&r.push(t);for(var n=t.querySelectorAll(i),s=0;s<n.length;s++)r.push(n[s])}else r.push(t)})),r},n.debounceMethod=function(t,e,n){n=n||100;var i=t.prototype[e],r=e+"Timeout";t.prototype[e]=function(){var t=this[r];clearTimeout(t);var e=arguments,s=this;this[r]=setTimeout((function(){i.apply(s,e),delete s[r]}),n)}},n.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},n.toDashed=function(t){return t.replace(/(.)([A-Z])/g,(function(t,e,n){return e+"-"+n})).toLowerCase()};var r=t.console;return n.htmlInit=function(e,i){n.docReady((function(){var s=n.toDashed(i),o="data-"+s,a=document.querySelectorAll("["+o+"]"),l=document.querySelectorAll(".js-"+s),c=n.makeArray(a).concat(n.makeArray(l)),u=o+"-options",h=t.jQuery;c.forEach((function(t){var n,s=t.getAttribute(o)||t.getAttribute(u);try{n=s&&JSON.parse(s)}catch(e){return void(r&&r.error("Error parsing "+o+" on "+t.className+": "+e))}var a=new e(t,n);h&&h.data(t,i,a)}))}))},n}(s,t)}.apply(e,i),void 0===r||(t.exports=r)}(window)},485:(t,e,n)=>{var i,r;window,void 0===(r="function"==typeof(i=function(){"use strict";function t(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}var e="undefined"==typeof console?function(){}:function(t){console.error(t)},n=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],i=n.length;function r(t){var n=getComputedStyle(t);return n||e("Style returned "+n+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),n}var s,o=!1;function a(e){if(function(){if(!o){o=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var n=document.body||document.documentElement;n.appendChild(e);var i=r(e);s=200==Math.round(t(i.width)),a.isBoxSizeOuter=s,n.removeChild(e)}}(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var l=r(e);if("none"==l.display)return function(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<i;e++)t[n[e]]=0;return t}();var c={};c.width=e.offsetWidth,c.height=e.offsetHeight;for(var u=c.isBorderBox="border-box"==l.boxSizing,h=0;h<i;h++){var d=n[h],f=l[d],p=parseFloat(f);c[d]=isNaN(p)?0:p}var g=c.paddingLeft+c.paddingRight,m=c.paddingTop+c.paddingBottom,y=c.marginLeft+c.marginRight,v=c.marginTop+c.marginBottom,b=c.borderLeftWidth+c.borderRightWidth,w=c.borderTopWidth+c.borderBottomWidth,E=u&&s,_=t(l.width);!1!==_&&(c.width=_+(E?0:g+b));var q=t(l.height);return!1!==q&&(c.height=q+(E?0:m+w)),c.innerWidth=c.width-(g+b),c.innerHeight=c.height-(m+w),c.outerWidth=c.width+y,c.outerHeight=c.height+v,c}}return a})?i.call(e,n,e,t):i)||(t.exports=r)},193:(t,e,n)=>{t=n.nmd(t);var i="__lodash_hash_undefined__",r=9007199254740991,s="[object Arguments]",o="[object Boolean]",a="[object Date]",l="[object Function]",c="[object GeneratorFunction]",u="[object Map]",h="[object Number]",d="[object Object]",f="[object Promise]",p="[object RegExp]",g="[object Set]",m="[object String]",y="[object Symbol]",v="[object WeakMap]",b="[object ArrayBuffer]",w="[object DataView]",E="[object Float32Array]",_="[object Float64Array]",q="[object Int8Array]",k="[object Int16Array]",T="[object Int32Array]",x="[object Uint8Array]",I="[object Uint8ClampedArray]",S="[object Uint16Array]",A="[object Uint32Array]",N=/\w*$/,C=/^\[object .+?Constructor\]$/,O=/^(?:0|[1-9]\d*)$/,L={};L[s]=L["[object Array]"]=L[b]=L[w]=L[o]=L[a]=L[E]=L[_]=L[q]=L[k]=L[T]=L[u]=L[h]=L[d]=L[p]=L[g]=L[m]=L[y]=L[x]=L[I]=L[S]=L[A]=!0,L["[object Error]"]=L[l]=L[v]=!1;var D="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,R="object"==typeof self&&self&&self.Object===Object&&self,M=D||R||Function("return this")(),P=e&&!e.nodeType&&e,j=P&&t&&!t.nodeType&&t,U=j&&j.exports===P;function F(t,e){return t.set(e[0],e[1]),t}function V(t,e){return t.add(e),t}function B(t,e,n,i){var r=-1,s=t?t.length:0;for(i&&s&&(n=t[++r]);++r<s;)n=e(n,t[r],r,t);return n}function z(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function H(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function $(t,e){return function(n){return t(e(n))}}function W(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var K,G=Array.prototype,Q=Function.prototype,Y=Object.prototype,X=M["__core-js_shared__"],J=(K=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||""))?"Symbol(src)_1."+K:"",Z=Q.toString,tt=Y.hasOwnProperty,et=Y.toString,nt=RegExp("^"+Z.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),it=U?M.Buffer:void 0,rt=M.Symbol,st=M.Uint8Array,ot=$(Object.getPrototypeOf,Object),at=Object.create,lt=Y.propertyIsEnumerable,ct=G.splice,ut=Object.getOwnPropertySymbols,ht=it?it.isBuffer:void 0,dt=$(Object.keys,Object),ft=Mt(M,"DataView"),pt=Mt(M,"Map"),gt=Mt(M,"Promise"),mt=Mt(M,"Set"),yt=Mt(M,"WeakMap"),vt=Mt(Object,"create"),bt=Vt(ft),wt=Vt(pt),Et=Vt(gt),_t=Vt(mt),qt=Vt(yt),kt=rt?rt.prototype:void 0,Tt=kt?kt.valueOf:void 0;function xt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function It(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function St(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function At(t){this.__data__=new It(t)}function Nt(t,e,n){var i=t[e];tt.call(t,e)&&Bt(i,n)&&(void 0!==n||e in t)||(t[e]=n)}function Ct(t,e){for(var n=t.length;n--;)if(Bt(t[n][0],e))return n;return-1}function Ot(t,e,n,i,r,f,v){var C;if(i&&(C=f?i(t,r,f,v):i(t)),void 0!==C)return C;if(!Kt(t))return t;var O=zt(t);if(O){if(C=function(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&tt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!e)return function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}(t,C)}else{var D=jt(t),R=D==l||D==c;if($t(t))return function(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}(t,e);if(D==d||D==s||R&&!f){if(z(t))return f?t:{};if(C=function(t){return"function"!=typeof t.constructor||Ft(t)?{}:Kt(e=ot(t))?at(e):{};var e}(R?{}:t),!e)return function(t,e){return Dt(t,Pt(t),e)}(t,function(t,e){return t&&Dt(e,Gt(e),t)}(C,t))}else{if(!L[D])return f?t:{};C=function(t,e,n,i){var r,s=t.constructor;switch(e){case b:return Lt(t);case o:case a:return new s(+t);case w:return function(t,e){var n=e?Lt(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,i);case E:case _:case q:case k:case T:case x:case I:case S:case A:return function(t,e){var n=e?Lt(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,i);case u:return function(t,e,n){return B(e?n(H(t),!0):H(t),F,new t.constructor)}(t,i,n);case h:case m:return new s(t);case p:return function(t){var e=new t.constructor(t.source,N.exec(t));return e.lastIndex=t.lastIndex,e}(t);case g:return function(t,e,n){return B(e?n(W(t),!0):W(t),V,new t.constructor)}(t,i,n);case y:return r=t,Tt?Object(Tt.call(r)):{}}}(t,D,Ot,e)}}v||(v=new At);var M=v.get(t);if(M)return M;if(v.set(t,C),!O)var P=n?function(t){return function(t,e,n){var i=e(t);return zt(t)?i:function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}(i,n(t))}(t,Gt,Pt)}(t):Gt(t);return function(t,e){for(var n=-1,i=t?t.length:0;++n<i&&!1!==e(t[n],n););}(P||t,(function(r,s){P&&(r=t[s=r]),Nt(C,s,Ot(r,e,n,i,s,t,v))})),C}function Lt(t){var e=new t.constructor(t.byteLength);return new st(e).set(new st(t)),e}function Dt(t,e,n,i){n||(n={});for(var r=-1,s=e.length;++r<s;){var o=e[r],a=i?i(n[o],t[o],o,n,t):void 0;Nt(n,o,void 0===a?t[o]:a)}return n}function Rt(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function Mt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Kt(t)||(e=t,J&&J in e))&&(Wt(t)||z(t)?nt:C).test(Vt(t));var e}(n)?n:void 0}xt.prototype.clear=function(){this.__data__=vt?vt(null):{}},xt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},xt.prototype.get=function(t){var e=this.__data__;if(vt){var n=e[t];return n===i?void 0:n}return tt.call(e,t)?e[t]:void 0},xt.prototype.has=function(t){var e=this.__data__;return vt?void 0!==e[t]:tt.call(e,t)},xt.prototype.set=function(t,e){return this.__data__[t]=vt&&void 0===e?i:e,this},It.prototype.clear=function(){this.__data__=[]},It.prototype.delete=function(t){var e=this.__data__,n=Ct(e,t);return!(n<0||(n==e.length-1?e.pop():ct.call(e,n,1),0))},It.prototype.get=function(t){var e=this.__data__,n=Ct(e,t);return n<0?void 0:e[n][1]},It.prototype.has=function(t){return Ct(this.__data__,t)>-1},It.prototype.set=function(t,e){var n=this.__data__,i=Ct(n,t);return i<0?n.push([t,e]):n[i][1]=e,this},St.prototype.clear=function(){this.__data__={hash:new xt,map:new(pt||It),string:new xt}},St.prototype.delete=function(t){return Rt(this,t).delete(t)},St.prototype.get=function(t){return Rt(this,t).get(t)},St.prototype.has=function(t){return Rt(this,t).has(t)},St.prototype.set=function(t,e){return Rt(this,t).set(t,e),this},At.prototype.clear=function(){this.__data__=new It},At.prototype.delete=function(t){return this.__data__.delete(t)},At.prototype.get=function(t){return this.__data__.get(t)},At.prototype.has=function(t){return this.__data__.has(t)},At.prototype.set=function(t,e){var n=this.__data__;if(n instanceof It){var i=n.__data__;if(!pt||i.length<199)return i.push([t,e]),this;n=this.__data__=new St(i)}return n.set(t,e),this};var Pt=ut?$(ut,Object):function(){return[]},jt=function(t){return et.call(t)};function Ut(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||O.test(t))&&t>-1&&t%1==0&&t<e}function Ft(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Y)}function Vt(t){if(null!=t){try{return Z.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Bt(t,e){return t===e||t!=t&&e!=e}(ft&&jt(new ft(new ArrayBuffer(1)))!=w||pt&&jt(new pt)!=u||gt&&jt(gt.resolve())!=f||mt&&jt(new mt)!=g||yt&&jt(new yt)!=v)&&(jt=function(t){var e=et.call(t),n=e==d?t.constructor:void 0,i=n?Vt(n):void 0;if(i)switch(i){case bt:return w;case wt:return u;case Et:return f;case _t:return g;case qt:return v}return e});var zt=Array.isArray;function Ht(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!Wt(t)}var $t=ht||function(){return!1};function Wt(t){var e=Kt(t)?et.call(t):"";return e==l||e==c}function Kt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Gt(t){return Ht(t)?function(t,e){var n=zt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&Ht(t)}(t)&&tt.call(t,"callee")&&(!lt.call(t,"callee")||et.call(t)==s)}(t)?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],i=n.length,r=!!i;for(var o in t)!e&&!tt.call(t,o)||r&&("length"==o||Ut(o,i))||n.push(o);return n}(t):function(t){if(!Ft(t))return dt(t);var e=[];for(var n in Object(t))tt.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}t.exports=function(t){return Ot(t,!0,!0)}},142:(t,e,n)=>{t=n.nmd(t);var i="__lodash_hash_undefined__",r=1,s=2,o=9007199254740991,a="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",h="[object Date]",d="[object Error]",f="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",y="[object Null]",v="[object Object]",b="[object Promise]",w="[object Proxy]",E="[object RegExp]",_="[object Set]",q="[object String]",k="[object Undefined]",T="[object WeakMap]",x="[object ArrayBuffer]",I="[object DataView]",S=/^\[object .+?Constructor\]$/,A=/^(?:0|[1-9]\d*)$/,N={};N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N[a]=N[l]=N[x]=N[u]=N[I]=N[h]=N[d]=N[f]=N[g]=N[m]=N[v]=N[E]=N[_]=N[q]=N[T]=!1;var C="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,O="object"==typeof self&&self&&self.Object===Object&&self,L=C||O||Function("return this")(),D=e&&!e.nodeType&&e,R=D&&t&&!t.nodeType&&t,M=R&&R.exports===D,P=M&&C.process,j=function(){try{return P&&P.binding&&P.binding("util")}catch(t){}}(),U=j&&j.isTypedArray;function F(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function V(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function B(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var z,H,$,W=Array.prototype,K=Function.prototype,G=Object.prototype,Q=L["__core-js_shared__"],Y=K.toString,X=G.hasOwnProperty,J=(z=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"",Z=G.toString,tt=RegExp("^"+Y.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=M?L.Buffer:void 0,nt=L.Symbol,it=L.Uint8Array,rt=G.propertyIsEnumerable,st=W.splice,ot=nt?nt.toStringTag:void 0,at=Object.getOwnPropertySymbols,lt=et?et.isBuffer:void 0,ct=(H=Object.keys,$=Object,function(t){return H($(t))}),ut=Rt(L,"DataView"),ht=Rt(L,"Map"),dt=Rt(L,"Promise"),ft=Rt(L,"Set"),pt=Rt(L,"WeakMap"),gt=Rt(Object,"create"),mt=Ut(ut),yt=Ut(ht),vt=Ut(dt),bt=Ut(ft),wt=Ut(pt),Et=nt?nt.prototype:void 0,_t=Et?Et.valueOf:void 0;function qt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function kt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Tt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function xt(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Tt;++e<n;)this.add(t[e])}function It(t){var e=this.__data__=new kt(t);this.size=e.size}function St(t,e){for(var n=t.length;n--;)if(Ft(t[n][0],e))return n;return-1}function At(t){return null==t?void 0===t?k:y:ot&&ot in Object(t)?function(t){var e=X.call(t,ot),n=t[ot];try{t[ot]=void 0;var i=!0}catch(t){}var r=Z.call(t);return i&&(e?t[ot]=n:delete t[ot]),r}(t):function(t){return Z.call(t)}(t)}function Nt(t){return Kt(t)&&At(t)==a}function Ct(t,e,n,i,o){return t===e||(null==t||null==e||!Kt(t)&&!Kt(e)?t!=t&&e!=e:function(t,e,n,i,o,c){var f=Bt(t),p=Bt(e),y=f?l:Pt(t),b=p?l:Pt(e),w=(y=y==a?v:y)==v,k=(b=b==a?v:b)==v,T=y==b;if(T&&zt(t)){if(!zt(e))return!1;f=!0,w=!1}if(T&&!w)return c||(c=new It),f||Gt(t)?Ot(t,e,n,i,o,c):function(t,e,n,i,o,a,l){switch(n){case I:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!a(new it(t),new it(e)));case u:case h:case m:return Ft(+t,+e);case d:return t.name==e.name&&t.message==e.message;case E:case q:return t==e+"";case g:var c=V;case _:var f=i&r;if(c||(c=B),t.size!=e.size&&!f)return!1;var p=l.get(t);if(p)return p==e;i|=s,l.set(t,e);var y=Ot(c(t),c(e),i,o,a,l);return l.delete(t),y;case"[object Symbol]":if(_t)return _t.call(t)==_t.call(e)}return!1}(t,e,y,n,i,o,c);if(!(n&r)){var S=w&&X.call(t,"__wrapped__"),A=k&&X.call(e,"__wrapped__");if(S||A){var N=S?t.value():t,C=A?e.value():e;return c||(c=new It),o(N,C,n,i,c)}}return!!T&&(c||(c=new It),function(t,e,n,i,s,o){var a=n&r,l=Lt(t),c=l.length;if(c!=Lt(e).length&&!a)return!1;for(var u=c;u--;){var h=l[u];if(!(a?h in e:X.call(e,h)))return!1}var d=o.get(t);if(d&&o.get(e))return d==e;var f=!0;o.set(t,e),o.set(e,t);for(var p=a;++u<c;){var g=t[h=l[u]],m=e[h];if(i)var y=a?i(m,g,h,e,t,o):i(g,m,h,t,e,o);if(!(void 0===y?g===m||s(g,m,n,i,o):y)){f=!1;break}p||(p="constructor"==h)}if(f&&!p){var v=t.constructor,b=e.constructor;v==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(f=!1)}return o.delete(t),o.delete(e),f}(t,e,n,i,o,c))}(t,e,n,i,Ct,o))}function Ot(t,e,n,i,o,a){var l=n&r,c=t.length,u=e.length;if(c!=u&&!(l&&u>c))return!1;var h=a.get(t);if(h&&a.get(e))return h==e;var d=-1,f=!0,p=n&s?new xt:void 0;for(a.set(t,e),a.set(e,t);++d<c;){var g=t[d],m=e[d];if(i)var y=l?i(m,g,d,e,t,a):i(g,m,d,t,e,a);if(void 0!==y){if(y)continue;f=!1;break}if(p){if(!F(e,(function(t,e){if(r=e,!p.has(r)&&(g===t||o(g,t,n,i,a)))return p.push(e);var r}))){f=!1;break}}else if(g!==m&&!o(g,m,n,i,a)){f=!1;break}}return a.delete(t),a.delete(e),f}function Lt(t){return function(t,e,n){var i=e(t);return Bt(t)?i:function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}(i,n(t))}(t,Qt,Mt)}function Dt(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function Rt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Wt(t)||function(t){return!!J&&J in t}(t))&&(Ht(t)?tt:S).test(Ut(t))}(n)?n:void 0}qt.prototype.clear=function(){this.__data__=gt?gt(null):{},this.size=0},qt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},qt.prototype.get=function(t){var e=this.__data__;if(gt){var n=e[t];return n===i?void 0:n}return X.call(e,t)?e[t]:void 0},qt.prototype.has=function(t){var e=this.__data__;return gt?void 0!==e[t]:X.call(e,t)},qt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=gt&&void 0===e?i:e,this},kt.prototype.clear=function(){this.__data__=[],this.size=0},kt.prototype.delete=function(t){var e=this.__data__,n=St(e,t);return!(n<0||(n==e.length-1?e.pop():st.call(e,n,1),--this.size,0))},kt.prototype.get=function(t){var e=this.__data__,n=St(e,t);return n<0?void 0:e[n][1]},kt.prototype.has=function(t){return St(this.__data__,t)>-1},kt.prototype.set=function(t,e){var n=this.__data__,i=St(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},Tt.prototype.clear=function(){this.size=0,this.__data__={hash:new qt,map:new(ht||kt),string:new qt}},Tt.prototype.delete=function(t){var e=Dt(this,t).delete(t);return this.size-=e?1:0,e},Tt.prototype.get=function(t){return Dt(this,t).get(t)},Tt.prototype.has=function(t){return Dt(this,t).has(t)},Tt.prototype.set=function(t,e){var n=Dt(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},xt.prototype.add=xt.prototype.push=function(t){return this.__data__.set(t,i),this},xt.prototype.has=function(t){return this.__data__.has(t)},It.prototype.clear=function(){this.__data__=new kt,this.size=0},It.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},It.prototype.get=function(t){return this.__data__.get(t)},It.prototype.has=function(t){return this.__data__.has(t)},It.prototype.set=function(t,e){var n=this.__data__;if(n instanceof kt){var i=n.__data__;if(!ht||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Tt(i)}return n.set(t,e),this.size=n.size,this};var Mt=at?function(t){return null==t?[]:(t=Object(t),function(e,n){for(var i=-1,r=null==e?0:e.length,s=0,o=[];++i<r;){var a=e[i];l=a,rt.call(t,l)&&(o[s++]=a)}var l;return o}(at(t)))}:function(){return[]},Pt=At;function jt(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||A.test(t))&&t>-1&&t%1==0&&t<e}function Ut(t){if(null!=t){try{return Y.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ft(t,e){return t===e||t!=t&&e!=e}(ut&&Pt(new ut(new ArrayBuffer(1)))!=I||ht&&Pt(new ht)!=g||dt&&Pt(dt.resolve())!=b||ft&&Pt(new ft)!=_||pt&&Pt(new pt)!=T)&&(Pt=function(t){var e=At(t),n=e==v?t.constructor:void 0,i=n?Ut(n):"";if(i)switch(i){case mt:return I;case yt:return g;case vt:return b;case bt:return _;case wt:return T}return e});var Vt=Nt(function(){return arguments}())?Nt:function(t){return Kt(t)&&X.call(t,"callee")&&!rt.call(t,"callee")},Bt=Array.isArray,zt=lt||function(){return!1};function Ht(t){if(!Wt(t))return!1;var e=At(t);return e==f||e==p||e==c||e==w}function $t(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}function Wt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Kt(t){return null!=t&&"object"==typeof t}var Gt=U?function(t){return function(e){return t(e)}}(U):function(t){return Kt(t)&&$t(t.length)&&!!N[At(t)]};function Qt(t){return null!=(e=t)&&$t(e.length)&&!Ht(e)?function(t,e){var n=Bt(t),i=!n&&Vt(t),r=!n&&!i&&zt(t),s=!n&&!i&&!r&&Gt(t),o=n||i||r||s,a=o?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],l=a.length;for(var c in t)!e&&!X.call(t,c)||o&&("length"==c||r&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||jt(c,l))||a.push(c);return a}(t):function(t){if(n=(e=t)&&e.constructor,e!==("function"==typeof n&&n.prototype||G))return ct(t);var e,n,i=[];for(var r in Object(t))X.call(t,r)&&"constructor"!=r&&i.push(r);return i}(t);var e}t.exports=function(t,e){return Ct(t,e)}},994:(t,e,n)=>{var i,r,s;window,r=[n(831),n(485)],void 0===(s="function"==typeof(i=function(t,e){"use strict";var n=t.create("masonry");n.compatOptions.fitWidth="isFitWidth";var i=n.prototype;return i._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var t=0;t<this.cols;t++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0},i.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],n=t&&t.element;this.columnWidth=n&&e(n).outerWidth||this.containerWidth}var i=this.columnWidth+=this.gutter,r=this.containerWidth+this.gutter,s=r/i,o=i-r%i;s=Math[o&&o<1?"round":"floor"](s),this.cols=Math.max(s,1)},i.getContainerWidth=function(){var t=this._getOption("fitWidth")?this.element.parentNode:this.element,n=e(t);this.containerWidth=n&&n.innerWidth},i._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,n=Math[e&&e<1?"round":"ceil"](t.size.outerWidth/this.columnWidth);n=Math.min(n,this.cols);for(var i=this[this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition"](n,t),r={x:this.columnWidth*i.col,y:i.y},s=i.y+t.size.outerHeight,o=n+i.col,a=i.col;a<o;a++)this.colYs[a]=s;return r},i._getTopColPosition=function(t){var e=this._getTopColGroup(t),n=Math.min.apply(Math,e);return{col:e.indexOf(n),y:n}},i._getTopColGroup=function(t){if(t<2)return this.colYs;for(var e=[],n=this.cols+1-t,i=0;i<n;i++)e[i]=this._getColGroupY(i,t);return e},i._getColGroupY=function(t,e){if(e<2)return this.colYs[t];var n=this.colYs.slice(t,t+e);return Math.max.apply(Math,n)},i._getHorizontalColPosition=function(t,e){var n=this.horizontalColIndex%this.cols;n=t>1&&n+t>this.cols?0:n;var i=e.size.outerWidth&&e.size.outerHeight;return this.horizontalColIndex=i?n+t:this.horizontalColIndex,{col:n,y:this._getColGroupY(n,t)}},i._manageStamp=function(t){var n=e(t),i=this._getElementOffset(t),r=this._getOption("originLeft")?i.left:i.right,s=r+n.outerWidth,o=Math.floor(r/this.columnWidth);o=Math.max(0,o);var a=Math.floor(s/this.columnWidth);a-=s%this.columnWidth?0:1,a=Math.min(this.cols-1,a);for(var l=(this._getOption("originTop")?i.top:i.bottom)+n.outerHeight,c=o;c<=a;c++)this.colYs[c]=Math.max(l,this.colYs[c])},i._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this._getOption("fitWidth")&&(t.width=this._getContainerFitWidth()),t},i._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return(this.cols-t)*this.columnWidth-this.gutter},i.needsResizeLayout=function(){var t=this.containerWidth;return this.getContainerWidth(),t!=this.containerWidth},n})?i.apply(e,r):i)||(t.exports=s)},169:(t,e,n)=>{var i,r,s;window,r=[n(137),n(485)],void 0===(s="function"==typeof(i=function(t,e){"use strict";var n=document.documentElement.style,i="string"==typeof n.transition?"transition":"WebkitTransition",r="string"==typeof n.transform?"transform":"WebkitTransform",s={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[i],o={transform:r,transition:i,transitionDuration:i+"Duration",transitionProperty:i+"Property",transitionDelay:i+"Delay"};function a(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}var l=a.prototype=Object.create(t.prototype);l.constructor=a,l._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},l.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},l.getSize=function(){this.size=e(this.element)},l.css=function(t){var e=this.element.style;for(var n in t)e[o[n]||n]=t[n]},l.getPosition=function(){var t=getComputedStyle(this.element),e=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop"),i=t[e?"left":"right"],r=t[n?"top":"bottom"],s=parseFloat(i),o=parseFloat(r),a=this.layout.size;-1!=i.indexOf("%")&&(s=s/100*a.width),-1!=r.indexOf("%")&&(o=o/100*a.height),s=isNaN(s)?0:s,o=isNaN(o)?0:o,s-=e?a.paddingLeft:a.paddingRight,o-=n?a.paddingTop:a.paddingBottom,this.position.x=s,this.position.y=o},l.layoutPosition=function(){var t=this.layout.size,e={},n=this.layout._getOption("originLeft"),i=this.layout._getOption("originTop"),r=n?"paddingLeft":"paddingRight",s=n?"left":"right",o=n?"right":"left",a=this.position.x+t[r];e[s]=this.getXValue(a),e[o]="";var l=i?"paddingTop":"paddingBottom",c=i?"top":"bottom",u=i?"bottom":"top",h=this.position.y+t[l];e[c]=this.getYValue(h),e[u]="",this.css(e),this.emitEvent("layout",[this])},l.getXValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!e?t/this.layout.size.width*100+"%":t+"px"},l.getYValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&e?t/this.layout.size.height*100+"%":t+"px"},l._transitionTo=function(t,e){this.getPosition();var n=this.position.x,i=this.position.y,r=t==this.position.x&&e==this.position.y;if(this.setPosition(t,e),!r||this.isTransitioning){var s=t-n,o=e-i,a={};a.transform=this.getTranslate(s,o),this.transition({to:a,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},l.getTranslate=function(t,e){return"translate3d("+(t=this.layout._getOption("originLeft")?t:-t)+"px, "+(e=this.layout._getOption("originTop")?e:-e)+"px, 0)"},l.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},l.moveTo=l._transitionTo,l.setPosition=function(t,e){this.position.x=parseFloat(t),this.position.y=parseFloat(e)},l._nonTransition=function(t){for(var e in this.css(t.to),t.isCleaning&&this._removeStyles(t.to),t.onTransitionEnd)t.onTransitionEnd[e].call(this)},l.transition=function(t){if(parseFloat(this.layout.options.transitionDuration)){var e=this._transn;for(var n in t.onTransitionEnd)e.onEnd[n]=t.onTransitionEnd[n];for(n in t.to)e.ingProperties[n]=!0,t.isCleaning&&(e.clean[n]=!0);t.from&&(this.css(t.from),this.element.offsetHeight),this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0}else this._nonTransition(t)};var c="opacity,"+r.replace(/([A-Z])/g,(function(t){return"-"+t.toLowerCase()}));l.enableTransition=function(){if(!this.isTransitioning){var t=this.layout.options.transitionDuration;t="number"==typeof t?t+"ms":t,this.css({transitionProperty:c,transitionDuration:t,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(s,this,!1)}},l.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},l.onotransitionend=function(t){this.ontransitionend(t)};var u={"-webkit-transform":"transform"};l.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,n=u[t.propertyName]||t.propertyName;delete e.ingProperties[n],function(t){for(var e in t)return!1;return!0}(e.ingProperties)&&this.disableTransition(),n in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[n]),n in e.onEnd&&(e.onEnd[n].call(this),delete e.onEnd[n]),this.emitEvent("transitionEnd",[this])}},l.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(s,this,!1),this.isTransitioning=!1},l._removeStyles=function(t){var e={};for(var n in t)e[n]="";this.css(e)};var h={transitionProperty:"",transitionDuration:"",transitionDelay:""};return l.removeTransitionStyles=function(){this.css(h)},l.stagger=function(t){t=isNaN(t)?0:t,this.staggerDelay=t+"ms"},l.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},l.remove=function(){i&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",(function(){this.removeElem()})),this.hide()):this.removeElem()},l.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0,onTransitionEnd:e})},l.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},l.getHideRevealTransitionEndProperty=function(t){var e=this.layout.options[t];if(e.opacity)return"opacity";for(var n in e)return n},l.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:e})},l.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},l.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},a})?i.apply(e,r):i)||(t.exports=s)},831:(t,e,n)=>{var i,r;!function(s,o){"use strict";i=[n(137),n(485),n(977),n(169)],r=function(t,e,n,i){return function(t,e,n,i,r){var s=t.console,o=t.jQuery,a=function(){},l=0,c={};function u(t,e){var n=i.getQueryElement(t);if(n){this.element=n,o&&(this.$element=o(this.element)),this.options=i.extend({},this.constructor.defaults),this.option(e);var r=++l;this.element.outlayerGUID=r,c[r]=this,this._create(),this._getOption("initLayout")&&this.layout()}else s&&s.error("Bad element for "+this.constructor.namespace+": "+(n||t))}u.namespace="outlayer",u.Item=r,u.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var h=u.prototype;function d(t){function e(){t.apply(this,arguments)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}i.extend(h,e.prototype),h.option=function(t){i.extend(this.options,t)},h._getOption=function(t){var e=this.constructor.compatOptions[t];return e&&void 0!==this.options[e]?this.options[e]:this.options[t]},u.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},h._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),i.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},h.reloadItems=function(){this.items=this._itemize(this.element.children)},h._itemize=function(t){for(var e=this._filterFindItemElements(t),n=this.constructor.Item,i=[],r=0;r<e.length;r++){var s=new n(e[r],this);i.push(s)}return i},h._filterFindItemElements=function(t){return i.filterFindElements(t,this.options.itemSelector)},h.getItemElements=function(){return this.items.map((function(t){return t.element}))},h.layout=function(){this._resetLayout(),this._manageStamps();var t=this._getOption("layoutInstant"),e=void 0!==t?t:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0},h._init=h.layout,h._resetLayout=function(){this.getSize()},h.getSize=function(){this.size=n(this.element)},h._getMeasurement=function(t,e){var i,r=this.options[t];r?("string"==typeof r?i=this.element.querySelector(r):r instanceof HTMLElement&&(i=r),this[t]=i?n(i)[e]:r):this[t]=0},h.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},h._getItemsForLayout=function(t){return t.filter((function(t){return!t.isIgnored}))},h._layoutItems=function(t,e){if(this._emitCompleteOnItems("layout",t),t&&t.length){var n=[];t.forEach((function(t){var i=this._getItemLayoutPosition(t);i.item=t,i.isInstant=e||t.isLayoutInstant,n.push(i)}),this),this._processLayoutQueue(n)}},h._getItemLayoutPosition=function(){return{x:0,y:0}},h._processLayoutQueue=function(t){this.updateStagger(),t.forEach((function(t,e){this._positionItem(t.item,t.x,t.y,t.isInstant,e)}),this)},h.updateStagger=function(){var t=this.options.stagger;if(null!=t)return this.stagger=function(t){if("number"==typeof t)return t;var e=t.match(/(^\d*\.?\d*)(\w*)/),n=e&&e[1],i=e&&e[2];return n.length?(n=parseFloat(n))*(f[i]||1):0}(t),this.stagger;this.stagger=0},h._positionItem=function(t,e,n,i,r){i?t.goTo(e,n):(t.stagger(r*this.stagger),t.moveTo(e,n))},h._postLayout=function(){this.resizeContainer()},h.resizeContainer=function(){if(this._getOption("resizeContainer")){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))}},h._getContainerSize=a,h._setContainerMeasure=function(t,e){if(void 0!==t){var n=this.size;n.isBorderBox&&(t+=e?n.paddingLeft+n.paddingRight+n.borderLeftWidth+n.borderRightWidth:n.paddingBottom+n.paddingTop+n.borderTopWidth+n.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},h._emitCompleteOnItems=function(t,e){var n=this;function i(){n.dispatchEvent(t+"Complete",null,[e])}var r=e.length;if(e&&r){var s=0;e.forEach((function(e){e.once(t,o)}))}else i();function o(){++s==r&&i()}},h.dispatchEvent=function(t,e,n){var i=e?[e].concat(n):n;if(this.emitEvent(t,i),o)if(this.$element=this.$element||o(this.element),e){var r=o.Event(e);r.type=t,this.$element.trigger(r,n)}else this.$element.trigger(t,n)},h.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},h.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},h.stamp=function(t){(t=this._find(t))&&(this.stamps=this.stamps.concat(t),t.forEach(this.ignore,this))},h.unstamp=function(t){(t=this._find(t))&&t.forEach((function(t){i.removeFrom(this.stamps,t),this.unignore(t)}),this)},h._find=function(t){if(t)return"string"==typeof t&&(t=this.element.querySelectorAll(t)),i.makeArray(t)},h._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},h._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},h._manageStamp=a,h._getElementOffset=function(t){var e=t.getBoundingClientRect(),i=this._boundingRect,r=n(t);return{left:e.left-i.left-r.marginLeft,top:e.top-i.top-r.marginTop,right:i.right-e.right-r.marginRight,bottom:i.bottom-e.bottom-r.marginBottom}},h.handleEvent=i.handleEvent,h.bindResize=function(){t.addEventListener("resize",this),this.isResizeBound=!0},h.unbindResize=function(){t.removeEventListener("resize",this),this.isResizeBound=!1},h.onresize=function(){this.resize()},i.debounceMethod(u,"onresize",100),h.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},h.needsResizeLayout=function(){var t=n(this.element);return this.size&&t&&t.innerWidth!==this.size.innerWidth},h.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},h.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},h.prepended=function(t){var e=this._itemize(t);if(e.length){var n=this.items.slice(0);this.items=e.concat(n),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(n)}},h.reveal=function(t){if(this._emitCompleteOnItems("reveal",t),t&&t.length){var e=this.updateStagger();t.forEach((function(t,n){t.stagger(n*e),t.reveal()}))}},h.hide=function(t){if(this._emitCompleteOnItems("hide",t),t&&t.length){var e=this.updateStagger();t.forEach((function(t,n){t.stagger(n*e),t.hide()}))}},h.revealItemElements=function(t){var e=this.getItems(t);this.reveal(e)},h.hideItemElements=function(t){var e=this.getItems(t);this.hide(e)},h.getItem=function(t){for(var e=0;e<this.items.length;e++){var n=this.items[e];if(n.element==t)return n}},h.getItems=function(t){t=i.makeArray(t);var e=[];return t.forEach((function(t){var n=this.getItem(t);n&&e.push(n)}),this),e},h.remove=function(t){var e=this.getItems(t);this._emitCompleteOnItems("remove",e),e&&e.length&&e.forEach((function(t){t.remove(),i.removeFrom(this.items,t)}),this)},h.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="",this.items.forEach((function(t){t.destroy()})),this.unbindResize();var e=this.element.outlayerGUID;delete c[e],delete this.element.outlayerGUID,o&&o.removeData(this.element,this.constructor.namespace)},u.data=function(t){var e=(t=i.getQueryElement(t))&&t.outlayerGUID;return e&&c[e]},u.create=function(t,e){var n=d(u);return n.defaults=i.extend({},u.defaults),i.extend(n.defaults,e),n.compatOptions=i.extend({},u.compatOptions),n.namespace=t,n.data=u.data,n.Item=d(r),i.htmlInit(n,t),o&&o.bridget&&o.bridget(t,n),n};var f={ms:1,s:1e3};return u.Item=r,u}(s,t,e,n,i)}.apply(e,i),void 0===r||(t.exports=r)}(window)},106:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(193),r=n(142);var s;!function(t){t.compose=function(t={},e={},n=!1){"object"!=typeof t&&(t={}),"object"!=typeof e&&(e={});let r=i(e);n||(r=Object.keys(r).reduce(((t,e)=>(null!=r[e]&&(t[e]=r[e]),t)),{}));for(const n in t)void 0!==t[n]&&void 0===e[n]&&(r[n]=t[n]);return Object.keys(r).length>0?r:void 0},t.diff=function(t={},e={}){"object"!=typeof t&&(t={}),"object"!=typeof e&&(e={});const n=Object.keys(t).concat(Object.keys(e)).reduce(((n,i)=>(r(t[i],e[i])||(n[i]=void 0===e[i]?null:e[i]),n)),{});return Object.keys(n).length>0?n:void 0},t.invert=function(t={},e={}){t=t||{};const n=Object.keys(e).reduce(((n,i)=>(e[i]!==t[i]&&void 0!==t[i]&&(n[i]=e[i]),n)),{});return Object.keys(t).reduce(((n,i)=>(t[i]!==e[i]&&void 0===e[i]&&(n[i]=null),n)),n)},t.transform=function(t,e,n=!1){if("object"!=typeof t)return e;if("object"!=typeof e)return;if(!n)return e;const i=Object.keys(e).reduce(((n,i)=>(void 0===t[i]&&(n[i]=e[i]),n)),{});return Object.keys(i).length>0?i:void 0}}(s||(s={})),e.default=s},660:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const i=n(606),r=n(193),s=n(142),o=n(106);e.AttributeMap=o.default;const a=n(759);e.Op=a.default;const l=n(317);e.OpIterator=l.default;const c=String.fromCharCode(0),u=(t,e)=>{if("object"!=typeof t||null===t)throw new Error("cannot retain a "+typeof t);if("object"!=typeof e||null===e)throw new Error("cannot retain a "+typeof e);const n=Object.keys(t)[0];if(!n||n!==Object.keys(e)[0])throw new Error(`embed types not matched: ${n} != ${Object.keys(e)[0]}`);return[n,t[n],e[n]]};class h{constructor(t){Array.isArray(t)?this.ops=t:null!=t&&Array.isArray(t.ops)?this.ops=t.ops:this.ops=[]}static registerEmbed(t,e){this.handlers[t]=e}static unregisterEmbed(t){delete this.handlers[t]}static getHandler(t){const e=this.handlers[t];if(!e)throw new Error(`no handlers for embed type "${t}"`);return e}insert(t,e){const n={};return"string"==typeof t&&0===t.length?this:(n.insert=t,null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n))}delete(t){return t<=0?this:this.push({delete:t})}retain(t,e){if("number"==typeof t&&t<=0)return this;const n={retain:t};return null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n)}push(t){let e=this.ops.length,n=this.ops[e-1];if(t=r(t),"object"==typeof n){if("number"==typeof t.delete&&"number"==typeof n.delete)return this.ops[e-1]={delete:n.delete+t.delete},this;if("number"==typeof n.delete&&null!=t.insert&&(e-=1,n=this.ops[e-1],"object"!=typeof n))return this.ops.unshift(t),this;if(s(t.attributes,n.attributes)){if("string"==typeof t.insert&&"string"==typeof n.insert)return this.ops[e-1]={insert:n.insert+t.insert},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this;if("number"==typeof t.retain&&"number"==typeof n.retain)return this.ops[e-1]={retain:n.retain+t.retain},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this}}return e===this.ops.length?this.ops.push(t):this.ops.splice(e,0,t),this}chop(){const t=this.ops[this.ops.length-1];return t&&"number"==typeof t.retain&&!t.attributes&&this.ops.pop(),this}filter(t){return this.ops.filter(t)}forEach(t){this.ops.forEach(t)}map(t){return this.ops.map(t)}partition(t){const e=[],n=[];return this.forEach((i=>{(t(i)?e:n).push(i)})),[e,n]}reduce(t,e){return this.ops.reduce(t,e)}changeLength(){return this.reduce(((t,e)=>e.insert?t+a.default.length(e):e.delete?t-e.delete:t),0)}length(){return this.reduce(((t,e)=>t+a.default.length(e)),0)}slice(t=0,e=1/0){const n=[],i=new l.default(this.ops);let r=0;for(;r<e&&i.hasNext();){let s;r<t?s=i.next(t-r):(s=i.next(e-r),n.push(s)),r+=a.default.length(s)}return new h(n)}compose(t){const e=new l.default(this.ops),n=new l.default(t.ops),i=[],r=n.peek();if(null!=r&&"number"==typeof r.retain&&null==r.attributes){let t=r.retain;for(;"insert"===e.peekType()&&e.peekLength()<=t;)t-=e.peekLength(),i.push(e.next());r.retain-t>0&&n.next(r.retain-t)}const a=new h(i);for(;e.hasNext()||n.hasNext();)if("insert"===n.peekType())a.push(n.next());else if("delete"===e.peekType())a.push(e.next());else{const t=Math.min(e.peekLength(),n.peekLength()),i=e.next(t),r=n.next(t);if(r.retain){const l={};if("number"==typeof i.retain)l.retain="number"==typeof r.retain?t:r.retain;else if("number"==typeof r.retain)null==i.retain?l.insert=i.insert:l.retain=i.retain;else{const t=null==i.retain?"insert":"retain",[e,n,s]=u(i[t],r.retain),o=h.getHandler(e);l[t]={[e]:o.compose(n,s,"retain"===t)}}const c=o.default.compose(i.attributes,r.attributes,"number"==typeof i.retain);if(c&&(l.attributes=c),a.push(l),!n.hasNext()&&s(a.ops[a.ops.length-1],l)){const t=new h(e.rest());return a.concat(t).chop()}}else"number"==typeof r.delete&&("number"==typeof i.retain||"object"==typeof i.retain&&null!==i.retain)&&a.push(r)}return a.chop()}concat(t){const e=new h(this.ops.slice());return t.ops.length>0&&(e.push(t.ops[0]),e.ops=e.ops.concat(t.ops.slice(1))),e}diff(t,e){if(this.ops===t.ops)return new h;const n=[this,t].map((e=>e.map((n=>{if(null!=n.insert)return"string"==typeof n.insert?n.insert:c;throw new Error("diff() called "+(e===t?"on":"with")+" non-document")})).join(""))),r=new h,a=i(n[0],n[1],e,!0),u=new l.default(this.ops),d=new l.default(t.ops);return a.forEach((t=>{let e=t[1].length;for(;e>0;){let n=0;switch(t[0]){case i.INSERT:n=Math.min(d.peekLength(),e),r.push(d.next(n));break;case i.DELETE:n=Math.min(e,u.peekLength()),u.next(n),r.delete(n);break;case i.EQUAL:n=Math.min(u.peekLength(),d.peekLength(),e);const t=u.next(n),a=d.next(n);s(t.insert,a.insert)?r.retain(n,o.default.diff(t.attributes,a.attributes)):r.push(a).delete(n)}e-=n}})),r.chop()}eachLine(t,e="\n"){const n=new l.default(this.ops);let i=new h,r=0;for(;n.hasNext();){if("insert"!==n.peekType())return;const s=n.peek(),o=a.default.length(s)-n.peekLength(),l="string"==typeof s.insert?s.insert.indexOf(e,o)-o:-1;if(l<0)i.push(n.next());else if(l>0)i.push(n.next(l));else{if(!1===t(i,n.next(1).attributes||{},r))return;r+=1,i=new h}}i.length()>0&&t(i,{},r)}invert(t){const e=new h;return this.reduce(((n,i)=>{if(i.insert)e.delete(a.default.length(i));else{if("number"==typeof i.retain&&null==i.attributes)return e.retain(i.retain),n+i.retain;if(i.delete||"number"==typeof i.retain){const r=i.delete||i.retain;return t.slice(n,n+r).forEach((t=>{i.delete?e.push(t):i.retain&&i.attributes&&e.retain(a.default.length(t),o.default.invert(i.attributes,t.attributes))})),n+r}if("object"==typeof i.retain&&null!==i.retain){const r=t.slice(n,n+1),s=new l.default(r.ops).next(),[a,c,d]=u(i.retain,s.insert),f=h.getHandler(a);return e.retain({[a]:f.invert(c,d)},o.default.invert(i.attributes,s.attributes)),n+1}}return n}),0),e.chop()}transform(t,e=!1){if(e=!!e,"number"==typeof t)return this.transformPosition(t,e);const n=t,i=new l.default(this.ops),r=new l.default(n.ops),s=new h;for(;i.hasNext()||r.hasNext();)if("insert"!==i.peekType()||!e&&"insert"===r.peekType())if("insert"===r.peekType())s.push(r.next());else{const t=Math.min(i.peekLength(),r.peekLength()),n=i.next(t),a=r.next(t);if(n.delete)continue;if(a.delete)s.push(a);else{const i=n.retain,r=a.retain;let l="object"==typeof r&&null!==r?r:t;if("object"==typeof i&&null!==i&&"object"==typeof r&&null!==r){const t=Object.keys(i)[0];if(t===Object.keys(r)[0]){const n=h.getHandler(t);n&&(l={[t]:n.transform(i[t],r[t],e)})}}s.retain(l,o.default.transform(n.attributes,a.attributes,e))}}else s.retain(a.default.length(i.next()));return s.chop()}transformPosition(t,e=!1){e=!!e;const n=new l.default(this.ops);let i=0;for(;n.hasNext()&&i<=t;){const r=n.peekLength(),s=n.peekType();n.next(),"delete"!==s?("insert"===s&&(i<t||!e)&&(t+=r),i+=r):t-=Math.min(r,t-i)}return t}}h.Op=a.default,h.OpIterator=l.default,h.AttributeMap=o.default,h.handlers={},e.default=h,t.exports=h,t.exports.default=h},759:(t,e)=>{"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.length=function(t){return"number"==typeof t.delete?t.delete:"number"==typeof t.retain?t.retain:"object"==typeof t.retain&&null!==t.retain?1:"string"==typeof t.insert?t.insert.length:1}}(n||(n={})),e.default=n},317:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(759);e.default=class{constructor(t){this.ops=t,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(t){t||(t=1/0);const e=this.ops[this.index];if(e){const n=this.offset,r=i.default.length(e);if(t>=r-n?(t=r-n,this.index+=1,this.offset=0):this.offset+=t,"number"==typeof e.delete)return{delete:t};{const i={};return e.attributes&&(i.attributes=e.attributes),"number"==typeof e.retain?i.retain=t:"object"==typeof e.retain&&null!==e.retain?i.retain=e.retain:"string"==typeof e.insert?i.insert=e.insert.substr(n,t):i.insert=e.insert,i}}return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?i.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const t=this.ops[this.index];return t?"number"==typeof t.delete?"delete":"number"==typeof t.retain||"object"==typeof t.retain&&null!==t.retain?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);{const t=this.offset,e=this.index,n=this.next(),i=this.ops.slice(this.index);return this.offset=t,this.index=e,[n].concat(i)}}return[]}}},697:t=>{"use strict";var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,i,s,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,s||t,o),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,o=new Array(s);r<s;r++)o[r]=i[r].fn;return o},a.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,r,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var l,c,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,s),!0;case 6:return u.fn.call(u.context,e,i,r,s,o),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,i);break;case 4:u[c].fn.call(u[c].context,e,i,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||r&&!a.once||i&&a.context!==i||o(this,s);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==e||r&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[s]=1===c.length?c[0]:c:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a},72:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var s={},o=[],a=0;a<t.length;a++){var l=t[a],c=i.base?l[0]+i.base:l[0],u=s[c]||0,h="".concat(c," ").concat(u);s[c]=u+1;var d=n(h),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var p=r(f,i);i.byIndex=a,e.splice(a,0,{identifier:h,updater:p,references:1})}o.push(h)}return o}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var s=i(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--}for(var l=i(t,r),c=0;c<s.length;c++){var u=n(s[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}s=l}}},659:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.nc=void 0,(()=>{"use strict";var t={};n.r(t),n.d(t,{Attributor:()=>Ib,AttributorStore:()=>Rb,BlockBlot:()=>Kb,ClassAttributor:()=>Ob,ContainerBlot:()=>Qb,EmbedBlot:()=>Yb,InlineBlot:()=>$b,LeafBlot:()=>Ub,ParentBlot:()=>zb,Registry:()=>Nb,Scope:()=>xb,ScrollBlot:()=>Zb,StyleAttributor:()=>Db,TextBlot:()=>ew});var e=n(994),i=n.n(e);const r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function s(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const o={date:s({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:s({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:s({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},a={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function l(t){return(e,n)=>{let i;if("formatting"===(n?.context?String(n.context):"standalone")&&t.formattingValues){const e=t.defaultFormattingWidth||t.defaultWidth,r=n?.width?String(n.width):e;i=t.formattingValues[r]||t.formattingValues[e]}else{const e=t.defaultWidth,r=n?.width?String(n.width):t.defaultWidth;i=t.values[r]||t.values[e]}return i[t.argumentCallback?t.argumentCallback(e):e]}}const c={ordinalNumber:(t,e)=>{const n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:l({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:l({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:t=>t-1}),month:l({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:l({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:l({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function u(t){return(e,n={})=>{const i=n.width,r=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],s=e.match(r);if(!s)return null;const o=s[0],a=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?function(t,e){for(let e=0;e<t.length;e++)if(t[e].test(o))return e}(a):function(t,e){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e].test(o))return e}(a);let c;return c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c,{value:c,rest:e.slice(o.length)}}}const h={ordinalNumber:(d={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:t=>parseInt(t,10)},(t,e={})=>{const n=t.match(d.matchPattern);if(!n)return null;const i=n[0],r=t.match(d.parsePattern);if(!r)return null;let s=d.valueCallback?d.valueCallback(r[0]):r[0];return s=e.valueCallback?e.valueCallback(s):s,{value:s,rest:t.slice(i.length)}}),era:u({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:u({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:t=>t+1}),month:u({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:u({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:u({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var d;const f={code:"en-US",formatDistance:(t,e,n)=>{let i;const s=r[t];return i="string"==typeof s?s:1===e?s.one:s.other.replace("{{count}}",e.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i},formatLong:o,formatRelative:(t,e,n,i)=>a[t],localize:c,match:h,options:{weekStartsOn:0,firstWeekContainsDate:1}};let p={};function g(){return p}Math.pow(10,8);const m=6048e5,y=864e5,v=36e5,b=43200;function w(t){const e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new t.constructor(+t):"number"==typeof t||"[object Number]"===e||"string"==typeof t||"[object String]"===e?new Date(t):new Date(NaN)}function E(t){const e=w(t);return e.setHours(0,0,0,0),e}function _(t){const e=w(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function q(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function k(t){const e=w(t);return function(t,e){const n=E(t),i=E(e),r=+n-_(n),s=+i-_(i);return Math.round((r-s)/y)}(e,function(t){const e=w(t),n=q(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}(e))+1}function T(t,e){const n=g(),i=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=w(t),s=r.getDay(),o=(s<i?7:0)+s-i;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function x(t){return T(t,{weekStartsOn:1})}function I(t){const e=w(t),n=e.getFullYear(),i=q(t,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const r=x(i),s=q(t,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const o=x(s);return e.getTime()>=r.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function S(t){const e=w(t),n=+x(e)-+function(t){const e=I(t),n=q(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),x(n)}(e);return Math.round(n/m)+1}function A(t,e){const n=w(t),i=n.getFullYear(),r=g(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=q(t,0);o.setFullYear(i+1,0,s),o.setHours(0,0,0,0);const a=T(o,e),l=q(t,0);l.setFullYear(i,0,s),l.setHours(0,0,0,0);const c=T(l,e);return n.getTime()>=a.getTime()?i+1:n.getTime()>=c.getTime()?i:i-1}function N(t,e){const n=w(t),i=+T(n,e)-+function(t,e){const n=g(),i=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,r=A(t,e),s=q(t,0);return s.setFullYear(r,0,i),s.setHours(0,0,0,0),T(s,e)}(n,e);return Math.round(i/m)+1}function C(t,e){return(t<0?"-":"")+Math.abs(t).toString().padStart(e,"0")}const O={y(t,e){const n=t.getFullYear(),i=n>0?n:1-n;return C("yy"===e?i%100:i,e.length)},M(t,e){const n=t.getMonth();return"M"===e?String(n+1):C(n+1,2)},d:(t,e)=>C(t.getDate(),e.length),a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(t,e)=>C(t.getHours()%12||12,e.length),H:(t,e)=>C(t.getHours(),e.length),m:(t,e)=>C(t.getMinutes(),e.length),s:(t,e)=>C(t.getSeconds(),e.length),S(t,e){const n=e.length,i=t.getMilliseconds();return C(Math.trunc(i*Math.pow(10,n-3)),e.length)}},L={G:function(t,e,n){const i=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});default:return n.era(i,{width:"wide"})}},y:function(t,e,n){if("yo"===e){const e=t.getFullYear(),i=e>0?e:1-e;return n.ordinalNumber(i,{unit:"year"})}return O.y(t,e)},Y:function(t,e,n,i){const r=A(t,i),s=r>0?r:1-r;return"YY"===e?C(s%100,2):"Yo"===e?n.ordinalNumber(s,{unit:"year"}):C(s,e.length)},R:function(t,e){return C(I(t),e.length)},u:function(t,e){return C(t.getFullYear(),e.length)},Q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return C(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return C(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,e,n){const i=t.getMonth();switch(e){case"M":case"MM":return O.M(t,e);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(t,e,n){const i=t.getMonth();switch(e){case"L":return String(i+1);case"LL":return C(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(t,e,n,i){const r=N(t,i);return"wo"===e?n.ordinalNumber(r,{unit:"week"}):C(r,e.length)},I:function(t,e,n){const i=S(t);return"Io"===e?n.ordinalNumber(i,{unit:"week"}):C(i,e.length)},d:function(t,e,n){return"do"===e?n.ordinalNumber(t.getDate(),{unit:"date"}):O.d(t,e)},D:function(t,e,n){const i=k(t);return"Do"===e?n.ordinalNumber(i,{unit:"dayOfYear"}):C(i,e.length)},E:function(t,e,n){const i=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(t,e,n,i){const r=t.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return C(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,i){const r=t.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return C(s,e.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const i=t.getDay(),r=0===i?7:i;switch(e){case"i":return String(r);case"ii":return C(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(t,e,n){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,n){const i=t.getHours();let r;switch(r=12===i?"noon":0===i?"midnight":i/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const i=t.getHours();let r;switch(r=i>=17?"evening":i>=12?"afternoon":i>=4?"morning":"night",e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if("ho"===e){let e=t.getHours()%12;return 0===e&&(e=12),n.ordinalNumber(e,{unit:"hour"})}return O.h(t,e)},H:function(t,e,n){return"Ho"===e?n.ordinalNumber(t.getHours(),{unit:"hour"}):O.H(t,e)},K:function(t,e,n){const i=t.getHours()%12;return"Ko"===e?n.ordinalNumber(i,{unit:"hour"}):C(i,e.length)},k:function(t,e,n){let i=t.getHours();return 0===i&&(i=24),"ko"===e?n.ordinalNumber(i,{unit:"hour"}):C(i,e.length)},m:function(t,e,n){return"mo"===e?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):O.m(t,e)},s:function(t,e,n){return"so"===e?n.ordinalNumber(t.getSeconds(),{unit:"second"}):O.s(t,e)},S:function(t,e){return O.S(t,e)},X:function(t,e,n){const i=t.getTimezoneOffset();if(0===i)return"Z";switch(e){case"X":return R(i);case"XXXX":case"XX":return M(i);default:return M(i,":")}},x:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"x":return R(i);case"xxxx":case"xx":return M(i);default:return M(i,":")}},O:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+D(i,":");default:return"GMT"+M(i,":")}},z:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+D(i,":");default:return"GMT"+M(i,":")}},t:function(t,e,n){return C(Math.trunc(t.getTime()/1e3),e.length)},T:function(t,e,n){return C(t.getTime(),e.length)}};function D(t,e=""){const n=t>0?"-":"+",i=Math.abs(t),r=Math.trunc(i/60),s=i%60;return 0===s?n+String(r):n+String(r)+e+C(s,2)}function R(t,e){return t%60==0?(t>0?"-":"+")+C(Math.abs(t)/60,2):M(t,e)}function M(t,e=""){const n=t>0?"-":"+",i=Math.abs(t);return n+C(Math.trunc(i/60),2)+e+C(i%60,2)}const P=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}},j=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}},U={p:j,P:(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],i=n[1],r=n[2];if(!r)return P(t,e);let s;switch(i){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;default:s=e.dateTime({width:"full"})}return s.replace("{{date}}",P(i,e)).replace("{{time}}",j(r,e))}},F=/^D+$/,V=/^Y+$/,B=["D","DD","YY","YYYY"];function z(t){if(!(e=t,e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)||"number"==typeof t))return!1;var e;const n=w(t);return!isNaN(Number(n))}const H=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,W=/^'([^]*?)'?$/,K=/''/g,G=/[a-zA-Z]/;function Q(t,e,n){const i=g(),r=n?.locale??i.locale??f,s=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,a=w(t);if(!z(a))throw new RangeError("Invalid time value");let l=e.match($).map((t=>{const e=t[0];return"p"===e||"P"===e?(0,U[e])(t,r.formatLong):t})).join("").match(H).map((t=>{if("''"===t)return{isToken:!1,value:"'"};const e=t[0];if("'"===e)return{isToken:!1,value:Y(t)};if(L[e])return{isToken:!0,value:t};if(e.match(G))throw new RangeError("Format string contains an unescaped latin alphabet character `"+e+"`");return{isToken:!1,value:t}}));r.localize.preprocessor&&(l=r.localize.preprocessor(a,l));const c={firstWeekContainsDate:s,weekStartsOn:o,locale:r};return l.map((i=>{if(!i.isToken)return i.value;const s=i.value;return(!n?.useAdditionalWeekYearTokens&&function(t){return V.test(t)}(s)||!n?.useAdditionalDayOfYearTokens&&function(t){return F.test(t)}(s))&&function(t,e,n){const i=function(t,e,n){const i="Y"===t[0]?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(t,e,n);if(console.warn(i),B.includes(t))throw new RangeError(i)}(s,e,String(t)),(0,L[s[0]])(a,s,r.localize,c)})).join("")}function Y(t){const e=t.match(W);return e?e[1].replace(K,"'"):t}var X=n(72),J=n.n(X),Z=n(825),tt=n.n(Z),et=n(659),nt=n.n(et),it=n(56),rt=n.n(it),st=n(540),ot=n.n(st),at=n(113),lt=n.n(at),ct=n(497),ut={};ut.styleTagTransform=lt(),ut.setAttributes=rt(),ut.insert=nt().bind(null,"head"),ut.domAPI=tt(),ut.insertStyleElement=ot(),J()(ct.A,ut),ct.A&&ct.A.locals&&ct.A.locals;const ht=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},dt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,l=a?t[e+2]:0,c=r>>2,u=(3&r)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),i.push(n[c],n[u],n[h],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ht(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],s=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==s||null==o||null==a)throw new ft;const l=r<<2|s>>4;if(i.push(l),64!==o){const t=s<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class ft extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pt=function(t){return function(t){const e=ht(t);return dt.encodeByteArray(e,!0)}(t).replace(/\./g,"")},gt=function(t){try{return dt.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},mt=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&gt(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},yt=t=>{var e,n;return null===(n=null===(e=mt())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},vt=()=>{var t;return null===(t=mt())||void 0===t?void 0:t.config},bt=t=>{var e;return null===(e=mt())||void 0===e?void 0:e[`_${t}`]};class wt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function Et(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function _t(){try{return"object"==typeof indexedDB}catch(t){return!1}}class qt extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,qt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,kt.prototype.create)}}class kt{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(Tt,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new qt(i,o,n)}}const Tt=/\{\$([^}]+)}/g;function xt(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(It(n)&&It(s)){if(!xt(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function It(t){return null!==t&&"object"==typeof t}function St(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function At(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function Nt(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class Ct{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=Ot),void 0===i.error&&(i.error=Ot),void 0===i.complete&&(i.complete=Ot);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function Ot(){}function Lt(t){return t&&t._delegate?t._delegate:t}class Dt{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Rt="[DEFAULT]";class Mt{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new wt;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Rt})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=Rt){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=Rt){return this.instances.has(t)}getOptions(t=Rt){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===Rt?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=Rt){return this.component?this.component.multipleInstances?t:Rt:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Pt{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Mt(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const jt=[];var Ut;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(Ut||(Ut={}));const Ft={debug:Ut.DEBUG,verbose:Ut.VERBOSE,info:Ut.INFO,warn:Ut.WARN,error:Ut.ERROR,silent:Ut.SILENT},Vt=Ut.INFO,Bt={[Ut.DEBUG]:"log",[Ut.VERBOSE]:"log",[Ut.INFO]:"info",[Ut.WARN]:"warn",[Ut.ERROR]:"error"},zt=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=Bt[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class Ht{constructor(t){this.name=t,this._logLevel=Vt,this._logHandler=zt,this._userLogHandler=null,jt.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ut))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?Ft[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ut.DEBUG,...t),this._logHandler(this,Ut.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ut.VERBOSE,...t),this._logHandler(this,Ut.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ut.INFO,...t),this._logHandler(this,Ut.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ut.WARN,...t),this._logHandler(this,Ut.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ut.ERROR,...t),this._logHandler(this,Ut.ERROR,...t)}}const $t=(t,e)=>e.some((e=>t instanceof e));let Wt,Kt;const Gt=new WeakMap,Qt=new WeakMap,Yt=new WeakMap,Xt=new WeakMap,Jt=new WeakMap;let Zt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return Qt.get(t);if("objectStoreNames"===e)return t.objectStoreNames||Yt.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ee(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function te(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Kt||(Kt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ne(this),t),ee(Gt.get(this))}:function(...t){return ee(e.apply(ne(this),t))}:function(t,...n){const i=e.call(ne(this),t,...n);return Yt.set(i,t.sort?t.sort():[t]),ee(i)}:(t instanceof IDBTransaction&&function(t){if(Qt.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));Qt.set(t,e)}(t),$t(t,Wt||(Wt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Zt):t);var e}function ee(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(ee(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&Gt.set(e,t)})).catch((()=>{})),Jt.set(e,t),e}(t);if(Xt.has(t))return Xt.get(t);const e=te(t);return e!==t&&(Xt.set(t,e),Jt.set(e,t)),e}const ne=t=>Jt.get(t),ie=["get","getKey","getAll","getAllKeys","count"],re=["put","add","delete","clear"],se=new Map;function oe(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(se.get(e))return se.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=re.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!ie.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return se.set(e,s),s}var ae;ae=Zt,Zt={...ae,get:(t,e,n)=>oe(t,e)||ae.get(t,e,n),has:(t,e)=>!!oe(t,e)||ae.has(t,e)};class le{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const ce="@firebase/app",ue="0.9.28",he=new Ht("@firebase/app"),de="[DEFAULT]",fe={[ce]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},pe=new Map,ge=new Map;function me(t,e){try{t.container.addComponent(e)}catch(n){he.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ye(t){const e=t.name;if(ge.has(e))return he.debug(`There were multiple attempts to register component ${e}.`),!1;ge.set(e,t);for(const e of pe.values())me(e,t);return!0}function ve(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const be=new kt("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class we{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Dt("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw be.create("app-deleted",{appName:this._name})}}const Ee="10.8.1";function _e(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:de,automaticDataCollectionEnabled:!1},e),r=i.name;if("string"!=typeof r||!r)throw be.create("bad-app-name",{appName:String(r)});if(n||(n=vt()),!n)throw be.create("no-options");const s=pe.get(r);if(s){if(xt(n,s.options)&&xt(i,s.config))return s;throw be.create("duplicate-app",{appName:r})}const o=new Pt(r);for(const t of ge.values())o.addComponent(t);const a=new we(n,i,o);return pe.set(r,a),a}function qe(t=de){const e=pe.get(t);if(!e&&t===de&&vt())return _e();if(!e)throw be.create("no-app",{appName:t});return e}function ke(t,e,n){var i;let r=null!==(i=fe[t])&&void 0!==i?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${r}" with version "${e}":`];return s&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void he.warn(t.join(" "))}ye(new Dt(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const Te="firebase-heartbeat-database",xe=1,Ie="firebase-heartbeat-store";let Se=null;function Ae(){return Se||(Se=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=ee(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(ee(o.result),t.oldVersion,t.newVersion,ee(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(t=>r(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(Te,xe,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Ie)}catch(t){console.warn(t)}}}).catch((t=>{throw be.create("idb-open",{originalErrorMessage:t.message})}))),Se}async function Ne(t,e){try{const n=(await Ae()).transaction(Ie,"readwrite"),i=n.objectStore(Ie);await i.put(e,Ce(t)),await n.done}catch(t){if(t instanceof qt)he.warn(t.message);else{const e=be.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});he.warn(e.message)}}}function Ce(t){return`${t.name}!${t.options.appId}`}class Oe{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new De(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Le();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=Le(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),Re(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Re(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=pt(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Le(){return(new Date).toISOString().substring(0,10)}class De{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!_t()&&new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await Ae()).transaction(Ie),n=await e.objectStore(Ie).get(Ce(t));return await e.done,n}catch(t){if(t instanceof qt)he.warn(t.message);else{const e=be.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});he.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ne(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ne(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Re(t){return pt(JSON.stringify({version:2,heartbeats:t})).length}ye(new Dt("platform-logger",(t=>new le(t)),"PRIVATE")),ye(new Dt("heartbeat",(t=>new Oe(t)),"PRIVATE")),ke(ce,ue,""),ke(ce,ue,"esm2017"),ke("fire-js",""),ke("firebase","10.8.1","app"),_e({apiKey:"AIzaSyCWCD0fELIxsopuhhfJo1KLymb2krWtHfI",authDomain:"rcsmr-notes-app.firebaseapp.com",projectId:"rcsmr-notes-app",storageBucket:"rcsmr-notes-app.appspot.com",messagingSenderId:"367911567246",appId:"1:367911567246:web:9b062c0ba2bca47fcfeedf"});var Me,Pe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},je={},Ue=Ue||{},Fe=Pe||self;function Ve(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Be(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ze="closure_uid_"+(1e9*Math.random()>>>0),He=0;function $e(t,e,n){return t.call.apply(t.bind,arguments)}function We(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Ke(t,e,n){return(Ke=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?$e:We).apply(null,arguments)}function Ge(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Qe(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function Ye(){this.s=this.s,this.o=this.o}Ye.prototype.s=!1,Ye.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,ze)&&t[ze]||(t[ze]=++He))},Ye.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Xe=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Je(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Ze(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Ve(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function tn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}tn.prototype.h=function(){this.defaultPrevented=!0};var en=function(){if(!Fe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};Fe.addEventListener("test",t,e),Fe.removeEventListener("test",t,e)}catch(t){}return t}();function nn(t){return/^[\s\xa0]*$/.test(t)}function rn(){var t=Fe.navigator;return t&&(t=t.userAgent)?t:""}function sn(t){return-1!=rn().indexOf(t)}function on(t){return on[" "](t),t}on[" "]=function(){};var an,ln,cn,un=sn("Opera"),hn=sn("Trident")||sn("MSIE"),dn=sn("Edge"),fn=dn||hn,pn=sn("Gecko")&&!(-1!=rn().toLowerCase().indexOf("webkit")&&!sn("Edge"))&&!(sn("Trident")||sn("MSIE"))&&!sn("Edge"),gn=-1!=rn().toLowerCase().indexOf("webkit")&&!sn("Edge");function mn(){var t=Fe.document;return t?t.documentMode:void 0}t:{var yn="",vn=(ln=rn(),pn?/rv:([^\);]+)(\)|;)/.exec(ln):dn?/Edge\/([\d\.]+)/.exec(ln):hn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ln):gn?/WebKit\/(\S+)/.exec(ln):un?/(?:Version)[ \/]?(\S+)/.exec(ln):void 0);if(vn&&(yn=vn?vn[1]:""),hn){var bn=mn();if(null!=bn&&bn>parseFloat(yn)){an=String(bn);break t}}an=yn}Fe.document&&hn?cn=mn()||parseInt(an,10)||void 0:cn=void 0;var wn=cn;function En(t,e){if(tn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(pn){t:{try{on(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_n[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&En.$.h.call(this)}}Qe(En,tn);var _n={2:"touch",3:"pen",4:"mouse"};En.prototype.h=function(){En.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var qn="closure_listenable_"+(1e6*Math.random()|0),kn=0;function Tn(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=r,this.key=++kn,this.fa=this.ia=!1}function xn(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function In(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function Sn(t){const e={};for(const n in t)e[n]=t[n];return e}const An="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Nn(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<An.length;e++)n=An[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function Cn(t){this.src=t,this.g={},this.h=0}function On(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=Xe(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(xn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Ln(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==i)return r}return-1}Cn.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Ln(t,e,i,r);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Tn(e,this.src,s,!!i,r)).ia=n,t.push(e)),e};var Dn="closure_lm_"+(1e6*Math.random()|0),Rn={};function Mn(t,e,n,i,r){if(i&&i.once)return jn(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Mn(t,e[s],n,i,r);return null}return n=$n(n),t&&t[qn]?t.O(e,n,Be(i)?!!i.capture:!!i,r):Pn(t,e,n,!1,i,r)}function Pn(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=Be(r)?!!r.capture:!!r,a=zn(t);if(a||(t[Dn]=a=new Cn(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){const t=Bn;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)en||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Vn(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function jn(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)jn(t,e[s],n,i,r);return null}return n=$n(n),t&&t[qn]?t.P(e,n,Be(i)?!!i.capture:!!i,r):Pn(t,e,n,!0,i,r)}function Un(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Un(t,e[s],n,i,r);else i=Be(i)?!!i.capture:!!i,n=$n(n),t&&t[qn]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Ln(s=t.g[e],n,i,r))&&(xn(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=zn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ln(e,n,i,r)),(n=-1<t?e[t]:null)&&Fn(n))}function Fn(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[qn])On(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Vn(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=zn(e))?(On(n,t),0==n.h&&(n.src=null,e[Dn]=null)):xn(t)}}}function Vn(t){return t in Rn?Rn[t]:Rn[t]="on"+t}function Bn(t,e){if(t.fa)t=!0;else{e=new En(e,this);var n=t.listener,i=t.la||t.src;t.ia&&Fn(t),t=n.call(i,e)}return t}function zn(t){return(t=t[Dn])instanceof Cn?t:null}var Hn="__closure_events_fn_"+(1e9*Math.random()>>>0);function $n(t){return"function"==typeof t?t:(t[Hn]||(t[Hn]=function(e){return t.handleEvent(e)}),t[Hn])}function Wn(){Ye.call(this),this.i=new Cn(this),this.S=this,this.J=null}function Kn(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new tn(e,t);else if(e instanceof tn)e.target=e.target||t;else{var r=e;Nn(e=new tn(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Gn(o,i,!0,e)&&r}if(r=Gn(o=e.g=t,i,!0,e)&&r,r=Gn(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Gn(o=e.g=n[s],i,!1,e)&&r}function Gn(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&On(t.i,o),r=!1!==a.call(l,i)&&r}}return r&&!i.defaultPrevented}Qe(Wn,Ye),Wn.prototype[qn]=!0,Wn.prototype.removeEventListener=function(t,e,n,i){Un(this,t,e,n,i)},Wn.prototype.N=function(){if(Wn.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)xn(n[i]);delete e.g[t],e.h--}}this.J=null},Wn.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Wn.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Qn=Fe.JSON.stringify;function Yn(){var t=ii;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Xn=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Jn),(t=>t.reset()));class Jn{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Zn(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function ti(t){Fe.setTimeout((()=>{throw t}),0)}let ei,ni=!1,ii=new class{constructor(){this.h=this.g=null}add(t,e){const n=Xn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},ri=()=>{const t=Fe.Promise.resolve(void 0);ei=()=>{t.then(si)}};var si=()=>{for(var t;t=Yn();){try{t.h.call(t.g)}catch(t){ti(t)}var e=Xn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ni=!1};function oi(t,e){Wn.call(this),this.h=t||1,this.g=e||Fe,this.j=Ke(this.qb,this),this.l=Date.now()}function ai(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function li(t,e,n){if("function"==typeof t)n&&(t=Ke(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Ke(t.handleEvent,t)}return 2147483647<Number(e)?-1:Fe.setTimeout(t,e||0)}function ci(t){t.g=li((()=>{t.g=null,t.i&&(t.i=!1,ci(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Qe(oi,Wn),(Me=oi.prototype).ga=!1,Me.T=null,Me.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Kn(this,"tick"),this.ga&&(ai(this),this.start()))}},Me.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Me.N=function(){oi.$.N.call(this),ai(this),delete this.g};class ui extends Ye{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:ci(this)}N(){super.N(),this.g&&(Fe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hi(t){Ye.call(this),this.h=t,this.g={}}Qe(hi,Ye);var di=[];function fi(t,e,n,i){Array.isArray(n)||(n&&(di[0]=n.toString()),n=di);for(var r=0;r<n.length;r++){var s=Mn(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function pi(t){In(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Fn(t)}),t),t.g={}}function gi(){this.g=!0}function mi(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Qn(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}hi.prototype.N=function(){hi.$.N.call(this),pi(this)},hi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},gi.prototype.Ea=function(){this.g=!1},gi.prototype.info=function(){};var yi={},vi=null;function bi(){return vi=vi||new Wn}function wi(t){tn.call(this,yi.Ta,t)}function Ei(t){const e=bi();Kn(e,new wi(e))}function _i(t,e){tn.call(this,yi.STAT_EVENT,t),this.stat=e}function qi(t){const e=bi();Kn(e,new _i(e,t))}function ki(t,e){tn.call(this,yi.Ua,t),this.size=e}function Ti(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Fe.setTimeout((function(){t()}),e)}yi.Ta="serverreachability",Qe(wi,tn),yi.STAT_EVENT="statevent",Qe(_i,tn),yi.Ua="timingevent",Qe(ki,tn);var xi={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Ii={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Si(){}function Ai(t){return t.h||(t.h=t.i())}function Ni(){}Si.prototype.h=null;var Ci,Oi={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Li(){tn.call(this,"d")}function Di(){tn.call(this,"c")}function Ri(){}function Mi(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new hi(this),this.P=ji,t=fn?125:void 0,this.V=new oi(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Pi}function Pi(){this.i=null,this.g="",this.h=!1}Qe(Li,tn),Qe(Di,tn),Qe(Ri,Si),Ri.prototype.g=function(){return new XMLHttpRequest},Ri.prototype.i=function(){return{}},Ci=new Ri;var ji=45e3,Ui={},Fi={};function Vi(t,e,n){t.L=1,t.A=or(er(e)),t.u=n,t.S=!0,Bi(t,null)}function Bi(t,e){t.G=Date.now(),Wi(t),t.B=er(t.A);var n=t.B,i=t.W;Array.isArray(i)||(i=[String(i)]),br(n.i,"t",i),t.o=0,n=t.l.J,t.h=new Pi,t.g=bs(t.l,n?e:null,!t.u),0<t.O&&(t.M=new ui(Ke(t.Pa,t,t.g),t.O)),fi(t.U,t.g,"readystatechange",t.nb),e=t.I?Sn(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Ei(),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function zi(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Hi(t,e,n){let i,r=!0;for(;!t.J&&t.o<n.length;){if(i=$i(t,n),i==Fi){4==e&&(t.s=4,qi(14),r=!1),mi(t.j,t.m,null,"[Incomplete Response]");break}if(i==Ui){t.s=4,qi(15),mi(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}mi(t.j,t.m,i,null),Xi(t,i)}zi(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,qi(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),hs(e),e.M=!0,qi(11))):(mi(t.j,t.m,n,"[Invalid Chunked Response]"),Yi(t),Qi(t))}function $i(t,e){var n=t.o,i=e.indexOf("\n",n);return-1==i?Fi:(n=Number(e.substring(n,i)),isNaN(n)?Ui:(i+=1)+n>e.length?Fi:(e=e.slice(i,i+n),t.o=i+n,e))}function Wi(t){t.Y=Date.now()+t.P,Ki(t,t.P)}function Ki(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=Ti(Ke(t.lb,t),e)}function Gi(t){t.C&&(Fe.clearTimeout(t.C),t.C=null)}function Qi(t){0==t.l.H||t.J||ps(t.l,t)}function Yi(t){Gi(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,ai(t.V),pi(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Xi(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||xr(n.i,t)))if(!t.K&&xr(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;fs(n),is(n)}us(n),qi(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=Ti(Ke(n.ib,n),6e3));if(1>=Tr(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else ms(n,11)}else if((t.K||n.g==t)&&fs(n),!nn(e))for(r=n.Ja.g.parse(e),e=0;e<r.length;e++){let c=r[e];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const e=c[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const r=c[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Ir(s,s.h),s.h=null))}if(i.F){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,sr(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((i=n).wa=vs(i,i.J?i.pa:null,i.Y),o.K){Sr(i.i,o);var a=o,l=i.L;l&&a.setTimeout(l),a.C&&(Gi(a),Wi(a)),i.g=o}else cs(i);0<n.j.length&&ss(n)}else"stop"!=c[0]&&"close"!=c[0]||ms(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ms(n,7):ns(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}Ei()}catch(t){}}function Ji(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Ve(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Ve(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Ve(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}(Me=Mi.prototype).setTimeout=function(t){this.P=t},Me.nb=function(t){t=t.target;const e=this.M;e&&3==Yr(t)?e.l():this.Pa(t)},Me.Pa=function(t){try{if(t==this.g)t:{const u=Yr(this.g);var e=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||fn||this.g&&(this.h.h||this.g.ja()||Xr(this.g)))){this.J||4!=u||7==e||Ei(),Gi(this);var n=this.g.da();this.ca=n;e:if(zi(this)){var i=Xr(this.g);t="";var r=i.length,s=4==Yr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Yi(this),Qi(this);var o="";break e}this.h.i=new Fe.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!nn(a)){var c=a;break e}}c=null}if(!(n=c)){this.i=!1,this.s=3,qi(12),Yi(this),Qi(this);break t}mi(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xi(this,n)}this.S?(Hi(this,u,o),fn&&this.i&&3==u&&(fi(this.U,this.V,"tick",this.mb),this.V.start())):(mi(this.j,this.m,o,null),Xi(this,o)),4==u&&Yi(this),this.i&&!this.J&&(4==u?ps(this.l,this):(this.i=!1,Wi(this)))}else(function(t){const e={};t=(t.g&&2<=Yr(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(nn(t[i]))continue;var n=Zn(t[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[r]||[];e[r]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,qi(12)):(this.s=0,qi(13)),Yi(this),Qi(this)}}}catch(t){}},Me.mb=function(){if(this.g){var t=Yr(this.g),e=this.g.ja();this.o<e.length&&(Gi(this),Hi(this,t,e),this.i&&4!=t&&Wi(this))}},Me.cancel=function(){this.J=!0,Yi(this)},Me.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(Ei(),qi(17)),Yi(this),this.s=2,Qi(this)):Ki(this,this.Y-t)};var Zi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tr(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof tr){this.h=t.h,nr(this,t.j),this.s=t.s,this.g=t.g,ir(this,t.m),this.l=t.l;var e=t.i,n=new gr;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),rr(this,n),this.o=t.o}else t&&(e=String(t).match(Zi))?(this.h=!1,nr(this,e[1]||"",!0),this.s=ar(e[2]||""),this.g=ar(e[3]||"",!0),ir(this,e[4]),this.l=ar(e[5]||"",!0),rr(this,e[6]||"",!0),this.o=ar(e[7]||"")):(this.h=!1,this.i=new gr(null,this.h))}function er(t){return new tr(t)}function nr(t,e,n){t.j=n?ar(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ir(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function rr(t,e,n){e instanceof gr?(t.i=e,function(t,e){e&&!t.j&&(mr(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(yr(this,e),br(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=lr(e,fr)),t.i=new gr(e,t.h))}function sr(t,e,n){t.i.set(e,n)}function or(t){return sr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ar(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function lr(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,cr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}tr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(lr(e,ur,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(lr(e,ur,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(lr(n,"/"==n.charAt(0)?dr:hr,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",lr(n,pr)),t.join("")};var ur=/[#\/\?@]/g,hr=/[#\?:]/g,dr=/[#\?]/g,fr=/[#\?@]/g,pr=/#/g;function gr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function mr(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function yr(t,e){mr(t),e=wr(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function vr(t,e){return mr(t),e=wr(t,e),t.g.has(e)}function br(t,e,n){yr(t,e),0<n.length&&(t.i=null,t.g.set(wr(t,e),Je(n)),t.h+=n.length)}function wr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Me=gr.prototype).add=function(t,e){mr(this),this.i=null,t=wr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Me.forEach=function(t,e){mr(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},Me.ta=function(){mr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},Me.Z=function(t){mr(this);let e=[];if("string"==typeof t)vr(this,t)&&(e=e.concat(this.g.get(wr(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},Me.set=function(t,e){return mr(this),this.i=null,vr(this,t=wr(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Me.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},Me.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};var Er=class{constructor(t,e){this.g=t,this.map=e}};function _r(t){this.l=t||qr,t=Fe.PerformanceNavigationTiming?0<(t=Fe.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Fe.g&&Fe.g.Ka&&Fe.g.Ka()&&Fe.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var qr=10;function kr(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Tr(t){return t.h?1:t.g?t.g.size:0}function xr(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Ir(t,e){t.g?t.g.add(e):t.h=e}function Sr(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Ar(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Je(t.i)}_r.prototype.cancel=function(){if(this.i=Ar(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var Nr=class{stringify(t){return Fe.JSON.stringify(t,void 0)}parse(t){return Fe.JSON.parse(t,void 0)}};function Cr(){this.g=new Nr}function Or(t,e,n){const i=n||"";try{Ji(t,(function(t,n){let r=t;Be(t)&&(r=Qn(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Lr(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function Dr(t){this.l=t.ec||null,this.j=t.ob||!1}function Rr(t,e){Wn.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Mr,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Qe(Dr,Si),Dr.prototype.g=function(){return new Rr(this.l,this.j)},Dr.prototype.i=function(t){return function(){return t}}({}),Qe(Rr,Wn);var Mr=0;function Pr(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function jr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ur(t)}function Ur(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Me=Rr.prototype).open=function(t,e){if(this.readyState!=Mr)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ur(this)},Me.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Fe).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Me.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,jr(this)),this.readyState=Mr},Me.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ur(this)),this.g&&(this.readyState=3,Ur(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Fe.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Pr(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},Me.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?jr(this):Ur(this),3==this.readyState&&Pr(this)}},Me.Za=function(t){this.g&&(this.response=this.responseText=t,jr(this))},Me.Ya=function(t){this.g&&(this.response=t,jr(this))},Me.ka=function(){this.g&&jr(this)},Me.setRequestHeader=function(t,e){this.v.append(t,e)},Me.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Me.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Rr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Fr=Fe.JSON.parse;function Vr(t){Wn.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Br,this.L=this.M=!1}Qe(Vr,Wn);var Br="",zr=/^https?$/i,Hr=["POST","PUT"];function $r(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Wr(t),Gr(t)}function Wr(t){t.F||(t.F=!0,Kn(t,"complete"),Kn(t,"error"))}function Kr(t){if(t.h&&void 0!==Ue&&(!t.C[1]||4!=Yr(t)||2!=t.da()))if(t.v&&4==Yr(t))li(t.La,0,t);else if(Kn(t,"readystatechange"),4==Yr(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===o){var r=String(t.I).match(Zi)[1]||null;!r&&Fe.self&&Fe.self.location&&(r=Fe.self.location.protocol.slice(0,-1)),i=!zr.test(r?r.toLowerCase():"")}n=i}if(n)Kn(t,"complete"),Kn(t,"success");else{t.m=6;try{var s=2<Yr(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",Wr(t)}}finally{Gr(t)}}}function Gr(t,e){if(t.g){Qr(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Kn(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Qr(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Fe.clearTimeout(t.A),t.A=null)}function Yr(t){return t.g?t.g.readyState:0}function Xr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Br:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Jr(t){let e="";return In(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Zr(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=Jr(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sr(t,e,n))}function ts(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function es(t){this.Ga=0,this.j=[],this.l=new gi,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ts("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ts("baseRetryDelayMs",5e3,t),this.hb=ts("retryDelaySeedMs",1e4,t),this.eb=ts("forwardChannelMaxRetries",2,t),this.xa=ts("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new _r(t&&t.concurrentRequestLimit),this.Ja=new Cr,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function ns(t){if(rs(t),3==t.H){var e=t.W++,n=er(t.I);if(sr(n,"SID",t.K),sr(n,"RID",e),sr(n,"TYPE","terminate"),as(t,n),(e=new Mi(t,t.l,e)).L=2,e.A=or(er(n)),n=!1,Fe.navigator&&Fe.navigator.sendBeacon)try{n=Fe.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&Fe.Image&&((new Image).src=e.A,n=!0),n||(e.g=bs(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Wi(e)}ys(t)}function is(t){t.g&&(hs(t),t.g.cancel(),t.g=null)}function rs(t){is(t),t.u&&(Fe.clearTimeout(t.u),t.u=null),fs(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Fe.clearTimeout(t.m),t.m=null)}function ss(t){if(!kr(t.i)&&!t.m){t.m=!0;var e=t.Na;ei||ri(),ni||(ei(),ni=!0),ii.add(e,t),t.C=0}}function os(t,e){var n;n=e?e.m:t.W++;const i=er(t.I);sr(i,"SID",t.K),sr(i,"RID",n),sr(i,"AID",t.V),as(t,i),t.o&&t.s&&Zr(i,t.o,t.s),n=new Mi(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=ls(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Ir(t.i,n),Vi(n,i,e)}function as(t,e){t.na&&In(t.na,(function(t,n){sr(e,n,t)})),t.h&&Ji({},(function(t,n){sr(e,n,t)}))}function ls(t,e,n){n=Math.min(t.j.length,n);var i=t.h?Ke(t.h.Va,t.h,t):null;t:{var r=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=e,0>n)e=Math.max(0,r[o].g-100),s=!1;else try{Or(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function cs(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;ei||ri(),ni||(ei(),ni=!0),ii.add(e,t),t.A=0}}function us(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=Ti(Ke(t.Ma,t),gs(t,t.A)),t.A++,0))}function hs(t){null!=t.B&&(Fe.clearTimeout(t.B),t.B=null)}function ds(t){t.g=new Mi(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=er(t.wa);sr(e,"RID","rpc"),sr(e,"SID",t.K),sr(e,"AID",t.V),sr(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&sr(e,"TO",t.qa),sr(e,"TYPE","xmlhttp"),as(t,e),t.o&&t.s&&Zr(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=or(er(e)),n.u=null,n.S=!0,Bi(n,t)}function fs(t){null!=t.v&&(Fe.clearTimeout(t.v),t.v=null)}function ps(t,e){var n=null;if(t.g==e){fs(t),hs(t),t.g=null;var i=2}else{if(!xr(t.i,e))return;n=e.F,Sr(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.u?e.u.length:0,e=Date.now()-e.G;var r=t.C;Kn(i=bi(),new ki(i,n)),ss(t)}else cs(t);else if(3==(r=e.s)||0==r&&0<e.ca||!(1==i&&function(t,e){return!(Tr(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Ti(Ke(t.Na,t,e),gs(t,t.C)),t.C++,0)))}(t,e)||2==i&&us(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:ms(t,5);break;case 4:ms(t,10);break;case 3:ms(t,6);break;default:ms(t,2)}}function gs(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ms(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=Ke(t.pb,t);n||(n=new tr("//www.google.com/images/cleardot.gif"),Fe.location&&"http"==Fe.location.protocol||nr(n,"https"),or(n)),function(t,e){const n=new gi;if(Fe.Image){const i=new Image;i.onload=Ge(Lr,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Ge(Lr,n,i,"TestLoadImage: error",!1,e),i.onabort=Ge(Lr,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Ge(Lr,n,i,"TestLoadImage: timeout",!1,e),Fe.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else qi(2);t.H=0,t.h&&t.h.za(e),ys(t),rs(t)}function ys(t){if(t.H=0,t.ma=[],t.h){const e=Ar(t.i);0==e.length&&0==t.j.length||(Ze(t.ma,e),Ze(t.ma,t.j),t.i.i.length=0,Je(t.j),t.j.length=0),t.h.ya()}}function vs(t,e,n){var i=n instanceof tr?er(n):new tr(n);if(""!=i.g)e&&(i.g=e+"."+i.g),ir(i,i.m);else{var r=Fe.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new tr(null);i&&nr(s,i),e&&(s.g=e),r&&ir(s,r),n&&(s.l=n),i=s}return n=t.F,e=t.Da,n&&e&&sr(i,n,e),sr(i,"VER",t.ra),as(t,i),i}function bs(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Vr(new Dr({ob:n})):new Vr(t.va)).Oa(t.J),e}function ws(){}function Es(){if(hn&&!(10<=Number(wn)))throw Error("Environmental error: no available transport.")}function _s(t,e){Wn.call(this),this.g=new es(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!nn(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!nn(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Ts(this)}function qs(t){Li.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ks(){Di.call(this),this.status=1}function Ts(t){this.g=t}function xs(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Is(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}function Ss(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var s=0|t[r];i&&s==e||(n[r]=s,i=!1)}this.g=n}(Me=Vr.prototype).Oa=function(t){this.M=t},Me.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ci.g(),this.C=this.u?Ai(this.u):Ai(Ci),this.g.onreadystatechange=Ke(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void $r(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),r=Fe.FormData&&t instanceof Fe.FormData,!(0<=Xe(Hr,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Qr(this),0<this.B&&((this.L=function(t){return hn&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ke(this.ua,this)):this.A=li(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){$r(this,t)}},Me.ua=function(){void 0!==Ue&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Kn(this,"timeout"),this.abort(8))},Me.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Kn(this,"complete"),Kn(this,"abort"),Gr(this))},Me.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Gr(this,!0)),Vr.$.N.call(this)},Me.La=function(){this.s||(this.G||this.v||this.l?Kr(this):this.kb())},Me.kb=function(){Kr(this)},Me.isActive=function(){return!!this.g},Me.da=function(){try{return 2<Yr(this)?this.g.status:-1}catch(t){return-1}},Me.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Me.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Fr(e)}},Me.Ia=function(){return this.m},Me.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Me=es.prototype).ra=8,Me.H=1,Me.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new Mi(this,this.l,t);let s=this.s;if(this.U&&(s?(s=Sn(s),Nn(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=ls(this,r,e),sr(n=er(this.I),"RID",t),sr(n,"CVER",22),this.F&&sr(n,"X-HTTP-Session-Id",this.F),as(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Jr(s)))+"&"+e:this.o&&Zr(n,this.o,s)),Ir(this.i,r),this.bb&&sr(n,"TYPE","init"),this.P?(sr(n,"$req",e),sr(n,"SID","null"),r.aa=!0,Vi(r,n,null)):Vi(r,n,e),this.H=2}}else 3==this.H&&(t?os(this,t):0==this.j.length||kr(this.i)||os(this))},Me.Ma=function(){if(this.u=null,ds(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Ti(Ke(this.jb,this),t)}},Me.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,qi(10),is(this),ds(this))},Me.ib=function(){null!=this.v&&(this.v=null,is(this),us(this),qi(19))},Me.pb=function(t){t?(this.l.info("Successfully pinged google.com"),qi(2)):(this.l.info("Failed to ping google.com"),qi(1))},Me.isActive=function(){return!!this.h&&this.h.isActive(this)},(Me=ws.prototype).Ba=function(){},Me.Aa=function(){},Me.za=function(){},Me.ya=function(){},Me.isActive=function(){return!0},Me.Va=function(){},Es.prototype.g=function(t,e){return new _s(t,e)},Qe(_s,Wn),_s.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;qi(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=vs(t,null,t.Y),ss(t)},_s.prototype.close=function(){ns(this.g)},_s.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Qn(t),t=n);e.j.push(new Er(e.fb++,t)),3==e.H&&ss(e)},_s.prototype.N=function(){this.g.h=null,delete this.j,ns(this.g),delete this.g,_s.$.N.call(this)},Qe(qs,Li),Qe(ks,Di),Qe(Ts,ws),Ts.prototype.Ba=function(){Kn(this.g,"a")},Ts.prototype.Aa=function(t){Kn(this.g,new qs(t))},Ts.prototype.za=function(t){Kn(this.g,new ks)},Ts.prototype.ya=function(){Kn(this.g,"b")},Qe(xs,(function(){this.blockSize=-1})),xs.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},xs.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=n;)Is(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(i[r++]=t.charCodeAt(s++),r==this.blockSize){Is(this,i),r=0;break}}else for(;s<e;)if(i[r++]=t[s++],r==this.blockSize){Is(this,i),r=0;break}}this.h=r,this.i+=e},xs.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var As={};function Ns(t){return-128<=t&&128>t?function(t,e){var n=As;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new Ss([0|t],0>t?-1:0)}(t)}(t):new Ss([0|t],0>t?-1:0)}function Cs(t){if(isNaN(t)||!isFinite(t))return Ls;if(0>t)return js(Cs(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=Os;return new Ss(e,0)}var Os=4294967296,Ls=Ns(0),Ds=Ns(1),Rs=Ns(16777216);function Ms(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function Ps(t){return-1==t.h}function js(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new Ss(n,~t.h).add(Ds)}function Us(t,e){return t.add(js(e))}function Fs(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Vs(t,e){this.g=t,this.h=e}function Bs(t,e){if(Ms(e))throw Error("division by zero");if(Ms(t))return new Vs(Ls,Ls);if(Ps(t))return e=Bs(js(t),e),new Vs(js(e.g),js(e.h));if(Ps(e))return e=Bs(t,js(e)),new Vs(js(e.g),e.h);if(30<t.g.length){if(Ps(t)||Ps(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Ds,i=e;0>=i.X(t);)n=zs(n),i=zs(i);var r=Hs(n,1),s=Hs(i,1);for(i=Hs(i,2),n=Hs(n,2);!Ms(i);){var o=s.add(i);0>=o.X(t)&&(r=r.add(n),s=o),i=Hs(i,1),n=Hs(n,1)}return e=Us(t,r.R(e)),new Vs(r,e)}for(r=Ls;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=Cs(n)).R(e);Ps(o)||0<o.X(t);)o=(s=Cs(n-=i)).R(e);Ms(s)&&(s=Ds),r=r.add(s),t=Us(t,o)}return new Vs(r,t)}function zs(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new Ss(n,t.h)}function Hs(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],s=0;s<i;s++)r[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ss(r,t.h)}(Me=Ss.prototype).ea=function(){if(Ps(this))return-js(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:Os+i)*e,e*=Os}return t},Me.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Ms(this))return"0";if(Ps(this))return"-"+js(this).toString(t);for(var e=Cs(Math.pow(t,6)),n=this,i="";;){var r=Bs(n,e).g,s=((0<(n=Us(n,r.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Ms(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},Me.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},Me.X=function(t){return Ps(t=Us(this,t))?-1:Ms(t)?0:1},Me.abs=function(){return Ps(this)?js(this):this},Me.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&t.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new Ss(n,-2147483648&n[n.length-1]?-1:0)},Me.R=function(t){if(Ms(this)||Ms(t))return Ls;if(Ps(this))return Ps(t)?js(this).R(js(t)):js(js(this).R(t));if(Ps(t))return js(this.R(js(t)));if(0>this.X(Rs)&&0>t.X(Rs))return Cs(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=t.D(r)>>>16,l=65535&t.D(r);n[2*i+2*r]+=o*l,Fs(n,2*i+2*r),n[2*i+2*r+1]+=s*l,Fs(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,Fs(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,Fs(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new Ss(n,0)},Me.gb=function(t){return Bs(this,t).h},Me.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new Ss(n,this.h&t.h)},Me.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new Ss(n,this.h|t.h)},Me.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new Ss(n,this.h^t.h)},Es.prototype.createWebChannel=Es.prototype.g,_s.prototype.send=_s.prototype.u,_s.prototype.open=_s.prototype.m,_s.prototype.close=_s.prototype.close,xi.NO_ERROR=0,xi.TIMEOUT=8,xi.HTTP_ERROR=6,Ii.COMPLETE="complete",Ni.EventType=Oi,Oi.OPEN="a",Oi.CLOSE="b",Oi.ERROR="c",Oi.MESSAGE="d",Wn.prototype.listen=Wn.prototype.O,Vr.prototype.listenOnce=Vr.prototype.P,Vr.prototype.getLastError=Vr.prototype.Sa,Vr.prototype.getLastErrorCode=Vr.prototype.Ia,Vr.prototype.getStatus=Vr.prototype.da,Vr.prototype.getResponseJson=Vr.prototype.Wa,Vr.prototype.getResponseText=Vr.prototype.ja,Vr.prototype.send=Vr.prototype.ha,Vr.prototype.setWithCredentials=Vr.prototype.Oa,xs.prototype.digest=xs.prototype.l,xs.prototype.reset=xs.prototype.reset,xs.prototype.update=xs.prototype.j,Ss.prototype.add=Ss.prototype.add,Ss.prototype.multiply=Ss.prototype.R,Ss.prototype.modulo=Ss.prototype.gb,Ss.prototype.compare=Ss.prototype.X,Ss.prototype.toNumber=Ss.prototype.ea,Ss.prototype.toString=Ss.prototype.toString,Ss.prototype.getBits=Ss.prototype.D,Ss.fromNumber=Cs,Ss.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return js(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=Cs(Math.pow(n,8)),r=Ls,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=Cs(Math.pow(n,o)),r=r.R(o).add(Cs(a))):r=(r=r.R(i)).add(Cs(a))}return r};var $s=je.createWebChannelTransport=function(){return new Es},Ws=je.getStatEventTarget=function(){return bi()},Ks=je.ErrorCode=xi,Gs=je.EventType=Ii,Qs=je.Event=yi,Ys=je.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Xs=(je.FetchXmlHttpFactory=Dr,je.WebChannel=Ni),Js=je.XhrIo=Vr,Zs=je.Md5=xs,to=je.Integer=Ss;const eo="@firebase/firestore";class no{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}no.UNAUTHENTICATED=new no(null),no.GOOGLE_CREDENTIALS=new no("google-credentials-uid"),no.FIRST_PARTY=new no("first-party-uid"),no.MOCK_USER=new no("mock-user");let io="10.8.1";const ro=new Ht("@firebase/firestore");function so(){return ro.logLevel}function oo(t,...e){if(ro.logLevel<=Ut.DEBUG){const n=e.map(co);ro.debug(`Firestore (${io}): ${t}`,...n)}}function ao(t,...e){if(ro.logLevel<=Ut.ERROR){const n=e.map(co);ro.error(`Firestore (${io}): ${t}`,...n)}}function lo(t,...e){if(ro.logLevel<=Ut.WARN){const n=e.map(co);ro.warn(`Firestore (${io}): ${t}`,...n)}}function co(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function uo(t="Unexpected state"){const e=`FIRESTORE (${io}) INTERNAL ASSERTION FAILED: `+t;throw ao(e),new Error(e)}function ho(t,e){t||uo()}function fo(t,e){return t}const po={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class go extends qt{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class mo{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class yo{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class vo{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(no.UNAUTHENTICATED)))}shutdown(){}}class bo{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class wo{constructor(t){this.t=t,this.currentUser=no.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new mo;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new mo,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{oo("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(oo("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new mo)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(oo("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(ho("string"==typeof e.accessToken),new yo(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return ho(null===t||"string"==typeof t),new no(t)}}class Eo{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=no.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class _o{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new Eo(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(no.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class qo{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ko{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&oo("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,oo("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{oo("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):oo("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(ho("string"==typeof t.token),this.R=t.token,new qo(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function To(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class xo{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=To(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function Io(t,e){return t<e?-1:t>e?1:0}function So(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class Ao{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new go(po.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new go(po.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new go(po.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new go(po.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Ao.fromMillis(Date.now())}static fromDate(t){return Ao.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Ao(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Io(this.nanoseconds,t.nanoseconds):Io(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class No{constructor(t){this.timestamp=t}static fromTimestamp(t){return new No(t)}static min(){return new No(new Ao(0,0))}static max(){return new No(new Ao(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Co{constructor(t,e,n){void 0===e?e=0:e>t.length&&uo(),void 0===n?n=t.length-e:n>t.length-e&&uo(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Co.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Co?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Oo extends Co{construct(t,e,n){return new Oo(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new go(po.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Oo(e)}static emptyPath(){return new Oo([])}}const Lo=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Do extends Co{construct(t,e,n){return new Do(t,e,n)}static isValidIdentifier(t){return Lo.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Do.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Do(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new go(po.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new go(po.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new go(po.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new go(po.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Do(e)}static emptyPath(){return new Do([])}}class Ro{constructor(t){this.path=t}static fromPath(t){return new Ro(Oo.fromString(t))}static fromName(t){return new Ro(Oo.fromString(t).popFirst(5))}static empty(){return new Ro(Oo.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Oo.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Oo.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ro(new Oo(t.slice()))}}function Mo(t){return new Po(t.readTime,t.key,-1)}class Po{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Po(No.min(),Ro.empty(),-1)}static max(){return new Po(No.max(),Ro.empty(),-1)}}function jo(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Ro.comparator(t.documentKey,e.documentKey),0!==n?n:Io(t.largestBatchId,e.largestBatchId))}const Uo="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Fo{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Vo(t){if(t.code!==po.FAILED_PRECONDITION||t.message!==Uo)throw t;oo("LocalStore","Unexpectedly lost primary lease")}class Bo{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&uo(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Bo(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Bo?e:Bo.resolve(e)}catch(t){return Bo.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Bo.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Bo.reject(e)}static resolve(t){return new Bo(((e,n)=>{e(t)}))}static reject(t){return new Bo(((e,n)=>{n(t)}))}static waitFor(t){return new Bo(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=Bo.resolve(!1);for(const n of t)e=e.next((t=>t?Bo.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Bo(((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const l=a;e(t[l]).next((t=>{s[l]=t,++o,o===r&&n(s)}),(t=>i(t)))}}))}static doWhile(t,e){return new Bo(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}class zo{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new mo,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Wo(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=Xo(e.target.error);this.V.reject(new Wo(t,n))}}static open(t,e,n,i){try{return new zo(e,t.transaction(i,n))}catch(t){throw new Wo(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(oo("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new Go(e)}}class Ho{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===Ho.S(Et())&&ao("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return oo("SimpleDb","Removing database:",t),Qo(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!_t())return!1;if(Ho.C())return!0;const t=Et(),e=Ho.S(t),n=0<e&&e<10,i=Ho.v(t),r=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||r)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(oo("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=t=>{const n=t.target.result;e(n)},i.onblocked=()=>{n(new Wo(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=e=>{const i=e.target.error;"VersionError"===i.name?n(new go(po.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new go(po.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new Wo(t,i))},i.onupgradeneeded=t=>{oo("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,i.transaction,t.oldVersion,this.version).next((()=>{oo("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,i){const r="readonly"===e;let s=0;for(;;){++s;try{this.db=await this.O(t);const e=zo.open(this.db,t,r?"readonly":"readwrite",n),s=i(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),Bo.reject(t)))).toPromise();return s.catch((()=>{})),await e.m,s}catch(t){const e=t,n="FirebaseError"!==e.name&&s<3;if(oo("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class $o{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return Qo(this.k.delete())}}class Wo extends go{constructor(t,e){super(po.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Ko(t){return"IndexedDbTransactionError"===t.name}class Go{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(oo("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(oo("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Qo(n)}add(t){return oo("SimpleDb","ADD",this.store.name,t,t),Qo(this.store.add(t))}get(t){return Qo(this.store.get(t)).next((e=>(void 0===e&&(e=null),oo("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return oo("SimpleDb","DELETE",this.store.name,t),Qo(this.store.delete(t))}count(){return oo("SimpleDb","COUNT",this.store.name),Qo(this.store.count())}W(t,e){const n=this.options(t,e),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const t=i.getAll(n.range);return new Bo(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new Bo(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){oo("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const i=this.cursor(n);return this.G(i,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const i=this.cursor(n);return this.G(i,e)}Z(t){const e=this.cursor({});return new Bo(((n,i)=>{e.onerror=t=>{const e=Xo(t.target.error);i(e)},e.onsuccess=e=>{const i=e.target.result;i?t(i.primaryKey,i.value).next((t=>{t?i.continue():n()})):n()}}))}G(t,e){const n=[];return new Bo(((i,r)=>{t.onerror=t=>{r(t.target.error)},t.onsuccess=t=>{const r=t.target.result;if(!r)return void i();const s=new $o(r),o=e(r.primaryKey,r.value,s);if(o instanceof Bo){const t=o.catch((t=>(s.done(),Bo.reject(t))));n.push(t)}s.isDone?i():null===s.$?r.continue():r.continue(s.$)}})).next((()=>Bo.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Qo(t){return new Bo(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=Xo(t.target.error);n(e)}}))}let Yo=!1;function Xo(t){const e=Ho.S(Et());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new go("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Yo||(Yo=!0,setTimeout((()=>{throw t}),0)),t}}return t}class Jo{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function Zo(t){return null==t}function ta(t){return 0===t&&1/t==-1/0}Jo._e=-1;function ea(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function na(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ia(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class ra{constructor(t,e){this.comparator=t,this.root=e||oa.EMPTY}insert(t,e){return new ra(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,oa.BLACK,null,null))}remove(t){return new ra(this.comparator,this.root.remove(t,this.comparator).copy(null,null,oa.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new sa(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new sa(this.root,t,this.comparator,!1)}getReverseIterator(){return new sa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new sa(this.root,t,this.comparator,!0)}}class sa{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class oa{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:oa.RED,this.left=null!=i?i:oa.EMPTY,this.right=null!=r?r:oa.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new oa(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return oa.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return oa.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,oa.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,oa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw uo();if(this.right.isRed())throw uo();const t=this.left.check();if(t!==this.right.check())throw uo();return t+(this.isRed()?0:1)}}oa.EMPTY=null,oa.RED=!0,oa.BLACK=!1,oa.EMPTY=new class{constructor(){this.size=0}get key(){throw uo()}get value(){throw uo()}get color(){throw uo()}get left(){throw uo()}get right(){throw uo()}copy(t,e,n,i,r){return this}insert(t,e,n){return new oa(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class aa{constructor(t){this.comparator=t,this.data=new ra(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new la(this.data.getIterator())}getIteratorFrom(t){return new la(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof aa))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new aa(this.comparator);return e.data=t,e}}class la{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ca{constructor(t){this.fields=t,t.sort(Do.comparator)}static empty(){return new ca([])}unionWith(t){let e=new aa(Do.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new ca(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return So(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class ua extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ha{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new ua("Invalid base64 string: "+t):t}}(t);return new ha(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ha(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Io(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ha.EMPTY_BYTE_STRING=new ha("");const da=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fa(t){if(ho(!!t),"string"==typeof t){let e=0;const n=da.exec(t);if(ho(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:pa(t.seconds),nanos:pa(t.nanos)}}function pa(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ga(t){return"string"==typeof t?ha.fromBase64String(t):ha.fromUint8Array(t)}function ma(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ya(t){const e=t.mapValue.fields.__previous_value__;return ma(e)?ya(e):e}function va(t){const e=fa(t.mapValue.fields.__local_write_time__.timestampValue);return new Ao(e.seconds,e.nanos)}class ba{constructor(t,e,n,i,r,s,o,a,l){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class wa{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new wa("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof wa&&t.projectId===this.projectId&&t.database===this.database}}const Ea={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function _a(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ma(t)?4:Ma(t)?9007199254740991:10:uo()}function qa(t,e){if(t===e)return!0;const n=_a(t);if(n!==_a(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return va(t).isEqual(va(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=fa(t.timestampValue),i=fa(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ga(t.bytesValue).isEqual(ga(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return pa(t.geoPointValue.latitude)===pa(e.geoPointValue.latitude)&&pa(t.geoPointValue.longitude)===pa(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return pa(t.integerValue)===pa(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=pa(t.doubleValue),i=pa(e.doubleValue);return n===i?ta(n)===ta(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return So(t.arrayValue.values||[],e.arrayValue.values||[],qa);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(ea(n)!==ea(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!qa(n[t],i[t])))return!1;return!0}(t,e);default:return uo()}}function ka(t,e){return void 0!==(t.values||[]).find((t=>qa(t,e)))}function Ta(t,e){if(t===e)return 0;const n=_a(t),i=_a(e);if(n!==i)return Io(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Io(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=pa(t.integerValue||t.doubleValue),i=pa(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return xa(t.timestampValue,e.timestampValue);case 4:return xa(va(t),va(e));case 5:return Io(t.stringValue,e.stringValue);case 6:return function(t,e){const n=ga(t),i=ga(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=Io(n[t],i[t]);if(0!==e)return e}return Io(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Io(pa(t.latitude),pa(e.latitude));return 0!==n?n:Io(pa(t.longitude),pa(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Ta(n[t],i[t]);if(e)return e}return Io(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===Ea.mapValue&&e===Ea.mapValue)return 0;if(t===Ea.mapValue)return 1;if(e===Ea.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=Io(i[t],s[t]);if(0!==e)return e;const o=Ta(n[i[t]],r[s[t]]);if(0!==o)return o}return Io(i.length,s.length)}(t.mapValue,e.mapValue);default:throw uo()}}function xa(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Io(t,e);const n=fa(t),i=fa(e),r=Io(n.seconds,i.seconds);return 0!==r?r:Io(n.nanos,i.nanos)}function Ia(t){return Sa(t)}function Sa(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=fa(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return ga(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return Ro.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Sa(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${Sa(t.fields[r])}`;return n+"}"}(t.mapValue):uo()}function Aa(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Na(t){return!!t&&"integerValue"in t}function Ca(t){return!!t&&"arrayValue"in t}function Oa(t){return!!t&&"nullValue"in t}function La(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Da(t){return!!t&&"mapValue"in t}function Ra(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return na(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Ra(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ra(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ma(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Pa{constructor(t){this.value=t}static empty(){return new Pa({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Da(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ra(e)}setAll(t){let e=Do.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=Ra(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Da(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return qa(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Da(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){na(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Pa(Ra(this.value))}}function ja(t){const e=[];return na(t.fields,((t,n)=>{const i=new Do([t]);if(Da(n)){const t=ja(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new ca(e)}class Ua{constructor(t,e,n,i,r,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(t){return new Ua(t,0,No.min(),No.min(),No.min(),Pa.empty(),0)}static newFoundDocument(t,e,n,i){return new Ua(t,1,e,No.min(),n,i,0)}static newNoDocument(t,e){return new Ua(t,2,e,No.min(),No.min(),Pa.empty(),0)}static newUnknownDocument(t,e){return new Ua(t,3,e,No.min(),No.min(),Pa.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(No.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Pa.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Pa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=No.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Ua&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ua(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Fa{constructor(t,e){this.position=t,this.inclusive=e}}function Va(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?Ro.comparator(Ro.fromName(o.referenceValue),n.key):Ta(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Ba(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!qa(t.position[n],e.position[n]))return!1;return!0}class za{constructor(t,e="asc"){this.field=t,this.dir=e}}function Ha(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class $a{}class Wa extends $a{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Za(t,e,n):"array-contains"===e?new il(t,n):"in"===e?new rl(t,n):"not-in"===e?new sl(t,n):"array-contains-any"===e?new ol(t,n):new Wa(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new tl(t,n):new el(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Ta(e,this.value)):null!==e&&_a(this.value)===_a(e)&&this.matchesComparison(Ta(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return uo()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ka extends $a{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new Ka(t,e)}matches(t){return Ga(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Ga(t){return"and"===t.op}function Qa(t){return function(t){for(const e of t.filters)if(e instanceof Ka)return!1;return!0}(t)&&Ga(t)}function Ya(t){if(t instanceof Wa)return t.field.canonicalString()+t.op.toString()+Ia(t.value);if(Qa(t))return t.filters.map((t=>Ya(t))).join(",");{const e=t.filters.map((t=>Ya(t))).join(",");return`${t.op}(${e})`}}function Xa(t,e){return t instanceof Wa?function(t,e){return e instanceof Wa&&t.op===e.op&&t.field.isEqual(e.field)&&qa(t.value,e.value)}(t,e):t instanceof Ka?function(t,e){return e instanceof Ka&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&Xa(n,e.filters[i])),!0)}(t,e):void uo()}function Ja(t){return t instanceof Wa?function(t){return`${t.field.canonicalString()} ${t.op} ${Ia(t.value)}`}(t):t instanceof Ka?function(t){return t.op.toString()+" {"+t.getFilters().map(Ja).join(" ,")+"}"}(t):"Filter"}class Za extends Wa{constructor(t,e,n){super(t,e,n),this.key=Ro.fromName(n.referenceValue)}matches(t){const e=Ro.comparator(t.key,this.key);return this.matchesComparison(e)}}class tl extends Wa{constructor(t,e){super(t,"in",e),this.keys=nl(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class el extends Wa{constructor(t,e){super(t,"not-in",e),this.keys=nl(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function nl(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Ro.fromName(t.referenceValue)))}class il extends Wa{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Ca(e)&&ka(e.arrayValue,this.value)}}class rl extends Wa{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&ka(this.value.arrayValue,e)}}class sl extends Wa{constructor(t,e){super(t,"not-in",e)}matches(t){if(ka(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!ka(this.value.arrayValue,e)}}class ol extends Wa{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Ca(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>ka(this.value.arrayValue,t)))}}class al{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ce=null}}function ll(t,e=null,n=[],i=[],r=null,s=null,o=null){return new al(t,e,n,i,r,s,o)}function cl(t){const e=fo(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Ya(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Zo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Ia(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Ia(t))).join(",")),e.ce=t}return e.ce}function ul(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Ha(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Xa(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ba(t.startAt,e.startAt)&&Ba(t.endAt,e.endAt)}function hl(t){return Ro.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class dl{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function fl(t){return new dl(t)}function pl(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function gl(t){return null!==t.collectionGroup}function ml(t){const e=fo(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new aa(Do.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.le.push(new za(i,n))})),t.has(Do.keyField().canonicalString())||e.le.push(new za(Do.keyField(),n))}return e.le}function yl(t){const e=fo(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return ll(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new za(t.field,e)}));const n=t.endAt?new Fa(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Fa(t.startAt.position,t.startAt.inclusive):null;return ll(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}(e,ml(t))),e.he}function vl(t,e){const n=t.filters.concat([e]);return new dl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function bl(t,e,n){return new dl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function wl(t,e){return ul(yl(t),yl(e))&&t.limitType===e.limitType}function El(t){return`${cl(yl(t))}|lt:${t.limitType}`}function _l(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Ja(t))).join(", ")}]`),Zo(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Ia(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Ia(t))).join(",")),`Target(${e})`}(yl(t))}; limitType=${t.limitType})`}function ql(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ro.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of ml(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Va(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,ml(t),e)||t.endAt&&!function(t,e,n){const i=Va(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,ml(t),e))}(t,e)}function kl(t){return(e,n)=>{let i=!1;for(const r of ml(t)){const t=Tl(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function Tl(t,e,n){const i=t.field.isKeyField()?Ro.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?Ta(i,r):uo()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return uo()}}class xl{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){na(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return ia(this.inner)}size(){return this.innerSize}}const Il=new ra(Ro.comparator);function Sl(){return Il}const Al=new ra(Ro.comparator);function Nl(...t){let e=Al;for(const n of t)e=e.insert(n.key,n);return e}function Cl(t){let e=Al;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Ol(){return Dl()}function Ll(){return Dl()}function Dl(){return new xl((t=>t.toString()),((t,e)=>t.isEqual(e)))}const Rl=new ra(Ro.comparator),Ml=new aa(Ro.comparator);function Pl(...t){let e=Ml;for(const n of t)e=e.add(n);return e}const jl=new aa(Io);function Ul(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ta(e)?"-0":e}}function Fl(t){return{integerValue:""+t}}function Vl(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!ta(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Fl(e):Ul(t,e)}class Bl{constructor(){this._=void 0}}function zl(t,e,n){return t instanceof Wl?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&ma(e)&&(e=ya(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Kl?Gl(t,e):t instanceof Ql?Yl(t,e):function(t,e){const n=$l(t,e),i=Jl(n)+Jl(t.Ie);return Na(n)&&Na(t.Ie)?Fl(i):Ul(t.serializer,i)}(t,e)}function Hl(t,e,n){return t instanceof Kl?Gl(t,e):t instanceof Ql?Yl(t,e):n}function $l(t,e){return t instanceof Xl?function(t){return Na(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Wl extends Bl{}class Kl extends Bl{constructor(t){super(),this.elements=t}}function Gl(t,e){const n=Zl(e);for(const e of t.elements)n.some((t=>qa(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Ql extends Bl{constructor(t){super(),this.elements=t}}function Yl(t,e){let n=Zl(e);for(const e of t.elements)n=n.filter((t=>!qa(t,e)));return{arrayValue:{values:n}}}class Xl extends Bl{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Jl(t){return pa(t.integerValue||t.doubleValue)}function Zl(t){return Ca(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class tc{constructor(t,e){this.version=t,this.transformResults=e}}class ec{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ec}static exists(t){return new ec(void 0,t)}static updateTime(t){return new ec(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function nc(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class ic{}function rc(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new pc(t.key,ec.none()):new cc(t.key,t.data,ec.none());{const n=t.data,i=Pa.empty();let r=new aa(Do.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new uc(t.key,i,new ca(r.toArray()),ec.none())}}function sc(t,e,n){t instanceof cc?function(t,e,n){const i=t.value.clone(),r=dc(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof uc?function(t,e,n){if(!nc(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=dc(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(hc(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function oc(t,e,n,i){return t instanceof cc?function(t,e,n,i){if(!nc(t.precondition,e))return n;const r=t.value.clone(),s=fc(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof uc?function(t,e,n,i){if(!nc(t.precondition,e))return n;const r=fc(t.fieldTransforms,i,e),s=e.data;return s.setAll(hc(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return nc(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function ac(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=$l(i.transform,t||null);null!=r&&(null===n&&(n=Pa.empty()),n.set(i.field,r))}return n||null}function lc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&So(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Kl&&e instanceof Kl||t instanceof Ql&&e instanceof Ql?So(t.elements,e.elements,qa):t instanceof Xl&&e instanceof Xl?qa(t.Ie,e.Ie):t instanceof Wl&&e instanceof Wl}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class cc extends ic{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class uc extends ic{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function hc(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function dc(t,e,n){const i=new Map;ho(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Hl(o,a,n[r]))}return i}function fc(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,zl(t,s,e))}return i}class pc extends ic{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gc extends ic{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mc{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&sc(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=oc(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=oc(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Ll();return this.mutations.forEach((i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=rc(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(No.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Pl())}isEqual(t){return this.batchId===t.batchId&&So(this.mutations,t.mutations,((t,e)=>lc(t,e)))&&So(this.baseMutations,t.baseMutations,((t,e)=>lc(t,e)))}}class yc{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){ho(t.mutations.length===n.length);let i=Rl;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new yc(t,e,n,i)}}class vc{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class bc{constructor(t,e){this.count=t,this.unchangedNames=e}}var wc,Ec;function _c(t){if(void 0===t)return ao("GRPC error has no .code"),po.UNKNOWN;switch(t){case wc.OK:return po.OK;case wc.CANCELLED:return po.CANCELLED;case wc.UNKNOWN:return po.UNKNOWN;case wc.DEADLINE_EXCEEDED:return po.DEADLINE_EXCEEDED;case wc.RESOURCE_EXHAUSTED:return po.RESOURCE_EXHAUSTED;case wc.INTERNAL:return po.INTERNAL;case wc.UNAVAILABLE:return po.UNAVAILABLE;case wc.UNAUTHENTICATED:return po.UNAUTHENTICATED;case wc.INVALID_ARGUMENT:return po.INVALID_ARGUMENT;case wc.NOT_FOUND:return po.NOT_FOUND;case wc.ALREADY_EXISTS:return po.ALREADY_EXISTS;case wc.PERMISSION_DENIED:return po.PERMISSION_DENIED;case wc.FAILED_PRECONDITION:return po.FAILED_PRECONDITION;case wc.ABORTED:return po.ABORTED;case wc.OUT_OF_RANGE:return po.OUT_OF_RANGE;case wc.UNIMPLEMENTED:return po.UNIMPLEMENTED;case wc.DATA_LOSS:return po.DATA_LOSS;default:return uo()}}(Ec=wc||(wc={}))[Ec.OK=0]="OK",Ec[Ec.CANCELLED=1]="CANCELLED",Ec[Ec.UNKNOWN=2]="UNKNOWN",Ec[Ec.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ec[Ec.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ec[Ec.NOT_FOUND=5]="NOT_FOUND",Ec[Ec.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ec[Ec.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ec[Ec.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ec[Ec.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ec[Ec.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ec[Ec.ABORTED=10]="ABORTED",Ec[Ec.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ec[Ec.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ec[Ec.INTERNAL=13]="INTERNAL",Ec[Ec.UNAVAILABLE=14]="UNAVAILABLE",Ec[Ec.DATA_LOSS=15]="DATA_LOSS";const qc=new to([4294967295,4294967295],0);function kc(t){const e=(new TextEncoder).encode(t),n=new Zs;return n.update(e),new Uint8Array(n.digest())}function Tc(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new to([n,i],0),new to([r,s],0)]}class xc{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new Ic(`Invalid padding: ${e}`);if(n<0)throw new Ic(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new Ic(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new Ic(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=to.fromNumber(this.Te)}de(t,e,n){let i=t.add(e.multiply(to.fromNumber(n)));return 1===i.compare(qc)&&(i=new to([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return 0!=(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=kc(t),[n,i]=Tc(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);if(!this.Ae(e))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),s=new xc(r,i,e);return n.forEach((t=>s.insert(t))),s}insert(t){if(0===this.Te)return;const e=kc(t),[n,i]=Tc(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);this.Re(e)}}Re(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class Ic extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Sc{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,Ac.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Sc(No.min(),i,new ra(Io),Sl(),Pl())}}class Ac{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Ac(n,e,Pl(),Pl(),Pl())}}class Nc{constructor(t,e,n,i){this.Ve=t,this.removedTargetIds=e,this.key=n,this.me=i}}class Cc{constructor(t,e){this.targetId=t,this.fe=e}}class Oc{constructor(t,e,n=ha.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class Lc{constructor(){this.ge=0,this.pe=Mc(),this.ye=ha.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=Pl(),e=Pl(),n=Pl();return this.pe.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:uo()}})),new Ac(this.ye,this.we,t,e,n)}Fe(){this.Se=!1,this.pe=Mc()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,ho(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Dc{constructor(t){this.Le=t,this.ke=new Map,this.qe=Sl(),this.Qe=Rc(),this.Ke=new ra(Io)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,(e=>{const n=this.ze(e);switch(t.state){case 0:this.je(e)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(e);break;case 3:this.je(e)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),n.Ce(t.resumeToken));break;default:uo()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach(((t,n)=>{this.je(n)&&e(n)}))}Je(t){const e=t.targetId,n=t.fe.count,i=this.Ye(e);if(i){const r=i.target;if(hl(r))if(0===n){const t=new Ro(r.path);this.We(e,t,Ua.newNoDocument(t,No.min()))}else ho(1===n);else{const i=this.Ze(e);if(i!==n){const n=this.Xe(t),r=n?this.et(n,t,i):1;if(0!==r){this.He(e);const t=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,t)}}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=e;let s,o;try{s=ga(n).toUint8Array()}catch(t){if(t instanceof ua)return lo("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new xc(s,i,r)}catch(t){return lo(t instanceof Ic?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.Te?null:o}et(t,e,n){return e.fe.count===n-this.rt(t,e.targetId)?0:2}rt(t,e){const n=this.Le.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const r=this.Le.nt(),s=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;t.mightContain(s)||(this.We(e,n,null),i++)})),i}it(t){const e=new Map;this.ke.forEach(((n,i)=>{const r=this.Ye(i);if(r){if(n.current&&hl(r.target)){const e=new Ro(r.target.path);null!==this.qe.get(e)||this.st(i,e)||this.We(i,e,Ua.newNoDocument(e,t))}n.De&&(e.set(i,n.ve()),n.Fe())}}));let n=Pl();this.Qe.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Ye(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.qe.forEach(((e,n)=>n.setReadTime(t)));const i=new Sc(t,e,this.Ke,this.qe,n);return this.qe=Sl(),this.Qe=Rc(),this.Ke=new ra(Io),i}Ue(t,e){if(!this.je(t))return;const n=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,n),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,e)?i.Me(e,1):i.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),n&&(this.qe=this.qe.insert(e,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new Lc,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new aa(Io),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||oo("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new Lc),this.Le.getRemoteKeysForTarget(t).forEach((e=>{this.We(t,e,null)}))}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function Rc(){return new ra(Ro.comparator)}function Mc(){return new ra(Ro.comparator)}const Pc={asc:"ASCENDING",desc:"DESCENDING"},jc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Uc={and:"AND",or:"OR"};class Fc{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Vc(t,e){return t.useProto3Json||Zo(e)?e:{value:e}}function Bc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zc(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Hc(t,e){return Bc(t,e.toTimestamp())}function $c(t){return ho(!!t),No.fromTimestamp(function(t){const e=fa(t);return new Ao(e.seconds,e.nanos)}(t))}function Wc(t,e){return Kc(t,e).canonicalString()}function Kc(t,e){const n=function(t){return new Oo(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Gc(t){const e=Oo.fromString(t);return ho(du(e)),e}function Qc(t,e){return Wc(t.databaseId,e.path)}function Yc(t,e){const n=Gc(e);if(n.get(1)!==t.databaseId.projectId)throw new go(po.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new go(po.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ro(Zc(n))}function Xc(t,e){return Wc(t.databaseId,e)}function Jc(t){return new Oo(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Zc(t){return ho(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function tu(t,e,n){return{name:Qc(t,e),fields:n.value.mapValue.fields}}function eu(t,e){return{documents:[Xc(t,e.path)]}}function nu(t,e){const n={structuredQuery:{}},i=e.path;let r;null!==e.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Xc(t,r);const s=function(t){if(0!==t.length)return uu(Ka.create(t,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:lu(t.field),direction:su(t.dir)}}(t)))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Vc(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{ut:n,parent:r}}function iu(t){let e=function(t){const e=Gc(t);return 4===e.length?Oo.emptyPath():Zc(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){ho(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=ru(t);return e instanceof Ka&&Qa(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new za(cu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Zo(e)?null:e}(n.limit));let l=null;n.startAt&&(l=function(t){const e=!!t.before,n=t.values||[];return new Fa(n,e)}(n.startAt));let c=null;return n.endAt&&(c=function(t){const e=!t.before,n=t.values||[];return new Fa(n,e)}(n.endAt)),function(t,e,n,i,r,s,o,a){return new dl(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",l,c)}function ru(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=cu(t.unaryFilter.field);return Wa.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=cu(t.unaryFilter.field);return Wa.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=cu(t.unaryFilter.field);return Wa.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=cu(t.unaryFilter.field);return Wa.create(r,"!=",{nullValue:"NULL_VALUE"});default:return uo()}}(t):void 0!==t.fieldFilter?function(t){return Wa.create(cu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return uo()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Ka.create(t.compositeFilter.filters.map((t=>ru(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return uo()}}(t.compositeFilter.op))}(t):uo()}function su(t){return Pc[t]}function ou(t){return jc[t]}function au(t){return Uc[t]}function lu(t){return{fieldPath:t.canonicalString()}}function cu(t){return Do.fromServerFormat(t.fieldPath)}function uu(t){return t instanceof Wa?function(t){if("=="===t.op){if(La(t.value))return{unaryFilter:{field:lu(t.field),op:"IS_NAN"}};if(Oa(t.value))return{unaryFilter:{field:lu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(La(t.value))return{unaryFilter:{field:lu(t.field),op:"IS_NOT_NAN"}};if(Oa(t.value))return{unaryFilter:{field:lu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lu(t.field),op:ou(t.op),value:t.value}}}(t):t instanceof Ka?function(t){const e=t.getFilters().map((t=>uu(t)));return 1===e.length?e[0]:{compositeFilter:{op:au(t.op),filters:e}}}(t):uo()}function hu(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function du(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class fu{constructor(t,e,n,i,r=No.min(),s=No.min(),o=ha.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new fu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new fu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new fu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new fu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class pu{constructor(t){this.ct=t}}function gu(t){const e=iu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?bl(e,e.limit,"L"):e}class mu{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(pa(t.integerValue));else if("doubleValue"in t){const n=pa(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),ta(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(ga(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?Ma(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):uo()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),Ro.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}mu.bt=new mu;class yu{constructor(){this._n=new vu}addToCollectionParentIndex(t,e){return this._n.add(e),Bo.resolve()}getCollectionParents(t,e){return Bo.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return Bo.resolve()}deleteFieldIndex(t,e){return Bo.resolve()}deleteAllFieldIndexes(t){return Bo.resolve()}createTargetIndexes(t,e){return Bo.resolve()}getDocumentsMatchingTarget(t,e){return Bo.resolve(null)}getIndexType(t,e){return Bo.resolve(0)}getFieldIndexes(t,e){return Bo.resolve([])}getNextCollectionGroupToUpdate(t){return Bo.resolve(null)}getMinOffset(t,e){return Bo.resolve(Po.min())}getMinOffsetFromCollectionGroup(t,e){return Bo.resolve(Po.min())}updateCollectionGroup(t,e,n){return Bo.resolve()}updateIndexEntries(t,e){return Bo.resolve()}}class vu{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new aa(Oo.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new aa(Oo.comparator)).toArray()}}new Uint8Array(0);class bu{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new bu(t,bu.DEFAULT_COLLECTION_PERCENTILE,bu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}bu.DEFAULT_COLLECTION_PERCENTILE=10,bu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bu.DEFAULT=new bu(41943040,bu.DEFAULT_COLLECTION_PERCENTILE,bu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bu.DISABLED=new bu(-1,0,0);class wu{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new wu(0)}static Bn(){return new wu(-1)}}class Eu{constructor(){this.changes=new xl((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ua.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Bo.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class _u{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class qu{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&oc(n.mutation,t,ca.empty(),Ao.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,Pl()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=Pl()){const i=Ol();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=Nl();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=Ol();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,Pl())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=Sl();const s=Dl(),o=Dl();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof uc)?r=r.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),oc(o.mutation,e,o.mutation.getFieldMask(),Ao.now())):s.set(e.key,ca.empty())})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new _u(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=Dl();let i=new ra(((t,e)=>t-e)),r=Pl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||ca.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||Pl()).add(t);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,l=i.value,c=Ll();l.forEach((t=>{if(!r.has(t)){const i=rc(e.get(t),n.get(t));null!==i&&c.set(t,i),r=r.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,c))}return Bo.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return Ro.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):gl(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):Bo.resolve(Ol());let o=-1,a=r;return s.next((e=>Bo.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?Bo.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,a,e,Pl()))).next((t=>({batchId:o,changes:Cl(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Ro(e)).next((t=>{let e=Nl();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const r=e.collectionGroup;let s=Nl();return this.indexManager.getCollectionParents(t,r).next((o=>Bo.forEach(o,(o=>{const a=function(t,e){return new dl(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(r));return this.getDocumentsMatchingCollectionQuery(t,a,n,i).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,r,i)))).next((t=>{r.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,Ua.newInvalidDocument(i)))}));let n=Nl();return t.forEach(((t,i)=>{const s=r.get(t);void 0!==s&&oc(s.mutation,i,ca.empty(),Ao.now()),ql(e,i)&&(n=n.insert(t,i))})),n}))}}class ku{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return Bo.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:$c(t.createTime)}}(e)),Bo.resolve()}getNamedQuery(t,e){return Bo.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:gu(t.bundledQuery),readTime:$c(t.readTime)}}(e)),Bo.resolve()}}class Tu{constructor(){this.overlays=new ra(Ro.comparator),this.hr=new Map}getOverlay(t,e){return Bo.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Ol();return Bo.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ht(t,e,i)})),Bo.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.hr.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),Bo.resolve()}getOverlaysForCollection(t,e,n){const i=Ol(),r=e.length+1,s=new Ro(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Bo.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new ra(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=Ol(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Ol(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return Bo.resolve(o)}ht(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new vc(e,n));let r=this.hr.get(e);void 0===r&&(r=Pl(),this.hr.set(e,r)),this.hr.set(e,r.add(n.key))}}class xu{constructor(){this.Pr=new aa(Iu.Ir),this.Tr=new aa(Iu.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new Iu(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new Iu(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new Ro(new Oo([])),n=new Iu(e,t),i=new Iu(e,t+1),r=[];return this.Tr.forEachInRange([n,i],(t=>{this.Ar(t),r.push(t.key)})),r}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new Ro(new Oo([])),n=new Iu(e,t),i=new Iu(e,t+1);let r=Pl();return this.Tr.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new Iu(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Iu{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return Ro.comparator(t.key,e.key)||Io(t.pr,e.pr)}static Er(t,e){return Io(t.pr,e.pr)||Ro.comparator(t.key,e.key)}}class Su{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new aa(Iu.Ir)}checkEmpty(t){return Bo.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new mc(r,e,n,i);this.mutationQueue.push(s);for(const e of i)this.wr=this.wr.add(new Iu(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Bo.resolve(s)}lookupMutationBatch(t,e){return Bo.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.br(n),r=i<0?0:i;return Bo.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Bo.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return Bo.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Iu(e,0),i=new Iu(e,Number.POSITIVE_INFINITY),r=[];return this.wr.forEachInRange([n,i],(t=>{const e=this.Sr(t.pr);r.push(e)})),Bo.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new aa(Io);return e.forEach((t=>{const e=new Iu(t,0),i=new Iu(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,i],(t=>{n=n.add(t.pr)}))})),Bo.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;Ro.isDocumentKey(r)||(r=r.child(""));const s=new Iu(new Ro(r),0);let o=new aa(Io);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.pr)),!0)}),s),Bo.resolve(this.Dr(o))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){ho(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return Bo.forEach(e.mutations,(i=>{const r=new Iu(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new Iu(e,0),i=this.wr.firstAfterOrEqual(n);return Bo.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Bo.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Au{constructor(t){this.vr=t,this.docs=new ra(Ro.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Bo.resolve(n?n.document.mutableCopy():Ua.newInvalidDocument(e))}getEntries(t,e){let n=Sl();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Ua.newInvalidDocument(t))})),Bo.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let r=Sl();const s=e.path,o=new Ro(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||jo(Mo(o),n)<=0||(i.has(o.key)||ql(e,o))&&(r=r.insert(o.key,o.mutableCopy()))}return Bo.resolve(r)}getAllFromCollectionGroup(t,e,n,i){uo()}Fr(t,e){return Bo.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Nu(this)}getSize(t){return Bo.resolve(this.size)}}class Nu extends Eu{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.ar.addEntry(t,i)):this.ar.removeEntry(n)})),Bo.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class Cu{constructor(t){this.persistence=t,this.Mr=new xl((t=>cl(t)),ul),this.lastRemoteSnapshotVersion=No.min(),this.highestTargetId=0,this.Or=0,this.Nr=new xu,this.targetCount=0,this.Br=wu.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),Bo.resolve()}getLastRemoteSnapshotVersion(t){return Bo.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Bo.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),Bo.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),Bo.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Br=new wu(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,Bo.resolve()}updateTargetData(t,e){return this.qn(e),Bo.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,Bo.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Mr.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Bo.waitFor(r).next((()=>i))}getTargetCount(t){return Bo.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return Bo.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),Bo.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),Bo.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),Bo.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return Bo.resolve(n)}containsKey(t,e){return Bo.resolve(this.Nr.containsKey(e))}}class Ou{constructor(t,e){this.Lr={},this.overlays={},this.kr=new Jo(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Cu(this),this.indexManager=new yu,this.remoteDocumentCache=function(t){return new Au(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new pu(e),this.$r=new ku(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Tu,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Lr[t.toKey()];return n||(n=new Su(e,this.referenceDelegate),this.Lr[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){oo("MemoryPersistence","Starting transaction:",t);const i=new Lu(this.kr.next());return this.referenceDelegate.Ur(),n(i).next((t=>this.referenceDelegate.Wr(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Gr(t,e){return Bo.or(Object.values(this.Lr).map((n=>()=>n.containsKey(t,e))))}}class Lu extends Fo{constructor(t){super(),this.currentSequenceNumber=t}}class Du{constructor(t){this.persistence=t,this.zr=new xu,this.jr=null}static Hr(t){return new Du(t)}get Jr(){if(this.jr)return this.jr;throw uo()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),Bo.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),Bo.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),Bo.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Bo.forEach(this.Jr,(n=>{const i=Ro.fromPath(n);return this.Yr(t,i).next((t=>{t||e.removeEntry(i,No.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return Bo.or([()=>Bo.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class Ru{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=i}static Ki(t,e){let n=Pl(),i=Pl();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new Ru(t,e.fromCache,n,i)}}class Mu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Pu{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=!function(){var t;const e=null===(t=mt())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:Ho.v(Et())>0?6:4}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,i){const r={result:null};return this.ji(t,e).next((t=>{r.result=t})).next((()=>{if(!r.result)return this.Hi(t,e,i,n).next((t=>{r.result=t}))})).next((()=>{if(r.result)return;const n=new Mu;return this.Ji(t,e,n).next((i=>{if(r.result=i,this.Ui)return this.Yi(t,e,n,i.size)}))})).next((()=>r.result))}Yi(t,e,n,i){return n.documentReadCount<this.Wi?(so()<=Ut.DEBUG&&oo("QueryEngine","SDK will not create cache indexes for query:",_l(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Bo.resolve()):(so()<=Ut.DEBUG&&oo("QueryEngine","Query:",_l(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(so()<=Ut.DEBUG&&oo("QueryEngine","The SDK decides to create cache indexes for query:",_l(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,yl(e))):Bo.resolve())}ji(t,e){if(pl(e))return Bo.resolve(null);let n=yl(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=bl(e,null,"F"),n=yl(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const r=Pl(...i);return this.zi.getDocuments(t,r).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Zi(e,i);return this.Xi(e,s,r,n.readTime)?this.ji(t,bl(e,null,"F")):this.es(t,s,e,n)}))))})))))}Hi(t,e,n,i){return pl(e)||i.isEqual(No.min())?Bo.resolve(null):this.zi.getDocuments(t,n).next((r=>{const s=this.Zi(e,r);return this.Xi(e,s,n,i)?Bo.resolve(null):(so()<=Ut.DEBUG&&oo("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),_l(e)),this.es(t,s,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=No.fromTimestamp(1e9===i?new Ao(n+1,0):new Ao(n,i));return new Po(r,Ro.empty(),e)}(i,-1)).next((t=>t)))}))}Zi(t,e){let n=new aa(kl(t));return e.forEach(((e,i)=>{ql(t,i)&&(n=n.add(i))})),n}Xi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ji(t,e,n){return so()<=Ut.DEBUG&&oo("QueryEngine","Using full collection scan to execute query:",_l(e)),this.zi.getDocumentsMatchingQuery(t,e,Po.min(),n)}es(t,e,n,i){return this.zi.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class ju{constructor(t,e,n,i){this.persistence=t,this.ts=e,this.serializer=i,this.ns=new ra(Io),this.rs=new xl((t=>cl(t)),ul),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new qu(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function Uu(t,e){const n=fo(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=Pl();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({us:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function Fu(t){const e=fo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}function Vu(t,e){const n=fo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function Bu(t,e,n){const i=fo(t),r=i.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!Ko(t))throw t;oo("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.ns=i.ns.remove(e),i.rs.delete(r.target)}function zu(t,e,n){const i=fo(t);let r=No.min(),s=Pl();return i.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const i=fo(t),r=i.rs.get(n);return void 0!==r?Bo.resolve(i.ns.get(r)):i.Qr.getTargetData(e,n)}(i,t,yl(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Qr.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>i.ts.getDocumentsMatchingQuery(t,e,n?r:No.min(),n?s:Pl()))).next((t=>(function(t,e,n){let i=t.ss.get(e)||No.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.ss.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,hs:s})))))}class Hu{constructor(){this.activeTargetIds=jl}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class $u{constructor(){this.no=new Hu,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new Hu,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Wu{io(t){}shutdown(){}}class Ku{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){oo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){oo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Gu=null;function Qu(){return null===Gu?Gu=268435456+Math.round(2147483648*Math.random()):Gu++,"0x"+Gu.toString(16)}const Yu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Xu{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const Ju="WebChannelConnection";class Zu extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${i}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get wo(){return!1}So(t,e,n,i,r){const s=Qu(),o=this.bo(t,e.toUriEncodedString());oo("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,i,r),this.Co(t,o,a,n).then((e=>(oo("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw lo("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,i,r,s){return this.So(t,e,n,i,r)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+io,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=Yu[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,i){const r=Qu();return new Promise(((s,o)=>{const a=new Js;a.setWithCredentials(!0),a.listenOnce(Gs.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Ks.NO_ERROR:const e=a.getResponseJson();oo(Ju,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(e)),s(e);break;case Ks.TIMEOUT:oo(Ju,`RPC '${t}' ${r} timed out`),o(new go(po.DEADLINE_EXCEEDED,"Request time out"));break;case Ks.HTTP_ERROR:const n=a.getStatus();if(oo(Ju,`RPC '${t}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(po).indexOf(e)>=0?e:po.UNKNOWN}(e.status);o(new go(t,e.message))}else o(new go(po.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new go(po.UNAVAILABLE,"Connection failed."));break;default:uo()}}finally{oo(Ju,`RPC '${t}' ${r} completed.`)}}));const l=JSON.stringify(i);oo(Ju,`RPC '${t}' ${r} sending request:`,i),a.send(e,"POST",l,n,15)}))}Fo(t,e,n){const i=Qu(),r=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=$s(),o=Ws(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const c=r.join("");oo(Ju,`Creating RPC '${t}' stream ${i}: ${c}`,a);const u=s.createWebChannel(c,a);let h=!1,d=!1;const f=new Xu({lo:e=>{d?oo(Ju,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(h||(oo(Ju,`Opening RPC '${t}' stream ${i} transport.`),u.open(),h=!0),oo(Ju,`RPC '${t}' stream ${i} sending:`,e),u.send(e))},ho:()=>u.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(u,Xs.EventType.OPEN,(()=>{d||oo(Ju,`RPC '${t}' stream ${i} transport opened.`)})),p(u,Xs.EventType.CLOSE,(()=>{d||(d=!0,oo(Ju,`RPC '${t}' stream ${i} transport closed`),f.Vo())})),p(u,Xs.EventType.ERROR,(e=>{d||(d=!0,lo(Ju,`RPC '${t}' stream ${i} transport errored:`,e),f.Vo(new go(po.UNAVAILABLE,"The operation could not be completed")))})),p(u,Xs.EventType.MESSAGE,(e=>{var n;if(!d){const r=e.data[0];ho(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){oo(Ju,`RPC '${t}' stream ${i} received error:`,o);const e=o.status;let n=function(t){const e=wc[t];if(void 0!==e)return _c(e)}(e),r=o.message;void 0===n&&(n=po.INTERNAL,r="Unknown error status: "+e+" with message "+o.message),d=!0,f.Vo(new go(n,r)),u.close()}else oo(Ju,`RPC '${t}' stream ${i} received:`,r),f.mo(r)}})),p(o,Qs.STAT_EVENT,(e=>{e.stat===Ys.PROXY?oo(Ju,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===Ys.NOPROXY&&oo(Ju,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function th(){return"undefined"!=typeof document?document:null}function eh(t){return new Fc(t,!0)}class nh{constructor(t,e,n=1e3,i=1.5,r=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=i,this.Oo=r,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),i=Math.max(0,e-n);i>0&&oo("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,(()=>(this.Lo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class ih{constructor(t,e,n,i,r,s,o,a){this.oi=t,this.$o=n,this.Uo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new nh(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===po.RESOURCE_EXHAUSTED?(ao(e.toString()),ao("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===po.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new go(po.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return oo("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(oo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class rh extends ih{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r}a_(t,e){return this.connection.Fo("Listen",t,e)}onMessage(t){this.jo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:uo()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.useProto3Json?(ho(void 0===e||"string"==typeof e),ha.fromBase64String(e||"")):(ho(void 0===e||e instanceof Uint8Array),ha.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?po.UNKNOWN:_c(t.code);return new go(e,t.message||"")}(o);n=new Oc(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Yc(t,i.document.name),s=$c(i.document.updateTime),o=i.document.createTime?$c(i.document.createTime):No.min(),a=new Pa({mapValue:{fields:i.document.fields}}),l=Ua.newFoundDocument(r,s,o,a),c=i.targetIds||[],u=i.removedTargetIds||[];n=new Nc(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Yc(t,i.document),s=i.readTime?$c(i.readTime):No.min(),o=Ua.newNoDocument(r,s),a=i.removedTargetIds||[];n=new Nc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Yc(t,i.document),s=i.removedTargetIds||[];n=new Nc([],s,r,null)}else{if(!("filter"in e))return uo();{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:r}=t,s=new bc(i,r),o=t.targetId;n=new Cc(o,s)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return No.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?No.min():e.readTime?$c(e.readTime):No.min()}(t);return this.listener.u_(e,n)}c_(t){const e={};e.database=Jc(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=hl(i)?{documents:eu(t,i)}:{query:nu(t,i).ut},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=zc(t,e.resumeToken);const i=Vc(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(No.min())>0){n.readTime=Bc(t,e.snapshotVersion.toTimestamp());const i=Vc(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return uo()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.t_(e)}l_(t){const e={};e.database=Jc(this.serializer),e.removeTarget=t,this.t_(e)}}class sh extends ih{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(ho(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(ho(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?$c(t.updateTime):$c(e);return n.isEqual(No.min())&&(n=$c(e)),new tc(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=$c(t.commitTime);return this.listener.T_(n,e)}return ho(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=Jc(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof cc)n={update:tu(t,e.key,e.value)};else if(e instanceof pc)n={delete:Qc(t,e.key)};else if(e instanceof uc)n={update:tu(t,e.key,e.data),updateMask:hu(e.fieldMask)};else{if(!(e instanceof gc))return uo();n={verify:Qc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Wl)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Kl)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ql)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Xl)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw uo()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Hc(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:uo()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}class oh extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new go(po.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.So(t,Kc(e,n),i,r,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===po.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new go(po.UNKNOWN,t.toString())}))}vo(t,e,n,i,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(t,Kc(e,n),i,s,o,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===po.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new go(po.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class ah{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(ao(e),this.g_=!1):oo("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class lh{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=r,this.M_.io((t=>{n.enqueueAndForget((async()=>{yh(this)&&(oo("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=fo(t);e.v_.add(4),await uh(e),e.x_.set("Unknown"),e.v_.delete(4),await ch(e)}(this))}))})),this.x_=new ah(n,i)}}async function ch(t){if(yh(t))for(const e of t.F_)await e(!0)}async function uh(t){for(const e of t.F_)await e(!1)}function hh(t,e){const n=fo(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),mh(n)?gh(n):Dh(n).Jo()&&fh(n,e))}function dh(t,e){const n=fo(t),i=Dh(n);n.C_.delete(e),i.Jo()&&ph(n,e),0===n.C_.size&&(i.Jo()?i.Xo():yh(n)&&n.x_.set("Unknown"))}function fh(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(No.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Dh(t).c_(e)}function ph(t,e){t.O_.Oe(e),Dh(t).l_(e)}function gh(t){t.O_=new Dc({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Dh(t).start(),t.x_.p_()}function mh(t){return yh(t)&&!Dh(t).Ho()&&t.C_.size>0}function yh(t){return 0===fo(t).v_.size}function vh(t){t.O_=void 0}async function bh(t){t.C_.forEach(((e,n)=>{fh(t,e)}))}async function wh(t,e){vh(t),mh(t)?(t.x_.S_(e),gh(t)):t.x_.set("Unknown")}async function Eh(t,e,n){if(t.x_.set("Online"),e instanceof Oc&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.C_.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.C_.delete(i),t.O_.removeTarget(i))}(t,e)}catch(n){oo("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await _h(t,n)}else if(e instanceof Nc?t.O_.$e(e):e instanceof Cc?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(No.min()))try{const e=await Fu(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.O_.it(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.C_.get(i);r&&t.C_.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const i=t.C_.get(e);if(!i)return;t.C_.set(e,i.withResumeToken(ha.EMPTY_BYTE_STRING,i.snapshotVersion)),ph(t,e);const r=new fu(i.target,e,n,i.sequenceNumber);fh(t,r)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){oo("RemoteStore","Failed to raise snapshot:",e),await _h(t,e)}}async function _h(t,e,n){if(!Ko(e))throw e;t.v_.add(1),await uh(t),t.x_.set("Offline"),n||(n=()=>Fu(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{oo("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await ch(t)}))}function qh(t,e){return e().catch((n=>_h(t,n,e)))}async function kh(t){const e=fo(t),n=Rh(e);let i=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;Th(e);)try{const t=await Vu(e.localStore,i);if(null===t){0===e.D_.length&&n.Xo();break}i=t.batchId,xh(e,t)}catch(t){await _h(e,t)}Ih(e)&&Sh(e)}function Th(t){return yh(t)&&t.D_.length<10}function xh(t,e){t.D_.push(e);const n=Rh(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function Ih(t){return yh(t)&&!Rh(t).Ho()&&t.D_.length>0}function Sh(t){Rh(t).start()}async function Ah(t){Rh(t).d_()}async function Nh(t){const e=Rh(t);for(const n of t.D_)e.I_(n.mutations)}async function Ch(t,e,n){const i=t.D_.shift(),r=yc.from(i,e,n);await qh(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await kh(t)}async function Oh(t,e){e&&Rh(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return uo();case po.CANCELLED:case po.UNKNOWN:case po.DEADLINE_EXCEEDED:case po.RESOURCE_EXHAUSTED:case po.INTERNAL:case po.UNAVAILABLE:case po.UNAUTHENTICATED:return!1;case po.INVALID_ARGUMENT:case po.NOT_FOUND:case po.ALREADY_EXISTS:case po.PERMISSION_DENIED:case po.FAILED_PRECONDITION:case po.ABORTED:case po.OUT_OF_RANGE:case po.UNIMPLEMENTED:case po.DATA_LOSS:return!0}}(t)&&t!==po.ABORTED}(e.code)){const n=t.D_.shift();Rh(t).Zo(),await qh(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await kh(t)}}(t,e),Ih(t)&&Sh(t)}async function Lh(t,e){const n=fo(t);n.asyncQueue.verifyOperationInProgress(),oo("RemoteStore","RemoteStore received new credentials");const i=yh(n);n.v_.add(3),await uh(n),i&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await ch(n)}function Dh(t){return t.N_||(t.N_=function(t,e,n){const i=fo(t);return i.R_(),new rh(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:bh.bind(null,t),To:wh.bind(null,t),u_:Eh.bind(null,t)}),t.F_.push((async e=>{e?(t.N_.Zo(),mh(t)?gh(t):t.x_.set("Unknown")):(await t.N_.stop(),vh(t))}))),t.N_}function Rh(t){return t.B_||(t.B_=function(t,e,n){const i=fo(t);return i.R_(),new sh(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:Ah.bind(null,t),To:Oh.bind(null,t),E_:Nh.bind(null,t),T_:Ch.bind(null,t)}),t.F_.push((async e=>{e?(t.B_.Zo(),await kh(t)):(await t.B_.stop(),t.D_.length>0&&(oo("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}class Mh{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new mo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new Mh(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new go(po.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ph(t,e){if(ao("AsyncQueue",`${e}: ${t}`),Ko(t))return new go(po.UNAVAILABLE,`${e}: ${t}`);throw t}class jh{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Ro.comparator(e.key,n.key):(t,e)=>Ro.comparator(t.key,e.key),this.keyedMap=Nl(),this.sortedSet=new ra(this.comparator)}static emptySet(t){return new jh(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof jh))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new jh;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class Uh{constructor(){this.L_=new ra(Ro.comparator)}track(t){const e=t.doc.key,n=this.L_.get(e);n?0!==t.type&&3===n.type?this.L_=this.L_.insert(e,t):3===t.type&&1!==n.type?this.L_=this.L_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.L_=this.L_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.L_=this.L_.remove(e):1===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):uo():this.L_=this.L_.insert(e,t)}k_(){const t=[];return this.L_.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Fh{constructor(t,e,n,i,r,s,o,a,l){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(t,e,n,i,r){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new Fh(t,e,jh.emptySet(e),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&wl(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Vh{constructor(){this.q_=void 0,this.Q_=[]}}class Bh{constructor(){this.queries=new xl((t=>El(t)),wl),this.onlineState="Unknown",this.K_=new Set}}function zh(t,e){const n=fo(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.Q_)e.W_(t)&&(i=!0);r.q_=t}}i&&$h(n)}function Hh(t,e,n){const i=fo(t),r=i.queries.get(e);if(r)for(const t of r.Q_)t.onError(n);i.queries.delete(e)}function $h(t){t.K_.forEach((t=>{t.next()}))}class Wh{constructor(t,e,n){this.query=t,this.G_=e,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=n||{}}W_(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Fh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.z_?this.H_(t)&&(this.G_.next(t),e=!0):this.J_(t,this.onlineState)&&(this.Y_(t),e=!0),this.j_=t,e}onError(t){this.G_.error(t)}U_(t){this.onlineState=t;let e=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),e=!0),e}J_(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Z_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}H_(t){if(t.docChanges.length>0)return!0;const e=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}Y_(t){t=Fh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}}class Kh{constructor(t){this.key=t}}class Gh{constructor(t){this.key=t}}class Qh{constructor(t,e){this.query=t,this.oa=e,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=Pl(),this.mutatedKeys=Pl(),this.ua=kl(t),this.ca=new jh(this.ua)}get la(){return this.oa}ha(t,e){const n=e?e.Pa:new Uh,i=e?e.ca:this.ca;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const c=i.get(t),u=ql(this.query,e)?e:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.Ia(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.ua(u,a)>0||l&&this.ua(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{ca:s,Pa:n,Xi:o,mutatedKeys:r}}Ia(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const r=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;const s=t.Pa.k_();s.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return uo()}};return n(t)-n(e)}(t.type,e.type)||this.ua(t.doc,e.doc))),this.Ta(n),i=null!=i&&i;const o=e&&!i?this.Ea():[],a=0===this.aa.size&&this.current&&!i?1:0,l=a!==this._a;return this._a=a,0!==s.length||l?{snapshot:new Fh(this.query,t.ca,r,s,t.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),da:o}:{da:o}}U_(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new Uh,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}Ta(t){t&&(t.addedDocuments.forEach((t=>this.oa=this.oa.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.oa=this.oa.delete(t))),this.current=t.current)}Ea(){if(!this.current)return[];const t=this.aa;this.aa=Pl(),this.ca.forEach((t=>{this.Aa(t.key)&&(this.aa=this.aa.add(t.key))}));const e=[];return t.forEach((t=>{this.aa.has(t)||e.push(new Gh(t))})),this.aa.forEach((n=>{t.has(n)||e.push(new Kh(n))})),e}Ra(t){this.oa=t.hs,this.aa=Pl();const e=this.ha(t.documents);return this.applyChanges(e,!0)}Va(){return Fh.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}class Yh{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Xh{constructor(t){this.key=t,this.ma=!1}}class Jh{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.fa={},this.ga=new xl((t=>El(t)),wl),this.pa=new Map,this.ya=new Set,this.wa=new ra(Ro.comparator),this.Sa=new Map,this.ba=new xu,this.Da={},this.Ca=new Map,this.va=wu.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}async function Zh(t,e){const n=function(t){const e=fo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ed.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gd.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=id.bind(null,e),e.fa.u_=zh.bind(null,e.eventManager),e.fa.xa=Hh.bind(null,e.eventManager),e}(t);let i,r;const s=n.ga.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.Va();else{const t=await function(t,e){const n=fo(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Qr.getTargetData(t,e).next((r=>r?(i=r,Bo.resolve(i)):n.Qr.allocateTargetId(t).next((r=>(i=new fu(e,r,"TargetPurposeListen",t.currentSequenceNumber),n.Qr.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.ns.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(t.targetId,t),n.rs.set(e,t.targetId)),t}))}(n.localStore,yl(e)),s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=await async function(t,e,n,i,r){t.Ma=(e,n,i)=>async function(t,e,n,i){let r=e.view.ha(n);r.Xi&&(r=await zu(t.localStore,e.query,!1).then((({documents:t})=>e.view.ha(t,r))));const s=i&&i.targetChanges.get(e.targetId),o=i&&null!=i.targetMismatches.get(e.targetId),a=e.view.applyChanges(r,t.isPrimaryClient,s,o);return ud(t,e.targetId,a.da),a.snapshot}(t,e,n,i);const s=await zu(t.localStore,e,!0),o=new Qh(e,s.hs),a=o.ha(s.documents),l=Ac.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),c=o.applyChanges(a,t.isPrimaryClient,l);ud(t,n,c.da);const u=new Yh(e,n,o);return t.ga.set(e,u),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),c.snapshot}(n,e,i,"current"===s,t.resumeToken),n.isPrimaryClient&&hh(n.remoteStore,t)}return r}async function td(t,e){const n=fo(t),i=n.ga.get(e),r=n.pa.get(i.targetId);if(r.length>1)return n.pa.set(i.targetId,r.filter((t=>!wl(t,e)))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Bu(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),dh(n.remoteStore,i.targetId),ld(n,i.targetId)})).catch(Vo)):(ld(n,i.targetId),await Bu(n.localStore,i.targetId,!0))}async function ed(t,e){const n=fo(t);try{const t=await function(t,e){const n=fo(t),i=e.snapshotVersion;let r=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.os.newChangeBuffer({trackRemovals:!0});r=n.ns;const o=[];e.targetChanges.forEach(((s,a)=>{const l=r.get(a);if(!l)return;o.push(n.Qr.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(t,s.addedDocuments,a))));let c=l.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?c=c.withResumeToken(ha.EMPTY_BYTE_STRING,No.min()).withLastLimboFreeSnapshotVersion(No.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,i)),r=r.insert(a,c),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.Qr.updateTargetData(t,c))}));let a=Sl(),l=Pl();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(function(t,e,n){let i=Pl(),r=Pl();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=Sl();return n.forEach(((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(No.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):oo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{cs:i,ls:r}}))}(t,s,e.documentUpdates).next((t=>{a=t.cs,l=t.ls}))),!i.isEqual(No.min())){const e=n.Qr.getLastRemoteSnapshotVersion(t).next((e=>n.Qr.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return Bo.waitFor(o).next((()=>s.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,l))).next((()=>a))})).then((t=>(n.ns=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.Sa.get(e);i&&(ho(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.ma=!0:t.modifiedDocuments.size>0?ho(i.ma):t.removedDocuments.size>0&&(ho(i.ma),i.ma=!1))})),await fd(n,t,e)}catch(t){await Vo(t)}}function nd(t,e,n){const i=fo(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ga.forEach(((n,i)=>{const r=i.view.U_(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=fo(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.U_(e)&&(i=!0)})),i&&$h(n)}(i.eventManager,e),t.length&&i.fa.u_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function id(t,e,n){const i=fo(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Sa.get(e),s=r&&r.key;if(s){let t=new ra(Ro.comparator);t=t.insert(s,Ua.newNoDocument(s,No.min()));const n=Pl().add(s),r=new Sc(No.min(),new Map,new ra(Io),t,n);await ed(i,r),i.wa=i.wa.remove(s),i.Sa.delete(e),dd(i)}else await Bu(i.localStore,e,!1).then((()=>ld(i,e,n))).catch(Vo)}async function rd(t,e){const n=fo(t),i=e.batch.batchId;try{const t=await function(t,e){const n=fo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=Bo.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);ho(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=Pl();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);ad(n,i,null),od(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await fd(n,t)}catch(t){await Vo(t)}}async function sd(t,e,n){const i=fo(t);try{const t=await function(t,e){const n=fo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(ho(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);ad(i,e,n),od(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await fd(i,t)}catch(n){await Vo(n)}}function od(t,e){(t.Ca.get(e)||[]).forEach((t=>{t.resolve()})),t.Ca.delete(e)}function ad(t,e,n){const i=fo(t);let r=i.Da[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.Da[i.currentUser.toKey()]=r}}function ld(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.pa.get(e))t.ga.delete(i),n&&t.fa.xa(i,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach((e=>{t.ba.containsKey(e)||cd(t,e)}))}function cd(t,e){t.ya.delete(e.path.canonicalString());const n=t.wa.get(e);null!==n&&(dh(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),dd(t))}function ud(t,e,n){for(const i of n)i instanceof Kh?(t.ba.addReference(i.key,e),hd(t,i)):i instanceof Gh?(oo("SyncEngine","Document no longer in limbo: "+i.key),t.ba.removeReference(i.key,e),t.ba.containsKey(i.key)||cd(t,i.key)):uo()}function hd(t,e){const n=e.key,i=n.path.canonicalString();t.wa.get(n)||t.ya.has(i)||(oo("SyncEngine","New document in limbo: "+n),t.ya.add(i),dd(t))}function dd(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){const e=t.ya.values().next().value;t.ya.delete(e);const n=new Ro(Oo.fromString(e)),i=t.va.next();t.Sa.set(i,new Xh(n)),t.wa=t.wa.insert(n,i),hh(t.remoteStore,new fu(yl(fl(n.path)),i,"TargetPurposeLimboResolution",Jo._e))}}async function fd(t,e,n){const i=fo(t),r=[],s=[],o=[];i.ga.isEmpty()||(i.ga.forEach(((t,a)=>{o.push(i.Ma(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=Ru.Ki(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.fa.u_(r),await async function(t,e){const n=fo(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Bo.forEach(e,(e=>Bo.forEach(e.qi,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Bo.forEach(e.Qi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!Ko(t))throw t;oo("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.ns=n.ns.insert(e,r)}}}(i.localStore,s))}async function pd(t,e){const n=fo(t);if(!n.currentUser.isEqual(e)){oo("SyncEngine","User change. New user:",e.toKey());const t=await Uu(n.localStore,e);n.currentUser=e,function(t,e){t.Ca.forEach((t=>{t.forEach((t=>{t.reject(new go(po.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ca.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await fd(n,t.us)}}function gd(t,e){const n=fo(t),i=n.Sa.get(e);if(i&&i.ma)return Pl().add(i.key);{let t=Pl();const i=n.pa.get(e);if(!i)return t;for(const e of i){const i=n.ga.get(e);t=t.unionWith(i.view.la)}return t}}function md(t){const e=fo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rd.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sd.bind(null,e),e}class yd{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=eh(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,i){return new ju(t,e,n,i)}(this.persistence,new Pu,t.initialUser,this.serializer)}createPersistence(t){return new Ou(Du.Hr,this.serializer)}createSharedClientState(t){return new $u}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class vd{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>nd(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=pd.bind(null,this.syncEngine),await async function(t,e){const n=fo(t);e?(n.v_.delete(2),await ch(n)):e||(n.v_.add(2),await uh(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Bh}createDatastore(t){const e=eh(t.databaseInfo.databaseId),n=function(t){return new Zu(t)}(t.databaseInfo);return function(t,e,n,i){return new oh(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,r){return new lh(t,e,n,i,r)}(this.localStore,this.datastore,t.asyncQueue,(t=>nd(this.syncEngine,t,0)),Ku.D()?new Ku:new Wu)}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new Jh(t,e,n,i,r,s);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=fo(t);oo("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await uh(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}class bd{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ba(this.observer.next,t)}error(t){this.observer.error?this.Ba(this.observer.error,t):ao("Uncaught Error in snapshot listener:",t.toString())}La(){this.muted=!0}Ba(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class wd{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=no.UNAUTHENTICATED,this.clientId=xo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{oo("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(oo("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new go(po.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new mo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Ph(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Ed(t,e){t.asyncQueue.verifyOperationInProgress(),oo("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Uu(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function _d(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){oo("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ed(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===po.FAILED_PRECONDITION||t.code===po.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;lo("Error using user provided cache. Falling back to memory cache: "+n),await Ed(t,new yd)}}else oo("FirestoreClient","Using default OfflineComponentProvider"),await Ed(t,new yd);return t._offlineComponents}(t);oo("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>Lh(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Lh(e.remoteStore,n))),t._onlineComponents=e}async function qd(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(oo("FirestoreClient","Using user provided OnlineComponentProvider"),await _d(t,t._uninitializedComponentsProvider._online)):(oo("FirestoreClient","Using default OnlineComponentProvider"),await _d(t,new vd))),t._onlineComponents}async function kd(t){const e=await qd(t),n=e.eventManager;return n.onListen=Zh.bind(null,e.syncEngine),n.onUnlisten=td.bind(null,e.syncEngine),n}function Td(t,e,n={}){const i=new mo;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,r){const s=new bd({next:n=>{e.enqueueAndForget((()=>async function(t,e){const n=fo(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.Q_.indexOf(e);t>=0&&(s.Q_.splice(t,1),r=0===s.Q_.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}(t,o))),n.fromCache&&"server"===i.source?r.reject(new go(po.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:t=>r.reject(t)}),o=new Wh(n,s,{includeMetadataChanges:!0,Z_:!0});return async function(t,e){const n=fo(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new Vh),r)try{s.q_=await n.onListen(i)}catch(t){const n=Ph(t,`Initialization of query '${_l(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&$h(n)}(t,o)}(await kd(t),t.asyncQueue,e,n,i))),i.promise}function xd(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Id=new Map;function Sd(t,e,n){if(!n)throw new go(po.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ad(t){if(!Ro.isDocumentKey(t))throw new go(po.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Nd(t){if(Ro.isDocumentKey(t))throw new go(po.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Cd(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":uo()}function Od(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new go(po.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Cd(t);throw new go(po.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Ld{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new go(po.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new go(po.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new go(po.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xd(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new go(po.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new go(po.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new go(po.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Dd{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ld({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new go(po.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new go(po.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ld(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new vo;switch(t.type){case"firstParty":return new _o(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new go(po.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Id.get(t);e&&(oo("ComponentProvider","Removing Datastore"),Id.delete(t),e.terminate())}(this),Promise.resolve()}}class Rd{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Rd(this.firestore,t,this._query)}}class Md{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pd(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Md(this.firestore,t,this._key)}}class Pd extends Rd{constructor(t,e,n){super(t,e,fl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Md(this.firestore,null,new Ro(t))}withConverter(t){return new Pd(this.firestore,t,this._path)}}function jd(t,e,...n){if(t=Lt(t),Sd("collection","path",e),t instanceof Dd){const i=Oo.fromString(e,...n);return Nd(i),new Pd(t,null,i)}{if(!(t instanceof Md||t instanceof Pd))throw new go(po.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Oo.fromString(e,...n));return Nd(i),new Pd(t.firestore,null,i)}}class Ud{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new nh(this,"async_queue_retry"),this._u=()=>{const t=th();t&&oo("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=th();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const e=th();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise((()=>{}));const e=new mo;return this.uu((()=>this.tu&&this.su?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.eu.push(t),this.cu())))}async cu(){if(0!==this.eu.length){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!Ko(t))throw t;oo("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo((()=>this.cu()))}}uu(t){const e=this.Xa.then((()=>(this.iu=!0,t().catch((t=>{this.ru=t,this.iu=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw ao("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.iu=!1,t))))));return this.Xa=e,e}enqueueAfterDelay(t,e,n){this.au(),this.ou.indexOf(t)>-1&&(e=0);const i=Mh.createAndSchedule(this,t,e,n,(t=>this.lu(t)));return this.nu.push(i),i}au(){this.ru&&uo()}verifyOperationInProgress(){}async hu(){let t;do{t=this.Xa,await t}while(t!==this.Xa)}Pu(t){for(const e of this.nu)if(e.timerId===t)return!0;return!1}Iu(t){return this.hu().then((()=>{this.nu.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.nu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.hu()}))}Tu(t){this.ou.push(t)}lu(t){const e=this.nu.indexOf(t);this.nu.splice(e,1)}}class Fd extends Dd{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Ud,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Bd(this),this._firestoreClient.terminate()}}function Vd(t){return t._firestoreClient||Bd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Bd(t){var e,n,i;const r=t._freezeSettings(),s=function(t,e,n,i){return new ba(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,xd(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new wd(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}class zd{constructor(t){this._byteString=t}static fromBase64String(t){try{return new zd(ha.fromBase64String(t))}catch(t){throw new go(po.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new zd(ha.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Hd{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new go(po.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Do(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class $d{constructor(t){this._methodName=t}}class Wd{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new go(po.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new go(po.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Io(this._lat,t._lat)||Io(this._long,t._long)}}const Kd=/^__.*__$/;class Gd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new uc(t,this.data,this.fieldMask,e,this.fieldTransforms):new cc(t,this.data,e,this.fieldTransforms)}}class Qd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new uc(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Yd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw uo()}}class Xd{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Eu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new Xd(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.mu(t),i}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.Eu(),i}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return uf(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(0===t.length)throw this.pu("Document fields must not be empty");if(Yd(this.du)&&Kd.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class Jd{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||eh(t)}Su(t,e,n,i=!1){return new Xd({du:t,methodName:e,wu:n,path:Do.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Zd(t){const e=t._freezeSettings(),n=eh(t._databaseId);return new Jd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function tf(t,e,n,i,r,s={}){const o=t.Su(s.merge||s.mergeFields?2:0,e,n,r);of("Data must be an object, but it was:",o,i);const a=rf(i,o);let l,c;if(s.merge)l=new ca(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=af(e,i,n);if(!o.contains(r))throw new go(po.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);hf(t,r)||t.push(r)}l=new ca(t),c=o.fieldTransforms.filter((t=>l.covers(t.field)))}else l=null,c=o.fieldTransforms;return new Gd(new Pa(a),l,c)}class ef extends $d{_toFieldTransform(t){if(2!==t.du)throw 1===t.du?t.pu(`${this._methodName}() can only appear at the top level of your update data`):t.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof ef}}function nf(t,e){if(sf(t=Lt(t)))return of("Unsupported field value:",e,t),rf(t,e);if(t instanceof $d)return function(t,e){if(!Yd(e.du))throw e.pu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.pu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&4!==e.du)throw e.pu("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=nf(r,e.gu(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Lt(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vl(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Ao.fromDate(t);return{timestampValue:Bc(e.serializer,n)}}if(t instanceof Ao){const n=new Ao(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Bc(e.serializer,n)}}if(t instanceof Wd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof zd)return{bytesValue:zc(e.serializer,t._byteString)};if(t instanceof Md){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.pu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Wc(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.pu(`Unsupported field value: ${Cd(t)}`)}(t,e)}function rf(t,e){const n={};return ia(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):na(t,((t,i)=>{const r=nf(i,e.Ru(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function sf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ao||t instanceof Wd||t instanceof zd||t instanceof Md||t instanceof $d)}function of(t,e,n){if(!sf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Cd(n);throw"an object"===i?e.pu(t+" a custom object"):e.pu(t+" "+i)}}function af(t,e,n){if((e=Lt(e))instanceof Hd)return e._internalPath;if("string"==typeof e)return cf(t,e);throw uf("Field path arguments must be of type string or ",t,!1,void 0,n)}const lf=new RegExp("[~\\*/\\[\\]]");function cf(t,e,n){if(e.search(lf)>=0)throw uf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Hd(...e.split("."))._internalPath}catch(i){throw uf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function uf(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new go(po.INVALID_ARGUMENT,a+t+l)}function hf(t,e){return t.some((t=>t.isEqual(e)))}class df{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Md(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new ff(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(pf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class ff extends df{data(){return super.data()}}function pf(t,e){return"string"==typeof e?cf(t,e):e instanceof Hd?e._internalPath:e._delegate._internalPath}class gf{}class mf extends gf{}function yf(t,e,...n){let i=[];e instanceof gf&&i.push(e),i=i.concat(n),function(t){const e=t.filter((t=>t instanceof wf)).length,n=t.filter((t=>t instanceof vf)).length;if(e>1||e>0&&n>0)throw new go(po.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const e of i)t=e._apply(t);return t}class vf extends mf{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new vf(t,e,n)}_apply(t){const e=this._parse(t);return xf(t._query,e),new Rd(t.firestore,t.converter,vl(t._query,e))}_parse(t){const e=Zd(t.firestore),n=function(t,e,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new go(po.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Tf(o,s);const e=[];for(const n of o)e.push(kf(i,t,n));a={arrayValue:{values:e}}}else a=kf(i,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Tf(o,s),a=function(t,e,n,i=!1){return nf(n,t.Su(i?4:3,e))}(n,"where",o,"in"===s||"not-in"===s);return Wa.create(r,s,a)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value);return n}}function bf(t,e,n){const i=e,r=pf("where",t);return vf._create(r,i,n)}class wf extends gf{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new wf(t,e)}_parse(t){const e=this._queryConstraints.map((e=>e._parse(t))).filter((t=>t.getFilters().length>0));return 1===e.length?e[0]:Ka.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const i=e.getFlattenedFilters();for(const t of i)xf(n,t),n=vl(n,t)}(t._query,e),new Rd(t.firestore,t.converter,vl(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Ef extends mf{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new Ef(t,e)}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new go(po.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new go(po.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new za(e,n)}(t._query,this._field,this._direction);return new Rd(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new dl(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function _f(t,e="asc"){const n=e,i=pf("orderBy",t);return Ef._create(i,n)}class qf extends mf{constructor(t,e,n){super(),this.type=t,this._limit=e,this._limitType=n}static _create(t,e,n){return new qf(t,e,n)}_apply(t){return new Rd(t.firestore,t.converter,bl(t._query,this._limit,this._limitType))}}function kf(t,e,n){if("string"==typeof(n=Lt(n))){if(""===n)throw new go(po.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gl(e)&&-1!==n.indexOf("/"))throw new go(po.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Oo.fromString(n));if(!Ro.isDocumentKey(i))throw new go(po.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Aa(t,new Ro(i))}if(n instanceof Md)return Aa(t,n._key);throw new go(po.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Cd(n)}.`)}function Tf(t,e){if(!Array.isArray(t)||0===t.length)throw new go(po.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function xf(t,e){const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new go(po.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new go(po.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class If{convertValue(t,e="none"){switch(_a(t)){case 0:return null;case 1:return t.booleanValue;case 2:return pa(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(ga(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw uo()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return na(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Wd(pa(t.latitude),pa(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=ya(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(va(t));default:return null}}convertTimestamp(t){const e=fa(t);return new Ao(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Oo.fromString(t);ho(du(n));const i=new wa(n.get(1),n.get(3)),r=new Ro(n.popFirst(5));return i.isEqual(e)||ao(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}class Sf{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Af extends df{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Nf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(pf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class Nf extends Af{data(t={}){return super.data(t)}}class Cf{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Sf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Nf(this._firestore,this._userDataWriter,n.key,n,new Sf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new go(po.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new Nf(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Sf(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new Nf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Sf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:Of(e.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Of(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return uo()}}class Lf extends If{constructor(t){super(),this.firestore=t}convertBytes(t){return new zd(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Md(this.firestore,null,e)}}function Df(t){t=Od(t,Rd);const e=Od(t.firestore,Fd),n=Vd(e),i=new Lf(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new go(po.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),Td(n,t._query).then((n=>new Cf(e,i,t,n)))}function Rf(t,e){return function(t,e){const n=new mo;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=md(t);try{const t=await function(t,e){const n=fo(t),i=Ao.now(),r=e.reduce(((t,e)=>t.add(e.key)),Pl());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Sl(),l=Pl();return n.os.getEntries(t,r).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(l=l.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((r=>{s=r;const o=[];for(const t of e){const e=ac(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new uc(t.key,e,ja(e.value.mapValue),ec.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:Cl(s)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Da[t.currentUser.toKey()];i||(i=new ra(Io)),i=i.insert(e,n),t.Da[t.currentUser.toKey()]=i}(i,t.batchId,n),await fd(i,t.changes),await kh(i.remoteStore)}catch(t){const e=Ph(t,"Failed to persist write");n.reject(e)}}(await function(t){return qd(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Vd(t),e)}function Mf(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}new WeakMap,function(t,e=!0){!function(t){io=t}(Ee),ye(new Dt("firestore",((t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new Fd(new wo(t.getProvider("auth-internal")),new ko(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new go(po.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wa(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),ke(eo,"4.4.3",t),ke(eo,"4.4.3","esm2017")}(),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Pf=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},jf=new kt("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Uf=new Ht("@firebase/auth");function Ff(t,...e){Uf.logLevel<=Ut.ERROR&&Uf.error(`Auth (${Ee}): ${t}`,...e)}function Vf(t,...e){throw Hf(t,...e)}function Bf(t,...e){return Hf(t,...e)}function zf(t,e,n){const i=Object.assign(Object.assign({},Pf()),{[e]:n});return new kt("auth","Firebase",i).create(e,{appName:t.name})}function Hf(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return jf.create(t,...e)}function $f(t,e,...n){if(!t)throw Hf(e,...n)}function Wf(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ff(e),new Error(e)}function Kf(t,e){t||Wf(e)}function Gf(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function Qf(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function Yf(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Qf()||"https:"===Qf()||function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class Xf{constructor(t,e){this.shortDelay=t,this.longDelay=e,Kf(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Et())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return Yf()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Jf(t,e){Kf(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Zf{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Wf("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Wf("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Wf("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const tp={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ep=new Xf(3e4,6e4);function np(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ip(t,e,n,i,r={}){return rp(t,r,(async()=>{let r={},s={};i&&("GET"===e?s=i:r={body:JSON.stringify(i)});const o=St(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),Zf.fetch()(op(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function rp(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},tp),e);try{const e=new lp(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw cp(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw cp(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw cp(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw cp(t,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw zf(t,a,o);Vf(t,a)}}catch(e){if(e instanceof qt)throw e;Vf(t,"network-request-failed",{message:String(e)})}}async function sp(t,e,n,i,r={}){const s=await ip(t,e,n,i,r);return"mfaPendingCredential"in s&&Vf(t,"multi-factor-auth-required",{_serverResponse:s}),s}function op(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?Jf(t.config,r):`${t.config.apiScheme}://${r}`}function ap(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class lp{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Bf(this.auth,"network-request-failed"))),ep.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function cp(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Bf(t,e,i);return r.customData._tokenResponse=n,r}function up(t){return void 0!==t&&void 0!==t.enterprise}class hp{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return ap(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}function dp(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function fp(t){return 1e3*Number(t)}function pp(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return Ff("JWT malformed, contained fewer than 3 sections"),null;try{const t=gt(n);return t?JSON.parse(t):(Ff("Failed to decode base64 JWT payload"),null)}catch(t){return Ff("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}async function gp(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof qt&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class mp{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class yp{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=dp(this.lastLoginAt),this.creationTime=dp(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function vp(t){var e;const n=t.auth,i=await t.getIdToken(),r=await gp(t,async function(t,e){return ip(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));$f(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=Mf(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(l=t.providerData,c=o,[...l.filter((t=>!c.some((e=>e.providerId===t.providerId)))),...c]);var l,c;const u=t.isAnonymous,h=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new yp(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class bp{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){$f(t.idToken,"internal-error"),$f(void 0!==t.idToken,"internal-error"),$f(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=pp(t);return $f(e,"internal-error"),$f(void 0!==e.exp,"internal-error"),$f(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return $f(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(t,e){const n=await rp(t,{},(async()=>{const n=St({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,s=op(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Zf.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new bp;return n&&($f("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&($f("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&($f("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new bp,this.toJSON())}_performRefresh(){return Wf("not implemented")}}function wp(t,e){$f("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Ep{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=Mf(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mp(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new yp(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await gp(this,this.stsTokenManager.getToken(this.auth,t));return $f(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=Lt(t),i=await n.getIdToken(e),r=pp(i);$f(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:dp(fp(r.auth_time)),issuedAtTime:dp(fp(r.iat)),expirationTime:dp(fp(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=Lt(t);await vp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&($f(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Ep(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){$f(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await vp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await gp(this,async function(t,e){return ip(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,l,c;const u=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=e.createdAt)&&void 0!==l?l:void 0,y=null!==(c=e.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:E,stsTokenManager:_}=e;$f(v&&_,t,"internal-error");const q=bp.fromJSON(this.name,_);$f("string"==typeof v,t,"internal-error"),wp(u,t.name),wp(h,t.name),$f("boolean"==typeof b,t,"internal-error"),$f("boolean"==typeof w,t,"internal-error"),wp(d,t.name),wp(f,t.name),wp(p,t.name),wp(g,t.name),wp(m,t.name),wp(y,t.name);const k=new Ep({uid:v,auth:t,email:h,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:q,createdAt:m,lastLoginAt:y});return E&&Array.isArray(E)&&(k.providerData=E.map((t=>Object.assign({},t)))),g&&(k._redirectEventId=g),k}static async _fromIdTokenResponse(t,e,n=!1){const i=new bp;i.updateFromServerResponse(e);const r=new Ep({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await vp(r),r}}const _p=new Map;function qp(t){Kf(t instanceof Function,"Expected a class definition");let e=_p.get(t);return e?(Kf(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,_p.set(t,e),e)}class kp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}kp.type="NONE";const Tp=kp;function xp(t,e,n){return`firebase:${t}:${e}:${n}`}class Ip{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=xp(this.userKey,i.apiKey,r),this.fullPersistenceKey=xp("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Ep._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Ip(qp(Tp),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||qp(Tp);const s=xp(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=Ep._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new Ip(r,t,n)):new Ip(r,t,n)}}function Sp(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Op(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ap(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Dp(e))return"Blackberry";if(Rp(e))return"Webos";if(Np(e))return"Safari";if((e.includes("chrome/")||Cp(e))&&!e.includes("edge/"))return"Chrome";if(Lp(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Ap(t=Et()){return/firefox\//i.test(t)}function Np(t=Et()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Cp(t=Et()){return/crios\//i.test(t)}function Op(t=Et()){return/iemobile/i.test(t)}function Lp(t=Et()){return/android/i.test(t)}function Dp(t=Et()){return/blackberry/i.test(t)}function Rp(t=Et()){return/webos/i.test(t)}function Mp(t=Et()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Pp(t=Et()){return Mp(t)||Lp(t)||Rp(t)||Dp(t)||/windows phone/i.test(t)||Op(t)}function jp(t,e=[]){let n;switch(t){case"Browser":n=Sp(Et());break;case"Worker":n=`${Sp(Et())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ee}/${i}`}class Up{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class Fp{constructor(t){var e,n,i,r;const s=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=s.minPasswordLength)&&void 0!==e?e:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=t.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}class Vp{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zp(this),this.idTokenSubscription=new zp(this),this.beforeStateQueue=new Up(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=qp(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Ip.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $f(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await vp(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?Lt(t):null;return e&&$f(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&$f(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(qp(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return ip(t,"GET","/v2/passwordPolicy",np(t,e))}(this),e=new Fp(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new kt("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return ip(t,"POST","/v2/accounts:revokeToken",np(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&qp(t)||this._popupRedirectResolver;$f(e,this,"argument-error"),this.redirectPersistenceManager=await Ip.create(this,[qp(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if($f(o,this,"internal-error"),o.then((()=>{s||r(this.currentUser)})),"function"==typeof e){const r=t.addObserver(e,n,i);return()=>{s=!0,r()}}{const n=t.addObserver(e);return()=>{s=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return $f(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=jp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){Uf.logLevel<=Ut.WARN&&Uf.warn(`Auth (${Ee}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function Bp(t){return Lt(t)}class zp{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new Ct(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return $f(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Hp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $p(t){return Hp.loadJS(t)}function Wp(t){return`__${t}${Math.floor(1e6*Math.random())}`}class Kp{constructor(t){this.type="recaptcha-enterprise",this.auth=Bp(t)}async verify(t="verify",e=!1){function n(e,n,i){const r=window.grecaptcha;up(r)?r.enterprise.ready((()=>{r.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{(async function(t,e){return ip(t,"GET","/v2/recaptchaConfig",np(t,e))})(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new hp(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((r=>{if(!e&&up(window.grecaptcha))n(r,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let e=Hp.recaptchaEnterpriseScript;0!==e.length&&(e+=r),$p(e).then((()=>{n(r,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function Gp(t,e,n,i=!1){const r=new Kp(t);let s;try{s=await r.verify(n)}catch(t){s=await r.verify(n,!0)}const o=Object.assign({},e);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Qp(t,e,n,i){var r;if(null===(r=t._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await Gp(t,e,n,"getOobCode"===n);return i(t,r)}return i(t,e).catch((async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await Gp(t,e,n,"getOobCode"===n);return i(t,r)}return Promise.reject(r)}))}function Yp(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Xp(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Jp{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Wf("not implemented")}_getIdTokenResponse(t){return Wf("not implemented")}_linkToIdToken(t,e){return Wf("not implemented")}_getReauthenticationResolver(t){return Wf("not implemented")}}async function Zp(t,e){return ip(t,"POST","/v1/accounts:signUp",e)}async function tg(t,e){return sp(t,"POST","/v1/accounts:signInWithPassword",np(t,e))}class eg extends Jp{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new eg(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new eg(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return Qp(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",tg);case"emailLink":return async function(t,e){return sp(t,"POST","/v1/accounts:signInWithEmailLink",np(t,e))}(t,{email:this._email,oobCode:this._password});default:Vf(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return Qp(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Zp);case"emailLink":return async function(t,e){return sp(t,"POST","/v1/accounts:signInWithEmailLink",np(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Vf(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function ng(t,e){return sp(t,"POST","/v1/accounts:signInWithIdp",np(t,e))}class ig extends Jp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new ig(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Vf("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=Mf(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new ig(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return ng(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,ng(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,ng(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=St(e)}return t}}const rg={USER_NOT_FOUND:"user-not-found"};class sg extends Jp{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new sg({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new sg({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return sp(t,"POST","/v1/accounts:signInWithPhoneNumber",np(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await sp(t,"POST","/v1/accounts:signInWithPhoneNumber",np(t,e));if(n.temporaryProof)throw cp(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return sp(t,"POST","/v1/accounts:signInWithPhoneNumber",np(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),rg)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new sg({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class og{constructor(t){var e,n,i,r,s,o;const a=At(Nt(t)),l=null!==(e=a.apiKey)&&void 0!==e?e:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);$f(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=At(Nt(t)).link,n=e?At(Nt(e)).deep_link_id:null,i=At(Nt(t)).deep_link_id;return(i?At(Nt(i)).link:null)||i||n||e||t}(t);try{return new og(e)}catch(t){return null}}}class ag{constructor(){this.providerId=ag.PROVIDER_ID}static credential(t,e){return eg._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=og.parseLink(e);return $f(n,"argument-error"),eg._fromEmailAndCode(t,n.code,n.tenantId)}}ag.PROVIDER_ID="password",ag.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ag.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class lg{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class cg extends lg{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class ug extends cg{constructor(){super("facebook.com")}static credential(t){return ig._fromParams({providerId:ug.PROVIDER_ID,signInMethod:ug.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ug.credentialFromTaggedObject(t)}static credentialFromError(t){return ug.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ug.credential(t.oauthAccessToken)}catch(t){return null}}}ug.FACEBOOK_SIGN_IN_METHOD="facebook.com",ug.PROVIDER_ID="facebook.com";class hg extends cg{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return ig._fromParams({providerId:hg.PROVIDER_ID,signInMethod:hg.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return hg.credentialFromTaggedObject(t)}static credentialFromError(t){return hg.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return hg.credential(e,n)}catch(t){return null}}}hg.GOOGLE_SIGN_IN_METHOD="google.com",hg.PROVIDER_ID="google.com";class dg extends cg{constructor(){super("github.com")}static credential(t){return ig._fromParams({providerId:dg.PROVIDER_ID,signInMethod:dg.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return dg.credentialFromTaggedObject(t)}static credentialFromError(t){return dg.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return dg.credential(t.oauthAccessToken)}catch(t){return null}}}dg.GITHUB_SIGN_IN_METHOD="github.com",dg.PROVIDER_ID="github.com";class fg extends cg{constructor(){super("twitter.com")}static credential(t,e){return ig._fromParams({providerId:fg.PROVIDER_ID,signInMethod:fg.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return fg.credentialFromTaggedObject(t)}static credentialFromError(t){return fg.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return fg.credential(e,n)}catch(t){return null}}}fg.TWITTER_SIGN_IN_METHOD="twitter.com",fg.PROVIDER_ID="twitter.com";class pg{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await Ep._fromIdTokenResponse(t,n,i),s=gg(n);return new pg({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=gg(n);return new pg({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function gg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class mg extends qt{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,mg.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new mg(t,e,n,i)}}function yg(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw mg._fromErrorAndOperation(t,n,e,i);throw n}))}function vg(t,e,n,i){return Lt(t).onAuthStateChanged(e,n,i)}new WeakMap;const bg="__sak";class wg{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(bg,"1"),this.storage.removeItem(bg),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class Eg extends wg{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=Et();return Np(t)||Mp(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=Pp(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);!function(){const t=Et();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||r===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Eg.type="LOCAL";const _g=Eg;class qg extends wg{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}qg.type="SESSION";const kg=qg;class Tg{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new Tg(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function xg(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}Tg.receivers=[];class Ig{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const l=xg("",20);i.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(c),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(c),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:l,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Sg(){return window}function Ag(){return void 0!==Sg().WorkerGlobalScope&&"function"==typeof Sg().importScripts}const Ng="firebaseLocalStorageDb",Cg="firebaseLocalStorage",Og="fbase_key";class Lg{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function Dg(t,e){return t.transaction([Cg],e?"readwrite":"readonly").objectStore(Cg)}function Rg(){const t=indexedDB.open(Ng,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Cg,{keyPath:Og})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(Cg)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Ng);return new Lg(t).toPromise()}(),e(await Rg()))}))}))}async function Mg(t,e,n){const i=Dg(t,!0).put({[Og]:e,value:n});return new Lg(i).toPromise()}function Pg(t,e){const n=Dg(t,!0).delete(e);return new Lg(n).toPromise()}class jg{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Rg()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ag()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tg._getInstance(Ag()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new Ig(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Rg();return await Mg(t,bg,"1"),await Pg(t,bg),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Mg(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=Dg(t,!1).get(e),i=await new Lg(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Pg(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=Dg(t,!1).getAll();return new Lg(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}jg.type="LOCAL";const Ug=jg;Wp("rcb"),new Xf(3e4,6e4);class Fg{constructor(t){this.providerId=Fg.PROVIDER_ID,this.auth=Bp(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if($f("string"==typeof r,t,"argument-error"),$f("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){$f("enroll"===e.type,t,"internal-error");const n=await function(t,e){return ip(t,"POST","/v2/accounts/mfaEnrollment:start",np(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{$f("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;$f(n,t,"missing-multi-factor-info");const o=await function(t,e){return ip(t,"POST","/v2/accounts/mfaSignIn:start",np(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return ip(t,"POST","/v1/accounts:sendVerificationCode",np(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,Lt(e))}static credential(t,e){return sg._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Fg.credentialFromTaggedObject(e)}static credentialFromError(t){return Fg.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?sg._fromTokenResponse(e,n):null}}function Vg(t,e){return e?qp(e):($f(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}Fg.PROVIDER_ID="phone",Fg.PHONE_SIGN_IN_METHOD="phone";class Bg extends Jp{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return ng(t,this._buildIdpRequest())}_linkToIdToken(t,e){return ng(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return ng(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function zg(t){return async function(t,e,n=!1){const i="signIn",r=await yg(t,i,e),s=await pg._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}(t.auth,new Bg(t),t.bypassAuthState)}function Hg(t){const{auth:e,user:n}=t;return $f(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await gp(t,yg(i,r,e,t),n);$f(s.idToken,i,"internal-error");const o=pp(s.idToken);$f(o,i,"internal-error");const{sub:a}=o;return $f(t.uid===a,i,"user-mismatch"),pg._forOperation(t,r,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&Vf(i,"user-mismatch"),t}}(n,new Bg(t),t.bypassAuthState)}async function $g(t){const{auth:e,user:n}=t;return $f(n,e,"internal-error"),async function(t,e,n=!1){const i=await gp(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return pg._forOperation(t,"link",i)}(n,new Bg(t),t.bypassAuthState)}class Wg{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return zg;case"linkViaPopup":case"linkViaRedirect":return $g;case"reauthViaPopup":case"reauthViaRedirect":return Hg;default:Vf(this.auth,"internal-error")}}resolve(t){Kf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Kf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Kg=new Xf(2e3,1e4);class Gg extends Wg{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Gg.currentPopupAction&&Gg.currentPopupAction.cancel(),Gg.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return $f(t,this.auth,"internal-error"),t}async onExecution(){Kf(1===this.filter.length,"Popup operations only handle one event");const t=xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Bf(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Bf(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gg.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Bf(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,Kg.get())};t()}}Gg.currentPopupAction=null;const Qg="pendingRedirect",Yg=new Map;class Xg extends Wg{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Yg.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=tm(e),i=Zg(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}Yg.set(this.auth._key(),t)}return this.bypassAuthState||Yg.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Jg(t,e){Yg.set(t._key(),e)}function Zg(t){return qp(t._redirectPersistence)}function tm(t){return xp(Qg,t.config.apiKey,t.name)}function em(t,e,n){return async function(t,e,n){const i=Bp(t);(function(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&Vf(t,"argument-error"),zf(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)})(t,e,lg),await i._initializationPromise;const r=Vg(i,n);return await async function(t,e){return Zg(t)._set(tm(e),"true")}(r,i),r._openRedirect(i,e,"signInViaRedirect")}(t,e,n)}async function nm(t,e,n=!1){const i=Bp(t),r=Vg(i,e),s=new Xg(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class im{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sm(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!sm(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Bf(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(rm(t))}saveEventToCache(t){this.cachedEventUids.add(rm(t)),this.lastProcessedEventTime=Date.now()}}function rm(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function sm({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const om=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,am=/^https?/;function lm(t){const e=Gf(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!am.test(n))return!1;if(om.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const cm=new Xf(3e4,6e4);function um(){const t=Sg().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}function hm(t){return new Promise(((e,n)=>{var i,r,s;function o(){um(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{um(),n(Bf(t,"network-request-failed"))},timeout:cm.get()})}if(null===(r=null===(i=Sg().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=Sg().gapi)||void 0===s?void 0:s.load)){const e=Wp("iframefcb");return Sg()[e]=()=>{gapi.load?o():n(Bf(t,"network-request-failed"))},$p(`${Hp.gapiScript}?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw dm=null,t}))}let dm=null;const fm=new Xf(5e3,15e3),pm="__/auth/iframe",gm="emulator/auth/iframe",mm={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ym=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vm(t){const e=t.config;$f(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Jf(e,gm):`https://${t.config.authDomain}/${pm}`,i={apiKey:e.apiKey,appName:t.name,v:Ee},r=ym.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${St(i).slice(1)}`}const bm={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class wm{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const Em=encodeURIComponent("fac");async function _m(t,e,n,i,r,s){$f(t.config.authDomain,t,"auth-domain-config-required"),$f(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:Ee,eventId:r};if(e instanceof lg){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof cg){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const l=await t._getAppCheckToken(),c=l?`#${Em}=${encodeURIComponent(l)}`:"";return`${function({config:t}){return t.emulator?Jf(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${St(a).slice(1)}${c}`}const qm="webStorageSupport",km=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kg,this._completeRedirectFn=nm,this._overrideRedirectResult=Jg}async _openPopup(t,e,n,i){var r;return Kf(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},bm),{width:i.toString(),height:r.toString(),top:s,left:o}),c=Et().toLowerCase();n&&(a=Cp(c)?"_blank":n),Ap(c)&&(e=e||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=Et()){var e;return Mp(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",a),new wm(null);const h=window.open(e||"",a,u);$f(h,t,"popup-blocked");try{h.focus()}catch(t){}return new wm(h)}(t,await _m(t,e,n,Gf(),i),xg())}async _openRedirect(t,e,n,i){return await this._originValidation(t),r=await _m(t,e,n,Gf(),i),Sg().location.href=r,new Promise((()=>{}));var r}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(Kf(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await function(t){return dm=dm||hm(t),dm}(t),n=Sg().gapi;return $f(n,t,"internal-error"),e.open({where:document.body,url:vm(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mm,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=Bf(t,"network-request-failed"),s=Sg().setTimeout((()=>{i(r)}),fm.get());function o(){Sg().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new im(t);return e.register("authEvent",(e=>($f(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(qm,{type:qm},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[qm];void 0!==r&&e(!!r),Vf(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return ip(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(lm(t))return}catch(t){}Vf(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Pp()||Np()||Mp()}};var Tm="@firebase/auth",xm="1.6.1";class Im{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){$f(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Sm=bt("authIdTokenMaxAge")||300;let Am=null;function Nm(t=qe()){const e=ve(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=ve(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(xt(n.getOptions(),null!=e?e:{}))return t;Vf(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:km,persistence:[Ug,_g,kg]}),i=bt("authTokenSyncURL");if(i){const t=(r=i,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>Sm)return;const i=null==e?void 0:e.token;Am!==i&&(Am=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,n){Lt(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,r){Lt(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var r;const s=yt("auth");return s&&function(t,e,n){const i=Bp(t);$f(i._canInitEmulator,i,"emulator-config-failed"),$f(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=Yp(e),{host:o,port:a}=function(t){const e=Yp(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const t=r[1];return{host:t,port:Xp(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:Xp(e)}}}(e),l=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}var Cm;let Om;!function(t){Hp=t}({loadJS:t=>new Promise(((e,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=Bf("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),Cm="Browser",ye(new Dt("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;$f(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:Cm,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jp(Cm)},l=new Vp(n,i,r,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(qp);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(l,e),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),ye(new Dt("auth-internal",(t=>{return e=Bp(t.getProvider("auth").getImmediate()),new Im(e);var e}),"PRIVATE").setInstantiationMode("EXPLICIT")),ke(Tm,xm,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Cm)),ke(Tm,xm,"esm2017"),vg(Nm(),(async t=>{t&&(Om=t.uid)}));const Lm=function(t,e){const n=ve(qe(),"firestore").getImmediate({identifier:"(default)"});if(!n._initialized){const t=(t=>{const e=yt("firestore");if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]})();t&&function(t,e,n,i={}){var r;const s=(t=Od(t,Dd))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&lo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=no.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[pt(JSON.stringify({alg:"none",type:"JWT"})),pt(JSON.stringify(s)),""].join(".")}(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new go(po.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new no(s)}t._authCredentials=new bo(new yo(e,n))}}(n,...t)}return n}(),Dm=function(t,e){return t===e||t!=t&&e!=e},Rm=function(t,e){for(var n=t.length;n--;)if(Dm(t[n][0],e))return n;return-1};var Mm=Array.prototype.splice;function Pm(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Pm.prototype.clear=function(){this.__data__=[],this.size=0},Pm.prototype.delete=function(t){var e=this.__data__,n=Rm(e,t);return!(n<0||(n==e.length-1?e.pop():Mm.call(e,n,1),--this.size,0))},Pm.prototype.get=function(t){var e=this.__data__,n=Rm(e,t);return n<0?void 0:e[n][1]},Pm.prototype.has=function(t){return Rm(this.__data__,t)>-1},Pm.prototype.set=function(t,e){var n=this.__data__,i=Rm(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};const jm=Pm,Um="object"==typeof global&&global&&global.Object===Object&&global;var Fm="object"==typeof self&&self&&self.Object===Object&&self;const Vm=Um||Fm||Function("return this")(),Bm=Vm.Symbol;var zm=Object.prototype,Hm=zm.hasOwnProperty,$m=zm.toString,Wm=Bm?Bm.toStringTag:void 0;var Km=Object.prototype.toString;var Gm=Bm?Bm.toStringTag:void 0;const Qm=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Gm&&Gm in Object(t)?function(t){var e=Hm.call(t,Wm),n=t[Wm];try{t[Wm]=void 0;var i=!0}catch(t){}var r=$m.call(t);return i&&(e?t[Wm]=n:delete t[Wm]),r}(t):function(t){return Km.call(t)}(t)},Ym=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},Xm=function(t){if(!Ym(t))return!1;var e=Qm(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Jm=Vm["__core-js_shared__"];var Zm=function(){var t=/[^.]+$/.exec(Jm&&Jm.keys&&Jm.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();var ty=Function.prototype.toString;const ey=function(t){if(null!=t){try{return ty.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var ny=/^\[object .+?Constructor\]$/,iy=Function.prototype,ry=Object.prototype,sy=iy.toString,oy=ry.hasOwnProperty,ay=RegExp("^"+sy.call(oy).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const ly=function(t){return!(!Ym(t)||(e=t,Zm&&Zm in e))&&(Xm(t)?ay:ny).test(ey(t));var e},cy=function(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return ly(n)?n:void 0},uy=cy(Vm,"Map"),hy=cy(Object,"create");var dy=Object.prototype.hasOwnProperty;var fy=Object.prototype.hasOwnProperty;function py(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}py.prototype.clear=function(){this.__data__=hy?hy(null):{},this.size=0},py.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},py.prototype.get=function(t){var e=this.__data__;if(hy){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return dy.call(e,t)?e[t]:void 0},py.prototype.has=function(t){var e=this.__data__;return hy?void 0!==e[t]:fy.call(e,t)},py.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=hy&&void 0===e?"__lodash_hash_undefined__":e,this};const gy=py,my=function(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map};function yy(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}yy.prototype.clear=function(){this.size=0,this.__data__={hash:new gy,map:new(uy||jm),string:new gy}},yy.prototype.delete=function(t){var e=my(this,t).delete(t);return this.size-=e?1:0,e},yy.prototype.get=function(t){return my(this,t).get(t)},yy.prototype.has=function(t){return my(this,t).has(t)},yy.prototype.set=function(t,e){var n=my(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};const vy=yy;function by(t){var e=this.__data__=new jm(t);this.size=e.size}by.prototype.clear=function(){this.__data__=new jm,this.size=0},by.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},by.prototype.get=function(t){return this.__data__.get(t)},by.prototype.has=function(t){return this.__data__.has(t)},by.prototype.set=function(t,e){var n=this.__data__;if(n instanceof jm){var i=n.__data__;if(!uy||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new vy(i)}return n.set(t,e),this.size=n.size,this};const wy=by,Ey=function(){try{var t=cy(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),_y=function(t,e,n){"__proto__"==e&&Ey?Ey(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},qy=function(t,e,n){(void 0!==n&&!Dm(t[e],n)||void 0===n&&!(e in t))&&_y(t,e,n)},ky=function(t,e,n){for(var i=-1,r=Object(t),s=n(t),o=s.length;o--;){var a=s[++i];if(!1===e(r[a],a,r))break}return t};var Ty="object"==typeof exports&&exports&&!exports.nodeType&&exports,xy=Ty&&"object"==typeof module&&module&&!module.nodeType&&module,Iy=xy&&xy.exports===Ty?Vm.Buffer:void 0,Sy=Iy?Iy.allocUnsafe:void 0;const Ay=function(t,e){if(e)return t.slice();var n=t.length,i=Sy?Sy(n):new t.constructor(n);return t.copy(i),i},Ny=Vm.Uint8Array,Cy=function(t){var e=new t.constructor(t.byteLength);return new Ny(e).set(new Ny(t)),e},Oy=function(t,e){var n=e?Cy(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)},Ly=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e};var Dy=Object.create;const Ry=function(){function t(){}return function(e){if(!Ym(e))return{};if(Dy)return Dy(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),My=function(t,e){return function(n){return t(e(n))}},Py=My(Object.getPrototypeOf,Object);var jy=Object.prototype;const Uy=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||jy)},Fy=function(t){return"function"!=typeof t.constructor||Uy(t)?{}:Ry(Py(t))},Vy=function(t){return null!=t&&"object"==typeof t},By=function(t){return Vy(t)&&"[object Arguments]"==Qm(t)};var zy=Object.prototype,Hy=zy.hasOwnProperty,$y=zy.propertyIsEnumerable;const Wy=By(function(){return arguments}())?By:function(t){return Vy(t)&&Hy.call(t,"callee")&&!$y.call(t,"callee")},Ky=Array.isArray,Gy=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Qy=function(t){return null!=t&&Gy(t.length)&&!Xm(t)};var Yy="object"==typeof exports&&exports&&!exports.nodeType&&exports,Xy=Yy&&"object"==typeof module&&module&&!module.nodeType&&module,Jy=Xy&&Xy.exports===Yy?Vm.Buffer:void 0;const Zy=(Jy?Jy.isBuffer:void 0)||function(){return!1};var tv=Function.prototype,ev=Object.prototype,nv=tv.toString,iv=ev.hasOwnProperty,rv=nv.call(Object);var sv={};sv["[object Float32Array]"]=sv["[object Float64Array]"]=sv["[object Int8Array]"]=sv["[object Int16Array]"]=sv["[object Int32Array]"]=sv["[object Uint8Array]"]=sv["[object Uint8ClampedArray]"]=sv["[object Uint16Array]"]=sv["[object Uint32Array]"]=!0,sv["[object Arguments]"]=sv["[object Array]"]=sv["[object ArrayBuffer]"]=sv["[object Boolean]"]=sv["[object DataView]"]=sv["[object Date]"]=sv["[object Error]"]=sv["[object Function]"]=sv["[object Map]"]=sv["[object Number]"]=sv["[object Object]"]=sv["[object RegExp]"]=sv["[object Set]"]=sv["[object String]"]=sv["[object WeakMap]"]=!1;const ov=function(t){return function(e){return t(e)}};var av="object"==typeof exports&&exports&&!exports.nodeType&&exports,lv=av&&"object"==typeof module&&module&&!module.nodeType&&module,cv=lv&&lv.exports===av&&Um.process;const uv=function(){try{return lv&&lv.require&&lv.require("util").types||cv&&cv.binding&&cv.binding("util")}catch(t){}}();var hv=uv&&uv.isTypedArray;const dv=hv?ov(hv):function(t){return Vy(t)&&Gy(t.length)&&!!sv[Qm(t)]},fv=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var pv=Object.prototype.hasOwnProperty;const gv=function(t,e,n){var i=t[e];pv.call(t,e)&&Dm(i,n)&&(void 0!==n||e in t)||_y(t,e,n)},mv=function(t,e,n,i){var r=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(n[a],t[a],a,n,t):void 0;void 0===l&&(l=t[a]),r?_y(n,a,l):gv(n,a,l)}return n};var yv=/^(?:0|[1-9]\d*)$/;const vv=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&yv.test(t))&&t>-1&&t%1==0&&t<e};var bv=Object.prototype.hasOwnProperty;const wv=function(t,e){var n=Ky(t),i=!n&&Wy(t),r=!n&&!i&&Zy(t),s=!n&&!i&&!r&&dv(t),o=n||i||r||s,a=o?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],l=a.length;for(var c in t)!e&&!bv.call(t,c)||o&&("length"==c||r&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||vv(c,l))||a.push(c);return a};var Ev=Object.prototype.hasOwnProperty;const _v=function(t){if(!Ym(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=Uy(t),n=[];for(var i in t)("constructor"!=i||!e&&Ev.call(t,i))&&n.push(i);return n},qv=function(t){return Qy(t)?wv(t,!0):_v(t)},kv=function(t,e,n,i,r,s,o){var a,l=fv(t,n),c=fv(e,n),u=o.get(c);if(u)qy(t,n,u);else{var h=s?s(l,c,n+"",t,e,o):void 0,d=void 0===h;if(d){var f=Ky(c),p=!f&&Zy(c),g=!f&&!p&&dv(c);h=c,f||p||g?Ky(l)?h=l:Vy(a=l)&&Qy(a)?h=Ly(l):p?(d=!1,h=Ay(c,!0)):g?(d=!1,h=Oy(c,!0)):h=[]:function(t){if(!Vy(t)||"[object Object]"!=Qm(t))return!1;var e=Py(t);if(null===e)return!0;var n=iv.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&nv.call(n)==rv}(c)||Wy(c)?(h=l,Wy(l)?h=function(t){return mv(t,qv(t))}(l):Ym(l)&&!Xm(l)||(h=Fy(c))):d=!1}d&&(o.set(c,h),r(h,c,i,s,o),o.delete(c)),qy(t,n,h)}},Tv=function t(e,n,i,r,s){e!==n&&ky(n,(function(o,a){if(s||(s=new wy),Ym(o))kv(e,n,a,i,t,r,s);else{var l=r?r(fv(e,a),o,a+"",e,n,s):void 0;void 0===l&&(l=o),qy(e,a,l)}}),qv)},xv=function(t){return t};var Iv=Math.max;const Sv=Ey?function(t,e){return Ey(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:xv;var Av=Date.now;const Nv=(Cv=Sv,Ov=0,Lv=0,function(){var t=Av(),e=16-(t-Lv);if(Lv=t,e>0){if(++Ov>=800)return arguments[0]}else Ov=0;return Cv.apply(void 0,arguments)});var Cv,Ov,Lv;const Dv=function(t,e){return Nv(function(t,e,n){return e=Iv(void 0===e?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=Iv(i.length-e,0),o=Array(s);++r<s;)o[r]=i[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=i[r];return a[e]=n(o),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,a)}}(t,e,xv),t+"")},Rv=(Mv=function(t,e,n){Tv(t,e,n)},Dv((function(t,e){var n=-1,i=e.length,r=i>1?e[i-1]:void 0,s=i>2?e[2]:void 0;for(r=Mv.length>3&&"function"==typeof r?(i--,r):void 0,s&&function(t,e,n){if(!Ym(n))return!1;var i=typeof e;return!!("number"==i?Qy(n)&&vv(e,n.length):"string"==i&&e in n)&&Dm(n[e],t)}(e[0],e[1],s)&&(r=i<3?void 0:r,i=1),t=Object(t);++n<i;){var o=e[n];o&&Mv(t,o,n)}return t})));var Mv;const Pv=My(Object.keys,Object);var jv=Object.prototype.hasOwnProperty;const Uv=function(t){return Qy(t)?wv(t):function(t){if(!Uy(t))return Pv(t);var e=[];for(var n in Object(t))jv.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)},Fv=function(){return[]};var Vv=Object.prototype.propertyIsEnumerable,Bv=Object.getOwnPropertySymbols;const zv=Bv?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[r++]=o)}return s}(Bv(t),(function(e){return Vv.call(t,e)})))}:Fv,Hv=function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t},$v=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Hv(e,zv(t)),t=Py(t);return e}:Fv,Wv=function(t,e,n){var i=e(t);return Ky(t)?i:Hv(i,n(t))},Kv=function(t){return Wv(t,Uv,zv)},Gv=function(t){return Wv(t,qv,$v)},Qv=cy(Vm,"DataView"),Yv=cy(Vm,"Promise"),Xv=cy(Vm,"Set"),Jv=cy(Vm,"WeakMap");var Zv="[object Map]",tb="[object Promise]",eb="[object Set]",nb="[object WeakMap]",ib="[object DataView]",rb=ey(Qv),sb=ey(uy),ob=ey(Yv),ab=ey(Xv),lb=ey(Jv),cb=Qm;(Qv&&cb(new Qv(new ArrayBuffer(1)))!=ib||uy&&cb(new uy)!=Zv||Yv&&cb(Yv.resolve())!=tb||Xv&&cb(new Xv)!=eb||Jv&&cb(new Jv)!=nb)&&(cb=function(t){var e=Qm(t),n="[object Object]"==e?t.constructor:void 0,i=n?ey(n):"";if(i)switch(i){case rb:return ib;case sb:return Zv;case ob:return tb;case ab:return eb;case lb:return nb}return e});const ub=cb;var hb=Object.prototype.hasOwnProperty;var db=/\w*$/;var fb=Bm?Bm.prototype:void 0,pb=fb?fb.valueOf:void 0;const gb=function(t,e,n){var i,r,s,o=t.constructor;switch(e){case"[object ArrayBuffer]":return Cy(t);case"[object Boolean]":case"[object Date]":return new o(+t);case"[object DataView]":return function(t,e){var n=e?Cy(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Oy(t,n);case"[object Map]":case"[object Set]":return new o;case"[object Number]":case"[object String]":return new o(t);case"[object RegExp]":return(s=new(r=t).constructor(r.source,db.exec(r))).lastIndex=r.lastIndex,s;case"[object Symbol]":return i=t,pb?Object(pb.call(i)):{}}};var mb=uv&&uv.isMap;const yb=mb?ov(mb):function(t){return Vy(t)&&"[object Map]"==ub(t)};var vb=uv&&uv.isSet;const bb=vb?ov(vb):function(t){return Vy(t)&&"[object Set]"==ub(t)};var wb="[object Arguments]",Eb="[object Function]",_b="[object Object]",qb={};qb[wb]=qb["[object Array]"]=qb["[object ArrayBuffer]"]=qb["[object DataView]"]=qb["[object Boolean]"]=qb["[object Date]"]=qb["[object Float32Array]"]=qb["[object Float64Array]"]=qb["[object Int8Array]"]=qb["[object Int16Array]"]=qb["[object Int32Array]"]=qb["[object Map]"]=qb["[object Number]"]=qb[_b]=qb["[object RegExp]"]=qb["[object Set]"]=qb["[object String]"]=qb["[object Symbol]"]=qb["[object Uint8Array]"]=qb["[object Uint8ClampedArray]"]=qb["[object Uint16Array]"]=qb["[object Uint32Array]"]=!0,qb["[object Error]"]=qb[Eb]=qb["[object WeakMap]"]=!1;const kb=function t(e,n,i,r,s,o){var a,l=1&n,c=2&n,u=4&n;if(i&&(a=s?i(e,r,s,o):i(e)),void 0!==a)return a;if(!Ym(e))return e;var h=Ky(e);if(h){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&hb.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(e),!l)return Ly(e,a)}else{var d=ub(e),f=d==Eb||"[object GeneratorFunction]"==d;if(Zy(e))return Ay(e,l);if(d==_b||d==wb||f&&!s){if(a=c||f?{}:Fy(e),!l)return c?function(t,e){return mv(t,$v(t),e)}(e,function(t,e){return t&&mv(e,qv(e),t)}(a,e)):function(t,e){return mv(t,zv(t),e)}(e,function(t,e){return t&&mv(e,Uv(e),t)}(a,e))}else{if(!qb[d])return s?e:{};a=gb(e,d,l)}}o||(o=new wy);var p=o.get(e);if(p)return p;o.set(e,a),bb(e)?e.forEach((function(r){a.add(t(r,n,i,r,e,o))})):yb(e)&&e.forEach((function(r,s){a.set(s,t(r,n,i,s,e,o))}));var g=h?void 0:(u?c?Gv:Kv:c?qv:Uv)(e);return function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););}(g||e,(function(r,s){g&&(r=e[s=r]),gv(a,s,t(r,n,i,s,e,o))})),a},Tb=function(t){return kb(t,5)};var xb=(t=>(t[t.TYPE=3]="TYPE",t[t.LEVEL=12]="LEVEL",t[t.ATTRIBUTE=13]="ATTRIBUTE",t[t.BLOT=14]="BLOT",t[t.INLINE=7]="INLINE",t[t.BLOCK=11]="BLOCK",t[t.BLOCK_BLOT=10]="BLOCK_BLOT",t[t.INLINE_BLOT=6]="INLINE_BLOT",t[t.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",t[t.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",t[t.ANY=15]="ANY",t))(xb||{});class Ib{constructor(t,e,n={}){this.attrName=t,this.keyName=e;const i=xb.TYPE&xb.ATTRIBUTE;this.scope=null!=n.scope?n.scope&xb.LEVEL|i:xb.ATTRIBUTE,null!=n.whitelist&&(this.whitelist=n.whitelist)}static keys(t){return Array.from(t.attributes).map((t=>t.name))}add(t,e){return!!this.canAdd(t,e)&&(t.setAttribute(this.keyName,e),!0)}canAdd(t,e){return null==this.whitelist||("string"==typeof e?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1)}remove(t){t.removeAttribute(this.keyName)}value(t){const e=t.getAttribute(this.keyName);return this.canAdd(t,e)&&e?e:""}}class Sb extends Error{constructor(t){super(t="[Parchment] "+t),this.message=t,this.name=this.constructor.name}}const Ab=class t{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(t,e=!1){if(null==t)return null;if(this.blots.has(t))return this.blots.get(t)||null;if(e){let n=null;try{n=t.parentNode}catch{return null}return this.find(n,e)}return null}create(e,n,i){const r=this.query(n);if(null==r)throw new Sb(`Unable to create ${n} blot`);const s=r,o=n instanceof Node||n.nodeType===Node.TEXT_NODE?n:s.create(i),a=new s(e,o,i);return t.blots.set(a.domNode,a),a}find(e,n=!1){return t.find(e,n)}query(t,e=xb.ANY){let n;return"string"==typeof t?n=this.types[t]||this.attributes[t]:t instanceof Text||t.nodeType===Node.TEXT_NODE?n=this.types.text:"number"==typeof t?t&xb.LEVEL&xb.BLOCK?n=this.types.block:t&xb.LEVEL&xb.INLINE&&(n=this.types.inline):t instanceof Element&&((t.getAttribute("class")||"").split(/\s+/).some((t=>(n=this.classes[t],!!n))),n=n||this.tags[t.tagName]),null==n?null:"scope"in n&&e&xb.LEVEL&n.scope&&e&xb.TYPE&n.scope?n:null}register(...t){return t.map((t=>{const e="blotName"in t,n="attrName"in t;if(!e&&!n)throw new Sb("Invalid definition");if(e&&"abstract"===t.blotName)throw new Sb("Cannot register abstract class");const i=e?t.blotName:n?t.attrName:void 0;return this.types[i]=t,n?"string"==typeof t.keyName&&(this.attributes[t.keyName]=t):e&&(t.className&&(this.classes[t.className]=t),t.tagName&&(Array.isArray(t.tagName)?t.tagName=t.tagName.map((t=>t.toUpperCase())):t.tagName=t.tagName.toUpperCase(),(Array.isArray(t.tagName)?t.tagName:[t.tagName]).forEach((e=>{(null==this.tags[e]||null==t.className)&&(this.tags[e]=t)})))),t}))}};Ab.blots=new WeakMap;let Nb=Ab;function Cb(t,e){return(t.getAttribute("class")||"").split(/\s+/).filter((t=>0===t.indexOf(`${e}-`)))}class Ob extends Ib{static keys(t){return(t.getAttribute("class")||"").split(/\s+/).map((t=>t.split("-").slice(0,-1).join("-")))}add(t,e){return!!this.canAdd(t,e)&&(this.remove(t),t.classList.add(`${this.keyName}-${e}`),!0)}remove(t){Cb(t,this.keyName).forEach((e=>{t.classList.remove(e)})),0===t.classList.length&&t.removeAttribute("class")}value(t){const e=(Cb(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,e)?e:""}}function Lb(t){const e=t.split("-"),n=e.slice(1).map((t=>t[0].toUpperCase()+t.slice(1))).join("");return e[0]+n}class Db extends Ib{static keys(t){return(t.getAttribute("style")||"").split(";").map((t=>t.split(":")[0].trim()))}add(t,e){return!!this.canAdd(t,e)&&(t.style[Lb(this.keyName)]=e,!0)}remove(t){t.style[Lb(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")}value(t){const e=t.style[Lb(this.keyName)];return this.canAdd(t,e)?e:""}}class Rb{constructor(t){this.attributes={},this.domNode=t,this.build()}attribute(t,e){e?t.add(this.domNode,e)&&(null!=t.value(this.domNode)?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])}build(){this.attributes={};const t=Nb.find(this.domNode);if(null==t)return;const e=Ib.keys(this.domNode),n=Ob.keys(this.domNode),i=Db.keys(this.domNode);e.concat(n).concat(i).forEach((e=>{const n=t.scroll.query(e,xb.ATTRIBUTE);n instanceof Ib&&(this.attributes[n.attrName]=n)}))}copy(t){Object.keys(this.attributes).forEach((e=>{const n=this.attributes[e].value(this.domNode);t.format(e,n)}))}move(t){this.copy(t),Object.keys(this.attributes).forEach((t=>{this.attributes[t].remove(this.domNode)})),this.attributes={}}values(){return Object.keys(this.attributes).reduce(((t,e)=>(t[e]=this.attributes[e].value(this.domNode),t)),{})}}const Mb=class{constructor(t,e){this.scroll=t,this.domNode=e,Nb.blots.set(e,this),this.prev=null,this.next=null}static create(t){if(null==this.tagName)throw new Sb("Blot definition missing tagName");let e,n;return Array.isArray(this.tagName)?("string"==typeof t?(n=t.toUpperCase(),parseInt(n,10).toString()===n&&(n=parseInt(n,10))):"number"==typeof t&&(n=t),e="number"==typeof n?document.createElement(this.tagName[n-1]):n&&this.tagName.indexOf(n)>-1?document.createElement(n):document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e}get statics(){return this.constructor}attach(){}clone(){const t=this.domNode.cloneNode(!1);return this.scroll.create(t)}detach(){null!=this.parent&&this.parent.removeChild(this),Nb.blots.delete(this.domNode)}deleteAt(t,e){this.isolate(t,e).remove()}formatAt(t,e,n,i){const r=this.isolate(t,e);if(null!=this.scroll.query(n,xb.BLOT)&&i)r.wrap(n,i);else if(null!=this.scroll.query(n,xb.ATTRIBUTE)){const t=this.scroll.create(this.statics.scope);r.wrap(t),t.format(n,i)}}insertAt(t,e,n){const i=null==n?this.scroll.create("text",e):this.scroll.create(e,n),r=this.split(t);this.parent.insertBefore(i,r||void 0)}isolate(t,e){const n=this.split(t);if(null==n)throw new Error("Attempt to isolate at end");return n.split(e),n}length(){return 1}offset(t=this.parent){return null==this.parent||this===t?0:this.parent.children.offset(this)+this.parent.offset(t)}optimize(t){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(t,e){const n="string"==typeof t?this.scroll.create(t,e):t;return null!=this.parent&&(this.parent.insertBefore(n,this.next||void 0),this.remove()),n}split(t,e){return 0===t?this:this.next}update(t,e){}wrap(t,e){const n="string"==typeof t?this.scroll.create(t,e):t;if(null!=this.parent&&this.parent.insertBefore(n,this.next||void 0),"function"!=typeof n.appendChild)throw new Sb(`Cannot wrap ${t}`);return n.appendChild(this),n}};Mb.blotName="abstract";let Pb=Mb;const jb=class extends Pb{static value(t){return!0}index(t,e){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1}position(t,e){let n=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return t>0&&(n+=1),[this.parent.domNode,n]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};jb.scope=xb.INLINE_BLOT;let Ub=jb;class Fb{constructor(){this.head=null,this.tail=null,this.length=0}append(...t){if(this.insertBefore(t[0],null),t.length>1){const e=t.slice(1);this.append(...e)}}at(t){const e=this.iterator();let n=e();for(;n&&t>0;)t-=1,n=e();return n}contains(t){const e=this.iterator();let n=e();for(;n;){if(n===t)return!0;n=e()}return!1}indexOf(t){const e=this.iterator();let n=e(),i=0;for(;n;){if(n===t)return i;i+=1,n=e()}return-1}insertBefore(t,e){null!=t&&(this.remove(t),t.next=e,null!=e?(t.prev=e.prev,null!=e.prev&&(e.prev.next=t),e.prev=t,e===this.head&&(this.head=t)):null!=this.tail?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)}offset(t){let e=0,n=this.head;for(;null!=n;){if(n===t)return e;e+=n.length(),n=n.next}return-1}remove(t){this.contains(t)&&(null!=t.prev&&(t.prev.next=t.next),null!=t.next&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)}iterator(t=this.head){return()=>{const e=t;return null!=t&&(t=t.next),e}}find(t,e=!1){const n=this.iterator();let i=n();for(;i;){const r=i.length();if(t<r||e&&t===r&&(null==i.next||0!==i.next.length()))return[i,t];t-=r,i=n()}return[null,0]}forEach(t){const e=this.iterator();let n=e();for(;n;)t(n),n=e()}forEachAt(t,e,n){if(e<=0)return;const[i,r]=this.find(t);let s=t-r;const o=this.iterator(i);let a=o();for(;a&&s<t+e;){const i=a.length();t>s?n(a,t-s,Math.min(e,s+i-t)):n(a,0,Math.min(i,t+e-s)),s+=i,a=o()}}map(t){return this.reduce(((e,n)=>(e.push(t(n)),e)),[])}reduce(t,e){const n=this.iterator();let i=n();for(;i;)e=t(e,i),i=n();return e}}function Vb(t,e){const n=e.find(t);if(n)return n;try{return e.create(t)}catch{const n=e.create(xb.INLINE);return Array.from(t.childNodes).forEach((t=>{n.domNode.appendChild(t)})),t.parentNode&&t.parentNode.replaceChild(n.domNode,t),n.attach(),n}}const Bb=class t extends Pb{constructor(t,e){super(t,e),this.uiNode=null,this.build()}appendChild(t){this.insertBefore(t)}attach(){super.attach(),this.children.forEach((t=>{t.attach()}))}attachUI(e){null!=this.uiNode&&this.uiNode.remove(),this.uiNode=e,t.uiClass&&this.uiNode.classList.add(t.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Fb,Array.from(this.domNode.childNodes).filter((t=>t!==this.uiNode)).reverse().forEach((t=>{try{const e=Vb(t,this.scroll);this.insertBefore(e,this.children.head||void 0)}catch(t){if(t instanceof Sb)return;throw t}}))}deleteAt(t,e){if(0===t&&e===this.length())return this.remove();this.children.forEachAt(t,e,((t,e,n)=>{t.deleteAt(e,n)}))}descendant(e,n=0){const[i,r]=this.children.find(n);return null==e.blotName&&e(i)||null!=e.blotName&&i instanceof e?[i,r]:i instanceof t?i.descendant(e,r):[null,-1]}descendants(e,n=0,i=Number.MAX_VALUE){let r=[],s=i;return this.children.forEachAt(n,i,((n,i,o)=>{(null==e.blotName&&e(n)||null!=e.blotName&&n instanceof e)&&r.push(n),n instanceof t&&(r=r.concat(n.descendants(e,i,s))),s-=o})),r}detach(){this.children.forEach((t=>{t.detach()})),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach((n=>{e||this.statics.allowedChildren.some((t=>n instanceof t))||(n.statics.scope===xb.BLOCK_BLOT?(null!=n.next&&this.splitAfter(n),null!=n.prev&&this.splitAfter(n.prev),n.parent.unwrap(),e=!0):n instanceof t?n.unwrap():n.remove())}))}formatAt(t,e,n,i){this.children.forEachAt(t,e,((t,e,r)=>{t.formatAt(e,r,n,i)}))}insertAt(t,e,n){const[i,r]=this.children.find(t);if(i)i.insertAt(r,e,n);else{const t=null==n?this.scroll.create("text",e):this.scroll.create(e,n);this.appendChild(t)}}insertBefore(t,e){null!=t.parent&&t.parent.children.remove(t);let n=null;this.children.insertBefore(t,e||null),t.parent=this,null!=e&&(n=e.domNode),(this.domNode.parentNode!==t.domNode||this.domNode.nextSibling!==n)&&this.domNode.insertBefore(t.domNode,n),t.attach()}length(){return this.children.reduce(((t,e)=>t+e.length()),0)}moveChildren(t,e){this.children.forEach((n=>{t.insertBefore(n,e)}))}optimize(t){if(super.optimize(t),this.enforceAllowedChildren(),null!=this.uiNode&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),0===this.children.length)if(null!=this.statics.defaultChild){const t=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(t)}else this.remove()}path(e,n=!1){const[i,r]=this.children.find(e,n),s=[[this,e]];return i instanceof t?s.concat(i.path(r,n)):(null!=i&&s.push([i,r]),s)}removeChild(t){this.children.remove(t)}replaceWith(e,n){const i="string"==typeof e?this.scroll.create(e,n):e;return i instanceof t&&this.moveChildren(i),super.replaceWith(i)}split(t,e=!1){if(!e){if(0===t)return this;if(t===this.length())return this.next}const n=this.clone();return this.parent&&this.parent.insertBefore(n,this.next||void 0),this.children.forEachAt(t,this.length(),((t,i,r)=>{const s=t.split(i,e);null!=s&&n.appendChild(s)})),n}splitAfter(t){const e=this.clone();for(;null!=t.next;)e.appendChild(t.next);return this.parent&&this.parent.insertBefore(e,this.next||void 0),e}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(t,e){const n=[],i=[];t.forEach((t=>{t.target===this.domNode&&"childList"===t.type&&(n.push(...t.addedNodes),i.push(...t.removedNodes))})),i.forEach((t=>{if(null!=t.parentNode&&"IFRAME"!==t.tagName&&document.body.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const e=this.scroll.find(t);null!=e&&(null==e.domNode.parentNode||e.domNode.parentNode===this.domNode)&&e.detach()})),n.filter((t=>t.parentNode===this.domNode&&t!==this.uiNode)).sort(((t,e)=>t===e?0:t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1)).forEach((t=>{let e=null;null!=t.nextSibling&&(e=this.scroll.find(t.nextSibling));const n=Vb(t,this.scroll);(n.next!==e||null==n.next)&&(null!=n.parent&&n.parent.removeChild(this),this.insertBefore(n,e||void 0))})),this.enforceAllowedChildren()}};Bb.uiClass="";let zb=Bb;const Hb=class t extends zb{constructor(t,e){super(t,e),this.attributes=new Rb(this.domNode)}static create(t){return super.create(t)}static formats(e,n){const i=n.query(t.blotName);if(null==i||e.tagName!==i.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}format(e,n){if(e!==this.statics.blotName||n){const t=this.scroll.query(e,xb.INLINE);if(null==t)return;t instanceof Ib?this.attributes.attribute(t,n):n&&(e!==this.statics.blotName||this.formats()[e]!==n)&&this.replaceWith(e,n)}else this.children.forEach((e=>{e instanceof t||(e=e.wrap(t.blotName,!0)),this.attributes.copy(e)})),this.unwrap()}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return null!=e&&(t[this.statics.blotName]=e),t}formatAt(t,e,n,i){null!=this.formats()[n]||this.scroll.query(n,xb.ATTRIBUTE)?this.isolate(t,e).format(n,i):super.formatAt(t,e,n,i)}optimize(e){super.optimize(e);const n=this.formats();if(0===Object.keys(n).length)return this.unwrap();const i=this.next;i instanceof t&&i.prev===this&&function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}(n,i.formats())&&(i.moveChildren(this),i.remove())}replaceWith(t,e){const n=super.replaceWith(t,e);return this.attributes.copy(n),n}update(t,e){super.update(t,e),t.some((t=>t.target===this.domNode&&"attributes"===t.type))&&this.attributes.build()}wrap(e,n){const i=super.wrap(e,n);return i instanceof t&&this.attributes.move(i),i}};Hb.allowedChildren=[Hb,Ub],Hb.blotName="inline",Hb.scope=xb.INLINE_BLOT,Hb.tagName="SPAN";let $b=Hb;const Wb=class t extends zb{constructor(t,e){super(t,e),this.attributes=new Rb(this.domNode)}static create(t){return super.create(t)}static formats(e,n){const i=n.query(t.blotName);if(null==i||e.tagName!==i.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}format(e,n){const i=this.scroll.query(e,xb.BLOCK);null!=i&&(i instanceof Ib?this.attributes.attribute(i,n):e!==this.statics.blotName||n?n&&(e!==this.statics.blotName||this.formats()[e]!==n)&&this.replaceWith(e,n):this.replaceWith(t.blotName))}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return null!=e&&(t[this.statics.blotName]=e),t}formatAt(t,e,n,i){null!=this.scroll.query(n,xb.BLOCK)?this.format(n,i):super.formatAt(t,e,n,i)}insertAt(t,e,n){if(null==n||null!=this.scroll.query(e,xb.INLINE))super.insertAt(t,e,n);else{const i=this.split(t);if(null==i)throw new Error("Attempt to insertAt after block boundaries");{const t=this.scroll.create(e,n);i.parent.insertBefore(t,i)}}}replaceWith(t,e){const n=super.replaceWith(t,e);return this.attributes.copy(n),n}update(t,e){super.update(t,e),t.some((t=>t.target===this.domNode&&"attributes"===t.type))&&this.attributes.build()}};Wb.blotName="block",Wb.scope=xb.BLOCK_BLOT,Wb.tagName="P",Wb.allowedChildren=[$b,Wb,Ub];let Kb=Wb;const Gb=class extends zb{checkMerge(){return null!==this.next&&this.next.statics.blotName===this.statics.blotName}deleteAt(t,e){super.deleteAt(t,e),this.enforceAllowedChildren()}formatAt(t,e,n,i){super.formatAt(t,e,n,i),this.enforceAllowedChildren()}insertAt(t,e,n){super.insertAt(t,e,n),this.enforceAllowedChildren()}optimize(t){super.optimize(t),this.children.length>0&&null!=this.next&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Gb.blotName="container",Gb.scope=xb.BLOCK_BLOT;let Qb=Gb;class Yb extends Ub{static formats(t,e){}format(t,e){super.formatAt(0,this.length(),t,e)}formatAt(t,e,n,i){0===t&&e===this.length()?this.format(n,i):super.formatAt(t,e,n,i)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Xb={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},Jb=class extends zb{constructor(t,e){super(null,e),this.registry=t,this.scroll=this,this.build(),this.observer=new MutationObserver((t=>{this.update(t)})),this.observer.observe(this.domNode,Xb),this.attach()}create(t,e){return this.registry.create(this,t,e)}find(t,e=!1){const n=this.registry.find(t,e);return n?n.scroll===this?n:e?this.find(n.scroll.domNode.parentNode,!0):null:null}query(t,e=xb.ANY){return this.registry.query(t,e)}register(...t){return this.registry.register(...t)}build(){null!=this.scroll&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(t,e){this.update(),0===t&&e===this.length()?this.children.forEach((t=>{t.remove()})):super.deleteAt(t,e)}formatAt(t,e,n,i){this.update(),super.formatAt(t,e,n,i)}insertAt(t,e,n){this.update(),super.insertAt(t,e,n)}optimize(t=[],e={}){super.optimize(e);const n=e.mutationsMap||new WeakMap;let i=Array.from(this.observer.takeRecords());for(;i.length>0;)t.push(i.pop());const r=(t,e=!0)=>{null==t||t===this||null!=t.domNode.parentNode&&(n.has(t.domNode)||n.set(t.domNode,[]),e&&r(t.parent))},s=t=>{n.has(t.domNode)&&(t instanceof zb&&t.children.forEach(s),n.delete(t.domNode),t.optimize(e))};let o=t;for(let e=0;o.length>0;e+=1){if(e>=100)throw new Error("[Parchment] Maximum optimize iterations reached");for(o.forEach((t=>{const e=this.find(t.target,!0);null!=e&&(e.domNode===t.target&&("childList"===t.type?(r(this.find(t.previousSibling,!1)),Array.from(t.addedNodes).forEach((t=>{const e=this.find(t,!1);r(e,!1),e instanceof zb&&e.children.forEach((t=>{r(t,!1)}))}))):"attributes"===t.type&&r(e.prev)),r(e))})),this.children.forEach(s),o=Array.from(this.observer.takeRecords()),i=o.slice();i.length>0;)t.push(i.pop())}}update(t,e={}){t=t||this.observer.takeRecords();const n=new WeakMap;t.map((t=>{const e=this.find(t.target,!0);return null==e?null:n.has(e.domNode)?(n.get(e.domNode).push(t),null):(n.set(e.domNode,[t]),e)})).forEach((t=>{null!=t&&t!==this&&n.has(t.domNode)&&t.update(n.get(t.domNode)||[],e)})),e.mutationsMap=n,n.has(this.domNode)&&super.update(n.get(this.domNode),e),this.optimize(t,e)}};Jb.blotName="scroll",Jb.defaultChild=Kb,Jb.allowedChildren=[Kb,Qb],Jb.scope=xb.BLOCK_BLOT,Jb.tagName="DIV";let Zb=Jb;const tw=class t extends Ub{constructor(t,e){super(t,e),this.text=this.statics.value(this.domNode)}static create(t){return document.createTextNode(t)}static value(t){return t.data}deleteAt(t,e){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+e)}index(t,e){return this.domNode===t?e:-1}insertAt(t,e,n){null==n?(this.text=this.text.slice(0,t)+e+this.text.slice(t),this.domNode.data=this.text):super.insertAt(t,e,n)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof t&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(t,e=!1){return[this.domNode,t]}split(t,e=!1){if(!e){if(0===t)return this;if(t===this.length())return this.next}const n=this.scroll.create(this.domNode.splitText(t));return this.parent.insertBefore(n,this.next||void 0),this.text=this.statics.value(this.domNode),n}update(t,e){t.some((t=>"characterData"===t.type&&t.target===this.domNode))&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};tw.blotName="text",tw.scope=xb.INLINE_BLOT;let ew=tw;var nw=n(660),iw=n.n(nw);function rw(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new vy;++e<n;)this.add(t[e])}rw.prototype.add=rw.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},rw.prototype.has=function(t){return this.__data__.has(t)};const sw=rw,ow=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1},aw=function(t,e,n,i,r,s){var o=1&n,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var h=-1,d=!0,f=2&n?new sw:void 0;for(s.set(t,e),s.set(e,t);++h<a;){var p=t[h],g=e[h];if(i)var m=o?i(g,p,h,e,t,s):i(p,g,h,t,e,s);if(void 0!==m){if(m)continue;d=!1;break}if(f){if(!ow(e,(function(t,e){if(o=e,!f.has(o)&&(p===t||r(p,t,n,i,s)))return f.push(e);var o}))){d=!1;break}}else if(p!==g&&!r(p,g,n,i,s)){d=!1;break}}return s.delete(t),s.delete(e),d},lw=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n},cw=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n};var uw=Bm?Bm.prototype:void 0,hw=uw?uw.valueOf:void 0;var dw=Object.prototype.hasOwnProperty;var fw="[object Arguments]",pw="[object Array]",gw="[object Object]",mw=Object.prototype.hasOwnProperty;const yw=function(t,e,n,i,r,s){var o=Ky(t),a=Ky(e),l=o?pw:ub(t),c=a?pw:ub(e),u=(l=l==fw?gw:l)==gw,h=(c=c==fw?gw:c)==gw,d=l==c;if(d&&Zy(t)){if(!Zy(e))return!1;o=!0,u=!1}if(d&&!u)return s||(s=new wy),o||dv(t)?aw(t,e,n,i,r,s):function(t,e,n,i,r,s,o){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!s(new Ny(t),new Ny(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Dm(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=lw;case"[object Set]":var l=1&i;if(a||(a=cw),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=2,o.set(t,e);var u=aw(a(t),a(e),i,r,s,o);return o.delete(t),u;case"[object Symbol]":if(hw)return hw.call(t)==hw.call(e)}return!1}(t,e,l,n,i,r,s);if(!(1&n)){var f=u&&mw.call(t,"__wrapped__"),p=h&&mw.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,m=p?e.value():e;return s||(s=new wy),r(g,m,n,i,s)}}return!!d&&(s||(s=new wy),function(t,e,n,i,r,s){var o=1&n,a=Kv(t),l=a.length;if(l!=Kv(e).length&&!o)return!1;for(var c=l;c--;){var u=a[c];if(!(o?u in e:dw.call(e,u)))return!1}var h=s.get(t),d=s.get(e);if(h&&d)return h==e&&d==t;var f=!0;s.set(t,e),s.set(e,t);for(var p=o;++c<l;){var g=t[u=a[c]],m=e[u];if(i)var y=o?i(m,g,u,e,t,s):i(g,m,u,t,e,s);if(!(void 0===y?g===m||r(g,m,n,i,s):y)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var v=t.constructor,b=e.constructor;v==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(f=!1)}return s.delete(t),s.delete(e),f}(t,e,n,i,r,s))},vw=function t(e,n,i,r,s){return e===n||(null==e||null==n||!Vy(e)&&!Vy(n)?e!=e&&n!=n:yw(e,n,i,r,t,s))},bw=function(t,e){return vw(t,e)};class ww extends Yb{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}ww.blotName="break",ww.tagName="BR";const Ew=ww;class _w extends ew{}function qw(t){return t.replace(/[&<>"']/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[t])))}class kw extends $b{static allowedChildren=[kw,Ew,Yb,_w];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(t,e){const n=kw.order.indexOf(t),i=kw.order.indexOf(e);return n>=0||i>=0?n-i:t===e?0:t<e?-1:1}formatAt(t,e,n,i){if(kw.compare(this.statics.blotName,n)<0&&this.scroll.query(n,xb.BLOT)){const r=this.isolate(t,e);i&&r.wrap(n,i)}else super.formatAt(t,e,n,i)}optimize(t){if(super.optimize(t),this.parent instanceof kw&&kw.compare(this.statics.blotName,this.parent.statics.blotName)>0){const t=this.parent.isolate(this.offset(),this.length());this.moveChildren(t),t.wrap(this)}}}const Tw=kw;class xw extends Kb{cache={};delta(){return null==this.cache.delta&&(this.cache.delta=function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.descendants(Ub).reduce(((t,n)=>0===n.length()?t:t.insert(n.value(),Sw(n,{},e))),new(iw())).insert("\n",Sw(t))}(this)),this.cache.delta}deleteAt(t,e){super.deleteAt(t,e),this.cache={}}formatAt(t,e,n,i){e<=0||(this.scroll.query(n,xb.BLOCK)?t+e===this.length()&&this.format(n,i):super.formatAt(t,Math.min(e,this.length()-t-1),n,i),this.cache={})}insertAt(t,e,n){if(null!=n)return super.insertAt(t,e,n),void(this.cache={});if(0===e.length)return;const i=e.split("\n"),r=i.shift();r.length>0&&(t<this.length()-1||null==this.children.tail?super.insertAt(Math.min(t,this.length()-1),r):this.children.tail.insertAt(this.children.tail.length(),r),this.cache={});let s=this;i.reduce(((t,e)=>(s=s.split(t,!0),s.insertAt(0,e),e.length)),t+r.length)}insertBefore(t,e){const{head:n}=this.children;super.insertBefore(t,e),n instanceof Ew&&n.remove(),this.cache={}}length(){return null==this.cache.length&&(this.cache.length=super.length()+1),this.cache.length}moveChildren(t,e){super.moveChildren(t,e),this.cache={}}optimize(t){super.optimize(t),this.cache={}}path(t){return super.path(t,!0)}removeChild(t){super.removeChild(t),this.cache={}}split(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&(0===t||t>=this.length()-1)){const e=this.clone();return 0===t?(this.parent.insertBefore(e,this),this):(this.parent.insertBefore(e,this.next),e)}const n=super.split(t,e);return this.cache={},n}}xw.blotName="block",xw.tagName="P",xw.defaultChild=Ew,xw.allowedChildren=[Ew,Tw,Yb,_w];class Iw extends Yb{attach(){super.attach(),this.attributes=new Rb(this.domNode)}delta(){return(new(iw())).insert(this.value(),{...this.formats(),...this.attributes.values()})}format(t,e){const n=this.scroll.query(t,xb.BLOCK_ATTRIBUTE);null!=n&&this.attributes.attribute(n,e)}formatAt(t,e,n,i){this.format(n,i)}insertAt(t,e,n){if(null!=n)return void super.insertAt(t,e,n);const i=e.split("\n"),r=i.pop(),s=i.map((t=>{const e=this.scroll.create(xw.blotName);return e.insertAt(0,t),e})),o=this.split(t);s.forEach((t=>{this.parent.insertBefore(t,o)})),r&&this.parent.insertBefore(this.scroll.create("text",r),o)}}function Sw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return null==t?e:("formats"in t&&"function"==typeof t.formats&&(e={...e,...t.formats()},n&&delete e["code-token"]),null==t.parent||"scroll"===t.parent.statics.blotName||t.parent.statics.scope!==t.statics.scope?e:Sw(t.parent,e,n))}Iw.scope=xb.BLOCK_BLOT;class Aw extends Yb{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\ufeff";static value(){}constructor(t,e,n){super(t,e),this.selection=n,this.textNode=document.createTextNode(Aw.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){null!=this.parent&&this.parent.removeChild(this)}format(t,e){if(0!==this.savedLength)return void super.format(t,e);let n=this,i=0;for(;null!=n&&n.statics.scope!==xb.BLOCK_BLOT;)i+=n.offset(n.parent),n=n.parent;null!=n&&(this.savedLength=Aw.CONTENTS.length,n.optimize(),n.formatAt(i,Aw.CONTENTS.length,t,e),this.savedLength=0)}index(t,e){return t===this.textNode?0:super.index(t,e)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||null==this.parent)return null;const t=this.selection.getNativeRange();for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const e=this.prev instanceof _w?this.prev:null,n=e?e.length():0,i=this.next instanceof _w?this.next:null,r=i?i.text:"",{textNode:s}=this,o=s.data.split(Aw.CONTENTS).join("");let a;if(s.data=Aw.CONTENTS,e)a=e,(o||i)&&(e.insertAt(e.length(),o+r),i&&i.remove());else if(i)a=i,i.insertAt(0,o);else{const t=document.createTextNode(o);a=this.scroll.create(t),this.parent.insertBefore(a,this)}if(this.remove(),t){const r=(t,r)=>e&&t===e.domNode?r:t===s?n+r-1:i&&t===i.domNode?n+o.length+r:null,l=r(t.start.node,t.start.offset),c=r(t.end.node,t.end.offset);if(null!==l&&null!==c)return{startNode:a.domNode,startOffset:l,endNode:a.domNode,endOffset:c}}return null}update(t,e){if(t.some((t=>"characterData"===t.type&&t.target===this.textNode))){const t=this.restore();t&&(e.range=t)}}optimize(t){super.optimize(t);let{parent:e}=this;for(;e;){if("A"===e.domNode.tagName){this.savedLength=Aw.CONTENTS.length,e.isolate(this.offset(e),this.length()).unwrap(),this.savedLength=0;break}e=e.parent}}value(){return""}}const Nw=Aw;var Cw=n(697);const Ow=new WeakMap,Lw=["error","warn","log","info"];let Dw="warn";function Rw(t){if(Dw&&Lw.indexOf(t)<=Lw.indexOf(Dw)){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];console[t](...n)}}function Mw(t){return Lw.reduce(((e,n)=>(e[n]=Rw.bind(console,n,t),e)),{})}Mw.level=t=>{Dw=t},Rw.level=Mw.level;const Pw=Mw,jw=Pw("quill:events");["selectionchange","mousedown","mouseup","click"].forEach((t=>{document.addEventListener(t,(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Array.from(document.querySelectorAll(".ql-container")).forEach((t=>{const n=Ow.get(t);n&&n.emitter&&n.emitter.handleDOM(...e)}))}))}));const Uw=class extends Cw{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",jw.error)}emit(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return jw.log.call(jw,...e),super.emit(...e)}handleDOM(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];(this.domListeners[t.type]||[]).forEach((e=>{let{node:i,handler:r}=e;(t.target===i||i.contains(t.target))&&r(t,...n)}))}listenDOM(t,e,n){this.domListeners[t]||(this.domListeners[t]=[]),this.domListeners[t].push({node:e,handler:n})}},Fw=Pw("quill:selection");class Vw{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.index=t,this.length=e}}class Bw{constructor(t,e){this.emitter=e,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new Vw(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,(()=>{this.mouseDown||this.composing||setTimeout(this.update.bind(this,Uw.sources.USER),1)})),this.emitter.on(Uw.events.SCROLL_BEFORE_UPDATE,(()=>{if(!this.hasFocus())return;const t=this.getNativeRange();null!=t&&t.start.node!==this.cursor.textNode&&this.emitter.once(Uw.events.SCROLL_UPDATE,((e,n)=>{try{this.root.contains(t.start.node)&&this.root.contains(t.end.node)&&this.setNativeRange(t.start.node,t.start.offset,t.end.node,t.end.offset);const i=n.some((t=>"characterData"===t.type||"childList"===t.type||"attributes"===t.type&&t.target===this.root));this.update(i?Uw.sources.SILENT:e)}catch(t){}}))})),this.emitter.on(Uw.events.SCROLL_OPTIMIZE,((t,e)=>{if(e.range){const{startNode:t,startOffset:n,endNode:i,endOffset:r}=e.range;this.setNativeRange(t,n,i,r),this.update(Uw.sources.SILENT)}})),this.update(Uw.sources.SILENT)}handleComposition(){this.emitter.on(Uw.events.COMPOSITION_BEFORE_START,(()=>{this.composing=!0})),this.emitter.on(Uw.events.COMPOSITION_END,(()=>{if(this.composing=!1,this.cursor.parent){const t=this.cursor.restore();if(!t)return;setTimeout((()=>{this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)}),1)}}))}handleDragging(){this.emitter.listenDOM("mousedown",document.body,(()=>{this.mouseDown=!0})),this.emitter.listenDOM("mouseup",document.body,(()=>{this.mouseDown=!1,this.update(Uw.sources.USER)}))}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(t,e){this.scroll.update();const n=this.getNativeRange();if(null!=n&&n.native.collapsed&&!this.scroll.query(t,xb.BLOCK)){if(n.start.node!==this.cursor.textNode){const t=this.scroll.find(n.start.node,!1);if(null==t)return;if(t instanceof Ub){const e=t.split(n.start.offset);t.parent.insertBefore(this.cursor,e)}else t.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(t,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.scroll.length();let i;t=Math.min(t,n-1),e=Math.min(t+e,n-1)-t;let[r,s]=this.scroll.leaf(t);if(null==r)return null;if(e>0&&s===r.length()){const[e]=this.scroll.leaf(t+1);if(e){const[n]=this.scroll.line(t),[i]=this.scroll.line(t+1);n===i&&(r=e,s=0)}}[i,s]=r.position(s,!0);const o=document.createRange();if(e>0)return o.setStart(i,s),[r,s]=this.scroll.leaf(t+e),null==r?null:([i,s]=r.position(s,!0),o.setEnd(i,s),o.getBoundingClientRect());let a,l="left";if(i instanceof Text){if(!i.data.length)return null;s<i.data.length?(o.setStart(i,s),o.setEnd(i,s+1)):(o.setStart(i,s-1),o.setEnd(i,s),l="right"),a=o.getBoundingClientRect()}else{if(!(r.domNode instanceof Element))return null;a=r.domNode.getBoundingClientRect(),s>0&&(l="right")}return{bottom:a.top+a.height,height:a.height,left:a[l],right:a[l],top:a.top,width:0}}getNativeRange(){const t=document.getSelection();if(null==t||t.rangeCount<=0)return null;const e=t.getRangeAt(0);if(null==e)return null;const n=this.normalizeNative(e);return Fw.info("getNativeRange",n),n}getRange(){const t=this.scroll.domNode;if("isConnected"in t&&!t.isConnected)return[null,null];const e=this.getNativeRange();return null==e?[null,null]:[this.normalizedToRange(e),e]}hasFocus(){return document.activeElement===this.root||null!=document.activeElement&&zw(this.root,document.activeElement)}normalizedToRange(t){const e=[[t.start.node,t.start.offset]];t.native.collapsed||e.push([t.end.node,t.end.offset]);const n=e.map((t=>{const[e,n]=t,i=this.scroll.find(e,!0),r=i.offset(this.scroll);return 0===n?r:i instanceof Ub?r+i.index(e,n):r+i.length()})),i=Math.min(Math.max(...n),this.scroll.length()-1),r=Math.min(i,...n);return new Vw(r,i-r)}normalizeNative(t){if(!zw(this.root,t.startContainer)||!t.collapsed&&!zw(this.root,t.endContainer))return null;const e={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[e.start,e.end].forEach((t=>{let{node:e,offset:n}=t;for(;!(e instanceof Text)&&e.childNodes.length>0;)if(e.childNodes.length>n)e=e.childNodes[n],n=0;else{if(e.childNodes.length!==n)break;e=e.lastChild,n=e instanceof Text?e.data.length:e.childNodes.length>0?e.childNodes.length:e.childNodes.length+1}t.node=e,t.offset=n})),e}rangeToNative(t){const e=this.scroll.length(),n=(t,n)=>{t=Math.min(e-1,t);const[i,r]=this.scroll.leaf(t);return i?i.position(r,n):[null,-1]};return[...n(t.index,!1),...n(t.index+t.length,!0)]}setNativeRange(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Fw.info("setNativeRange",t,e,n,i),null!=t&&(null==this.root.parentNode||null==t.parentNode||null==n.parentNode))return;const s=document.getSelection();if(null!=s)if(null!=t){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:o}=this.getNativeRange()||{};if(null==o||r||t!==o.startContainer||e!==o.startOffset||n!==o.endContainer||i!==o.endOffset){t instanceof Element&&"BR"===t.tagName&&(e=Array.from(t.parentNode.childNodes).indexOf(t),t=t.parentNode),n instanceof Element&&"BR"===n.tagName&&(i=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);const r=document.createRange();r.setStart(t,e),r.setEnd(n,i),s.removeAllRanges(),s.addRange(r)}}else s.removeAllRanges(),this.root.blur()}setRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uw.sources.API;if("string"==typeof e&&(n=e,e=!1),Fw.info("setRange",t),null!=t){const n=this.rangeToNative(t);this.setNativeRange(...n,e)}else this.setNativeRange(null);this.update(n)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uw.sources.USER;const e=this.lastRange,[n,i]=this.getRange();if(this.lastRange=n,this.lastNative=i,null!=this.lastRange&&(this.savedRange=this.lastRange),!bw(e,this.lastRange)){if(!this.composing&&null!=i&&i.native.collapsed&&i.start.node!==this.cursor.textNode){const t=this.cursor.restore();t&&this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)}const n=[Uw.events.SELECTION_CHANGE,Tb(this.lastRange),Tb(e),t];this.emitter.emit(Uw.events.EDITOR_CHANGE,...n),t!==Uw.sources.SILENT&&this.emitter.emit(...n)}}}function zw(t,e){try{e.parentNode}catch(t){return!1}return t.contains(e)}const Hw=/^[ -~]*$/;function $w(t,e,n){if(0===t.length){const[t]=Gw(n.pop());return e<=0?`</li></${t}>`:`</li></${t}>${$w([],e-1,n)}`}const[{child:i,offset:r,length:s,indent:o,type:a},...l]=t,[c,u]=Gw(a);if(o>e)return n.push(a),o===e+1?`<${c}><li${u}>${Ww(i,r,s)}${$w(l,o,n)}`:`<${c}><li>${$w(t,e+1,n)}`;const h=n[n.length-1];if(o===e&&a===h)return`</li><li${u}>${Ww(i,r,s)}${$w(l,o,n)}`;const[d]=Gw(n.pop());return`</li></${d}>${$w(t,e-1,n)}`}function Ww(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("html"in t&&"function"==typeof t.html)return t.html(e,n);if(t instanceof _w)return qw(t.value().slice(e,e+n));if(t instanceof zb){if("list-container"===t.statics.blotName){const i=[];return t.children.forEachAt(e,n,((t,e,n)=>{const r="formats"in t&&"function"==typeof t.formats?t.formats():{};i.push({child:t,offset:e,length:n,indent:r.indent||0,type:r.list})})),$w(i,-1,[])}const r=[];if(t.children.forEachAt(e,n,((t,e,n)=>{r.push(Ww(t,e,n))})),i||"list"===t.statics.blotName)return r.join("");const{outerHTML:s,innerHTML:o}=t.domNode,[a,l]=s.split(`>${o}<`);return"<table"===a?`<table style="border: 1px solid #000;">${r.join("")}<${l}`:`${a}>${r.join("")}<${l}`}return t.domNode instanceof Element?t.domNode.outerHTML:""}function Kw(t,e){return Object.keys(e).reduce(((n,i)=>{if(null==t[i])return n;const r=e[i];return r===t[i]?n[i]=r:Array.isArray(r)?r.indexOf(t[i])<0?n[i]=r.concat([t[i]]):n[i]=r:n[i]=[r,t[i]],n}),{})}function Gw(t){const e="ordered"===t?"ol":"ul";switch(t){case"checked":return[e,' data-list="checked"'];case"unchecked":return[e,' data-list="unchecked"'];default:return[e,""]}}function Qw(t){return t.reduce(((t,e)=>{if("string"==typeof e.insert){const n=e.insert.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return t.insert(n,e.attributes)}return t.push(e)}),new(iw()))}function Yw(t,e){let{index:n,length:i}=t;return new Vw(n+e,i)}const Xw=class{constructor(t){this.scroll=t,this.delta=this.getDelta()}applyDelta(t){this.scroll.update();let e=this.scroll.length();this.scroll.batchStart();const n=Qw(t),i=new(iw());return function(t){const e=[];return t.forEach((t=>{"string"==typeof t.insert?t.insert.split("\n").forEach(((n,i)=>{i&&e.push({insert:"\n",attributes:t.attributes}),n&&e.push({insert:n,attributes:t.attributes})})):e.push(t)})),e}(n.ops.slice()).reduce(((t,n)=>{const r=nw.Op.length(n);let s=n.attributes||{},o=!1,a=!1;if(null!=n.insert){if(i.retain(r),"string"==typeof n.insert){const i=n.insert;a=!i.endsWith("\n")&&(e<=t||!!this.scroll.descendant(Iw,t)[0]),this.scroll.insertAt(t,i);const[r,o]=this.scroll.line(t);let l=Rv({},Sw(r));if(r instanceof xw){const[t]=r.descendant(Ub,o);t&&(l=Rv(l,Sw(t)))}s=nw.AttributeMap.diff(l,s)||{}}else if("object"==typeof n.insert){const i=Object.keys(n.insert)[0];if(null==i)return t;const r=null!=this.scroll.query(i,xb.INLINE);if(r)(e<=t||this.scroll.descendant(Iw,t)[0])&&(a=!0);else if(t>0){const[e,n]=this.scroll.descendant(Ub,t-1);e instanceof _w?"\n"!==e.value()[n]&&(o=!0):e instanceof Yb&&e.statics.scope===xb.INLINE_BLOT&&(o=!0)}if(this.scroll.insertAt(t,i,n.insert[i]),r){const[e]=this.scroll.descendant(Ub,t);if(e){const t=Rv({},Sw(e));s=nw.AttributeMap.diff(t,s)||{}}}}e+=r}else if(i.push(n),null!==n.retain&&"object"==typeof n.retain){const e=Object.keys(n.retain)[0];if(null==e)return t;this.scroll.updateEmbedAt(t,e,n.retain[e])}Object.keys(s).forEach((e=>{this.scroll.formatAt(t,r,e,s[e])}));const l=o?1:0,c=a?1:0;return e+=l+c,i.retain(l),i.delete(c),t+r+l+c}),0),i.reduce(((t,e)=>"number"==typeof e.delete?(this.scroll.deleteAt(t,e.delete),t):t+nw.Op.length(e)),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(n)}deleteText(t,e){return this.scroll.deleteAt(t,e),this.update((new(iw())).retain(t).delete(e))}formatLine(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.scroll.update(),Object.keys(n).forEach((i=>{this.scroll.lines(t,Math.max(e,1)).forEach((t=>{t.format(i,n[i])}))})),this.scroll.optimize();const i=(new(iw())).retain(t).retain(e,Tb(n));return this.update(i)}formatText(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.keys(n).forEach((i=>{this.scroll.formatAt(t,e,i,n[i])}));const i=(new(iw())).retain(t).retain(e,Tb(n));return this.update(i)}getContents(t,e){return this.delta.slice(t,t+e)}getDelta(){return this.scroll.lines().reduce(((t,e)=>t.concat(e.delta())),new(iw()))}getFormat(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],i=[];0===e?this.scroll.path(t).forEach((t=>{const[e]=t;e instanceof xw?n.push(e):e instanceof Ub&&i.push(e)})):(n=this.scroll.lines(t,e),i=this.scroll.descendants(Ub,t,e));const[r,s]=[n,i].map((t=>{const e=t.shift();if(null==e)return{};let n=Sw(e);for(;Object.keys(n).length>0;){const e=t.shift();if(null==e)return n;n=Kw(Sw(e),n)}return n}));return{...r,...s}}getHTML(t,e){const[n,i]=this.scroll.line(t);if(n){const r=n.length();return n.length()>=i+e?Ww(n,i,e,!(0===i&&e===r)):Ww(this.scroll,t,e,!0)}return""}getText(t,e){return this.getContents(t,e).filter((t=>"string"==typeof t.insert)).map((t=>t.insert)).join("")}insertContents(t,e){const n=Qw(e),i=(new(iw())).retain(t).concat(n);return this.scroll.insertContents(t,n),this.update(i)}insertEmbed(t,e,n){return this.scroll.insertAt(t,e,n),this.update((new(iw())).retain(t).insert({[e]:n}))}insertText(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),this.scroll.insertAt(t,e),Object.keys(n).forEach((i=>{this.scroll.formatAt(t,e.length,i,n[i])})),this.update((new(iw())).retain(t).insert(e,Tb(n)))}isBlank(){if(0===this.scroll.children.length)return!0;if(this.scroll.children.length>1)return!1;const t=this.scroll.children.head;if(t?.statics.blotName!==xw.blotName)return!1;const e=t;return!(e.children.length>1)&&e.children.head instanceof Ew}removeFormat(t,e){const n=this.getText(t,e),[i,r]=this.scroll.line(t+e);let s=0,o=new(iw());null!=i&&(s=i.length()-r,o=i.delta().slice(r,r+s-1).insert("\n"));const a=this.getContents(t,e+s).diff((new(iw())).insert(n).concat(o)),l=(new(iw())).retain(t).concat(a);return this.applyDelta(l)}update(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const i=this.delta;if(1===e.length&&"characterData"===e[0].type&&e[0].target.data.match(Hw)&&this.scroll.find(e[0].target)){const r=this.scroll.find(e[0].target),s=Sw(r),o=r.offset(this.scroll),a=e[0].oldValue.replace(Nw.CONTENTS,""),l=(new(iw())).insert(a),c=(new(iw())).insert(r.value()),u=n&&{oldRange:Yw(n.oldRange,-o),newRange:Yw(n.newRange,-o)};t=(new(iw())).retain(o).concat(l.diff(c,u)).reduce(((t,e)=>e.insert?t.insert(e.insert,s):t.push(e)),new(iw())),this.delta=i.compose(t)}else this.delta=this.getDelta(),t&&bw(i.compose(t),this.delta)||(t=i.diff(this.delta,n));return t}},Jw=class{static DEFAULTS={};constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.quill=t,this.options=e}},Zw="\ufeff",tE=class extends Yb{constructor(t,e){super(t,e),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach((t=>{this.contentNode.appendChild(t)})),this.leftGuard=document.createTextNode(Zw),this.rightGuard=document.createTextNode(Zw),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(t,e){return t===this.leftGuard?0:t===this.rightGuard?1:super.index(t,e)}restore(t){let e,n=null;const i=t.data.split(Zw).join("");if(t===this.leftGuard)if(this.prev instanceof _w){const t=this.prev.length();this.prev.insertAt(t,i),n={startNode:this.prev.domNode,startOffset:t+i.length}}else e=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(e),this),n={startNode:e,startOffset:i.length};else t===this.rightGuard&&(this.next instanceof _w?(this.next.insertAt(0,i),n={startNode:this.next.domNode,startOffset:i.length}):(e=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(e),this.next),n={startNode:e,startOffset:i.length}));return t.data=Zw,n}update(t,e){t.forEach((t=>{if("characterData"===t.type&&(t.target===this.leftGuard||t.target===this.rightGuard)){const n=this.restore(t.target);n&&(e.range=n)}}))}},eE=class{isComposing=!1;constructor(t,e){this.scroll=t,this.emitter=e,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",(t=>{this.isComposing||this.handleCompositionStart(t)})),this.scroll.domNode.addEventListener("compositionend",(t=>{this.isComposing&&queueMicrotask((()=>{this.handleCompositionEnd(t)}))}))}handleCompositionStart(t){const e=t.target instanceof Node?this.scroll.find(t.target,!0):null;!e||e instanceof tE||(this.emitter.emit(Uw.events.COMPOSITION_BEFORE_START,t),this.scroll.batchStart(),this.emitter.emit(Uw.events.COMPOSITION_START,t),this.isComposing=!0)}handleCompositionEnd(t){this.emitter.emit(Uw.events.COMPOSITION_BEFORE_END,t),this.scroll.batchEnd(),this.emitter.emit(Uw.events.COMPOSITION_END,t),this.isComposing=!1}};class nE{static DEFAULTS={modules:{}};static themes={default:nE};modules={};constructor(t,e){this.quill=t,this.options=e}init(){Object.keys(this.options.modules).forEach((t=>{null==this.modules[t]&&this.addModule(t)}))}addModule(t){const e=this.quill.constructor.import(`modules/${t}`);return this.modules[t]=new e(this.quill,this.options.modules[t]||{}),this.modules[t]}}const iE=nE,rE=t=>{const e=t.getBoundingClientRect(),n="offsetWidth"in t&&Math.abs(e.width)/t.offsetWidth||1,i="offsetHeight"in t&&Math.abs(e.height)/t.offsetHeight||1;return{top:e.top,right:e.left+t.clientWidth*n,bottom:e.top+t.clientHeight*i,left:e.left}},sE=t=>{const e=parseInt(t,10);return Number.isNaN(e)?0:e},oE=(t,e,n,i,r,s)=>t<n&&e>i?0:t<n?-(n-t+r):e>i?e-t>i-n?t+r-n:e-i+s:0,aE=Pw("quill"),lE=new Nb;zb.uiClass="ql-ui";class cE{static DEFAULTS={bounds:null,modules:{},placeholder:"",readOnly:!1,registry:lE,theme:"default"};static events=Uw.events;static sources=Uw.sources;static version="2.0.0-rc.2";static imports={delta:iw(),parchment:t,"core/module":Jw,"core/theme":iE};static debug(t){!0===t&&(t="log"),Pw.level(t)}static find(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Ow.get(t)||lE.find(t,e)}static import(t){return null==this.imports[t]&&aE.error(`Cannot import ${t}. Are you sure it was registered?`),this.imports[t]}static register(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!=typeof t){const n="attrName"in t?t.attrName:t.blotName;"string"==typeof n?this.register(`formats/${n}`,t,e):Object.keys(t).forEach((n=>{this.register(n,t[n],e)}))}else null==this.imports[t]||n||aE.warn(`Overwriting ${t} with`,e),this.imports[t]=e,(t.startsWith("blots/")||t.startsWith("formats/"))&&e&&"boolean"!=typeof e&&"abstract"!==e.blotName&&lE.register(e),"function"==typeof e.register&&e.register(lE)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.options=function(t,e){let n=Rv({container:t,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0}},e);if(n.theme&&n.theme!==cE.DEFAULTS.theme){if(n.theme=cE.import(`themes/${n.theme}`),null==n.theme)throw new Error(`Invalid theme ${n.theme}. Did you register it?`)}else n.theme=iE;const i=Tb(n.theme.DEFAULTS);[i,n].forEach((t=>{t.modules=t.modules||{},Object.keys(t.modules).forEach((e=>{!0===t.modules[e]&&(t.modules[e]={})}))}));const r=Object.keys(i.modules).concat(Object.keys(n.modules)).reduce(((t,e)=>{const n=cE.import(`modules/${e}`);return null==n?aE.error(`Cannot load ${e} module. Are you sure you registered it?`):t[e]=n.DEFAULTS||{},t}),{});return null!=n.modules&&n.modules.toolbar&&n.modules.toolbar.constructor!==Object&&(n.modules.toolbar={container:n.modules.toolbar}),n=Rv({},cE.DEFAULTS,{modules:r},i,n),["bounds","container"].forEach((t=>{const e=n[t];"string"==typeof e&&(n[t]=document.querySelector(e))})),n.modules=Object.keys(n.modules).reduce(((t,e)=>(n.modules[e]&&(t[e]=n.modules[e]),t)),{}),n}(t,e),this.container=this.options.container,null==this.container)return void aE.error("Invalid Quill container",t);this.options.debug&&cE.debug(this.options.debug);const n=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",Ow.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new Uw;const i=Zb.blotName,r=this.options.registry.query(i);if(!r||!("blotName"in r))throw new Error(`Cannot initialize Quill without "${i}" blot`);if(this.scroll=new r(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new Xw(this.scroll),this.selection=new Bw(this.scroll,this.emitter),this.composition=new eE(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(Uw.events.EDITOR_CHANGE,(t=>{t===Uw.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())})),this.emitter.on(Uw.events.SCROLL_UPDATE,((t,e)=>{const n=this.selection.lastRange,[i]=this.selection.getRange(),r=n&&i?{oldRange:n,newRange:i}:void 0;uE.call(this,(()=>this.editor.update(null,e,r)),t)})),this.emitter.on(Uw.events.SCROLL_EMBED_UPDATE,((t,e)=>{const n=this.selection.lastRange,[i]=this.selection.getRange(),r=n&&i?{oldRange:n,newRange:i}:void 0;uE.call(this,(()=>{const n=(new(iw())).retain(t.offset(this)).retain({[t.statics.blotName]:e});return this.editor.update(n,[],r)}),cE.sources.USER)})),n){const t=this.clipboard.convert({html:`${n}<p><br></p>`,text:"\n"});this.setContents(t)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof t){const e=t;(t=document.createElement("div")).classList.add(e)}return this.container.insertBefore(t,e),t}blur(){this.selection.setRange(null)}deleteText(t,e,n){return[t,e,,n]=hE(t,e,n),uE.call(this,(()=>this.editor.deleteText(t,e)),n,t,-1*e)}disable(){this.enable(!1)}editReadOnly(t){this.allowReadOnlyEdits=!0;const e=t();return this.allowReadOnlyEdits=!1,e}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}focus(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selection.focus(),t.preventScroll||this.scrollSelectionIntoView()}format(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uw.sources.API;return uE.call(this,(()=>{const n=this.getSelection(!0);let i=new(iw());if(null==n)return i;if(this.scroll.query(t,xb.BLOCK))i=this.editor.formatLine(n.index,n.length,{[t]:e});else{if(0===n.length)return this.selection.format(t,e),i;i=this.editor.formatText(n.index,n.length,{[t]:e})}return this.setSelection(n,Uw.sources.SILENT),i}),n)}formatLine(t,e,n,i,r){let s;return[t,e,s,r]=hE(t,e,n,i,r),uE.call(this,(()=>this.editor.formatLine(t,e,s)),r,t,0)}formatText(t,e,n,i,r){let s;return[t,e,s,r]=hE(t,e,n,i,r),uE.call(this,(()=>this.editor.formatText(t,e,s)),r,t,0)}getBounds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=null;if(n="number"==typeof t?this.selection.getBounds(t,e):this.selection.getBounds(t.index,t.length),!n)return null;const i=this.container.getBoundingClientRect();return{bottom:n.bottom-i.top,height:n.height,left:n.left-i.left,right:n.right-i.left,top:n.top-i.top,width:n.width}}getContents(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-t;return[t,e]=hE(t,e),this.editor.getContents(t,e)}getFormat(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection(!0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"==typeof t?this.editor.getFormat(t,e):this.editor.getFormat(t.index,t.length)}getIndex(t){return t.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(t){return this.scroll.leaf(t)}getLine(t){return this.scroll.line(t)}getLines(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return"number"!=typeof t?this.scroll.lines(t.index,t.length):this.scroll.lines(t,e)}getModule(t){return this.theme.modules[t]}getSelection(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return"number"==typeof t&&(e=e??this.getLength()-t),[t,e]=hE(t,e),this.editor.getHTML(t,e)}getText(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return"number"==typeof t&&(e=e??this.getLength()-t),[t,e]=hE(t,e),this.editor.getText(t,e)}hasFocus(){return this.selection.hasFocus()}insertEmbed(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:cE.sources.API;return uE.call(this,(()=>this.editor.insertEmbed(t,e,n)),i,t)}insertText(t,e,n,i,r){let s;return[t,,s,r]=hE(t,0,n,i,r),uE.call(this,(()=>this.editor.insertText(t,e,s)),r,t,e.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(){const[t,e,,n]=hE(...arguments);return uE.call(this,(()=>this.editor.removeFormat(t,e)),n,t)}scrollRectIntoView(t){((t,e)=>{const n=t.ownerDocument;let i=e,r=t;for(;r;){const t=r===n.body,e=t?{top:0,right:window.visualViewport?.width??n.documentElement.clientWidth,bottom:window.visualViewport?.height??n.documentElement.clientHeight,left:0}:rE(r),o=getComputedStyle(r),a=oE(i.left,i.right,e.left,e.right,sE(o.scrollPaddingLeft),sE(o.scrollPaddingRight)),l=oE(i.top,i.bottom,e.top,e.bottom,sE(o.scrollPaddingTop),sE(o.scrollPaddingBottom));if(a||l)if(t)n.defaultView?.scrollBy(a,l);else{const{scrollLeft:t,scrollTop:e}=r;l&&(r.scrollTop+=l),a&&(r.scrollLeft+=a);const n=r.scrollLeft-t,s=r.scrollTop-e;i={left:i.left-n,top:i.top-s,right:i.right-n,bottom:i.bottom-s}}r=t||"fixed"===o.position?null:(s=r).parentElement||s.getRootNode().host||null}var s})(this.root,t)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const t=this.selection.lastRange,e=t&&this.selection.getBounds(t.index,t.length);e&&this.scrollRectIntoView(e)}setContents(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uw.sources.API;return uE.call(this,(()=>{t=new(iw())(t);const e=this.getLength(),n=this.editor.deleteText(0,e),i=this.editor.insertContents(0,t),r=this.editor.deleteText(this.getLength()-1,1);return n.compose(i).compose(r)}),e)}setSelection(t,e,n){null==t?this.selection.setRange(null,e||cE.sources.API):([t,e,,n]=hE(t,e,n),this.selection.setRange(new Vw(Math.max(0,t),e),n),n!==Uw.sources.SILENT&&this.scrollSelectionIntoView())}setText(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uw.sources.API;const n=(new(iw())).insert(t);return this.setContents(n,e)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uw.sources.USER;const e=this.scroll.update(t);return this.selection.update(t),e}updateContents(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uw.sources.API;return uE.call(this,(()=>(t=new(iw())(t),this.editor.applyDelta(t))),e,!0)}}function uE(t,e,n,i){if(!this.isEnabled()&&e===Uw.sources.USER&&!this.allowReadOnlyEdits)return new(iw());let r=null==n?null:this.getSelection();const s=this.editor.delta,o=t();if(null!=r&&(!0===n&&(n=r.index),null==i?r=dE(r,o,e):0!==i&&(r=dE(r,n,i,e)),this.setSelection(r,Uw.sources.SILENT)),o.length()>0){const t=[Uw.events.TEXT_CHANGE,o,s,e];this.emitter.emit(Uw.events.EDITOR_CHANGE,...t),e!==Uw.sources.SILENT&&this.emitter.emit(...t)}return o}function hE(t,e,n,i,r){let s={};return"number"==typeof t.index&&"number"==typeof t.length?"number"!=typeof e?(r=i,i=n,n=e,e=t.length,t=t.index):(e=t.length,t=t.index):"number"!=typeof e&&(r=i,i=n,n=e,e=0),"object"==typeof n?(s=n,r=i):"string"==typeof n&&(null!=i?s[n]=i:r=n),[t,e,s,r=r||Uw.sources.API]}function dE(t,e,n,i){const r="number"==typeof n?n:0;if(null==t)return null;let s,o;return e&&"function"==typeof e.transformPosition?[s,o]=[t.index,t.index+t.length].map((t=>e.transformPosition(t,i!==Uw.sources.USER))):[s,o]=[t.index,t.index+t.length].map((t=>t<e||t===e&&i===Uw.sources.USER?t:r>=0?t+r:Math.max(e,t+r))),new Vw(s,o-s)}const fE=class extends Qb{};function pE(t){return t instanceof xw||t instanceof Iw}function gE(t){return"function"==typeof t.updateContent}function mE(t,e,n){n.reduce(((e,n)=>{const i=nw.Op.length(n);let r=n.attributes||{};if(null!=n.insert)if("string"==typeof n.insert){const i=n.insert;t.insertAt(e,i);const[s]=t.descendant(Ub,e),o=Sw(s);r=nw.AttributeMap.diff(o,r)||{}}else if("object"==typeof n.insert){const i=Object.keys(n.insert)[0];if(null==i)return e;if(t.insertAt(e,i,n.insert[i]),null!=t.scroll.query(i,xb.INLINE)){const[n]=t.descendant(Ub,e),i=Sw(n);r=nw.AttributeMap.diff(i,r)||{}}}return Object.keys(r).forEach((n=>{t.formatAt(e,i,n,r[n])})),e+i}),e)}const yE={scope:xb.BLOCK,whitelist:["right","center","justify"]},vE=new Ib("align","align",yE),bE=(new Ob("align","ql-align",yE),new Db("align","text-align",yE));class wE extends Db{value(t){let e=super.value(t);return e.startsWith("rgb(")?(e=e.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${e.split(",").map((t=>`00${parseInt(t,10).toString(16)}`.slice(-2))).join("")}`):e}}new Ob("color","ql-color",{scope:xb.INLINE});const EE=new wE("color","color",{scope:xb.INLINE}),_E=(new Ob("background","ql-bg",{scope:xb.INLINE}),new wE("background","background-color",{scope:xb.INLINE}));class qE extends fE{static create(t){const e=super.create(t);return e.setAttribute("spellcheck","false"),e}code(t,e){return this.children.map((t=>t.length()<=1?"":t.domNode.innerText)).join("\n").slice(t,t+e)}html(t,e){return`<pre>\n${qw(this.code(t,e))}\n</pre>`}}class kE extends xw{static TAB="  ";static register(){cE.register(qE)}}class TE extends Tw{}TE.blotName="code",TE.tagName="CODE",kE.blotName="code-block",kE.className="ql-code-block",kE.tagName="DIV",qE.blotName="code-block-container",qE.className="ql-code-block-container",qE.tagName="DIV",qE.allowedChildren=[kE],kE.allowedChildren=[_w,Ew,Nw],kE.requiredContainer=qE;const xE={scope:xb.BLOCK,whitelist:["rtl"]},IE=new Ib("direction","dir",xE),SE=(new Ob("direction","ql-direction",xE),new Db("direction","direction",xE)),AE={scope:xb.INLINE,whitelist:["serif","monospace"]};new Ob("font","ql-font",AE);const NE=new class extends Db{value(t){return super.value(t).replace(/["']/g,"")}}("font","font-family",AE),CE=(new Ob("size","ql-size",{scope:xb.INLINE,whitelist:["small","large","huge"]}),new Db("size","font-size",{scope:xb.INLINE,whitelist:["10px","18px","32px"]})),OE=Pw("quill:keyboard"),LE=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class DE extends Jw{static match(t,e){return!["altKey","ctrlKey","metaKey","shiftKey"].some((n=>!!e[n]!==t[n]&&null!==e[n]))&&(e.key===t.key||e.key===t.which)}constructor(t,e){super(t,e),this.bindings={},Object.keys(this.options.bindings).forEach((t=>{this.options.bindings[t]&&this.addBinding(this.options.bindings[t])})),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},(()=>{})),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=function(t){if("string"==typeof t||"number"==typeof t)t={key:t};else{if("object"!=typeof t)return null;t=Tb(t)}return t.shortKey&&(t[LE]=t.shortKey,delete t.shortKey),t}(t);null!=i?("function"==typeof e&&(e={handler:e}),"function"==typeof n&&(n={handler:n}),(Array.isArray(i.key)?i.key:[i.key]).forEach((t=>{const r={...i,key:t,...e,...n};this.bindings[r.key]=this.bindings[r.key]||[],this.bindings[r.key].push(r)}))):OE.warn("Attempted to add invalid keyboard binding",i)}listen(){this.quill.root.addEventListener("keydown",(t=>{if(t.defaultPrevented||t.isComposing)return;const e=(this.bindings[t.key]||[]).concat(this.bindings[t.which]||[]).filter((e=>DE.match(t,e)));if(0===e.length)return;const n=cE.find(t.target,!0);if(n&&n.scroll!==this.quill.scroll)return;const i=this.quill.getSelection();if(null==i||!this.quill.hasFocus())return;const[r,s]=this.quill.getLine(i.index),[o,a]=this.quill.getLeaf(i.index),[l,c]=0===i.length?[o,a]:this.quill.getLeaf(i.index+i.length),u=o instanceof ew?o.value().slice(0,a):"",h=l instanceof ew?l.value().slice(c):"",d={collapsed:0===i.length,empty:0===i.length&&r.length()<=1,format:this.quill.getFormat(i),line:r,offset:s,prefix:u,suffix:h,event:t};e.some((t=>{if(null!=t.collapsed&&t.collapsed!==d.collapsed)return!1;if(null!=t.empty&&t.empty!==d.empty)return!1;if(null!=t.offset&&t.offset!==d.offset)return!1;if(Array.isArray(t.format)){if(t.format.every((t=>null==d.format[t])))return!1}else if("object"==typeof t.format&&!Object.keys(t.format).every((e=>!0===t.format[e]?null!=d.format[e]:!1===t.format[e]?null==d.format[e]:bw(t.format[e],d.format[e]))))return!1;return!(null!=t.prefix&&!t.prefix.test(d.prefix)||null!=t.suffix&&!t.suffix.test(d.suffix)||!0===t.handler.call(this,i,d,t))}))&&t.preventDefault()}))}handleBackspace(t,e){const n=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;if(0===t.index||this.quill.getLength()<=1)return;let i={};const[r]=this.quill.getLine(t.index);let s=(new(iw())).retain(t.index-n).delete(n);if(0===e.offset){const[e]=this.quill.getLine(t.index-1);if(e&&!("block"===e.statics.blotName&&e.length()<=1)){const e=r.formats(),n=this.quill.getFormat(t.index-1,1);if(i=nw.AttributeMap.diff(e,n)||{},Object.keys(i).length>0){const e=(new(iw())).retain(t.index+r.length()-2).retain(1,i);s=s.compose(e)}}}this.quill.updateContents(s,cE.sources.USER),this.quill.focus()}handleDelete(t,e){const n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(t.index>=this.quill.getLength()-n)return;let i={};const[r]=this.quill.getLine(t.index);let s=(new(iw())).retain(t.index).delete(n);if(e.offset>=r.length()-1){const[e]=this.quill.getLine(t.index+1);if(e){const n=r.formats(),o=this.quill.getFormat(t.index,1);i=nw.AttributeMap.diff(n,o)||{},Object.keys(i).length>0&&(s=s.retain(e.length()-1).retain(1,i))}}this.quill.updateContents(s,cE.sources.USER),this.quill.focus()}handleDeleteRange(t){FE({range:t,quill:this.quill}),this.quill.focus()}handleEnter(t,e){const n=Object.keys(e.format).reduce(((t,n)=>(this.quill.scroll.query(n,xb.BLOCK)&&!Array.isArray(e.format[n])&&(t[n]=e.format[n]),t)),{}),i=(new(iw())).retain(t.index).delete(t.length).insert("\n",n);this.quill.updateContents(i,cE.sources.USER),this.quill.setSelection(t.index+1,cE.sources.SILENT),this.quill.focus()}}const RE={bindings:{bold:jE("bold"),italic:jE("italic"),underline:jE("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(t,e){return!(!e.collapsed||0===e.offset)||(this.quill.format("indent","+1",cE.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(t,e){return!(!e.collapsed||0===e.offset)||(this.quill.format("indent","-1",cE.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(t,e){null!=e.format.indent?this.quill.format("indent","-1",cE.sources.USER):null!=e.format.list&&this.quill.format("list",!1,cE.sources.USER)}},"indent code-block":ME(!0),"outdent code-block":ME(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(t){this.quill.deleteText(t.index-1,1,cE.sources.USER)}},tab:{key:"Tab",handler(t,e){if(e.format.table)return!0;this.quill.history.cutoff();const n=(new(iw())).retain(t.index).delete(t.length).insert("\t");return this.quill.updateContents(n,cE.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index+1,cE.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,cE.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(t,e){const n={list:!1};e.format.indent&&(n.indent=!1),this.quill.formatLine(t.index,t.length,n,cE.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(t){const[e,n]=this.quill.getLine(t.index),i={...e.formats(),list:"checked"},r=(new(iw())).retain(t.index).insert("\n",i).retain(e.length()-n-1).retain(1,{list:"unchecked"});this.quill.updateContents(r,cE.sources.USER),this.quill.setSelection(t.index+1,cE.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(t,e){const[n,i]=this.quill.getLine(t.index),r=(new(iw())).retain(t.index).insert("\n",e.format).retain(n.length()-i-1).retain(1,{header:null});this.quill.updateContents(r,cE.sources.USER),this.quill.setSelection(t.index+1,cE.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(t){const e=this.quill.getModule("table");if(e){const[n,i,r,s]=e.getTable(t),o=function(t,e,n,i){return null==e.prev&&null==e.next?null==n.prev&&null==n.next?0===i?-1:1:null==n.prev?-1:1:null==e.prev?-1:null==e.next?1:null}(0,i,r,s);if(null==o)return;let a=n.offset();if(o<0){const e=(new(iw())).retain(a).insert("\n");this.quill.updateContents(e,cE.sources.USER),this.quill.setSelection(t.index+1,t.length,cE.sources.SILENT)}else if(o>0){a+=n.length();const t=(new(iw())).retain(a).insert("\n");this.quill.updateContents(t,cE.sources.USER),this.quill.setSelection(a,cE.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(t,e){const{event:n,line:i}=e,r=i.offset(this.quill.scroll);n.shiftKey?this.quill.setSelection(r-1,cE.sources.USER):this.quill.setSelection(r+i.length(),cE.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(t,e){if(null==this.quill.scroll.query("list"))return!0;const{length:n}=e.prefix,[i,r]=this.quill.getLine(t.index);if(r>n)return!0;let s;switch(e.prefix.trim()){case"[]":case"[ ]":s="unchecked";break;case"[x]":s="checked";break;case"-":case"*":s="bullet";break;default:s="ordered"}this.quill.insertText(t.index," ",cE.sources.USER),this.quill.history.cutoff();const o=(new(iw())).retain(t.index-r).delete(n+1).retain(i.length()-2-r).retain(1,{list:s});return this.quill.updateContents(o,cE.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index-n,cE.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(t){const[e,n]=this.quill.getLine(t.index);let i=2,r=e;for(;null!=r&&r.length()<=1&&r.formats()["code-block"];)if(r=r.prev,i-=1,i<=0){const i=(new(iw())).retain(t.index+e.length()-n-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(i,cE.sources.USER),this.quill.setSelection(t.index-1,cE.sources.SILENT),!1}return!0}},"embed left":PE("ArrowLeft",!1),"embed left shift":PE("ArrowLeft",!0),"embed right":PE("ArrowRight",!1),"embed right shift":PE("ArrowRight",!0),"table down":UE(!1),"table up":UE(!0)}};function ME(t){return{key:"Tab",shiftKey:!t,format:{"code-block":!0},handler(e,n){let{event:i}=n;const r=this.quill.scroll.query("code-block"),{TAB:s}=r;if(0===e.length&&!i.shiftKey)return this.quill.insertText(e.index,s,cE.sources.USER),void this.quill.setSelection(e.index+s.length,cE.sources.SILENT);const o=0===e.length?this.quill.getLines(e.index,1):this.quill.getLines(e);let{index:a,length:l}=e;o.forEach(((e,n)=>{t?(e.insertAt(0,s),0===n?a+=s.length:l+=s.length):e.domNode.textContent.startsWith(s)&&(e.deleteAt(0,s.length),0===n?a-=s.length:l-=s.length)})),this.quill.update(cE.sources.USER),this.quill.setSelection(a,l,cE.sources.SILENT)}}}function PE(t,e){return{key:t,shiftKey:e,altKey:null,["ArrowLeft"===t?"prefix":"suffix"]:/^$/,handler(n){let{index:i}=n;"ArrowRight"===t&&(i+=n.length+1);const[r]=this.quill.getLeaf(i);return!(r instanceof Yb&&("ArrowLeft"===t?e?this.quill.setSelection(n.index-1,n.length+1,cE.sources.USER):this.quill.setSelection(n.index-1,cE.sources.USER):e?this.quill.setSelection(n.index,n.length+1,cE.sources.USER):this.quill.setSelection(n.index+n.length+1,cE.sources.USER),1))}}}function jE(t){return{key:t[0],shortKey:!0,handler(e,n){this.quill.format(t,!n.format[t],cE.sources.USER)}}}function UE(t){return{key:t?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(e,n){const i=t?"prev":"next",r=n.line,s=r.parent[i];if(null!=s){if("table-row"===s.statics.blotName){let t=s.children.head,e=r;for(;null!=e.prev;)e=e.prev,t=t.next;const i=t.offset(this.quill.scroll)+Math.min(n.offset,t.length()-1);this.quill.setSelection(i,0,cE.sources.USER)}}else{const e=r.table()[i];null!=e&&(t?this.quill.setSelection(e.offset(this.quill.scroll)+e.length()-1,0,cE.sources.USER):this.quill.setSelection(e.offset(this.quill.scroll),0,cE.sources.USER))}return!1}}}function FE(t){let{quill:e,range:n}=t;const i=e.getLines(n);let r={};if(i.length>1){const t=i[0].formats(),e=i[i.length-1].formats();r=nw.AttributeMap.diff(e,t)||{}}e.deleteText(n,cE.sources.USER),Object.keys(r).length>0&&e.formatLine(n.index,1,r,cE.sources.USER),e.setSelection(n.index,cE.sources.SILENT)}DE.DEFAULTS=RE;const VE=/font-weight:\s*normal/,BE=["P","OL","UL"],zE=t=>t&&BE.includes(t.tagName),HE=/\bmso-list:[^;]*ignore/i,$E=/\bmso-list:[^;]*\bl(\d+)/i,WE=/\bmso-list:[^;]*\blevel(\d+)/i,KE=[function(t){"urn:schemas-microsoft-com:office:word"===t.documentElement.getAttribute("xmlns:w")&&(t=>{const e=Array.from(t.querySelectorAll("[style*=mso-list]")),n=[],i=[];e.forEach((t=>{(t.getAttribute("style")||"").match(HE)?n.push(t):i.push(t)})),n.forEach((t=>t.parentNode?.removeChild(t)));const r=t.documentElement.innerHTML,s=i.map((t=>((t,e)=>{const n=t.getAttribute("style"),i=n?.match($E);if(!i)return null;const r=Number(i[1]),s=n?.match(WE),o=s?Number(s[1]):1,a=new RegExp(`@list l${r}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),l=e.match(a);return{id:r,indent:o,type:l&&"bullet"===l[1]?"bullet":"ordered",element:t}})(t,r))).filter((t=>t));for(;s.length;){const t=[];let e=s.shift();for(;e;)t.push(e),e=s.length&&s[0]?.element===e.element.nextElementSibling&&s[0].id===e.id?s.shift():null;const n=document.createElement("ul");t.forEach((t=>{const e=document.createElement("li");e.setAttribute("data-list",t.type),t.indent>1&&e.setAttribute("class","ql-indent-"+(t.indent-1)),e.innerHTML=t.element.innerHTML,n.appendChild(e)}));const i=t[0]?.element,{parentNode:r}=i??{};i&&r?.replaceChild(n,i),t.slice(1).forEach((t=>{let{element:e}=t;r?.removeChild(e)}))}})(t)},function(t){t.querySelector('[id^="docs-internal-guid-"]')&&((t=>{Array.from(t.querySelectorAll('b[style*="font-weight"]')).filter((t=>t.getAttribute("style")?.match(VE))).forEach((e=>{const n=t.createDocumentFragment();n.append(...e.childNodes),e.parentNode?.replaceChild(n,e)}))})(t),(t=>{Array.from(t.querySelectorAll("br")).filter((t=>zE(t.previousElementSibling)&&zE(t.nextElementSibling))).forEach((t=>{t.parentNode?.removeChild(t)}))})(t))}],GE=Pw("quill:clipboard"),QE=[[Node.TEXT_NODE,function(t,e,n){let i=t.data;if("O:P"===t.parentElement?.tagName)return e.insert(i.trim());if(!i_(t)){if(0===i.trim().length&&i.includes("\n")&&!function(t,e){return t.previousElementSibling&&t.nextElementSibling&&!e_(t.previousElementSibling,e)&&!e_(t.nextElementSibling,e)}(t,n))return e;const r=(t,e)=>{const n=e.replace(/[^\u00a0]/g,"");return n.length<1&&t?" ":n};i=i.replace(/\r\n/g," ").replace(/\n/g," "),i=i.replace(/\s\s+/g,r.bind(r,!0)),(null==t.previousSibling&&null!=t.parentElement&&e_(t.parentElement,n)||t.previousSibling instanceof Element&&e_(t.previousSibling,n))&&(i=i.replace(/^\s+/,r.bind(r,!1))),(null==t.nextSibling&&null!=t.parentElement&&e_(t.parentElement,n)||t.nextSibling instanceof Element&&e_(t.nextSibling,n))&&(i=i.replace(/\s+$/,r.bind(r,!1)))}return e.insert(i)}],[Node.TEXT_NODE,o_],["br",function(t,e){return t_(e,"\n")||e.insert("\n"),e}],[Node.ELEMENT_NODE,o_],[Node.ELEMENT_NODE,function(t,e,n){const i=n.query(t);if(null==i)return e;if(i.prototype instanceof Yb){const e={},r=i.value(t);if(null!=r)return e[i.blotName]=r,(new(iw())).insert(e,i.formats(t,n))}else if(i.prototype instanceof Kb&&!t_(e,"\n")&&e.insert("\n"),"blotName"in i&&"formats"in i&&"function"==typeof i.formats)return ZE(e,i.blotName,i.formats(t,n),n);return e}],[Node.ELEMENT_NODE,function(t,e,n){const i=Ib.keys(t),r=Ob.keys(t),s=Db.keys(t),o={};return i.concat(r).concat(s).forEach((e=>{let i=n.query(e,xb.ATTRIBUTE);null!=i&&(o[i.attrName]=i.value(t),o[i.attrName])||(i=YE[e],null==i||i.attrName!==e&&i.keyName!==e||(o[i.attrName]=i.value(t)||void 0),i=XE[e],null==i||i.attrName!==e&&i.keyName!==e||(i=XE[e],o[i.attrName]=i.value(t)||void 0))})),Object.entries(o).reduce(((t,e)=>{let[i,r]=e;return ZE(t,i,r,n)}),e)}],[Node.ELEMENT_NODE,function(t,e,n){const i={},r=t.style||{};return"italic"===r.fontStyle&&(i.italic=!0),"underline"===r.textDecoration&&(i.underline=!0),"line-through"===r.textDecoration&&(i.strike=!0),(r.fontWeight?.startsWith("bold")||parseInt(r.fontWeight,10)>=700)&&(i.bold=!0),e=Object.entries(i).reduce(((t,e)=>{let[i,r]=e;return ZE(t,i,r,n)}),e),parseFloat(r.textIndent||0)>0?(new(iw())).insert("\t").concat(e):e}],["li",function(t,e,n){const i=n.query(t);if(null==i||"list"!==i.blotName||!t_(e,"\n"))return e;let r=-1,s=t.parentNode;for(;null!=s;)["OL","UL"].includes(s.tagName)&&(r+=1),s=s.parentNode;return r<=0?e:e.reduce(((t,e)=>e.attributes&&"number"==typeof e.attributes.indent?t.push(e):t.insert(e.insert,{indent:r,...e.attributes||{}})),new(iw()))}],["ol, ul",function(t,e,n){return ZE(e,"list","OL"===t.tagName?"ordered":"bullet",n)}],["pre",function(t,e,n){const i=n.query("code-block");return ZE(e,"code-block",!i||!("formats"in i)||"function"!=typeof i.formats||i.formats(t,n),n)}],["tr",function(t,e,n){const i="TABLE"===t.parentElement?.tagName?t.parentElement:t.parentElement?.parentElement;return null!=i?ZE(e,"table",Array.from(i.querySelectorAll("tr")).indexOf(t)+1,n):e}],["b",s_("bold")],["i",s_("italic")],["strike",s_("strike")],["style",function(){return new(iw())}]],YE=[vE,IE].reduce(((t,e)=>(t[e.keyName]=e,t)),{}),XE=[bE,_E,EE,SE,NE,CE].reduce(((t,e)=>(t[e.keyName]=e,t)),{});class JE extends Jw{constructor(t,e){super(t,e),this.quill.root.addEventListener("copy",(t=>this.onCaptureCopy(t,!1))),this.quill.root.addEventListener("cut",(t=>this.onCaptureCopy(t,!0))),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],QE.concat(this.options.matchers).forEach((t=>{let[e,n]=t;this.addMatcher(e,n)}))}addMatcher(t,e){this.matchers.push([t,e])}convert(t){let{html:e,text:n}=t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i[kE.blotName])return(new(iw())).insert(n||"",{[kE.blotName]:i[kE.blotName]});if(!e)return(new(iw())).insert(n||"",i);const r=this.convertHTML(e);return t_(r,"\n")&&(null==r.ops[r.ops.length-1].attributes||i.table)?r.compose((new(iw())).retain(r.length()-1).delete(1)):r}normalizeHTML(t){(t=>{t.documentElement&&KE.forEach((e=>{e(t)}))})(t)}convertHTML(t){const e=(new DOMParser).parseFromString(t,"text/html");this.normalizeHTML(e);const n=e.body,i=new WeakMap,[r,s]=this.prepareMatching(n,i);return r_(this.quill.scroll,n,r,s,i)}dangerouslyPasteHTML(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cE.sources.API;if("string"==typeof t){const n=this.convert({html:t,text:""});this.quill.setContents(n,e),this.quill.setSelection(0,cE.sources.SILENT)}else{const i=this.convert({html:e,text:""});this.quill.updateContents((new(iw())).retain(t).concat(i),n),this.quill.setSelection(t+i.length(),cE.sources.SILENT)}}onCaptureCopy(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.defaultPrevented)return;t.preventDefault();const[n]=this.quill.selection.getRange();if(null==n)return;const{html:i,text:r}=this.onCopy(n,e);t.clipboardData?.setData("text/plain",r),t.clipboardData?.setData("text/html",i),e&&FE({range:n,quill:this.quill})}onCapturePaste(t){if(t.defaultPrevented||!this.quill.isEnabled())return;t.preventDefault();const e=this.quill.getSelection(!0);if(null==e)return;const n=t.clipboardData?.getData("text/html"),i=t.clipboardData?.getData("text/plain"),r=Array.from(t.clipboardData?.files||[]);if(!n&&r.length>0)this.quill.uploader.upload(e,r);else{if(n&&r.length>0){const t=(new DOMParser).parseFromString(n,"text/html");if(1===t.body.childElementCount&&"IMG"===t.body.firstElementChild?.tagName)return void this.quill.uploader.upload(e,r)}this.onPaste(e,{html:n,text:i})}}onCopy(t){const e=this.quill.getText(t);return{html:this.quill.getSemanticHTML(t),text:e}}onPaste(t,e){let{text:n,html:i}=e;const r=this.quill.getFormat(t.index),s=this.convert({text:n,html:i},r);GE.log("onPaste",s,{text:n,html:i});const o=(new(iw())).retain(t.index).delete(t.length).concat(s);this.quill.updateContents(o,cE.sources.USER),this.quill.setSelection(o.length()-t.length,cE.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(t,e){const n=[],i=[];return this.matchers.forEach((r=>{const[s,o]=r;switch(s){case Node.TEXT_NODE:i.push(o);break;case Node.ELEMENT_NODE:n.push(o);break;default:Array.from(t.querySelectorAll(s)).forEach((t=>{if(e.has(t)){const n=e.get(t);n?.push(o)}else e.set(t,[o])}))}})),[n,i]}}function ZE(t,e,n,i){return i.query(e)?t.reduce(((t,i)=>{if(i.attributes&&i.attributes[e])return t.push(i);const r=n?{[e]:n}:{};return t.insert(i.insert,{...r,...i.attributes})}),new(iw())):t}function t_(t,e){let n="";for(let i=t.ops.length-1;i>=0&&n.length<e.length;--i){const e=t.ops[i];if("string"!=typeof e.insert)break;n=e.insert+n}return n.slice(-1*e.length)===e}function e_(t,e){if(!(t instanceof Element))return!1;const n=e.query(t);return!(n&&n.prototype instanceof Yb)&&["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(t.tagName.toLowerCase())}JE.DEFAULTS={matchers:[]};const n_=new WeakMap;function i_(t){return null!=t&&(n_.has(t)||("PRE"===t.tagName?n_.set(t,!0):n_.set(t,i_(t.parentNode))),n_.get(t))}function r_(t,e,n,i,r){return e.nodeType===e.TEXT_NODE?i.reduce(((n,i)=>i(e,n,t)),new(iw())):e.nodeType===e.ELEMENT_NODE?Array.from(e.childNodes||[]).reduce(((s,o)=>{let a=r_(t,o,n,i,r);return o.nodeType===e.ELEMENT_NODE&&(a=n.reduce(((e,n)=>n(o,e,t)),a),a=(r.get(o)||[]).reduce(((e,n)=>n(o,e,t)),a)),s.concat(a)}),new(iw())):new(iw())}function s_(t){return(e,n,i)=>ZE(n,t,!0,i)}function o_(t,e,n){if(!t_(e,"\n")){if(e_(t,n))return e.insert("\n");if(e.length()>0&&t.nextSibling){let i=t.nextSibling;for(;null!=i;){if(e_(i,n))return e.insert("\n");const t=n.query(i);if(t&&t.prototype instanceof Iw)return e.insert("\n");i=i.firstChild}}}return e}class a_ extends Jw{lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(t,e){super(t,e),this.quill.on(cE.events.EDITOR_CHANGE,((t,e,n,i)=>{t===cE.events.SELECTION_CHANGE?e&&i!==cE.sources.SILENT&&(this.currentRange=e):t===cE.events.TEXT_CHANGE&&(this.ignoreChange||(this.options.userOnly&&i!==cE.sources.USER?this.transform(e):this.record(e,n)),this.currentRange=c_(this.currentRange,e))})),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",(t=>{"historyUndo"===t.inputType?(this.undo(),t.preventDefault()):"historyRedo"===t.inputType&&(this.redo(),t.preventDefault())}))}change(t,e){if(0===this.stack[t].length)return;const n=this.stack[t].pop();if(!n)return;const i=this.quill.getContents(),r=n.delta.invert(i);this.stack[e].push({delta:r,range:c_(n.range,r)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n.delta,cE.sources.USER),this.ignoreChange=!1,this.restoreSelection(n)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(t,e){if(0===t.ops.length)return;this.stack.redo=[];let n=t.invert(e),i=this.currentRange;const r=Date.now();if(this.lastRecorded+this.options.delay>r&&this.stack.undo.length>0){const t=this.stack.undo.pop();t&&(n=n.compose(t.delta),i=t.range)}else this.lastRecorded=r;0!==n.length()&&(this.stack.undo.push({delta:n,range:i}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(t){l_(this.stack.undo,t),l_(this.stack.redo,t)}undo(){this.change("undo","redo")}restoreSelection(t){if(t.range)this.quill.setSelection(t.range,cE.sources.USER);else{const e=function(t,e){const n=e.reduce(((t,e)=>t+(e.delete||0)),0);let i=e.length()-n;return function(t,e){const n=e.ops[e.ops.length-1];return null!=n&&(null!=n.insert?"string"==typeof n.insert&&n.insert.endsWith("\n"):null!=n.attributes&&Object.keys(n.attributes).some((e=>null!=t.query(e,xb.BLOCK))))}(t,e)&&(i-=1),i}(this.quill.scroll,t.delta);this.quill.setSelection(e,cE.sources.USER)}}}function l_(t,e){let n=e;for(let e=t.length-1;e>=0;e-=1){const i=t[e];t[e]={delta:n.transform(i.delta,!0),range:i.range&&c_(i.range,n)},n=i.delta.transform(n),0===t[e].delta.length()&&t.splice(e,1)}}function c_(t,e){if(!t)return t;const n=e.transformPosition(t.index);return{index:n,length:e.transformPosition(t.index+t.length)-n}}a_.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};class u_ extends Jw{constructor(t,e){super(t,e),t.root.addEventListener("drop",(e=>{e.preventDefault();let n=null;if(document.caretRangeFromPoint)n=document.caretRangeFromPoint(e.clientX,e.clientY);else if(document.caretPositionFromPoint){const t=document.caretPositionFromPoint(e.clientX,e.clientY);n=document.createRange(),n.setStart(t.offsetNode,t.offset),n.setEnd(t.offsetNode,t.offset)}const i=n&&t.selection.normalizeNative(n);if(i){const n=t.selection.normalizedToRange(i);e.dataTransfer?.files&&this.upload(n,e.dataTransfer.files)}}))}upload(t,e){const n=[];Array.from(e).forEach((t=>{t&&this.options.mimetypes?.includes(t.type)&&n.push(t)})),n.length>0&&this.options.handler.call(this,t,n)}}u_.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(t,e){const n=e.map((t=>new Promise((e=>{const n=new FileReader;n.onload=t=>{e(t.target.result)},n.readAsDataURL(t)}))));Promise.all(n).then((e=>{const n=e.reduce(((t,e)=>t.insert({image:e})),(new(iw())).retain(t.index).delete(t.length));this.quill.updateContents(n,Uw.sources.USER),this.quill.setSelection(t.index+e.length,Uw.sources.SILENT)}))}};const h_=u_,d_=["insertText","insertReplacementText"],f_=/Mac/i.test(navigator.platform);cE.register({"blots/block":xw,"blots/block/embed":Iw,"blots/break":Ew,"blots/container":fE,"blots/cursor":Nw,"blots/embed":tE,"blots/inline":Tw,"blots/scroll":class extends Zb{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=xw;static allowedChildren=[xw,Iw,fE];constructor(t,e,n){let{emitter:i}=n;super(t,e),this.emitter=i,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",(t=>this.handleDragStart(t)))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const t=this.batch;this.batch=!1,this.update(t)}emitMount(t){this.emitter.emit(Uw.events.SCROLL_BLOT_MOUNT,t)}emitUnmount(t){this.emitter.emit(Uw.events.SCROLL_BLOT_UNMOUNT,t)}emitEmbedUpdate(t,e){this.emitter.emit(Uw.events.SCROLL_EMBED_UPDATE,t,e)}deleteAt(t,e){const[n,i]=this.line(t),[r]=this.line(t+e);if(super.deleteAt(t,e),null!=r&&n!==r&&i>0){if(n instanceof Iw||r instanceof Iw)return void this.optimize();const t=r.children.head instanceof Ew?null:r.children.head;n.moveChildren(r,t),n.remove()}this.optimize()}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.domNode.setAttribute("contenteditable",t?"true":"false")}formatAt(t,e,n,i){super.formatAt(t,e,n,i),this.optimize()}insertAt(t,e,n){if(t>=this.length())if(null==n||null==this.scroll.query(e,xb.BLOCK)){const t=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(t),null==n&&e.endsWith("\n")?t.insertAt(0,e.slice(0,-1),n):t.insertAt(0,e,n)}else{const t=this.scroll.create(e,n);this.appendChild(t)}else super.insertAt(t,e,n);this.optimize()}insertBefore(t,e){if(t.statics.scope===xb.INLINE_BLOT){const n=this.scroll.create(this.statics.defaultChild.blotName);n.appendChild(t),super.insertBefore(n,e)}else super.insertBefore(t,e)}insertContents(t,e){const n=this.deltaToRenderBlocks(e.concat((new(iw())).insert("\n"))),i=n.pop();if(null==i)return;this.batchStart();const r=n.shift();if(r){const e="block"===r.type&&(0===r.delta.length()||!this.descendant(Iw,t)[0]&&t<this.length()),n="block"===r.type?r.delta:(new(iw())).insert({[r.key]:r.value});mE(this,t,n);const i="block"===r.type?1:0,s=t+n.length()+i;e&&this.insertAt(s-1,"\n");const o=Sw(this.line(t)[0]),a=nw.AttributeMap.diff(o,r.attributes)||{};Object.keys(a).forEach((t=>{this.formatAt(s-1,1,t,a[t])})),t=s}let[s,o]=this.children.find(t);n.length&&(s&&(s=s.split(o),o=0),n.forEach((t=>{if("block"===t.type)mE(this.createBlock(t.attributes,s||void 0),0,t.delta);else{const e=this.create(t.key,t.value);this.insertBefore(e,s||void 0),Object.keys(t.attributes).forEach((n=>{e.format(n,t.attributes[n])}))}}))),"block"===i.type&&i.delta.length()&&mE(this,s?s.offset(s.scroll)+o:this.length(),i.delta),this.batchEnd(),this.optimize()}isEnabled(){return"true"===this.domNode.getAttribute("contenteditable")}leaf(t){const e=this.path(t).pop();if(!e)return[null,-1];const[n,i]=e;return n instanceof Ub?[n,i]:[null,-1]}line(t){return t===this.length()?this.line(t-1):this.descendant(pE,t)}lines(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;const n=(t,e,i)=>{let r=[],s=i;return t.children.forEachAt(e,i,((t,e,i)=>{pE(t)?r.push(t):t instanceof Qb&&(r=r.concat(n(t,e,s))),s-=i})),r};return n(this,t,e)}optimize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.batch||(super.optimize(t,e),t.length>0&&this.emitter.emit(Uw.events.SCROLL_OPTIMIZE,t,e))}path(t){return super.path(t).slice(1)}remove(){}update(t){if(this.batch)return void(Array.isArray(t)&&(this.batch=this.batch.concat(t)));let e=Uw.sources.USER;"string"==typeof t&&(e=t),Array.isArray(t)||(t=this.observer.takeRecords()),(t=t.filter((t=>{let{target:e}=t;const n=this.find(e,!0);return n&&!gE(n)}))).length>0&&this.emitter.emit(Uw.events.SCROLL_BEFORE_UPDATE,e,t),super.update(t.concat([])),t.length>0&&this.emitter.emit(Uw.events.SCROLL_UPDATE,e,t)}updateEmbedAt(t,e,n){const[i]=this.descendant((t=>t instanceof Iw),t);i&&i.statics.blotName===e&&gE(i)&&i.updateContent(n)}handleDragStart(t){t.preventDefault()}deltaToRenderBlocks(t){const e=[];let n=new(iw());return t.forEach((t=>{const i=t?.insert;if(i)if("string"==typeof i){const r=i.split("\n");r.slice(0,-1).forEach((i=>{n.insert(i,t.attributes),e.push({type:"block",delta:n,attributes:t.attributes??{}}),n=new(iw())}));const s=r[r.length-1];s&&n.insert(s,t.attributes)}else{const r=Object.keys(i)[0];if(!r)return;this.query(r,xb.INLINE)?n.push(t):(n.length()&&e.push({type:"block",delta:n,attributes:{}}),n=new(iw()),e.push({type:"blockEmbed",key:r,value:i[r],attributes:t.attributes??{}}))}})),n.length()&&e.push({type:"block",delta:n,attributes:{}}),e}createBlock(t,e){let n;const i={};Object.entries(t).forEach((t=>{let[e,r]=t;null!=this.query(e,xb.BLOCK&xb.BLOT)?n=e:i[e]=r}));const r=this.create(n||this.statics.defaultChild.blotName,n?t[n]:void 0);this.insertBefore(r,e||void 0);const s=r.length();return Object.entries(i).forEach((t=>{let[e,n]=t;r.formatAt(0,s,e,n)})),r}},"blots/text":_w,"modules/clipboard":JE,"modules/history":a_,"modules/keyboard":DE,"modules/uploader":h_,"modules/input":class extends Jw{constructor(t,e){super(t,e),t.root.addEventListener("beforeinput",(t=>{this.handleBeforeInput(t)})),/Android/i.test(navigator.userAgent)||t.on(cE.events.COMPOSITION_BEFORE_START,(()=>{this.handleCompositionStart()}))}deleteRange(t){FE({range:t,quill:this.quill})}replaceText(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(0===t.length)return!1;if(e){const n=this.quill.getFormat(t.index,1);this.deleteRange(t),this.quill.updateContents((new(iw())).retain(t.index).insert(e,n),cE.sources.USER)}else this.deleteRange(t);return this.quill.setSelection(t.index+e.length,0,cE.sources.SILENT),!0}handleBeforeInput(t){if(this.quill.composition.isComposing||t.defaultPrevented||!d_.includes(t.inputType))return;const e=t.getTargetRanges?t.getTargetRanges()[0]:null;if(!e||!0===e.collapsed)return;const n=function(t){return"string"==typeof t.data?t.data:t.dataTransfer?.types.includes("text/plain")?t.dataTransfer.getData("text/plain"):null}(t);if(null==n)return;const i=this.quill.selection.normalizeNative(e),r=i?this.quill.selection.normalizedToRange(i):null;r&&this.replaceText(r,n)&&t.preventDefault()}handleCompositionStart(){const t=this.quill.getSelection();t&&this.replaceText(t)}},"modules/uiNode":class extends Jw{isListening=!1;selectionChangeDeadline=0;constructor(t,e){super(t,e),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(t,e){let{line:n,event:i}=e;if(!(n instanceof zb&&n.uiNode))return!0;const r="rtl"===getComputedStyle(n.domNode).direction;return!!(r&&"ArrowRight"!==i.key||!r&&"ArrowLeft"!==i.key)||(this.quill.setSelection(t.index-1,t.length+(i.shiftKey?1:0),cE.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",(t=>{!t.defaultPrevented&&(t=>"ArrowLeft"===t.key||"ArrowRight"===t.key||"ArrowUp"===t.key||"ArrowDown"===t.key||"Home"===t.key||!(!f_||"a"!==t.key||!0!==t.ctrlKey))(t)&&this.ensureListeningToSelectionChange()}))}ensureListeningToSelectionChange(){this.selectionChangeDeadline=Date.now()+100,this.isListening||(this.isListening=!0,document.addEventListener("selectionchange",(()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()}),{once:!0}))}handleSelectionChange(){const t=document.getSelection();if(!t)return;const e=t.getRangeAt(0);if(!0!==e.collapsed||0!==e.startOffset)return;const n=this.quill.scroll.find(e.startContainer);if(!(n instanceof zb&&n.uiNode))return;const i=document.createRange();i.setStartAfter(n.uiNode),i.setEndAfter(n.uiNode),t.removeAllRanges(),t.addRange(i)}}});const p_=cE,g_=Pw("quill:toolbar");class m_ extends Jw{constructor(t,e){if(super(t,e),Array.isArray(this.options.container)){const e=document.createElement("div");e.setAttribute("role","toolbar"),function(t,e){Array.isArray(e[0])||(e=[e]),e.forEach((e=>{const n=document.createElement("span");n.classList.add("ql-formats"),e.forEach((t=>{if("string"==typeof t)y_(n,t);else{const e=Object.keys(t)[0],i=t[e];Array.isArray(i)?function(t,e,n){const i=document.createElement("select");i.classList.add(`ql-${e}`),n.forEach((t=>{const e=document.createElement("option");!1!==t?e.setAttribute("value",String(t)):e.setAttribute("selected","selected"),i.appendChild(e)})),t.appendChild(i)}(n,e,i):y_(n,e,i)}})),t.appendChild(n)}))}(e,this.options.container),t.container?.parentNode?.insertBefore(e,t.container),this.container=e}else"string"==typeof this.options.container?this.container=document.querySelector(this.options.container):this.container=this.options.container;this.container instanceof HTMLElement?(this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach((t=>{const e=this.options.handlers?.[t];e&&this.addHandler(t,e)})),Array.from(this.container.querySelectorAll("button, select")).forEach((t=>{this.attach(t)})),this.quill.on(cE.events.EDITOR_CHANGE,(()=>{const[t]=this.quill.selection.getRange();this.update(t)}))):g_.error("Container required for toolbar",this.options)}addHandler(t,e){this.handlers[t]=e}attach(t){let e=Array.from(t.classList).find((t=>0===t.indexOf("ql-")));if(!e)return;if(e=e.slice(3),"BUTTON"===t.tagName&&t.setAttribute("type","button"),null==this.handlers[e]&&null==this.quill.scroll.query(e))return void g_.warn("ignoring attaching to nonexistent format",e,t);const n="SELECT"===t.tagName?"change":"click";t.addEventListener(n,(n=>{let i;if("SELECT"===t.tagName){if(t.selectedIndex<0)return;const e=t.options[t.selectedIndex];i=!e.hasAttribute("selected")&&(e.value||!1)}else i=!t.classList.contains("ql-active")&&(t.value||!t.hasAttribute("value")),n.preventDefault();this.quill.focus();const[r]=this.quill.selection.getRange();if(null!=this.handlers[e])this.handlers[e].call(this,i);else if(this.quill.scroll.query(e).prototype instanceof Yb){if(i=prompt(`Enter ${e}`),!i)return;this.quill.updateContents((new(iw())).retain(r.index).delete(r.length).insert({[e]:i}),cE.sources.USER)}else this.quill.format(e,i,cE.sources.USER);this.update(r)})),this.controls.push([e,t])}update(t){const e=null==t?{}:this.quill.getFormat(t);this.controls.forEach((n=>{const[i,r]=n;if("SELECT"===r.tagName){let n=null;if(null==t)n=null;else if(null==e[i])n=r.querySelector("option[selected]");else if(!Array.isArray(e[i])){let t=e[i];"string"==typeof t&&(t=t.replace(/"/g,'\\"')),n=r.querySelector(`option[value="${t}"]`)}null==n?(r.value="",r.selectedIndex=-1):n.selected=!0}else if(null==t)r.classList.remove("ql-active"),r.setAttribute("aria-pressed","false");else if(r.hasAttribute("value")){const t=e[i],n=t===r.getAttribute("value")||null!=t&&t.toString()===r.getAttribute("value")||null==t&&!r.getAttribute("value");r.classList.toggle("ql-active",n),r.setAttribute("aria-pressed",n.toString())}else{const t=null!=e[i];r.classList.toggle("ql-active",t),r.setAttribute("aria-pressed",t.toString())}}))}}function y_(t,e,n){const i=document.createElement("button");i.setAttribute("type","button"),i.classList.add(`ql-${e}`),i.setAttribute("aria-pressed","false"),null!=n?(i.value=n,i.setAttribute("aria-label",`${e}: ${n}`)):i.setAttribute("aria-label",e),t.appendChild(i)}m_.DEFAULTS={},m_.DEFAULTS={container:null,handlers:{clean(){const t=this.quill.getSelection();if(null!=t)if(0===t.length){const t=this.quill.getFormat();Object.keys(t).forEach((t=>{null!=this.quill.scroll.query(t,xb.INLINE)&&this.quill.format(t,!1,cE.sources.USER)}))}else this.quill.removeFormat(t,cE.sources.USER)},direction(t){const{align:e}=this.quill.getFormat();"rtl"===t&&null==e?this.quill.format("align","right",cE.sources.USER):t||"right"!==e||this.quill.format("align",!1,cE.sources.USER),this.quill.format("direction",t,cE.sources.USER)},indent(t){const e=this.quill.getSelection(),n=this.quill.getFormat(e),i=parseInt(n.indent||0,10);if("+1"===t||"-1"===t){let e="+1"===t?1:-1;"rtl"===n.direction&&(e*=-1),this.quill.format("indent",i+e,cE.sources.USER)}},link(t){!0===t&&(t=prompt("Enter link URL:")),this.quill.format("link",t,cE.sources.USER)},list(t){const e=this.quill.getSelection(),n=this.quill.getFormat(e);"check"===t?"checked"===n.list||"unchecked"===n.list?this.quill.format("list",!1,cE.sources.USER):this.quill.format("list","unchecked",cE.sources.USER):this.quill.format("list",t,cE.sources.USER)}}};let v_=0;function b_(t,e){t.setAttribute(e,`${!("true"===t.getAttribute(e))}`)}const w_=class{constructor(t){this.select=t,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",(()=>{this.togglePicker()})),this.label.addEventListener("keydown",(t=>{switch(t.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),t.preventDefault()}})),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),b_(this.label,"aria-expanded"),b_(this.options,"aria-hidden")}buildItem(t){const e=document.createElement("span");e.tabIndex="0",e.setAttribute("role","button"),e.classList.add("ql-picker-item");const n=t.getAttribute("value");return n&&e.setAttribute("data-value",n),t.textContent&&e.setAttribute("data-label",t.textContent),e.addEventListener("click",(()=>{this.selectItem(e,!0)})),e.addEventListener("keydown",(t=>{switch(t.key){case"Enter":this.selectItem(e,!0),t.preventDefault();break;case"Escape":this.escape(),t.preventDefault()}})),e}buildLabel(){const t=document.createElement("span");return t.classList.add("ql-picker-label"),t.innerHTML='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>',t.tabIndex="0",t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),this.container.appendChild(t),t}buildOptions(){const t=document.createElement("span");t.classList.add("ql-picker-options"),t.setAttribute("aria-hidden","true"),t.tabIndex="-1",t.id=`ql-picker-options-${v_}`,v_+=1,this.label.setAttribute("aria-controls",t.id),this.options=t,Array.from(this.select.options).forEach((e=>{const n=this.buildItem(e);t.appendChild(n),!0===e.selected&&this.selectItem(n)})),this.container.appendChild(t)}buildPicker(){Array.from(this.select.attributes).forEach((t=>{this.container.setAttribute(t.name,t.value)})),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout((()=>this.label.focus()),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.container.querySelector(".ql-selected");t!==n&&(null!=n&&n.classList.remove("ql-selected"),null!=t&&(t.classList.add("ql-selected"),this.select.selectedIndex=Array.from(t.parentNode.children).indexOf(t),t.hasAttribute("data-value")?this.label.setAttribute("data-value",t.getAttribute("data-value")):this.label.removeAttribute("data-value"),t.hasAttribute("data-label")?this.label.setAttribute("data-label",t.getAttribute("data-label")):this.label.removeAttribute("data-label"),e&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let t;if(this.select.selectedIndex>-1){const e=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];t=this.select.options[this.select.selectedIndex],this.selectItem(e)}else this.selectItem(null);const e=null!=t&&t!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",e)}},E_=class extends w_{constructor(t,e){super(t),this.label.innerHTML=e,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach((t=>{t.classList.add("ql-primary")}))}buildItem(t){const e=super.buildItem(t);return e.style.backgroundColor=t.getAttribute("value")||"",e}selectItem(t,e){super.selectItem(t,e);const n=this.label.querySelector(".ql-color-label"),i=t&&t.getAttribute("data-value")||"";n&&("line"===n.tagName?n.style.stroke=i:n.style.fill=i)}},__=class extends w_{constructor(t,e){super(t),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach((t=>{t.innerHTML=e[t.getAttribute("data-value")||""]})),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(t,e){super.selectItem(t,e);const n=t||this.defaultItem;if(null!=n){if(this.label.innerHTML===n.innerHTML)return;this.label.innerHTML=n.innerHTML}}},q_=class{constructor(t,e){this.quill=t,this.boundsContainer=e||document.body,this.root=t.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,(t=>{const{overflowY:e}=getComputedStyle(t,null);return"visible"!==e&&"clip"!==e})(this.quill.root)&&this.quill.root.addEventListener("scroll",(()=>{this.root.style.marginTop=-1*this.quill.root.scrollTop+"px"})),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(t){const e=t.left+t.width/2-this.root.offsetWidth/2,n=t.bottom+this.quill.root.scrollTop;this.root.style.left=`${e}px`,this.root.style.top=`${n}px`,this.root.classList.remove("ql-flip");const i=this.boundsContainer.getBoundingClientRect(),r=this.root.getBoundingClientRect();let s=0;if(r.right>i.right&&(s=i.right-r.right,this.root.style.left=`${e+s}px`),r.left<i.left&&(s=i.left-r.left,this.root.style.left=`${e+s}px`),r.bottom>i.bottom){const e=r.bottom-r.top,i=t.bottom-t.top+e;this.root.style.top=n-i+"px",this.root.classList.add("ql-flip")}return s}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}},k_=[!1,"center","right","justify"],T_=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],x_=[!1,"serif","monospace"],I_=["1","2","3",!1],S_=["small",!1,"large","huge"];class A_ extends iE{constructor(t,e){super(t,e);const n=e=>{document.body.contains(t.root)?(null==this.tooltip||this.tooltip.root.contains(e.target)||document.activeElement===this.tooltip.textbox||this.quill.hasFocus()||this.tooltip.hide(),null!=this.pickers&&this.pickers.forEach((t=>{t.container.contains(e.target)||t.close()}))):document.body.removeEventListener("click",n)};t.emitter.listenDOM("click",document.body,n)}addModule(t){const e=super.addModule(t);return"toolbar"===t&&this.extendToolbar(e),e}buildButtons(t,e){Array.from(t).forEach((t=>{(t.getAttribute("class")||"").split(/\s+/).forEach((n=>{if(n.startsWith("ql-")&&(n=n.slice(3),null!=e[n]))if("direction"===n)t.innerHTML=e[n][""]+e[n].rtl;else if("string"==typeof e[n])t.innerHTML=e[n];else{const i=t.value||"";null!=i&&e[n][i]&&(t.innerHTML=e[n][i])}}))}))}buildPickers(t,e){this.pickers=Array.from(t).map((t=>{if(t.classList.contains("ql-align")&&(null==t.querySelector("option")&&C_(t,k_),"object"==typeof e.align))return new __(t,e.align);if(t.classList.contains("ql-background")||t.classList.contains("ql-color")){const n=t.classList.contains("ql-background")?"background":"color";return null==t.querySelector("option")&&C_(t,T_,"background"===n?"#ffffff":"#000000"),new E_(t,e[n])}return null==t.querySelector("option")&&(t.classList.contains("ql-font")?C_(t,x_):t.classList.contains("ql-header")?C_(t,I_):t.classList.contains("ql-size")&&C_(t,S_)),new w_(t)})),this.quill.on(Uw.events.EDITOR_CHANGE,(()=>{this.pickers.forEach((t=>{t.update()}))}))}}A_.DEFAULTS=Rv({},iE.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let t=this.container.querySelector("input.ql-image[type=file]");null==t&&(t=document.createElement("input"),t.setAttribute("type","file"),t.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),t.classList.add("ql-image"),t.addEventListener("change",(()=>{const e=this.quill.getSelection(!0);this.quill.uploader.upload(e,t.files),t.value=""})),this.container.appendChild(t)),t.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class N_ extends q_{constructor(t,e){super(t,e),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",(t=>{"Enter"===t.key?(this.save(),t.preventDefault()):"Escape"===t.key&&(this.cancel(),t.preventDefault())}))}cancel(){this.hide(),this.restoreFocus()}edit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"link",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),null==this.textbox)return;null!=e?this.textbox.value=e:t!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const n=this.quill.getBounds(this.quill.selection.savedRange);null!=n&&this.position(n),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${t}`)||""),this.root.setAttribute("data-mode",t)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:t}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:e}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",t,Uw.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",t,Uw.sources.USER)),this.quill.root.scrollTop=e;break}case"video":t=function(t){let e=t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return e?`${e[1]||"https"}://www.youtube.com/embed/${e[2]}?showinfo=0`:(e=t.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${e[1]||"https"}://player.vimeo.com/video/${e[2]}/`:t}(t);case"formula":{if(!t)break;const e=this.quill.getSelection(!0);if(null!=e){const n=e.index+e.length;this.quill.insertEmbed(n,this.root.getAttribute("data-mode"),t,Uw.sources.USER),"formula"===this.root.getAttribute("data-mode")&&this.quill.insertText(n+1," ",Uw.sources.USER),this.quill.setSelection(n+2,Uw.sources.USER)}break}}this.textbox.value="",this.hide()}}function C_(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.forEach((e=>{const i=document.createElement("option");e===n?i.setAttribute("selected","selected"):i.setAttribute("value",String(e)),t.appendChild(i)}))}class O_ extends Tw{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(t){const e=super.create(t);return e.setAttribute("href",this.sanitize(t)),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"),e}static formats(t){return t.getAttribute("href")}static sanitize(t){return function(t,e){const n=document.createElement("a");n.href=t;const i=n.href.slice(0,n.href.indexOf(":"));return e.indexOf(i)>-1}(t,this.PROTOCOL_WHITELIST)?t:this.SANITIZED_URL}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("href",this.constructor.sanitize(e)):super.format(t,e)}}const L_='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',D_={align:{"":'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',center:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',right:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',justify:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>'},background:'<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',blockquote:'<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',bold:'<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',clean:'<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',code:L_,"code-block":L_,color:'<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',direction:{"":'<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',rtl:'<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>'},formula:'<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',header:{1:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',2:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>'},italic:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',image:'<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',indent:{"+1":'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',"-1":'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>'},link:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',list:{bullet:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',check:'<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',ordered:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>'},script:{sub:'<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',super:'<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>'},strike:'<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',table:'<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',underline:'<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',video:'<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>'},R_=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class M_ extends N_{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",(t=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),t.preventDefault()})),this.root.querySelector("a.ql-remove").addEventListener("click",(t=>{if(null!=this.linkRange){const t=this.linkRange;this.restoreFocus(),this.quill.formatText(t,"link",!1,Uw.sources.USER),delete this.linkRange}t.preventDefault(),this.hide()})),this.quill.on(Uw.events.SELECTION_CHANGE,((t,e,n)=>{if(null!=t){if(0===t.length&&n===Uw.sources.USER){const[e,n]=this.quill.scroll.descendant(O_,t.index);if(null!=e){this.linkRange=new Vw(t.index-n,e.length());const i=O_.formats(e.domNode);this.preview.textContent=i,this.preview.setAttribute("href",i),this.show();const r=this.quill.getBounds(this.linkRange);return void(null!=r&&this.position(r))}}else delete this.linkRange;this.hide()}}))}show(){super.show(),this.root.removeAttribute("data-mode")}}class P_ extends A_{constructor(t,e){null!=e.modules.toolbar&&null==e.modules.toolbar.container&&(e.modules.toolbar.container=R_),super(t,e),this.quill.container.classList.add("ql-snow")}extendToolbar(t){null!=t.container&&(t.container.classList.add("ql-snow"),this.buildButtons(t.container.querySelectorAll("button"),D_),this.buildPickers(t.container.querySelectorAll("select"),D_),this.tooltip=new M_(this.quill,this.options.bounds),t.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},((e,n)=>{t.handlers.link.call(t,!n.format.link)})))}}P_.DEFAULTS=Rv({},A_.DEFAULTS,{modules:{toolbar:{handlers:{link(t){if(t){const t=this.quill.getSelection();if(null==t||0===t.length)return;let e=this.quill.getText(t);/^\S+@\S+\.\S+$/.test(e)&&0!==e.indexOf("mailto:")&&(e=`mailto:${e}`);const{tooltip:n}=this.quill.theme;n.edit("link",e)}else this.quill.format("link",!1)}}}}});const j_=P_,U_=class extends Tw{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(t){super.optimize(t),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}};class F_ extends fE{}F_.blotName="list-container",F_.tagName="OL";class V_ extends xw{static create(t){const e=super.create();return e.setAttribute("data-list",t),e}static formats(t){return t.getAttribute("data-list")||void 0}static register(){cE.register(F_)}constructor(t,e){super(t,e);const n=e.ownerDocument.createElement("span"),i=n=>{if(!t.isEnabled())return;const i=this.statics.formats(e,t);"checked"===i?(this.format("list","unchecked"),n.preventDefault()):"unchecked"===i&&(this.format("list","checked"),n.preventDefault())};n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),this.attachUI(n)}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("data-list",e):super.format(t,e)}}V_.blotName="list",V_.tagName="LI",F_.allowedChildren=[V_],V_.requiredContainer=F_,O_.PROTOCOL_WHITELIST=["http","https","mailto","tel","radar","rdar","smb","sms"];var B_=n(878),z_={};z_.styleTagTransform=lt(),z_.setAttributes=rt(),z_.insert=nt().bind(null,"head"),z_.domAPI=tt(),z_.insertStyleElement=ot(),J()(B_.A,z_),B_.A&&B_.A.locals&&B_.A.locals;var H_=n(410),$_={};$_.styleTagTransform=lt(),$_.setAttributes=rt(),$_.insert=nt().bind(null,"head"),$_.domAPI=tt(),$_.insertStyleElement=ot(),J()(H_.A,$_),H_.A&&H_.A.locals&&H_.A.locals,p_.register({"modules/toolbar":m_,"themes/snow":j_,"formats/bold":U_,"formats/italic":class extends U_{static blotName="italic";static tagName=["EM","I"]},"formats/underline":class extends Tw{static blotName="underline";static tagName="U"},"formats/strike":class extends U_{static blotName="strike";static tagName=["S","STRIKE"]},"formats/header":class extends xw{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(t){return this.tagName.indexOf(t.tagName)+1}},"formats/blockquote":class extends xw{static blotName="blockquote";static tagName="blockquote"},"formats/code":kE,"formats/list":V_,"formats/color":EE,"formats/link":class extends O_{static sanitize(t){const e=super.sanitize(t);return e&&"about:blank"!==e?this.PROTOCOL_WHITELIST.some((function(t){return e.startsWith(t)}))?e:`https://${e}`:e}}}),p_.register("modules/clipboard",class extends JE{onPaste(t,{text:e}){const n=(new(iw())).retain(t.index).delete(t.length).insert(e);this.quill.updateContents(n,p_.sources.USER),this.quill.setSelection(n.length()-t.length,p_.sources.SILENT),this.quill.scrollSelectionIntoView()}},!0);const W_={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},K_=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,G_=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Q_=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Y_(t){return t?parseInt(t):1}function X_(t){return t&&parseFloat(t.replace(",","."))||0}const J_=[31,null,31,30,31,30,31,31,30,31,30,31];function Z_(t){return t%400==0||t%4==0&&t%100!=0}function tq(t,e){const n=w(t),i=w(e),r=n.getTime()-i.getTime();return r<0?-1:r>0?1:r}function eq(t){const e=w(t);return+function(t){const e=w(t);return e.setHours(23,59,59,999),e}(e)==+function(t){const e=w(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}(e)}function nq(t,e){const n=w(t),i=w(e),r=tq(n,i),s=Math.abs(function(t,e){const n=w(t),i=w(e);return 12*(n.getFullYear()-i.getFullYear())+(n.getMonth()-i.getMonth())}(n,i));let o;if(s<1)o=0;else{1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-r*s);let e=tq(n,i)===-r;eq(w(t))&&1===s&&1===tq(t,i)&&(e=!1),o=r*(s-Number(e))}return 0===o?0:o}function iq(t,e,n){const i=function(t,e){return+w(t)-+w(e)}(t,e)/1e3;return(r=n?.roundingMethod,t=>{const e=(r?Math[r]:Math.trunc)(t);return 0===e?0:e})(i);var r}function rq(t,e,n){const i=g(),r=n?.locale??i.locale??f,s=tq(t,e);if(isNaN(s))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:s});let a,l;s>0?(a=w(e),l=w(t)):(a=w(t),l=w(e));const c=iq(l,a),u=(_(l)-_(a))/1e3,h=Math.round((c-u)/60);let d;if(h<2)return n?.includeSeconds?c<5?r.formatDistance("lessThanXSeconds",5,o):c<10?r.formatDistance("lessThanXSeconds",10,o):c<20?r.formatDistance("lessThanXSeconds",20,o):c<40?r.formatDistance("halfAMinute",0,o):c<60?r.formatDistance("lessThanXMinutes",1,o):r.formatDistance("xMinutes",1,o):0===h?r.formatDistance("lessThanXMinutes",1,o):r.formatDistance("xMinutes",h,o);if(h<45)return r.formatDistance("xMinutes",h,o);if(h<90)return r.formatDistance("aboutXHours",1,o);if(h<1440){const t=Math.round(h/60);return r.formatDistance("aboutXHours",t,o)}if(h<2520)return r.formatDistance("xDays",1,o);if(h<b){const t=Math.round(h/1440);return r.formatDistance("xDays",t,o)}if(h<86400)return d=Math.round(h/b),r.formatDistance("aboutXMonths",d,o);if(d=nq(l,a),d<12){const t=Math.round(h/b);return r.formatDistance("xMonths",t,o)}{const t=d%12,e=Math.trunc(d/12);return t<3?r.formatDistance("aboutXYears",e,o):t<9?r.formatDistance("overXYears",e,o):r.formatDistance("almostXYears",e+1,o)}}var sq=n(430),oq={};oq.styleTagTransform=lt(),oq.setAttributes=rt(),oq.insert=nt().bind(null,"head"),oq.domAPI=tt(),oq.insertStyleElement=ot(),J()(sq.A,oq),sq.A&&sq.A.locals&&sq.A.locals;var aq=n(523),lq={};lq.styleTagTransform=lt(),lq.setAttributes=rt(),lq.insert=nt().bind(null,"head"),lq.domAPI=tt(),lq.insertStyleElement=ot(),J()(aq.A,lq),aq.A&&aq.A.locals&&aq.A.locals;const cq=document.getElementById("dialog-sign-in"),uq=document.getElementById("dialog-sign-out"),hq=document.getElementById("btn-google-sign-in"),dq=document.getElementById("btn-github-sign-in"),fq=document.getElementById("dialog-button-options"),pq=document.getElementById("dialog-note-form"),gq=document.getElementById("form-container"),mq=document.getElementById("input-note-title"),yq=document.getElementById("btn-color-popover"),vq=document.getElementById("popover-overlay"),bq=document.getElementById("popover-dialog"),wq=document.getElementById("colors-menu"),Eq=document.getElementById("actions-menu"),_q=document.getElementById("btn-user-actions"),qq=document.getElementById("user-profile-photo"),kq=Nm(),Tq=new hg,xq=new dg,Iq=async()=>{var t;uq.close(),(t=kq,Lt(t).signOut()).then((()=>{})).catch((t=>{}))};cq.addEventListener("cancel",(t=>{t.preventDefault()})),hq.onclick=()=>{em(kq,Tq).then((t=>{t.user})).catch((t=>{t.code,t.message}))},dq.onclick=()=>{em(kq,xq).then((t=>{dg.credentialFromResult(t).accessToken,t.user})).catch((t=>{t.code,t.message,t.customData.email,dg.credentialFromError(t)}))},vg(kq,(async t=>{t?(Vq(await Mq.getAllNotes()),qq.innerHTML=` <img src="${t.photoURL}" alt="">`,cq.close(),Lq(t),Cq(),Oq()):(document.getElementById("menu-container").innerHTML="",qq.innerHTML="",wq.innerHTML="",cq.showModal(),Aq.remove(Sq.children))}));const Sq=document.querySelector(".notes-container"),Aq=new(i())(Sq,{percentPosition:!0,itemSelector:".note-card",columnWidth:".grid-sizer",horizontalOrder:!1,hiddenStyle:{transform:"translateY(100px)",opacity:0},visibleStyle:{transform:"translateY(0px)",opacity:1}});_q.addEventListener("click",(()=>{uq.showModal()})),uq.addEventListener("click",(t=>{"DIALOG"===t.target.tagName&&uq.close()}));const Nq=["#FFD966","#FFC470","#FFAFA3","#FFADE7","#E6E6E6","#D9B8FF","#AFBCCF","#85E0A3","#80CAFF"],Cq=()=>{let t=document.createElement("button");t.id="btn-open-newnote-modal",t.classList.add("btn-primary"),t.innerText="Add Note",t.onclick=Hq,document.getElementById("menu-container").appendChild(t)},Oq=()=>{let t=document.createElement("div");t.classList.add("floating-btn-container");let e=document.createElement("button");e.id="btn-open-newnote-modal-mobile",e.innerText="+",e.onclick=Hq,t.appendChild(e),document.body.appendChild(t)},Lq=t=>{let e=document.createElement("button"),n=document.createElement("h4"),i=document.createElement("small");e.id="btn-sign-out",e.innerText="Sign out",e.style.width="100%",e.style.marginTop="1rem",e.classList.add("btn-primary"),e.onclick=Iq,n.innerText=t.displayName,i.innerText=t.email,uq.appendChild(n),uq.appendChild(i),uq.appendChild(e)},Dq=t=>{gq.style.backgroundColor=t,yq.style.backgroundColor=t},Rq=function(t){const e=document.getElementById("input-note-text"),n=new p_(e,{theme:"snow",modules:{toolbar:{container:[["bold","italic","underline","strike"],[{color:[]}],[{list:"ordered"},{list:"bullet"}],["blockquote","code-block","link"],[{header:1},{header:2}],["clean"]]}},placeholder:"What's up?"});return{getEditorContents:()=>n.getContents(),setEditorContents:t=>n.setContents(t),clearEditor:()=>n.setContents([]),getFocus:()=>n.focus(),getEditorContentsHTML:()=>n.getSemanticHTML()}}(),Mq=function(){let t=[];return{addNote:async(e,n,i,r)=>{t.push(r);const s=jd(Lm,"users/"+Om+"/notes/");let o=Q(new Date,"yyyy-MM-dd'T'HH:mm:ss.SSS");(function(t,e){const n=Od(t.firestore,Fd),i=function(t,e,...n){if(t=Lt(t),1===arguments.length&&(e=xo.newId()),Sd("doc","path",e),t instanceof Dd){const i=Oo.fromString(e,...n);return Ad(i),new Md(t,null,new Ro(i))}{if(!(t instanceof Md||t instanceof Pd))throw new go(po.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Oo.fromString(e,...n));return Ad(i),new Md(t.firestore,t instanceof Pd?t.converter:null,new Ro(i))}}(t),r=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return Rf(n,[tf(Zd(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,ec.exists(!1))]).then((()=>i))})(s,{title:e,text:{...n},html:i,id:crypto.randomUUID(),created_at:o,modified_at:o,color:r}).then((()=>{}))},removeNote:async(e,n)=>{let i=t.findIndex((t=>t===n));t.splice(i,1);const r=yf(jd(Lm,"users/"+Om+"/notes/"),bf("id","==",e));(await Df(r)).forEach((t=>{var e;(e=t.ref,Rf(Od(e.firestore,Fd),[new pc(e._key,ec.none())])).then((()=>{}))}))},updateNote:async(t,e,n,i,r)=>{const s=yf(jd(Lm,"users/"+Om+"/notes/"),bf("id","==",i));(await Df(s)).forEach((i=>{(function(t,e,n,...i){t=Od(t,Md);const r=Od(t.firestore,Fd),s=Zd(r);let o;return o="string"==typeof(e=Lt(e))||e instanceof Hd?function(t,e,n,i,r,s){const o=t.Su(1,e,n),a=[af(e,i,n)],l=[r];if(s.length%2!=0)throw new go(po.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(af(e,s[t])),l.push(s[t+1]);const c=[],u=Pa.empty();for(let t=a.length-1;t>=0;--t)if(!hf(c,a[t])){const e=a[t];let n=l[t];n=Lt(n);const i=o.fu(e);if(n instanceof ef)c.push(e);else{const t=nf(n,i);null!=t&&(c.push(e),u.set(e,t))}}const h=new ca(c);return new Qd(u,h,o.fieldTransforms)}(s,"updateDoc",t._key,e,n,i):function(t,e,n,i){const r=t.Su(1,e,n);of("Data must be an object, but it was:",r,i);const s=[],o=Pa.empty();na(i,((t,i)=>{const a=cf(e,t,n);i=Lt(i);const l=r.fu(a);if(i instanceof ef)s.push(a);else{const t=nf(i,l);null!=t&&(s.push(a),o.set(a,t))}}));const a=new ca(s);return new Qd(o,a,r.fieldTransforms)}(s,"updateDoc",t._key,e),Rf(r,[o.toMutation(t._key,ec.exists(!0))])})(i.ref,{title:t,text:{...e},html:n,modified_at:Q(new Date,"yyyy-MM-dd'T'HH:mm:ss.SSS"),color:r}).then((()=>{}))}))},getAllNotes:async()=>{const e=yf(jd(Lm,"users/"+Om+"/notes/"),_f("modified_at","desc")),n=await Df(e);let i=[];return t=[],n.forEach((e=>{i.push({...e.data()}),t.push(e.data().color)})),i},filterNotes:async(t,e)=>{const n=yf(jd(Lm,"users/"+Om+"/notes/"),bf(t,"==",e)),i=await Df(n);let r=[];return i.forEach((t=>{r.push({...t.data()})})),r},getNewestNote:async()=>{const t=yf(jd(Lm,"users/"+Om+"/notes/"),_f("modified_at","desc"),(function(t,e){if(e<=0)throw new go(po.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}("limit",1),qf._create("limit",1,"F")));const e=await Df(t);let n={};return e.forEach((t=>{n={...t.data()}})),n},getAllAvailableColors:()=>t}}(),Pq=(t,e,n,i,r,s,o)=>{const a=document.createElement("div");a.classList.add("note-card"),a.addEventListener("click",(n=>{Dq(o),pq.showModal();let i=document.createElement("button");i.innerText="Save",i.style.marginLeft="auto",i.classList.add("btn-primary"),i.addEventListener("click",(async t=>{t.stopPropagation(),pq.close();let e=Rq.getEditorContentsHTML();"<p></p>"!==e&&Rq.getEditorContentsHTML().replaceAll("<p></p>","<br/>"),await Mq.updateNote($q(),Rq.getEditorContents(),e,s,Bq(yq.style.backgroundColor)),Aq.remove(Sq.children),Vq(await Mq.getAllNotes())})),fq.insertAdjacentElement("beforeend",i),mq.value=t,Rq.setEditorContents(e)}));const l=document.createElement("button");l.classList.add("btn-delete-card"),l.innerHTML='<ion-icon name="close-outline"></ion-icon>',l.addEventListener("click",(async t=>{t.preventDefault(),t.stopPropagation(),await Mq.removeNote(s,o);let e=t.target.parentNode.parentNode;Aq.remove(e),Sq.children.length<3?(Eq.innerHTML="",Vq(await Mq.getAllNotes()),jq=!1):Aq.layout(),Fq()}));const c=document.createElement("div");c.style.backgroundColor=o,c.classList.add("note-content");const u=document.createElement("h2");u.classList.add("note-title"),u.innerText=t;const h=document.createElement("p");h.innerText=Q(function(t,e){const n=e?.additionalDigits??2,i=function(t){const e={},n=t.split(W_.dateTimeDelimiter);let i;if(n.length>2)return e;if(/:/.test(n[0])?i=n[0]:(e.date=n[0],i=n[1],W_.timeZoneDelimiter.test(e.date)&&(e.date=t.split(W_.timeZoneDelimiter)[0],i=t.substr(e.date.length,t.length))),i){const t=W_.timezone.exec(i);t?(e.time=i.replace(t[1],""),e.timezone=t[1]):e.time=i}return e}(t);let r;if(i.date){const t=function(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),i=t.match(n);if(!i)return{year:NaN,restDateString:""};const r=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:null===s?r:100*s,restDateString:t.slice((i[1]||i[2]).length)}}(i.date,n);r=function(t,e){if(null===e)return new Date(NaN);const n=t.match(K_);if(!n)return new Date(NaN);const i=!!n[4],r=Y_(n[1]),s=Y_(n[2])-1,o=Y_(n[3]),a=Y_(n[4]),l=Y_(n[5])-1;if(i)return function(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}(0,a,l)?function(t,e,n){const i=new Date(0);i.setUTCFullYear(t,0,4);const r=7*(e-1)+n+1-(i.getUTCDay()||7);return i.setUTCDate(i.getUTCDate()+r),i}(e,a,l):new Date(NaN);{const t=new Date(0);return function(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(J_[e]||(Z_(t)?29:28))}(e,s,o)&&function(t,e){return e>=1&&e<=(Z_(t)?366:365)}(e,r)?(t.setUTCFullYear(e,s,Math.max(r,o)),t):new Date(NaN)}}(t.restDateString,t.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const s=r.getTime();let o,a=0;if(i.time&&(a=function(t){const e=t.match(G_);if(!e)return NaN;const n=X_(e[1]),i=X_(e[2]),r=X_(e[3]);return function(t,e,n){return 24===t?0===e&&0===n:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}(n,i,r)?n*v+6e4*i+1e3*r:NaN}(i.time),isNaN(a)))return new Date(NaN);if(!i.timezone){const t=new Date(s+a),e=new Date(0);return e.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),e.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),e}return o=function(t){if("Z"===t)return 0;const e=t.match(Q_);if(!e)return 0;const n="+"===e[1]?-1:1,i=parseInt(e[2]),r=e[3]&&parseInt(e[3])||0;return function(t,e){return e>=0&&e<=59}(0,r)?n*(i*v+6e4*r):NaN}(i.timezone),isNaN(o)?new Date(NaN):new Date(s+a+o)}(i),"PPP"),h.classList.add("note-readable-date");let d="";d=i===r?rq(i,Q(new Date,"yyyy-MM-dd'T'HH:mm:ss.SSS"),{addSuffix:!0}):"edited "+rq(r,Q(new Date,"yyyy-MM-dd'T'HH:mm:ss.SSS"),{addSuffix:!0});const f=document.createElement("small");f.innerText=d;const p=document.createElement("div");return p.classList.add("note-text"),p.innerHTML=n,c.appendChild(l),c.appendChild(u),c.appendChild(h),c.appendChild(f),c.appendChild(p),a.appendChild(c),a};let jq=!1,Uq=[];const Fq=()=>{let t=Mq.getAllAvailableColors();const e=[...new Set(t)];if(Uq.push(e.length),console.log(Uq),e.sort().reverse(),wq.innerHTML="",e.length>1&&!jq){Eq.innerHTML="";let t=0;for(let n of e){let i=document.createElement("button");i.classList.add("btn-color-menu-option"),i.style.backgroundColor=n,e.length!==Uq[Uq.length-2]?(i.style.animationTimingFunction="ease-out",i.style.animation="fade-in-from-bottom .5s",i.style.animationDelay=`${t}s`,i.style.animationFillMode="forwards",t+=.05):i.style.opacity=1,i.addEventListener("click",(()=>{jq=!0,Aq.remove(Sq.children),Vq(Mq.filterNotes("color",n))})),wq.appendChild(i)}}if(e.length>1&&jq&&0===Eq.children.length){Uq.length=0;let t=document.createElement("button");t.id="btn-filter-all",t.classList.add("btn-action-menu-option"),t.style.animationTimingFunction="ease-out",t.style.animation="fade-in-from-bottom .5s",t.innerHTML='<ion-icon name="return-down-back-outline" size="large"></ion-icon>',t.addEventListener("click",(()=>{jq=!1,Aq.remove(Sq.children),Vq(Mq.getAllNotes())})),Eq.appendChild(t)}},Vq=async t=>{let e=await t;Fq();for(let t of e){let e=Pq(t.title,t.text,t.html,t.created_at,t.modified_at,t.id,t.color);Sq.appendChild(e),Aq.appended(e),Aq.layout()}};function Bq(t){if("r"==t.charAt(0)){t=t.replace("rgb(","").replace(")","").split(",");var e=parseInt(t[0],10).toString(16),n=parseInt(t[1],10).toString(16),i=parseInt(t[2],10).toString(16);return"#"+(e=1==e.length?"0"+e:e)+(n=1==n.length?"0"+n:n)+(1==i.length?"0"+i:i)}}const zq=async()=>{await Mq.addNote($q(),Rq.getEditorContents(),Rq.getEditorContentsHTML(),Bq(yq.style.backgroundColor));let t=await Mq.getNewestNote(),e=Pq(t.title,t.text,t.html,t.created_at,t.modified_at,t.id,t.color);jq?(jq=!1,Aq.remove(Sq.children),Vq(await Mq.getAllNotes())):(Fq(),Sq.appendChild(e),Aq.prepended(e),Aq.layout()),pq.close()},Hq=()=>{Dq(Nq[0]),pq.showModal(),Rq.getFocus();let t=document.createElement("button");t.innerText="Save",t.style.marginLeft="auto",t.onclick=zq,t.classList.add("btn-primary"),fq.insertAdjacentElement("beforeend",t)};pq.addEventListener("close",(t=>{Rq.clearEditor(),Wq(),fq.removeChild(fq.lastChild),vq.classList.remove("active"),bq.classList.remove("active"),Dq(Nq[0])})),pq.addEventListener("mousedown",(t=>{"DIALOG"===t.target.tagName&&pq.close()}));const $q=()=>null===mq||""===mq.value?"Untitled":mq.value,Wq=()=>{mq.value=""};yq.addEventListener("click",(t=>{t.preventDefault(),vq.classList.toggle("active"),bq.classList.toggle("active")})),vq.addEventListener("click",(()=>{vq.classList.remove("active"),bq.classList.remove("active")})),(t=>{yq.innerHTML='<ion-icon name="color-palette-outline" size="large"></ion-icon>';for(let e of t){let t=document.createElement("button");t.classList.add("btn-color-option"),t.style.backgroundColor=e,t.style.cursor="pointer",bq.appendChild(t),t.onclick=()=>{Dq(e),vq.classList.remove("active"),bq.classList.remove("active")}}})(Nq)})()})();