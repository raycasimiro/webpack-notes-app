/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={878:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"/*!\n * Quill Editor v2.0.0-rc.2\n * https://quilljs.com\n * Copyright (c) 2017-2024, Slab\n * Copyright (c) 2014, Jason Chen\n * Copyright (c) 2013, salesforce.com\n */\n.ql-container{box-sizing:border-box;font-family:Helvetica,Arial,sans-serif;font-size:13px;height:100%;margin:0;position:relative}.ql-container.ql-disabled .ql-tooltip{visibility:hidden}.ql-container:not(.ql-disabled) li[data-list=checked] > .ql-ui,.ql-container:not(.ql-disabled) li[data-list=unchecked] > .ql-ui{cursor:pointer}.ql-clipboard{left:-100000px;height:1px;overflow-y:hidden;position:absolute;top:50%}.ql-clipboard p{margin:0;padding:0}.ql-editor{box-sizing:border-box;counter-reset:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9;line-height:1.42;height:100%;outline:none;overflow-y:auto;padding:12px 15px;tab-size:4;-moz-tab-size:4;text-align:left;white-space:pre-wrap;word-wrap:break-word}.ql-editor > *{cursor:text}.ql-editor p,.ql-editor ol,.ql-editor pre,.ql-editor blockquote,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{margin:0;padding:0}@supports (counter-set:none){.ql-editor p,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{counter-set:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor p,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{counter-reset:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor table{border-collapse:collapse}.ql-editor td{border:1px solid #000;padding:2px 5px}.ql-editor ol{padding-left:1.5em}.ql-editor li{list-style-type:none;padding-left:1.5em;position:relative}.ql-editor li > .ql-ui:before{display:inline-block;margin-left:-1.5em;margin-right:.3em;text-align:right;white-space:nowrap;width:1.2em}.ql-editor li[data-list=checked] > .ql-ui,.ql-editor li[data-list=unchecked] > .ql-ui{color:#777}.ql-editor li[data-list=bullet] > .ql-ui:before{content:'\\2022'}.ql-editor li[data-list=checked] > .ql-ui:before{content:'\\2611'}.ql-editor li[data-list=unchecked] > .ql-ui:before{content:'\\2610'}@supports (counter-set:none){.ql-editor li[data-list]{counter-set:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list]{counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered]{counter-increment:list-0}.ql-editor li[data-list=ordered] > .ql-ui:before{content:counter(list-0, decimal) '. '}.ql-editor li[data-list=ordered].ql-indent-1{counter-increment:list-1}.ql-editor li[data-list=ordered].ql-indent-1 > .ql-ui:before{content:counter(list-1, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-1{counter-set:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-1{counter-reset:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-2{counter-increment:list-2}.ql-editor li[data-list=ordered].ql-indent-2 > .ql-ui:before{content:counter(list-2, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-2{counter-set:list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-2{counter-reset:list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-3{counter-increment:list-3}.ql-editor li[data-list=ordered].ql-indent-3 > .ql-ui:before{content:counter(list-3, decimal) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-3{counter-set:list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-3{counter-reset:list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-4{counter-increment:list-4}.ql-editor li[data-list=ordered].ql-indent-4 > .ql-ui:before{content:counter(list-4, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-4{counter-set:list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-4{counter-reset:list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-5{counter-increment:list-5}.ql-editor li[data-list=ordered].ql-indent-5 > .ql-ui:before{content:counter(list-5, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-5{counter-set:list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-5{counter-reset:list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-6{counter-increment:list-6}.ql-editor li[data-list=ordered].ql-indent-6 > .ql-ui:before{content:counter(list-6, decimal) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-6{counter-set:list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-6{counter-reset:list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-7{counter-increment:list-7}.ql-editor li[data-list=ordered].ql-indent-7 > .ql-ui:before{content:counter(list-7, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-7{counter-set:list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-7{counter-reset:list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-8{counter-increment:list-8}.ql-editor li[data-list=ordered].ql-indent-8 > .ql-ui:before{content:counter(list-8, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-8{counter-set:list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-8{counter-reset:list-9}}.ql-editor li[data-list=ordered].ql-indent-9{counter-increment:list-9}.ql-editor li[data-list=ordered].ql-indent-9 > .ql-ui:before{content:counter(list-9, decimal) '. '}.ql-editor .ql-indent-1:not(.ql-direction-rtl){padding-left:3em}.ql-editor li.ql-indent-1:not(.ql-direction-rtl){padding-left:4.5em}.ql-editor .ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:3em}.ql-editor li.ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:4.5em}.ql-editor .ql-indent-2:not(.ql-direction-rtl){padding-left:6em}.ql-editor li.ql-indent-2:not(.ql-direction-rtl){padding-left:7.5em}.ql-editor .ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:6em}.ql-editor li.ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:7.5em}.ql-editor .ql-indent-3:not(.ql-direction-rtl){padding-left:9em}.ql-editor li.ql-indent-3:not(.ql-direction-rtl){padding-left:10.5em}.ql-editor .ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:9em}.ql-editor li.ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:10.5em}.ql-editor .ql-indent-4:not(.ql-direction-rtl){padding-left:12em}.ql-editor li.ql-indent-4:not(.ql-direction-rtl){padding-left:13.5em}.ql-editor .ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:12em}.ql-editor li.ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:13.5em}.ql-editor .ql-indent-5:not(.ql-direction-rtl){padding-left:15em}.ql-editor li.ql-indent-5:not(.ql-direction-rtl){padding-left:16.5em}.ql-editor .ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:15em}.ql-editor li.ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:16.5em}.ql-editor .ql-indent-6:not(.ql-direction-rtl){padding-left:18em}.ql-editor li.ql-indent-6:not(.ql-direction-rtl){padding-left:19.5em}.ql-editor .ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:18em}.ql-editor li.ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:19.5em}.ql-editor .ql-indent-7:not(.ql-direction-rtl){padding-left:21em}.ql-editor li.ql-indent-7:not(.ql-direction-rtl){padding-left:22.5em}.ql-editor .ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:21em}.ql-editor li.ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:22.5em}.ql-editor .ql-indent-8:not(.ql-direction-rtl){padding-left:24em}.ql-editor li.ql-indent-8:not(.ql-direction-rtl){padding-left:25.5em}.ql-editor .ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:24em}.ql-editor li.ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:25.5em}.ql-editor .ql-indent-9:not(.ql-direction-rtl){padding-left:27em}.ql-editor li.ql-indent-9:not(.ql-direction-rtl){padding-left:28.5em}.ql-editor .ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:27em}.ql-editor li.ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:28.5em}.ql-editor li.ql-direction-rtl{padding-right:1.5em}.ql-editor li.ql-direction-rtl > .ql-ui:before{margin-left:.3em;margin-right:-1.5em;text-align:left}.ql-editor table{table-layout:fixed;width:100%}.ql-editor table td{outline:none}.ql-editor .ql-code-block-container{font-family:monospace}.ql-editor .ql-video{display:block;max-width:100%}.ql-editor .ql-video.ql-align-center{margin:0 auto}.ql-editor .ql-video.ql-align-right{margin:0 0 0 auto}.ql-editor .ql-bg-black{background-color:#000}.ql-editor .ql-bg-red{background-color:#e60000}.ql-editor .ql-bg-orange{background-color:#f90}.ql-editor .ql-bg-yellow{background-color:#ff0}.ql-editor .ql-bg-green{background-color:#008a00}.ql-editor .ql-bg-blue{background-color:#06c}.ql-editor .ql-bg-purple{background-color:#93f}.ql-editor .ql-color-white{color:#fff}.ql-editor .ql-color-red{color:#e60000}.ql-editor .ql-color-orange{color:#f90}.ql-editor .ql-color-yellow{color:#ff0}.ql-editor .ql-color-green{color:#008a00}.ql-editor .ql-color-blue{color:#06c}.ql-editor .ql-color-purple{color:#93f}.ql-editor .ql-font-serif{font-family:Georgia,Times New Roman,serif}.ql-editor .ql-font-monospace{font-family:Monaco,Courier New,monospace}.ql-editor .ql-size-small{font-size:.75em}.ql-editor .ql-size-large{font-size:1.5em}.ql-editor .ql-size-huge{font-size:2.5em}.ql-editor .ql-direction-rtl{direction:rtl;text-align:inherit}.ql-editor .ql-align-center{text-align:center}.ql-editor .ql-align-justify{text-align:justify}.ql-editor .ql-align-right{text-align:right}.ql-editor .ql-ui{position:absolute}.ql-editor.ql-blank::before{color:rgba(0,0,0,0.6);content:attr(data-placeholder);font-style:italic;left:15px;pointer-events:none;position:absolute;right:15px}.ql-snow.ql-toolbar:after,.ql-snow .ql-toolbar:after{clear:both;content:'';display:table}.ql-snow.ql-toolbar button,.ql-snow .ql-toolbar button{background:none;border:none;cursor:pointer;display:inline-block;float:left;height:24px;padding:3px 5px;width:28px}.ql-snow.ql-toolbar button svg,.ql-snow .ql-toolbar button svg{float:left;height:100%}.ql-snow.ql-toolbar button:active:hover,.ql-snow .ql-toolbar button:active:hover{outline:none}.ql-snow.ql-toolbar input.ql-image[type=file],.ql-snow .ql-toolbar input.ql-image[type=file]{display:none}.ql-snow.ql-toolbar button:hover,.ql-snow .ql-toolbar button:hover,.ql-snow.ql-toolbar button:focus,.ql-snow .ql-toolbar button:focus,.ql-snow.ql-toolbar button.ql-active,.ql-snow .ql-toolbar button.ql-active,.ql-snow.ql-toolbar .ql-picker-label:hover,.ql-snow .ql-toolbar .ql-picker-label:hover,.ql-snow.ql-toolbar .ql-picker-label.ql-active,.ql-snow .ql-toolbar .ql-picker-label.ql-active,.ql-snow.ql-toolbar .ql-picker-item:hover,.ql-snow .ql-toolbar .ql-picker-item:hover,.ql-snow.ql-toolbar .ql-picker-item.ql-selected,.ql-snow .ql-toolbar .ql-picker-item.ql-selected{color:#06c}.ql-snow.ql-toolbar button:hover .ql-fill,.ql-snow .ql-toolbar button:hover .ql-fill,.ql-snow.ql-toolbar button:focus .ql-fill,.ql-snow .ql-toolbar button:focus .ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow.ql-toolbar button:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill{fill:#06c}.ql-snow.ql-toolbar button:hover .ql-stroke,.ql-snow .ql-toolbar button:hover .ql-stroke,.ql-snow.ql-toolbar button:focus .ql-stroke,.ql-snow .ql-toolbar button:focus .ql-stroke,.ql-snow.ql-toolbar button.ql-active .ql-stroke,.ql-snow .ql-toolbar button.ql-active .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow.ql-toolbar button:hover .ql-stroke-miter,.ql-snow .ql-toolbar button:hover .ql-stroke-miter,.ql-snow.ql-toolbar button:focus .ql-stroke-miter,.ql-snow .ql-toolbar button:focus .ql-stroke-miter,.ql-snow.ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter{stroke:#06c}@media (pointer:coarse){.ql-snow.ql-toolbar button:hover:not(.ql-active),.ql-snow .ql-toolbar button:hover:not(.ql-active){color:#444}.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill{fill:#444}.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter{stroke:#444}}.ql-snow{box-sizing:border-box}.ql-snow *{box-sizing:border-box}.ql-snow .ql-hidden{display:none}.ql-snow .ql-out-bottom,.ql-snow .ql-out-top{visibility:hidden}.ql-snow .ql-tooltip{position:absolute;transform:translateY(10px)}.ql-snow .ql-tooltip a{cursor:pointer;text-decoration:none}.ql-snow .ql-tooltip.ql-flip{transform:translateY(-10px)}.ql-snow .ql-formats{display:inline-block;vertical-align:middle}.ql-snow .ql-formats:after{clear:both;content:'';display:table}.ql-snow .ql-stroke{fill:none;stroke:#444;stroke-linecap:round;stroke-linejoin:round;stroke-width:2}.ql-snow .ql-stroke-miter{fill:none;stroke:#444;stroke-miterlimit:10;stroke-width:2}.ql-snow .ql-fill,.ql-snow .ql-stroke.ql-fill{fill:#444}.ql-snow .ql-empty{fill:none}.ql-snow .ql-even{fill-rule:evenodd}.ql-snow .ql-thin,.ql-snow .ql-stroke.ql-thin{stroke-width:1}.ql-snow .ql-transparent{opacity:.4}.ql-snow .ql-direction svg:last-child{display:none}.ql-snow .ql-direction.ql-active svg:last-child{display:inline}.ql-snow .ql-direction.ql-active svg:first-child{display:none}.ql-snow .ql-editor h1{font-size:2em}.ql-snow .ql-editor h2{font-size:1.5em}.ql-snow .ql-editor h3{font-size:1.17em}.ql-snow .ql-editor h4{font-size:1em}.ql-snow .ql-editor h5{font-size:.83em}.ql-snow .ql-editor h6{font-size:.67em}.ql-snow .ql-editor a{text-decoration:underline}.ql-snow .ql-editor blockquote{border-left:4px solid #ccc;margin-bottom:5px;margin-top:5px;padding-left:16px}.ql-snow .ql-editor code,.ql-snow .ql-editor .ql-code-block-container{background-color:#f0f0f0;border-radius:3px}.ql-snow .ql-editor .ql-code-block-container{margin-bottom:5px;margin-top:5px;padding:5px 10px}.ql-snow .ql-editor code{font-size:85%;padding:2px 4px}.ql-snow .ql-editor .ql-code-block-container{background-color:#23241f;color:#f8f8f2;overflow:visible}.ql-snow .ql-editor img{max-width:100%}.ql-snow .ql-picker{color:#444;display:inline-block;float:left;font-size:14px;font-weight:500;height:24px;position:relative;vertical-align:middle}.ql-snow .ql-picker-label{cursor:pointer;display:inline-block;height:100%;padding-left:8px;padding-right:2px;position:relative;width:100%}.ql-snow .ql-picker-label::before{display:inline-block;line-height:22px}.ql-snow .ql-picker-options{background-color:#fff;display:none;min-width:100%;padding:4px 8px;position:absolute;white-space:nowrap}.ql-snow .ql-picker-options .ql-picker-item{cursor:pointer;display:block;padding-bottom:5px;padding-top:5px}.ql-snow .ql-picker.ql-expanded .ql-picker-label{color:#ccc;z-index:2}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-fill{fill:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-stroke{stroke:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-options{display:block;margin-top:-1px;top:100%;z-index:1}.ql-snow .ql-color-picker,.ql-snow .ql-icon-picker{width:28px}.ql-snow .ql-color-picker .ql-picker-label,.ql-snow .ql-icon-picker .ql-picker-label{padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-label svg,.ql-snow .ql-icon-picker .ql-picker-label svg{right:4px}.ql-snow .ql-icon-picker .ql-picker-options{padding:4px 0}.ql-snow .ql-icon-picker .ql-picker-item{height:24px;width:24px;padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-options{padding:3px 5px;width:152px}.ql-snow .ql-color-picker .ql-picker-item{border:1px solid transparent;float:left;height:16px;margin:2px;padding:0;width:16px}.ql-snow .ql-picker:not(.ql-color-picker):not(.ql-icon-picker) svg{position:absolute;margin-top:-9px;right:0;top:50%;width:18px}.ql-snow .ql-picker.ql-header .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-font .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-label]:not([data-label=''])::before{content:attr(data-label)}.ql-snow .ql-picker.ql-header{width:98px}.ql-snow .ql-picker.ql-header .ql-picker-label::before,.ql-snow .ql-picker.ql-header .ql-picker-item::before{content:'Normal'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"1\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before{content:'Heading 1'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"2\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before{content:'Heading 2'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"3\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before{content:'Heading 3'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"4\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before{content:'Heading 4'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"5\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before{content:'Heading 5'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"6\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before{content:'Heading 6'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before{font-size:2em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before{font-size:1.5em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before{font-size:1.17em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before{font-size:1em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before{font-size:.83em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before{font-size:.67em}.ql-snow .ql-picker.ql-font{width:108px}.ql-snow .ql-picker.ql-font .ql-picker-label::before,.ql-snow .ql-picker.ql-font .ql-picker-item::before{content:'Sans Serif'}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=serif]::before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before{content:'Serif'}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=monospace]::before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before{content:'Monospace'}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before{font-family:Georgia,Times New Roman,serif}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before{font-family:Monaco,Courier New,monospace}.ql-snow .ql-picker.ql-size{width:98px}.ql-snow .ql-picker.ql-size .ql-picker-label::before,.ql-snow .ql-picker.ql-size .ql-picker-item::before{content:'Normal'}.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=small]::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before{content:'Small'}.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=large]::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before{content:'Large'}.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=huge]::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before{content:'Huge'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before{font-size:10px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before{font-size:18px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before{font-size:32px}.ql-snow .ql-color-picker.ql-background .ql-picker-item{background-color:#fff}.ql-snow .ql-color-picker.ql-color .ql-picker-item{background-color:#000}.ql-code-block-container{position:relative}.ql-code-block-container .ql-ui{right:5px;top:5px}.ql-toolbar.ql-snow{border:1px solid #ccc;box-sizing:border-box;font-family:'Helvetica Neue','Helvetica','Arial',sans-serif;padding:8px}.ql-toolbar.ql-snow .ql-formats{margin-right:15px}.ql-toolbar.ql-snow .ql-picker-label{border:1px solid transparent}.ql-toolbar.ql-snow .ql-picker-options{border:1px solid transparent;box-shadow:rgba(0,0,0,0.2) 0 2px 8px}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-label{border-color:#ccc}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-options{border-color:#ccc}.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item.ql-selected,.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item:hover{border-color:#000}.ql-toolbar.ql-snow + .ql-container.ql-snow{border-top:0}.ql-snow .ql-tooltip{background-color:#fff;border:1px solid #ccc;box-shadow:0 0 5px #ddd;color:#444;padding:5px 12px;white-space:nowrap}.ql-snow .ql-tooltip::before{content:\"Visit URL:\";line-height:26px;margin-right:8px}.ql-snow .ql-tooltip input[type=text]{display:none;border:1px solid #ccc;font-size:13px;height:26px;margin:0;padding:3px 5px;width:170px}.ql-snow .ql-tooltip a.ql-preview{display:inline-block;max-width:200px;overflow-x:hidden;text-overflow:ellipsis;vertical-align:top}.ql-snow .ql-tooltip a.ql-action::after{border-right:1px solid #ccc;content:'Edit';margin-left:16px;padding-right:8px}.ql-snow .ql-tooltip a.ql-remove::before{content:'Remove';margin-left:8px}.ql-snow .ql-tooltip a{line-height:26px}.ql-snow .ql-tooltip.ql-editing a.ql-preview,.ql-snow .ql-tooltip.ql-editing a.ql-remove{display:none}.ql-snow .ql-tooltip.ql-editing input[type=text]{display:inline-block}.ql-snow .ql-tooltip.ql-editing a.ql-action::after{border-right:0;content:'Save';padding-right:0}.ql-snow .ql-tooltip[data-mode=link]::before{content:\"Enter link:\"}.ql-snow .ql-tooltip[data-mode=formula]::before{content:\"Enter formula:\"}.ql-snow .ql-tooltip[data-mode=video]::before{content:\"Enter video:\"}.ql-snow a{color:#06c}.ql-container.ql-snow{border:1px solid #ccc}",""]);const a=o},497:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".notes-container {\n  margin: 0 auto;\n  margin: 0.5rem;\n}\n\n.grid-sizer,\n.note-card {\n  width: 25%;\n  padding: 0.5rem;\n}\n\n@media only screen and (max-width: 375px) {\n  .grid-sizer,\n  .note-card {\n    width: 100%;\n  }\n}\n\n@media only screen and (min-width: 376px) and (max-width: 768px) {\n  .grid-sizer,\n  .note-card {\n    width: 50%;\n  }\n}\n\n#new-note-title {\n  color: var(--primary-text-color);\n}\n\n.note-content {\n  outline: 1px solid red;\n  padding: 1rem;\n  border-radius: 5px;\n}\n\n.note-text {\n  display: -webkit-box;\n  -webkit-line-clamp: 8;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  margin: 1rem 0;\n}\n\n/*///////////////////////// TEXT FORMATTING /////////////////////////*/\n\n.note-text h1 {\n  font-size: 26px;\n  line-height: 37px;\n  font-weight: 400;\n  color: var(--primary-text-color);\n}\n\n.note-text h2 {\n  font-size: 20px;\n  line-height: 28px;\n  font-weight: 400;\n  color: var(--primary-text-color);\n}\n\n.note-text p,\nli {\n  color: var(--primary-text-color);\n}\n\n.note-text ul > li::before {\n  content: '\\2022';\n  display: inline-block;\n  margin-left: -1.5em;\n  margin-right: 0.3em;\n  text-align: right;\n  white-space: nowrap;\n  width: 1.2em;\n}\n\n.note-text ul {\n  list-style-type: none;\n}\n\n.note-text blockquote {\n  border-left: 3px solid #ccc;\n  font-style: italic;\n  margin-top: 10px;\n  margin-bottom: 10px;\n  padding-left: 16px;\n}\n\n.note-text > pre,\n.note-text > .ql-code-block {\n  font-size: 1rem;\n  border-radius: 3px;\n  font-family: monospace;\n  background-color: #23241f;\n  color: #f8f8f2;\n  margin-bottom: 5px;\n  margin-top: 5px;\n  padding: 5px 10px;\n}\n\n.note-title {\n  font-weight: 500;\n  line-height: 2rem;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  color: var(--primary-text-color);\n}\n",""]);const a=o},410:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".ql-container {\n  font-family: 'Inter', Helvetica, Arial, sans-serif, 'Apple Color Emoji',\n    'Segoe UI Emoji', 'Segoe UI Symbol';\n  display: flex;\n  flex-direction: column-reverse;\n}\n\n.ql-editor {\n  min-height: 300px;\n  max-height: 55vh;\n  border-radius: 5px;\n  padding: 15px 12px;\n}\n\n.ql-toolbar {\n  border-radius: 0 0 5px 5px;\n  border: 0;\n}\n\n.ql-editor.ql-blank::before {\n  left: 12px;\n  font-size: 1rem;\n}\n\n.ql-bubble .ql-tooltip {\n  background-color: #000;\n}\n.ql-bubble .ql-tooltip:not(.ql-flip) .ql-tooltip-arrow {\n  border-bottom: 6px solid #000;\n}\n\n.ql-snow .ql-picker.ql-expanded .ql-picker-options {\n  top: unset;\n  bottom: 100%;\n}\n\n/*///////////////////////// TEXT FORMATTING /////////////////////////*/\n\n.ql-snow .ql-editor h1 {\n  font-size: 26px;\n  line-height: 37px;\n  font-weight: 400;\n  color: var(--primary-text-color);\n}\n\n.ql-snow .ql-editor h2 {\n  font-size: 20px;\n  line-height: 28px;\n  font-weight: 400;\n  color: var(--primary-text-color);\n}\n\n.ql-snow .ql-editor p,\nli,\nblockquote {\n  font-size: 1rem;\n  color: var(--primary-text-color);\n}\n\n.ql-code-block {\n  font-size: 1rem;\n}\n\n.ql-editor ol {\n  padding-left: 1rem;\n}\n\n.ql-snow .ql-editor blockquote {\n  border-left: 3px solid #ccc;\n  font-style: italic;\n  margin-top: 10px;\n  margin-bottom: 10px;\n  padding-left: 16px;\n}\n\n#new-note-title {\n  width: 100%;\n  border: 1px solid #ccc;\n  border-bottom: 0;\n  padding: 15px 12px;\n  font-size: 26px;\n  line-height: 37px;\n  border-radius: 5px 5px 0 0;\n}\n",""]);const a=o},523:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,":root {\n  --primary-text-color: #1f1f1f;\n}\n\nbody {\n  font-family: 'Inter', Helvetica, Arial, sans-serif, 'Apple Color Emoji',\n    'Segoe UI Emoji', 'Segoe UI Symbol';\n}\n\nnav {\n  display: flex;\n  background-color: white;\n  color: var(--primary-text-color);\n  padding: 1rem;\n}\n\n.menu-container {\n  outline: 1px solid red;\n  padding: 1rem;\n  display: flex;\n}\n\n#btn-open-newnote-modal {\n  margin-left: auto;\n}\n\n.notes-container {\n  margin: 0 auto;\n  margin: 0.5rem;\n}\n\n.note-content {\n  outline: 1px solid red;\n  padding: 1rem;\n  border-radius: 5px;\n}\n\n.note-content small {\n  color: #777;\n}\n\n.note-text {\n  display: -webkit-box;\n  -webkit-line-clamp: 12;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n.note-title {\n  font-weight: 500;\n  line-height: 2rem;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n.btn-delete-card {\n  display: flex;\n  align-items: center;\n  position: absolute;\n  top: 1rem;\n  right: 1rem;\n  width: 30px;\n  height: 30px;\n  border-radius: 15px;\n  border: 0;\n  cursor: pointer;\n}\n\n.grid-sizer,\n.note-card {\n  width: 25%;\n  padding: 0.5rem;\n  position: relative;\n}\n\n@media only screen and (max-width: 375px) {\n  .grid-sizer,\n  .note-card {\n    width: 100%;\n  }\n  #btn-open-newnote-modal {\n    display: none;\n  }\n}\n\n@media only screen and (min-width: 376px) and (max-width: 768px) {\n  .grid-sizer,\n  .note-card {\n    width: 50%;\n  }\n  #btn-open-newnote-modal {\n    display: none;\n  }\n}\n\n*:focus {\n  outline: none;\n}\n\n#dialog-newnote-form {\n  overflow: visible;\n  margin: auto;\n  border: 0;\n  background-color: transparent;\n  padding: 1.5rem;\n  max-width: 100%;\n  max-height: 100%;\n}\n\n.form-container {\n  border-radius: 5px;\n  padding: 1.5rem;\n  background-color: white;\n  box-shadow: 0px 0px 15px -3px rgba(0, 0, 0, 0.1);\n}\n\ndialog::backdrop {\n  background-color: rgba(0, 0, 0, 0.391);\n  /* backdrop-filter: blur(1px); */\n}\n\n#editor-new-note {\n  border-bottom: 0;\n  display: flex;\n}\n\n#btn-save-note {\n  width: fit-content;\n  margin: auto;\n}\n\n.new-note-form-separator {\n  border-left: 1px solid #ccc;\n  border-right: 1px solid #ccc;\n}\n\n.new-note-form-separator > hr {\n  height: 1px;\n  border: none;\n  color: #ccc;\n  background-color: #ccc;\n}\n\n#dialog-button-options {\n  display: flex;\n  padding-top: 1.5rem;\n}\n\n.dialog-btn {\n  height: 40px;\n  border-radius: 20px;\n  padding: 0 30px;\n  border: 0;\n  margin-left: auto;\n}\n\nbutton > ion-icon {\n  pointer-events: none;\n}\n\n#loginStatus {\n  display: flex;\n  align-items: center;\n}\n",""]);const a=o},430:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"/*\n  Josh's Custom CSS Reset\n  https://www.joshwcomeau.com/css/custom-css-reset/\n*/\n*,\n*::before,\n*::after {\n  box-sizing: border-box;\n}\n* {\n  margin: 0;\n}\nhtml,\nbody {\n  height: 100%;\n}\nbody {\n  line-height: 1.5;\n  -webkit-font-smoothing: antialiased;\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif,\n    'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';\n}\nimg,\npicture,\nvideo,\ncanvas,\nsvg {\n  display: block;\n  max-width: 100%;\n}\ninput,\nbutton,\ntextarea,\nselect {\n  font: inherit;\n}\np,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  overflow-wrap: break-word;\n}\n#root,\n#__next {\n  isolation: isolate;\n}\n",""]);const a=o},314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);i&&o[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},601:t=>{"use strict";t.exports=function(t){return t[1]}},786:(t,e,n)=>{var i,r;!function(s,o){"use strict";void 0===(r="function"==typeof(i=o)?i.call(e,n,e,t):i)||(t.exports=r)}(window,(function(){"use strict";var t=function(){var t=window.Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],n=0;n<e.length;n++){var i=e[n]+"MatchesSelector";if(t[i])return i}}();return function(e,n){return e[t](n)}}))},137:function(t,e,n){var i,r;"undefined"!=typeof window&&window,void 0===(r="function"==typeof(i=function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var n=this._events=this._events||{},i=n[t]=n[t]||[];return-1==i.indexOf(e)&&i.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var n=this._onceEvents=this._onceEvents||{};return(n[t]=n[t]||{})[e]=!0,this}},e.off=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){var i=n.indexOf(e);return-1!=i&&n.splice(i,1),this}},e.emitEvent=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){n=n.slice(0),e=e||[];for(var i=this._onceEvents&&this._onceEvents[t],r=0;r<n.length;r++){var s=n[r];i&&i[s]&&(this.off(t,s),delete i[s]),s.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t})?i.call(e,n,e,t):i)||(t.exports=r)},606:t=>{var e=-1,n=1,i=0;function r(t,g,m,y,v){if(t===g)return t?[[i,t]]:[];if(null!=m){var w=function(t,e,n){var i="number"==typeof n?{index:n,length:0}:n.oldRange,r="number"==typeof n?null:n.newRange,s=t.length,o=e.length;if(0===i.length&&(null===r||0===r.length)){var a=i.index,l=t.slice(0,a),c=t.slice(a),u=r?r.index:null,h=a+o-s;if((null===u||u===h)&&!(h<0||h>o)){var d=e.slice(0,h);if((g=e.slice(h))===c){var f=Math.min(a,h);if((y=l.slice(0,f))===(w=d.slice(0,f)))return b(y,l.slice(f),d.slice(f),c)}}if(null===u||u===a){var p=a,g=(d=e.slice(0,p),e.slice(p));if(d===l){var m=Math.min(s-p,o-p);if((v=c.slice(c.length-m))===(E=g.slice(g.length-m)))return b(l,c.slice(0,c.length-m),g.slice(0,g.length-m),v)}}}if(i.length>0&&r&&0===r.length){var y=t.slice(0,i.index),v=t.slice(i.index+i.length);if(!(o<(f=y.length)+(m=v.length))){var w=e.slice(0,f),E=e.slice(o-m);if(y===w&&v===E)return b(y,t.slice(f,s-m),e.slice(f,o-m),v)}}return null}(t,g,m);if(w)return w}var E=o(t,g),_=t.substring(0,E);E=l(t=t.substring(E),g=g.substring(E));var q=t.substring(t.length-E),k=function(t,a){var c;if(!t)return[[n,a]];if(!a)return[[e,t]];var u=t.length>a.length?t:a,h=t.length>a.length?a:t,d=u.indexOf(h);if(-1!==d)return c=[[n,u.substring(0,d)],[i,h],[n,u.substring(d+h.length)]],t.length>a.length&&(c[0][0]=c[2][0]=e),c;if(1===h.length)return[[e,t],[n,a]];var f=function(t,e){var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;function r(t,e,n){for(var i,r,s,a,c=t.substring(n,n+Math.floor(t.length/4)),u=-1,h="";-1!==(u=e.indexOf(c,u+1));){var d=o(t.substring(n),e.substring(u)),f=l(t.substring(0,n),e.substring(0,u));h.length<f+d&&(h=e.substring(u-f,u)+e.substring(u,u+d),i=t.substring(0,n-f),r=t.substring(n+d),s=e.substring(0,u-f),a=e.substring(u+d))}return 2*h.length>=t.length?[i,r,s,a,h]:null}var s,a,c,u,h,d=r(n,i,Math.ceil(n.length/4)),f=r(n,i,Math.ceil(n.length/2));return d||f?(s=f?d&&d[4].length>f[4].length?d:f:d,t.length>e.length?(a=s[0],c=s[1],u=s[2],h=s[3]):(u=s[0],h=s[1],a=s[2],c=s[3]),[a,c,u,h,s[4]]):null}(t,a);if(f){var p=f[0],g=f[1],m=f[2],y=f[3],v=f[4],b=r(p,m),w=r(g,y);return b.concat([[i,v]],w)}return function(t,i){for(var r=t.length,o=i.length,a=Math.ceil((r+o)/2),l=a,c=2*a,u=new Array(c),h=new Array(c),d=0;d<c;d++)u[d]=-1,h[d]=-1;u[l+1]=0,h[l+1]=0;for(var f=r-o,p=f%2!=0,g=0,m=0,y=0,v=0,b=0;b<a;b++){for(var w=-b+g;w<=b-m;w+=2){for(var E=l+w,_=(I=w===-b||w!==b&&u[E-1]<u[E+1]?u[E+1]:u[E-1]+1)-w;I<r&&_<o&&t.charAt(I)===i.charAt(_);)I++,_++;if(u[E]=I,I>r)m+=2;else if(_>o)g+=2;else if(p&&(T=l+f-w)>=0&&T<c&&-1!==h[T]&&I>=(k=r-h[T]))return s(t,i,I,_)}for(var q=-b+y;q<=b-v;q+=2){for(var k,T=l+q,x=(k=q===-b||q!==b&&h[T-1]<h[T+1]?h[T+1]:h[T-1]+1)-q;k<r&&x<o&&t.charAt(r-k-1)===i.charAt(o-x-1);)k++,x++;if(h[T]=k,k>r)v+=2;else if(x>o)y+=2;else if(!p){var I;if((E=l+f-q)>=0&&E<c&&-1!==u[E])if(_=l+(I=u[E])-E,I>=(k=r-k))return s(t,i,I,_)}}}return[[e,t],[n,i]]}(t,a)}(t=t.substring(0,t.length-E),g=g.substring(0,g.length-E));return _&&k.unshift([i,_]),q&&k.push([i,q]),p(k,v),y&&function(t){for(var r=!1,s=[],o=0,g=null,m=0,y=0,v=0,b=0,w=0;m<t.length;)t[m][0]==i?(s[o++]=m,y=b,v=w,b=0,w=0,g=t[m][1]):(t[m][0]==n?b+=t[m][1].length:w+=t[m][1].length,g&&g.length<=Math.max(y,v)&&g.length<=Math.max(b,w)&&(t.splice(s[o-1],0,[e,g]),t[s[o-1]+1][0]=n,o--,m=--o>0?s[o-1]:-1,y=0,v=0,b=0,w=0,g=null,r=!0)),m++;for(r&&p(t),function(t){function e(t,e){if(!t||!e)return 6;var n=t.charAt(t.length-1),i=e.charAt(0),r=n.match(c),s=i.match(c),o=r&&n.match(u),a=s&&i.match(u),l=o&&n.match(h),p=a&&i.match(h),g=l&&t.match(d),m=p&&e.match(f);return g||m?5:l||p?4:r&&!o&&a?3:o||a?2:r||s?1:0}for(var n=1;n<t.length-1;){if(t[n-1][0]==i&&t[n+1][0]==i){var r=t[n-1][1],s=t[n][1],o=t[n+1][1],a=l(r,s);if(a){var p=s.substring(s.length-a);r=r.substring(0,r.length-a),s=p+s.substring(0,s.length-a),o=p+o}for(var g=r,m=s,y=o,v=e(r,s)+e(s,o);s.charAt(0)===o.charAt(0);){r+=s.charAt(0),s=s.substring(1)+o.charAt(0),o=o.substring(1);var b=e(r,s)+e(s,o);b>=v&&(v=b,g=r,m=s,y=o)}t[n-1][1]!=g&&(g?t[n-1][1]=g:(t.splice(n-1,1),n--),t[n][1]=m,y?t[n+1][1]=y:(t.splice(n+1,1),n--))}n++}}(t),m=1;m<t.length;){if(t[m-1][0]==e&&t[m][0]==n){var E=t[m-1][1],_=t[m][1],q=a(E,_),k=a(_,E);q>=k?(q>=E.length/2||q>=_.length/2)&&(t.splice(m,0,[i,_.substring(0,q)]),t[m-1][1]=E.substring(0,E.length-q),t[m+1][1]=_.substring(q),m++):(k>=E.length/2||k>=_.length/2)&&(t.splice(m,0,[i,E.substring(0,k)]),t[m-1][0]=n,t[m-1][1]=_.substring(0,_.length-k),t[m+1][0]=e,t[m+1][1]=E.substring(k),m++),m++}m++}}(k),k}function s(t,e,n,i){var s=t.substring(0,n),o=e.substring(0,i),a=t.substring(n),l=e.substring(i),c=r(s,o),u=r(a,l);return c.concat(u)}function o(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(s,r)==e.substring(s,r)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return g(t.charCodeAt(r-1))&&r--,r}function a(t,e){var n=t.length,i=e.length;if(0==n||0==i)return 0;n>i?t=t.substring(n-i):n<i&&(e=e.substring(0,n));var r=Math.min(n,i);if(t==e)return r;for(var s=0,o=1;;){var a=t.substring(r-o),l=e.indexOf(a);if(-1==l)return s;o+=l,0!=l&&t.substring(r-o)!=e.substring(0,o)||(s=o,o++)}}function l(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(t.length-r,t.length-s)==e.substring(e.length-r,e.length-s)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return m(t.charCodeAt(t.length-r))&&r--,r}var c=/[^a-zA-Z0-9]/,u=/\s/,h=/[\r\n]/,d=/\n\r?\n$/,f=/^\r?\n\r?\n/;function p(t,r){t.push([i,""]);for(var s,a=0,c=0,u=0,h="",d="";a<t.length;)if(a<t.length-1&&!t[a][1])t.splice(a,1);else switch(t[a][0]){case n:u++,d+=t[a][1],a++;break;case e:c++,h+=t[a][1],a++;break;case i:var f=a-u-c-1;if(r){if(f>=0&&v(t[f][1])){var g=t[f][1].slice(-1);if(t[f][1]=t[f][1].slice(0,-1),h=g+h,d=g+d,!t[f][1]){t.splice(f,1),a--;var m=f-1;t[m]&&t[m][0]===n&&(u++,d=t[m][1]+d,m--),t[m]&&t[m][0]===e&&(c++,h=t[m][1]+h,m--),f=m}}y(t[a][1])&&(g=t[a][1].charAt(0),t[a][1]=t[a][1].slice(1),h+=g,d+=g)}if(a<t.length-1&&!t[a][1]){t.splice(a,1);break}if(h.length>0||d.length>0){h.length>0&&d.length>0&&(0!==(s=o(d,h))&&(f>=0?t[f][1]+=d.substring(0,s):(t.splice(0,0,[i,d.substring(0,s)]),a++),d=d.substring(s),h=h.substring(s)),0!==(s=l(d,h))&&(t[a][1]=d.substring(d.length-s)+t[a][1],d=d.substring(0,d.length-s),h=h.substring(0,h.length-s)));var b=u+c;0===h.length&&0===d.length?(t.splice(a-b,b),a-=b):0===h.length?(t.splice(a-b,b,[n,d]),a=a-b+1):0===d.length?(t.splice(a-b,b,[e,h]),a=a-b+1):(t.splice(a-b,b,[e,h],[n,d]),a=a-b+2)}0!==a&&t[a-1][0]===i?(t[a-1][1]+=t[a][1],t.splice(a,1)):a++,u=0,c=0,h="",d=""}""===t[t.length-1][1]&&t.pop();var w=!1;for(a=1;a<t.length-1;)t[a-1][0]===i&&t[a+1][0]===i&&(t[a][1].substring(t[a][1].length-t[a-1][1].length)===t[a-1][1]?(t[a][1]=t[a-1][1]+t[a][1].substring(0,t[a][1].length-t[a-1][1].length),t[a+1][1]=t[a-1][1]+t[a+1][1],t.splice(a-1,1),w=!0):t[a][1].substring(0,t[a+1][1].length)==t[a+1][1]&&(t[a-1][1]+=t[a+1][1],t[a][1]=t[a][1].substring(t[a+1][1].length)+t[a+1][1],t.splice(a+1,1),w=!0)),a++;w&&p(t,r)}function g(t){return t>=55296&&t<=56319}function m(t){return t>=56320&&t<=57343}function y(t){return m(t.charCodeAt(0))}function v(t){return g(t.charCodeAt(t.length-1))}function b(t,r,s,o){return v(t)||y(o)?null:function(t){for(var e=[],n=0;n<t.length;n++)t[n][1].length>0&&e.push(t[n]);return e}([[i,t],[e,r],[n,s],[i,o]])}function w(t,e,n,i){return r(t,e,n,i,!0)}w.INSERT=n,w.DELETE=e,w.EQUAL=i,t.exports=w},977:(t,e,n)=>{var i,r;!function(s,o){i=[n(786)],r=function(t){return function(t,e){"use strict";var n={extend:function(t,e){for(var n in e)t[n]=e[n];return t},modulo:function(t,e){return(t%e+e)%e}},i=Array.prototype.slice;n.makeArray=function(t){return Array.isArray(t)?t:null==t?[]:"object"==typeof t&&"number"==typeof t.length?i.call(t):[t]},n.removeFrom=function(t,e){var n=t.indexOf(e);-1!=n&&t.splice(n,1)},n.getParent=function(t,n){for(;t.parentNode&&t!=document.body;)if(t=t.parentNode,e(t,n))return t},n.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},n.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},n.filterFindElements=function(t,i){t=n.makeArray(t);var r=[];return t.forEach((function(t){if(t instanceof HTMLElement)if(i){e(t,i)&&r.push(t);for(var n=t.querySelectorAll(i),s=0;s<n.length;s++)r.push(n[s])}else r.push(t)})),r},n.debounceMethod=function(t,e,n){n=n||100;var i=t.prototype[e],r=e+"Timeout";t.prototype[e]=function(){var t=this[r];clearTimeout(t);var e=arguments,s=this;this[r]=setTimeout((function(){i.apply(s,e),delete s[r]}),n)}},n.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},n.toDashed=function(t){return t.replace(/(.)([A-Z])/g,(function(t,e,n){return e+"-"+n})).toLowerCase()};var r=t.console;return n.htmlInit=function(e,i){n.docReady((function(){var s=n.toDashed(i),o="data-"+s,a=document.querySelectorAll("["+o+"]"),l=document.querySelectorAll(".js-"+s),c=n.makeArray(a).concat(n.makeArray(l)),u=o+"-options",h=t.jQuery;c.forEach((function(t){var n,s=t.getAttribute(o)||t.getAttribute(u);try{n=s&&JSON.parse(s)}catch(e){return void(r&&r.error("Error parsing "+o+" on "+t.className+": "+e))}var a=new e(t,n);h&&h.data(t,i,a)}))}))},n}(s,t)}.apply(e,i),void 0===r||(t.exports=r)}(window)},485:(t,e,n)=>{var i,r;window,void 0===(r="function"==typeof(i=function(){"use strict";function t(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}var e="undefined"==typeof console?function(){}:function(t){console.error(t)},n=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],i=n.length;function r(t){var n=getComputedStyle(t);return n||e("Style returned "+n+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),n}var s,o=!1;function a(e){if(function(){if(!o){o=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var n=document.body||document.documentElement;n.appendChild(e);var i=r(e);s=200==Math.round(t(i.width)),a.isBoxSizeOuter=s,n.removeChild(e)}}(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var l=r(e);if("none"==l.display)return function(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<i;e++)t[n[e]]=0;return t}();var c={};c.width=e.offsetWidth,c.height=e.offsetHeight;for(var u=c.isBorderBox="border-box"==l.boxSizing,h=0;h<i;h++){var d=n[h],f=l[d],p=parseFloat(f);c[d]=isNaN(p)?0:p}var g=c.paddingLeft+c.paddingRight,m=c.paddingTop+c.paddingBottom,y=c.marginLeft+c.marginRight,v=c.marginTop+c.marginBottom,b=c.borderLeftWidth+c.borderRightWidth,w=c.borderTopWidth+c.borderBottomWidth,E=u&&s,_=t(l.width);!1!==_&&(c.width=_+(E?0:g+b));var q=t(l.height);return!1!==q&&(c.height=q+(E?0:m+w)),c.innerWidth=c.width-(g+b),c.innerHeight=c.height-(m+w),c.outerWidth=c.width+y,c.outerHeight=c.height+v,c}}return a})?i.call(e,n,e,t):i)||(t.exports=r)},193:(t,e,n)=>{t=n.nmd(t);var i="__lodash_hash_undefined__",r=9007199254740991,s="[object Arguments]",o="[object Boolean]",a="[object Date]",l="[object Function]",c="[object GeneratorFunction]",u="[object Map]",h="[object Number]",d="[object Object]",f="[object Promise]",p="[object RegExp]",g="[object Set]",m="[object String]",y="[object Symbol]",v="[object WeakMap]",b="[object ArrayBuffer]",w="[object DataView]",E="[object Float32Array]",_="[object Float64Array]",q="[object Int8Array]",k="[object Int16Array]",T="[object Int32Array]",x="[object Uint8Array]",I="[object Uint8ClampedArray]",S="[object Uint16Array]",A="[object Uint32Array]",N=/\w*$/,C=/^\[object .+?Constructor\]$/,O=/^(?:0|[1-9]\d*)$/,L={};L[s]=L["[object Array]"]=L[b]=L[w]=L[o]=L[a]=L[E]=L[_]=L[q]=L[k]=L[T]=L[u]=L[h]=L[d]=L[p]=L[g]=L[m]=L[y]=L[x]=L[I]=L[S]=L[A]=!0,L["[object Error]"]=L[l]=L[v]=!1;var R="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,D="object"==typeof self&&self&&self.Object===Object&&self,M=R||D||Function("return this")(),P=e&&!e.nodeType&&e,j=P&&t&&!t.nodeType&&t,U=j&&j.exports===P;function F(t,e){return t.set(e[0],e[1]),t}function V(t,e){return t.add(e),t}function B(t,e,n,i){var r=-1,s=t?t.length:0;for(i&&s&&(n=t[++r]);++r<s;)n=e(n,t[r],r,t);return n}function z(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function H(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function $(t,e){return function(n){return t(e(n))}}function W(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var K,G=Array.prototype,Q=Function.prototype,Y=Object.prototype,X=M["__core-js_shared__"],J=(K=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||""))?"Symbol(src)_1."+K:"",Z=Q.toString,tt=Y.hasOwnProperty,et=Y.toString,nt=RegExp("^"+Z.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),it=U?M.Buffer:void 0,rt=M.Symbol,st=M.Uint8Array,ot=$(Object.getPrototypeOf,Object),at=Object.create,lt=Y.propertyIsEnumerable,ct=G.splice,ut=Object.getOwnPropertySymbols,ht=it?it.isBuffer:void 0,dt=$(Object.keys,Object),ft=Mt(M,"DataView"),pt=Mt(M,"Map"),gt=Mt(M,"Promise"),mt=Mt(M,"Set"),yt=Mt(M,"WeakMap"),vt=Mt(Object,"create"),bt=Vt(ft),wt=Vt(pt),Et=Vt(gt),_t=Vt(mt),qt=Vt(yt),kt=rt?rt.prototype:void 0,Tt=kt?kt.valueOf:void 0;function xt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function It(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function St(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function At(t){this.__data__=new It(t)}function Nt(t,e,n){var i=t[e];tt.call(t,e)&&Bt(i,n)&&(void 0!==n||e in t)||(t[e]=n)}function Ct(t,e){for(var n=t.length;n--;)if(Bt(t[n][0],e))return n;return-1}function Ot(t,e,n,i,r,f,v){var C;if(i&&(C=f?i(t,r,f,v):i(t)),void 0!==C)return C;if(!Kt(t))return t;var O=zt(t);if(O){if(C=function(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&tt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!e)return function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}(t,C)}else{var R=jt(t),D=R==l||R==c;if($t(t))return function(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}(t,e);if(R==d||R==s||D&&!f){if(z(t))return f?t:{};if(C=function(t){return"function"!=typeof t.constructor||Ft(t)?{}:Kt(e=ot(t))?at(e):{};var e}(D?{}:t),!e)return function(t,e){return Rt(t,Pt(t),e)}(t,function(t,e){return t&&Rt(e,Gt(e),t)}(C,t))}else{if(!L[R])return f?t:{};C=function(t,e,n,i){var r,s=t.constructor;switch(e){case b:return Lt(t);case o:case a:return new s(+t);case w:return function(t,e){var n=e?Lt(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,i);case E:case _:case q:case k:case T:case x:case I:case S:case A:return function(t,e){var n=e?Lt(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,i);case u:return function(t,e,n){return B(e?n(H(t),!0):H(t),F,new t.constructor)}(t,i,n);case h:case m:return new s(t);case p:return function(t){var e=new t.constructor(t.source,N.exec(t));return e.lastIndex=t.lastIndex,e}(t);case g:return function(t,e,n){return B(e?n(W(t),!0):W(t),V,new t.constructor)}(t,i,n);case y:return r=t,Tt?Object(Tt.call(r)):{}}}(t,R,Ot,e)}}v||(v=new At);var M=v.get(t);if(M)return M;if(v.set(t,C),!O)var P=n?function(t){return function(t,e,n){var i=e(t);return zt(t)?i:function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}(i,n(t))}(t,Gt,Pt)}(t):Gt(t);return function(t,e){for(var n=-1,i=t?t.length:0;++n<i&&!1!==e(t[n],n););}(P||t,(function(r,s){P&&(r=t[s=r]),Nt(C,s,Ot(r,e,n,i,s,t,v))})),C}function Lt(t){var e=new t.constructor(t.byteLength);return new st(e).set(new st(t)),e}function Rt(t,e,n,i){n||(n={});for(var r=-1,s=e.length;++r<s;){var o=e[r],a=i?i(n[o],t[o],o,n,t):void 0;Nt(n,o,void 0===a?t[o]:a)}return n}function Dt(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function Mt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Kt(t)||(e=t,J&&J in e))&&(Wt(t)||z(t)?nt:C).test(Vt(t));var e}(n)?n:void 0}xt.prototype.clear=function(){this.__data__=vt?vt(null):{}},xt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},xt.prototype.get=function(t){var e=this.__data__;if(vt){var n=e[t];return n===i?void 0:n}return tt.call(e,t)?e[t]:void 0},xt.prototype.has=function(t){var e=this.__data__;return vt?void 0!==e[t]:tt.call(e,t)},xt.prototype.set=function(t,e){return this.__data__[t]=vt&&void 0===e?i:e,this},It.prototype.clear=function(){this.__data__=[]},It.prototype.delete=function(t){var e=this.__data__,n=Ct(e,t);return!(n<0||(n==e.length-1?e.pop():ct.call(e,n,1),0))},It.prototype.get=function(t){var e=this.__data__,n=Ct(e,t);return n<0?void 0:e[n][1]},It.prototype.has=function(t){return Ct(this.__data__,t)>-1},It.prototype.set=function(t,e){var n=this.__data__,i=Ct(n,t);return i<0?n.push([t,e]):n[i][1]=e,this},St.prototype.clear=function(){this.__data__={hash:new xt,map:new(pt||It),string:new xt}},St.prototype.delete=function(t){return Dt(this,t).delete(t)},St.prototype.get=function(t){return Dt(this,t).get(t)},St.prototype.has=function(t){return Dt(this,t).has(t)},St.prototype.set=function(t,e){return Dt(this,t).set(t,e),this},At.prototype.clear=function(){this.__data__=new It},At.prototype.delete=function(t){return this.__data__.delete(t)},At.prototype.get=function(t){return this.__data__.get(t)},At.prototype.has=function(t){return this.__data__.has(t)},At.prototype.set=function(t,e){var n=this.__data__;if(n instanceof It){var i=n.__data__;if(!pt||i.length<199)return i.push([t,e]),this;n=this.__data__=new St(i)}return n.set(t,e),this};var Pt=ut?$(ut,Object):function(){return[]},jt=function(t){return et.call(t)};function Ut(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||O.test(t))&&t>-1&&t%1==0&&t<e}function Ft(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Y)}function Vt(t){if(null!=t){try{return Z.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Bt(t,e){return t===e||t!=t&&e!=e}(ft&&jt(new ft(new ArrayBuffer(1)))!=w||pt&&jt(new pt)!=u||gt&&jt(gt.resolve())!=f||mt&&jt(new mt)!=g||yt&&jt(new yt)!=v)&&(jt=function(t){var e=et.call(t),n=e==d?t.constructor:void 0,i=n?Vt(n):void 0;if(i)switch(i){case bt:return w;case wt:return u;case Et:return f;case _t:return g;case qt:return v}return e});var zt=Array.isArray;function Ht(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!Wt(t)}var $t=ht||function(){return!1};function Wt(t){var e=Kt(t)?et.call(t):"";return e==l||e==c}function Kt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Gt(t){return Ht(t)?function(t,e){var n=zt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&Ht(t)}(t)&&tt.call(t,"callee")&&(!lt.call(t,"callee")||et.call(t)==s)}(t)?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],i=n.length,r=!!i;for(var o in t)!e&&!tt.call(t,o)||r&&("length"==o||Ut(o,i))||n.push(o);return n}(t):function(t){if(!Ft(t))return dt(t);var e=[];for(var n in Object(t))tt.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}t.exports=function(t){return Ot(t,!0,!0)}},142:(t,e,n)=>{t=n.nmd(t);var i="__lodash_hash_undefined__",r=1,s=2,o=9007199254740991,a="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",h="[object Date]",d="[object Error]",f="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",y="[object Null]",v="[object Object]",b="[object Promise]",w="[object Proxy]",E="[object RegExp]",_="[object Set]",q="[object String]",k="[object Undefined]",T="[object WeakMap]",x="[object ArrayBuffer]",I="[object DataView]",S=/^\[object .+?Constructor\]$/,A=/^(?:0|[1-9]\d*)$/,N={};N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N[a]=N[l]=N[x]=N[u]=N[I]=N[h]=N[d]=N[f]=N[g]=N[m]=N[v]=N[E]=N[_]=N[q]=N[T]=!1;var C="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,O="object"==typeof self&&self&&self.Object===Object&&self,L=C||O||Function("return this")(),R=e&&!e.nodeType&&e,D=R&&t&&!t.nodeType&&t,M=D&&D.exports===R,P=M&&C.process,j=function(){try{return P&&P.binding&&P.binding("util")}catch(t){}}(),U=j&&j.isTypedArray;function F(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function V(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function B(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var z,H,$,W=Array.prototype,K=Function.prototype,G=Object.prototype,Q=L["__core-js_shared__"],Y=K.toString,X=G.hasOwnProperty,J=(z=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"",Z=G.toString,tt=RegExp("^"+Y.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=M?L.Buffer:void 0,nt=L.Symbol,it=L.Uint8Array,rt=G.propertyIsEnumerable,st=W.splice,ot=nt?nt.toStringTag:void 0,at=Object.getOwnPropertySymbols,lt=et?et.isBuffer:void 0,ct=(H=Object.keys,$=Object,function(t){return H($(t))}),ut=Dt(L,"DataView"),ht=Dt(L,"Map"),dt=Dt(L,"Promise"),ft=Dt(L,"Set"),pt=Dt(L,"WeakMap"),gt=Dt(Object,"create"),mt=Ut(ut),yt=Ut(ht),vt=Ut(dt),bt=Ut(ft),wt=Ut(pt),Et=nt?nt.prototype:void 0,_t=Et?Et.valueOf:void 0;function qt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function kt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Tt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function xt(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Tt;++e<n;)this.add(t[e])}function It(t){var e=this.__data__=new kt(t);this.size=e.size}function St(t,e){for(var n=t.length;n--;)if(Ft(t[n][0],e))return n;return-1}function At(t){return null==t?void 0===t?k:y:ot&&ot in Object(t)?function(t){var e=X.call(t,ot),n=t[ot];try{t[ot]=void 0;var i=!0}catch(t){}var r=Z.call(t);return i&&(e?t[ot]=n:delete t[ot]),r}(t):function(t){return Z.call(t)}(t)}function Nt(t){return Kt(t)&&At(t)==a}function Ct(t,e,n,i,o){return t===e||(null==t||null==e||!Kt(t)&&!Kt(e)?t!=t&&e!=e:function(t,e,n,i,o,c){var f=Bt(t),p=Bt(e),y=f?l:Pt(t),b=p?l:Pt(e),w=(y=y==a?v:y)==v,k=(b=b==a?v:b)==v,T=y==b;if(T&&zt(t)){if(!zt(e))return!1;f=!0,w=!1}if(T&&!w)return c||(c=new It),f||Gt(t)?Ot(t,e,n,i,o,c):function(t,e,n,i,o,a,l){switch(n){case I:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!a(new it(t),new it(e)));case u:case h:case m:return Ft(+t,+e);case d:return t.name==e.name&&t.message==e.message;case E:case q:return t==e+"";case g:var c=V;case _:var f=i&r;if(c||(c=B),t.size!=e.size&&!f)return!1;var p=l.get(t);if(p)return p==e;i|=s,l.set(t,e);var y=Ot(c(t),c(e),i,o,a,l);return l.delete(t),y;case"[object Symbol]":if(_t)return _t.call(t)==_t.call(e)}return!1}(t,e,y,n,i,o,c);if(!(n&r)){var S=w&&X.call(t,"__wrapped__"),A=k&&X.call(e,"__wrapped__");if(S||A){var N=S?t.value():t,C=A?e.value():e;return c||(c=new It),o(N,C,n,i,c)}}return!!T&&(c||(c=new It),function(t,e,n,i,s,o){var a=n&r,l=Lt(t),c=l.length;if(c!=Lt(e).length&&!a)return!1;for(var u=c;u--;){var h=l[u];if(!(a?h in e:X.call(e,h)))return!1}var d=o.get(t);if(d&&o.get(e))return d==e;var f=!0;o.set(t,e),o.set(e,t);for(var p=a;++u<c;){var g=t[h=l[u]],m=e[h];if(i)var y=a?i(m,g,h,e,t,o):i(g,m,h,t,e,o);if(!(void 0===y?g===m||s(g,m,n,i,o):y)){f=!1;break}p||(p="constructor"==h)}if(f&&!p){var v=t.constructor,b=e.constructor;v==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(f=!1)}return o.delete(t),o.delete(e),f}(t,e,n,i,o,c))}(t,e,n,i,Ct,o))}function Ot(t,e,n,i,o,a){var l=n&r,c=t.length,u=e.length;if(c!=u&&!(l&&u>c))return!1;var h=a.get(t);if(h&&a.get(e))return h==e;var d=-1,f=!0,p=n&s?new xt:void 0;for(a.set(t,e),a.set(e,t);++d<c;){var g=t[d],m=e[d];if(i)var y=l?i(m,g,d,e,t,a):i(g,m,d,t,e,a);if(void 0!==y){if(y)continue;f=!1;break}if(p){if(!F(e,(function(t,e){if(r=e,!p.has(r)&&(g===t||o(g,t,n,i,a)))return p.push(e);var r}))){f=!1;break}}else if(g!==m&&!o(g,m,n,i,a)){f=!1;break}}return a.delete(t),a.delete(e),f}function Lt(t){return function(t,e,n){var i=e(t);return Bt(t)?i:function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}(i,n(t))}(t,Qt,Mt)}function Rt(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function Dt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Wt(t)||function(t){return!!J&&J in t}(t))&&(Ht(t)?tt:S).test(Ut(t))}(n)?n:void 0}qt.prototype.clear=function(){this.__data__=gt?gt(null):{},this.size=0},qt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},qt.prototype.get=function(t){var e=this.__data__;if(gt){var n=e[t];return n===i?void 0:n}return X.call(e,t)?e[t]:void 0},qt.prototype.has=function(t){var e=this.__data__;return gt?void 0!==e[t]:X.call(e,t)},qt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=gt&&void 0===e?i:e,this},kt.prototype.clear=function(){this.__data__=[],this.size=0},kt.prototype.delete=function(t){var e=this.__data__,n=St(e,t);return!(n<0||(n==e.length-1?e.pop():st.call(e,n,1),--this.size,0))},kt.prototype.get=function(t){var e=this.__data__,n=St(e,t);return n<0?void 0:e[n][1]},kt.prototype.has=function(t){return St(this.__data__,t)>-1},kt.prototype.set=function(t,e){var n=this.__data__,i=St(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},Tt.prototype.clear=function(){this.size=0,this.__data__={hash:new qt,map:new(ht||kt),string:new qt}},Tt.prototype.delete=function(t){var e=Rt(this,t).delete(t);return this.size-=e?1:0,e},Tt.prototype.get=function(t){return Rt(this,t).get(t)},Tt.prototype.has=function(t){return Rt(this,t).has(t)},Tt.prototype.set=function(t,e){var n=Rt(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},xt.prototype.add=xt.prototype.push=function(t){return this.__data__.set(t,i),this},xt.prototype.has=function(t){return this.__data__.has(t)},It.prototype.clear=function(){this.__data__=new kt,this.size=0},It.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},It.prototype.get=function(t){return this.__data__.get(t)},It.prototype.has=function(t){return this.__data__.has(t)},It.prototype.set=function(t,e){var n=this.__data__;if(n instanceof kt){var i=n.__data__;if(!ht||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Tt(i)}return n.set(t,e),this.size=n.size,this};var Mt=at?function(t){return null==t?[]:(t=Object(t),function(e,n){for(var i=-1,r=null==e?0:e.length,s=0,o=[];++i<r;){var a=e[i];l=a,rt.call(t,l)&&(o[s++]=a)}var l;return o}(at(t)))}:function(){return[]},Pt=At;function jt(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||A.test(t))&&t>-1&&t%1==0&&t<e}function Ut(t){if(null!=t){try{return Y.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ft(t,e){return t===e||t!=t&&e!=e}(ut&&Pt(new ut(new ArrayBuffer(1)))!=I||ht&&Pt(new ht)!=g||dt&&Pt(dt.resolve())!=b||ft&&Pt(new ft)!=_||pt&&Pt(new pt)!=T)&&(Pt=function(t){var e=At(t),n=e==v?t.constructor:void 0,i=n?Ut(n):"";if(i)switch(i){case mt:return I;case yt:return g;case vt:return b;case bt:return _;case wt:return T}return e});var Vt=Nt(function(){return arguments}())?Nt:function(t){return Kt(t)&&X.call(t,"callee")&&!rt.call(t,"callee")},Bt=Array.isArray,zt=lt||function(){return!1};function Ht(t){if(!Wt(t))return!1;var e=At(t);return e==f||e==p||e==c||e==w}function $t(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}function Wt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Kt(t){return null!=t&&"object"==typeof t}var Gt=U?function(t){return function(e){return t(e)}}(U):function(t){return Kt(t)&&$t(t.length)&&!!N[At(t)]};function Qt(t){return null!=(e=t)&&$t(e.length)&&!Ht(e)?function(t,e){var n=Bt(t),i=!n&&Vt(t),r=!n&&!i&&zt(t),s=!n&&!i&&!r&&Gt(t),o=n||i||r||s,a=o?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],l=a.length;for(var c in t)!e&&!X.call(t,c)||o&&("length"==c||r&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||jt(c,l))||a.push(c);return a}(t):function(t){if(n=(e=t)&&e.constructor,e!==("function"==typeof n&&n.prototype||G))return ct(t);var e,n,i=[];for(var r in Object(t))X.call(t,r)&&"constructor"!=r&&i.push(r);return i}(t);var e}t.exports=function(t,e){return Ct(t,e)}},994:(t,e,n)=>{var i,r,s;window,r=[n(831),n(485)],void 0===(s="function"==typeof(i=function(t,e){"use strict";var n=t.create("masonry");n.compatOptions.fitWidth="isFitWidth";var i=n.prototype;return i._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var t=0;t<this.cols;t++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0},i.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],n=t&&t.element;this.columnWidth=n&&e(n).outerWidth||this.containerWidth}var i=this.columnWidth+=this.gutter,r=this.containerWidth+this.gutter,s=r/i,o=i-r%i;s=Math[o&&o<1?"round":"floor"](s),this.cols=Math.max(s,1)},i.getContainerWidth=function(){var t=this._getOption("fitWidth")?this.element.parentNode:this.element,n=e(t);this.containerWidth=n&&n.innerWidth},i._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,n=Math[e&&e<1?"round":"ceil"](t.size.outerWidth/this.columnWidth);n=Math.min(n,this.cols);for(var i=this[this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition"](n,t),r={x:this.columnWidth*i.col,y:i.y},s=i.y+t.size.outerHeight,o=n+i.col,a=i.col;a<o;a++)this.colYs[a]=s;return r},i._getTopColPosition=function(t){var e=this._getTopColGroup(t),n=Math.min.apply(Math,e);return{col:e.indexOf(n),y:n}},i._getTopColGroup=function(t){if(t<2)return this.colYs;for(var e=[],n=this.cols+1-t,i=0;i<n;i++)e[i]=this._getColGroupY(i,t);return e},i._getColGroupY=function(t,e){if(e<2)return this.colYs[t];var n=this.colYs.slice(t,t+e);return Math.max.apply(Math,n)},i._getHorizontalColPosition=function(t,e){var n=this.horizontalColIndex%this.cols;n=t>1&&n+t>this.cols?0:n;var i=e.size.outerWidth&&e.size.outerHeight;return this.horizontalColIndex=i?n+t:this.horizontalColIndex,{col:n,y:this._getColGroupY(n,t)}},i._manageStamp=function(t){var n=e(t),i=this._getElementOffset(t),r=this._getOption("originLeft")?i.left:i.right,s=r+n.outerWidth,o=Math.floor(r/this.columnWidth);o=Math.max(0,o);var a=Math.floor(s/this.columnWidth);a-=s%this.columnWidth?0:1,a=Math.min(this.cols-1,a);for(var l=(this._getOption("originTop")?i.top:i.bottom)+n.outerHeight,c=o;c<=a;c++)this.colYs[c]=Math.max(l,this.colYs[c])},i._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this._getOption("fitWidth")&&(t.width=this._getContainerFitWidth()),t},i._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return(this.cols-t)*this.columnWidth-this.gutter},i.needsResizeLayout=function(){var t=this.containerWidth;return this.getContainerWidth(),t!=this.containerWidth},n})?i.apply(e,r):i)||(t.exports=s)},169:(t,e,n)=>{var i,r,s;window,r=[n(137),n(485)],void 0===(s="function"==typeof(i=function(t,e){"use strict";var n=document.documentElement.style,i="string"==typeof n.transition?"transition":"WebkitTransition",r="string"==typeof n.transform?"transform":"WebkitTransform",s={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[i],o={transform:r,transition:i,transitionDuration:i+"Duration",transitionProperty:i+"Property",transitionDelay:i+"Delay"};function a(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}var l=a.prototype=Object.create(t.prototype);l.constructor=a,l._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},l.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},l.getSize=function(){this.size=e(this.element)},l.css=function(t){var e=this.element.style;for(var n in t)e[o[n]||n]=t[n]},l.getPosition=function(){var t=getComputedStyle(this.element),e=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop"),i=t[e?"left":"right"],r=t[n?"top":"bottom"],s=parseFloat(i),o=parseFloat(r),a=this.layout.size;-1!=i.indexOf("%")&&(s=s/100*a.width),-1!=r.indexOf("%")&&(o=o/100*a.height),s=isNaN(s)?0:s,o=isNaN(o)?0:o,s-=e?a.paddingLeft:a.paddingRight,o-=n?a.paddingTop:a.paddingBottom,this.position.x=s,this.position.y=o},l.layoutPosition=function(){var t=this.layout.size,e={},n=this.layout._getOption("originLeft"),i=this.layout._getOption("originTop"),r=n?"paddingLeft":"paddingRight",s=n?"left":"right",o=n?"right":"left",a=this.position.x+t[r];e[s]=this.getXValue(a),e[o]="";var l=i?"paddingTop":"paddingBottom",c=i?"top":"bottom",u=i?"bottom":"top",h=this.position.y+t[l];e[c]=this.getYValue(h),e[u]="",this.css(e),this.emitEvent("layout",[this])},l.getXValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!e?t/this.layout.size.width*100+"%":t+"px"},l.getYValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&e?t/this.layout.size.height*100+"%":t+"px"},l._transitionTo=function(t,e){this.getPosition();var n=this.position.x,i=this.position.y,r=t==this.position.x&&e==this.position.y;if(this.setPosition(t,e),!r||this.isTransitioning){var s=t-n,o=e-i,a={};a.transform=this.getTranslate(s,o),this.transition({to:a,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},l.getTranslate=function(t,e){return"translate3d("+(t=this.layout._getOption("originLeft")?t:-t)+"px, "+(e=this.layout._getOption("originTop")?e:-e)+"px, 0)"},l.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},l.moveTo=l._transitionTo,l.setPosition=function(t,e){this.position.x=parseFloat(t),this.position.y=parseFloat(e)},l._nonTransition=function(t){for(var e in this.css(t.to),t.isCleaning&&this._removeStyles(t.to),t.onTransitionEnd)t.onTransitionEnd[e].call(this)},l.transition=function(t){if(parseFloat(this.layout.options.transitionDuration)){var e=this._transn;for(var n in t.onTransitionEnd)e.onEnd[n]=t.onTransitionEnd[n];for(n in t.to)e.ingProperties[n]=!0,t.isCleaning&&(e.clean[n]=!0);t.from&&(this.css(t.from),this.element.offsetHeight),this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0}else this._nonTransition(t)};var c="opacity,"+r.replace(/([A-Z])/g,(function(t){return"-"+t.toLowerCase()}));l.enableTransition=function(){if(!this.isTransitioning){var t=this.layout.options.transitionDuration;t="number"==typeof t?t+"ms":t,this.css({transitionProperty:c,transitionDuration:t,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(s,this,!1)}},l.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},l.onotransitionend=function(t){this.ontransitionend(t)};var u={"-webkit-transform":"transform"};l.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,n=u[t.propertyName]||t.propertyName;delete e.ingProperties[n],function(t){for(var e in t)return!1;return!0}(e.ingProperties)&&this.disableTransition(),n in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[n]),n in e.onEnd&&(e.onEnd[n].call(this),delete e.onEnd[n]),this.emitEvent("transitionEnd",[this])}},l.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(s,this,!1),this.isTransitioning=!1},l._removeStyles=function(t){var e={};for(var n in t)e[n]="";this.css(e)};var h={transitionProperty:"",transitionDuration:"",transitionDelay:""};return l.removeTransitionStyles=function(){this.css(h)},l.stagger=function(t){t=isNaN(t)?0:t,this.staggerDelay=t+"ms"},l.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},l.remove=function(){i&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",(function(){this.removeElem()})),this.hide()):this.removeElem()},l.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0,onTransitionEnd:e})},l.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},l.getHideRevealTransitionEndProperty=function(t){var e=this.layout.options[t];if(e.opacity)return"opacity";for(var n in e)return n},l.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:e})},l.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},l.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},a})?i.apply(e,r):i)||(t.exports=s)},831:(t,e,n)=>{var i,r;!function(s,o){"use strict";i=[n(137),n(485),n(977),n(169)],r=function(t,e,n,i){return function(t,e,n,i,r){var s=t.console,o=t.jQuery,a=function(){},l=0,c={};function u(t,e){var n=i.getQueryElement(t);if(n){this.element=n,o&&(this.$element=o(this.element)),this.options=i.extend({},this.constructor.defaults),this.option(e);var r=++l;this.element.outlayerGUID=r,c[r]=this,this._create(),this._getOption("initLayout")&&this.layout()}else s&&s.error("Bad element for "+this.constructor.namespace+": "+(n||t))}u.namespace="outlayer",u.Item=r,u.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var h=u.prototype;function d(t){function e(){t.apply(this,arguments)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}i.extend(h,e.prototype),h.option=function(t){i.extend(this.options,t)},h._getOption=function(t){var e=this.constructor.compatOptions[t];return e&&void 0!==this.options[e]?this.options[e]:this.options[t]},u.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},h._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),i.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},h.reloadItems=function(){this.items=this._itemize(this.element.children)},h._itemize=function(t){for(var e=this._filterFindItemElements(t),n=this.constructor.Item,i=[],r=0;r<e.length;r++){var s=new n(e[r],this);i.push(s)}return i},h._filterFindItemElements=function(t){return i.filterFindElements(t,this.options.itemSelector)},h.getItemElements=function(){return this.items.map((function(t){return t.element}))},h.layout=function(){this._resetLayout(),this._manageStamps();var t=this._getOption("layoutInstant"),e=void 0!==t?t:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0},h._init=h.layout,h._resetLayout=function(){this.getSize()},h.getSize=function(){this.size=n(this.element)},h._getMeasurement=function(t,e){var i,r=this.options[t];r?("string"==typeof r?i=this.element.querySelector(r):r instanceof HTMLElement&&(i=r),this[t]=i?n(i)[e]:r):this[t]=0},h.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},h._getItemsForLayout=function(t){return t.filter((function(t){return!t.isIgnored}))},h._layoutItems=function(t,e){if(this._emitCompleteOnItems("layout",t),t&&t.length){var n=[];t.forEach((function(t){var i=this._getItemLayoutPosition(t);i.item=t,i.isInstant=e||t.isLayoutInstant,n.push(i)}),this),this._processLayoutQueue(n)}},h._getItemLayoutPosition=function(){return{x:0,y:0}},h._processLayoutQueue=function(t){this.updateStagger(),t.forEach((function(t,e){this._positionItem(t.item,t.x,t.y,t.isInstant,e)}),this)},h.updateStagger=function(){var t=this.options.stagger;if(null!=t)return this.stagger=function(t){if("number"==typeof t)return t;var e=t.match(/(^\d*\.?\d*)(\w*)/),n=e&&e[1],i=e&&e[2];return n.length?(n=parseFloat(n))*(f[i]||1):0}(t),this.stagger;this.stagger=0},h._positionItem=function(t,e,n,i,r){i?t.goTo(e,n):(t.stagger(r*this.stagger),t.moveTo(e,n))},h._postLayout=function(){this.resizeContainer()},h.resizeContainer=function(){if(this._getOption("resizeContainer")){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))}},h._getContainerSize=a,h._setContainerMeasure=function(t,e){if(void 0!==t){var n=this.size;n.isBorderBox&&(t+=e?n.paddingLeft+n.paddingRight+n.borderLeftWidth+n.borderRightWidth:n.paddingBottom+n.paddingTop+n.borderTopWidth+n.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},h._emitCompleteOnItems=function(t,e){var n=this;function i(){n.dispatchEvent(t+"Complete",null,[e])}var r=e.length;if(e&&r){var s=0;e.forEach((function(e){e.once(t,o)}))}else i();function o(){++s==r&&i()}},h.dispatchEvent=function(t,e,n){var i=e?[e].concat(n):n;if(this.emitEvent(t,i),o)if(this.$element=this.$element||o(this.element),e){var r=o.Event(e);r.type=t,this.$element.trigger(r,n)}else this.$element.trigger(t,n)},h.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},h.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},h.stamp=function(t){(t=this._find(t))&&(this.stamps=this.stamps.concat(t),t.forEach(this.ignore,this))},h.unstamp=function(t){(t=this._find(t))&&t.forEach((function(t){i.removeFrom(this.stamps,t),this.unignore(t)}),this)},h._find=function(t){if(t)return"string"==typeof t&&(t=this.element.querySelectorAll(t)),i.makeArray(t)},h._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},h._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},h._manageStamp=a,h._getElementOffset=function(t){var e=t.getBoundingClientRect(),i=this._boundingRect,r=n(t);return{left:e.left-i.left-r.marginLeft,top:e.top-i.top-r.marginTop,right:i.right-e.right-r.marginRight,bottom:i.bottom-e.bottom-r.marginBottom}},h.handleEvent=i.handleEvent,h.bindResize=function(){t.addEventListener("resize",this),this.isResizeBound=!0},h.unbindResize=function(){t.removeEventListener("resize",this),this.isResizeBound=!1},h.onresize=function(){this.resize()},i.debounceMethod(u,"onresize",100),h.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},h.needsResizeLayout=function(){var t=n(this.element);return this.size&&t&&t.innerWidth!==this.size.innerWidth},h.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},h.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},h.prepended=function(t){var e=this._itemize(t);if(e.length){var n=this.items.slice(0);this.items=e.concat(n),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(n)}},h.reveal=function(t){if(this._emitCompleteOnItems("reveal",t),t&&t.length){var e=this.updateStagger();t.forEach((function(t,n){t.stagger(n*e),t.reveal()}))}},h.hide=function(t){if(this._emitCompleteOnItems("hide",t),t&&t.length){var e=this.updateStagger();t.forEach((function(t,n){t.stagger(n*e),t.hide()}))}},h.revealItemElements=function(t){var e=this.getItems(t);this.reveal(e)},h.hideItemElements=function(t){var e=this.getItems(t);this.hide(e)},h.getItem=function(t){for(var e=0;e<this.items.length;e++){var n=this.items[e];if(n.element==t)return n}},h.getItems=function(t){t=i.makeArray(t);var e=[];return t.forEach((function(t){var n=this.getItem(t);n&&e.push(n)}),this),e},h.remove=function(t){var e=this.getItems(t);this._emitCompleteOnItems("remove",e),e&&e.length&&e.forEach((function(t){t.remove(),i.removeFrom(this.items,t)}),this)},h.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="",this.items.forEach((function(t){t.destroy()})),this.unbindResize();var e=this.element.outlayerGUID;delete c[e],delete this.element.outlayerGUID,o&&o.removeData(this.element,this.constructor.namespace)},u.data=function(t){var e=(t=i.getQueryElement(t))&&t.outlayerGUID;return e&&c[e]},u.create=function(t,e){var n=d(u);return n.defaults=i.extend({},u.defaults),i.extend(n.defaults,e),n.compatOptions=i.extend({},u.compatOptions),n.namespace=t,n.data=u.data,n.Item=d(r),i.htmlInit(n,t),o&&o.bridget&&o.bridget(t,n),n};var f={ms:1,s:1e3};return u.Item=r,u}(s,t,e,n,i)}.apply(e,i),void 0===r||(t.exports=r)}(window)},106:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(193),r=n(142);var s;!function(t){t.compose=function(t={},e={},n=!1){"object"!=typeof t&&(t={}),"object"!=typeof e&&(e={});let r=i(e);n||(r=Object.keys(r).reduce(((t,e)=>(null!=r[e]&&(t[e]=r[e]),t)),{}));for(const n in t)void 0!==t[n]&&void 0===e[n]&&(r[n]=t[n]);return Object.keys(r).length>0?r:void 0},t.diff=function(t={},e={}){"object"!=typeof t&&(t={}),"object"!=typeof e&&(e={});const n=Object.keys(t).concat(Object.keys(e)).reduce(((n,i)=>(r(t[i],e[i])||(n[i]=void 0===e[i]?null:e[i]),n)),{});return Object.keys(n).length>0?n:void 0},t.invert=function(t={},e={}){t=t||{};const n=Object.keys(e).reduce(((n,i)=>(e[i]!==t[i]&&void 0!==t[i]&&(n[i]=e[i]),n)),{});return Object.keys(t).reduce(((n,i)=>(t[i]!==e[i]&&void 0===e[i]&&(n[i]=null),n)),n)},t.transform=function(t,e,n=!1){if("object"!=typeof t)return e;if("object"!=typeof e)return;if(!n)return e;const i=Object.keys(e).reduce(((n,i)=>(void 0===t[i]&&(n[i]=e[i]),n)),{});return Object.keys(i).length>0?i:void 0}}(s||(s={})),e.default=s},660:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const i=n(606),r=n(193),s=n(142),o=n(106);e.AttributeMap=o.default;const a=n(759);e.Op=a.default;const l=n(317);e.OpIterator=l.default;const c=String.fromCharCode(0),u=(t,e)=>{if("object"!=typeof t||null===t)throw new Error("cannot retain a "+typeof t);if("object"!=typeof e||null===e)throw new Error("cannot retain a "+typeof e);const n=Object.keys(t)[0];if(!n||n!==Object.keys(e)[0])throw new Error(`embed types not matched: ${n} != ${Object.keys(e)[0]}`);return[n,t[n],e[n]]};class h{constructor(t){Array.isArray(t)?this.ops=t:null!=t&&Array.isArray(t.ops)?this.ops=t.ops:this.ops=[]}static registerEmbed(t,e){this.handlers[t]=e}static unregisterEmbed(t){delete this.handlers[t]}static getHandler(t){const e=this.handlers[t];if(!e)throw new Error(`no handlers for embed type "${t}"`);return e}insert(t,e){const n={};return"string"==typeof t&&0===t.length?this:(n.insert=t,null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n))}delete(t){return t<=0?this:this.push({delete:t})}retain(t,e){if("number"==typeof t&&t<=0)return this;const n={retain:t};return null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n)}push(t){let e=this.ops.length,n=this.ops[e-1];if(t=r(t),"object"==typeof n){if("number"==typeof t.delete&&"number"==typeof n.delete)return this.ops[e-1]={delete:n.delete+t.delete},this;if("number"==typeof n.delete&&null!=t.insert&&(e-=1,n=this.ops[e-1],"object"!=typeof n))return this.ops.unshift(t),this;if(s(t.attributes,n.attributes)){if("string"==typeof t.insert&&"string"==typeof n.insert)return this.ops[e-1]={insert:n.insert+t.insert},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this;if("number"==typeof t.retain&&"number"==typeof n.retain)return this.ops[e-1]={retain:n.retain+t.retain},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this}}return e===this.ops.length?this.ops.push(t):this.ops.splice(e,0,t),this}chop(){const t=this.ops[this.ops.length-1];return t&&"number"==typeof t.retain&&!t.attributes&&this.ops.pop(),this}filter(t){return this.ops.filter(t)}forEach(t){this.ops.forEach(t)}map(t){return this.ops.map(t)}partition(t){const e=[],n=[];return this.forEach((i=>{(t(i)?e:n).push(i)})),[e,n]}reduce(t,e){return this.ops.reduce(t,e)}changeLength(){return this.reduce(((t,e)=>e.insert?t+a.default.length(e):e.delete?t-e.delete:t),0)}length(){return this.reduce(((t,e)=>t+a.default.length(e)),0)}slice(t=0,e=1/0){const n=[],i=new l.default(this.ops);let r=0;for(;r<e&&i.hasNext();){let s;r<t?s=i.next(t-r):(s=i.next(e-r),n.push(s)),r+=a.default.length(s)}return new h(n)}compose(t){const e=new l.default(this.ops),n=new l.default(t.ops),i=[],r=n.peek();if(null!=r&&"number"==typeof r.retain&&null==r.attributes){let t=r.retain;for(;"insert"===e.peekType()&&e.peekLength()<=t;)t-=e.peekLength(),i.push(e.next());r.retain-t>0&&n.next(r.retain-t)}const a=new h(i);for(;e.hasNext()||n.hasNext();)if("insert"===n.peekType())a.push(n.next());else if("delete"===e.peekType())a.push(e.next());else{const t=Math.min(e.peekLength(),n.peekLength()),i=e.next(t),r=n.next(t);if(r.retain){const l={};if("number"==typeof i.retain)l.retain="number"==typeof r.retain?t:r.retain;else if("number"==typeof r.retain)null==i.retain?l.insert=i.insert:l.retain=i.retain;else{const t=null==i.retain?"insert":"retain",[e,n,s]=u(i[t],r.retain),o=h.getHandler(e);l[t]={[e]:o.compose(n,s,"retain"===t)}}const c=o.default.compose(i.attributes,r.attributes,"number"==typeof i.retain);if(c&&(l.attributes=c),a.push(l),!n.hasNext()&&s(a.ops[a.ops.length-1],l)){const t=new h(e.rest());return a.concat(t).chop()}}else"number"==typeof r.delete&&("number"==typeof i.retain||"object"==typeof i.retain&&null!==i.retain)&&a.push(r)}return a.chop()}concat(t){const e=new h(this.ops.slice());return t.ops.length>0&&(e.push(t.ops[0]),e.ops=e.ops.concat(t.ops.slice(1))),e}diff(t,e){if(this.ops===t.ops)return new h;const n=[this,t].map((e=>e.map((n=>{if(null!=n.insert)return"string"==typeof n.insert?n.insert:c;throw new Error("diff() called "+(e===t?"on":"with")+" non-document")})).join(""))),r=new h,a=i(n[0],n[1],e,!0),u=new l.default(this.ops),d=new l.default(t.ops);return a.forEach((t=>{let e=t[1].length;for(;e>0;){let n=0;switch(t[0]){case i.INSERT:n=Math.min(d.peekLength(),e),r.push(d.next(n));break;case i.DELETE:n=Math.min(e,u.peekLength()),u.next(n),r.delete(n);break;case i.EQUAL:n=Math.min(u.peekLength(),d.peekLength(),e);const t=u.next(n),a=d.next(n);s(t.insert,a.insert)?r.retain(n,o.default.diff(t.attributes,a.attributes)):r.push(a).delete(n)}e-=n}})),r.chop()}eachLine(t,e="\n"){const n=new l.default(this.ops);let i=new h,r=0;for(;n.hasNext();){if("insert"!==n.peekType())return;const s=n.peek(),o=a.default.length(s)-n.peekLength(),l="string"==typeof s.insert?s.insert.indexOf(e,o)-o:-1;if(l<0)i.push(n.next());else if(l>0)i.push(n.next(l));else{if(!1===t(i,n.next(1).attributes||{},r))return;r+=1,i=new h}}i.length()>0&&t(i,{},r)}invert(t){const e=new h;return this.reduce(((n,i)=>{if(i.insert)e.delete(a.default.length(i));else{if("number"==typeof i.retain&&null==i.attributes)return e.retain(i.retain),n+i.retain;if(i.delete||"number"==typeof i.retain){const r=i.delete||i.retain;return t.slice(n,n+r).forEach((t=>{i.delete?e.push(t):i.retain&&i.attributes&&e.retain(a.default.length(t),o.default.invert(i.attributes,t.attributes))})),n+r}if("object"==typeof i.retain&&null!==i.retain){const r=t.slice(n,n+1),s=new l.default(r.ops).next(),[a,c,d]=u(i.retain,s.insert),f=h.getHandler(a);return e.retain({[a]:f.invert(c,d)},o.default.invert(i.attributes,s.attributes)),n+1}}return n}),0),e.chop()}transform(t,e=!1){if(e=!!e,"number"==typeof t)return this.transformPosition(t,e);const n=t,i=new l.default(this.ops),r=new l.default(n.ops),s=new h;for(;i.hasNext()||r.hasNext();)if("insert"!==i.peekType()||!e&&"insert"===r.peekType())if("insert"===r.peekType())s.push(r.next());else{const t=Math.min(i.peekLength(),r.peekLength()),n=i.next(t),a=r.next(t);if(n.delete)continue;if(a.delete)s.push(a);else{const i=n.retain,r=a.retain;let l="object"==typeof r&&null!==r?r:t;if("object"==typeof i&&null!==i&&"object"==typeof r&&null!==r){const t=Object.keys(i)[0];if(t===Object.keys(r)[0]){const n=h.getHandler(t);n&&(l={[t]:n.transform(i[t],r[t],e)})}}s.retain(l,o.default.transform(n.attributes,a.attributes,e))}}else s.retain(a.default.length(i.next()));return s.chop()}transformPosition(t,e=!1){e=!!e;const n=new l.default(this.ops);let i=0;for(;n.hasNext()&&i<=t;){const r=n.peekLength(),s=n.peekType();n.next(),"delete"!==s?("insert"===s&&(i<t||!e)&&(t+=r),i+=r):t-=Math.min(r,t-i)}return t}}h.Op=a.default,h.OpIterator=l.default,h.AttributeMap=o.default,h.handlers={},e.default=h,t.exports=h,t.exports.default=h},759:(t,e)=>{"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.length=function(t){return"number"==typeof t.delete?t.delete:"number"==typeof t.retain?t.retain:"object"==typeof t.retain&&null!==t.retain?1:"string"==typeof t.insert?t.insert.length:1}}(n||(n={})),e.default=n},317:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(759);e.default=class{constructor(t){this.ops=t,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(t){t||(t=1/0);const e=this.ops[this.index];if(e){const n=this.offset,r=i.default.length(e);if(t>=r-n?(t=r-n,this.index+=1,this.offset=0):this.offset+=t,"number"==typeof e.delete)return{delete:t};{const i={};return e.attributes&&(i.attributes=e.attributes),"number"==typeof e.retain?i.retain=t:"object"==typeof e.retain&&null!==e.retain?i.retain=e.retain:"string"==typeof e.insert?i.insert=e.insert.substr(n,t):i.insert=e.insert,i}}return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?i.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const t=this.ops[this.index];return t?"number"==typeof t.delete?"delete":"number"==typeof t.retain||"object"==typeof t.retain&&null!==t.retain?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);{const t=this.offset,e=this.index,n=this.next(),i=this.ops.slice(this.index);return this.offset=t,this.index=e,[n].concat(i)}}return[]}}},697:t=>{"use strict";var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,i,s,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,s||t,o),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,o=new Array(s);r<s;r++)o[r]=i[r].fn;return o},a.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,r,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var l,c,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,s),!0;case 6:return u.fn.call(u.context,e,i,r,s,o),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,i);break;case 4:u[c].fn.call(u[c].context,e,i,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||r&&!a.once||i&&a.context!==i||o(this,s);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==e||r&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[s]=1===c.length?c[0]:c:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a},72:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var s={},o=[],a=0;a<t.length;a++){var l=t[a],c=i.base?l[0]+i.base:l[0],u=s[c]||0,h="".concat(c," ").concat(u);s[c]=u+1;var d=n(h),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var p=r(f,i);i.byIndex=a,e.splice(a,0,{identifier:h,updater:p,references:1})}o.push(h)}return o}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var s=i(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--}for(var l=i(t,r),c=0;c<s.length;c++){var u=n(s[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}s=l}}},659:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.nc=void 0,(()=>{"use strict";var t={};n.r(t),n.d(t,{Attributor:()=>Lb,AttributorStore:()=>Vb,BlockBlot:()=>Zb,ClassAttributor:()=>jb,ContainerBlot:()=>ew,EmbedBlot:()=>nw,InlineBlot:()=>Xb,LeafBlot:()=>$b,ParentBlot:()=>Qb,Registry:()=>Mb,Scope:()=>Ob,ScrollBlot:()=>sw,StyleAttributor:()=>Fb,TextBlot:()=>aw});var e=n(994),i=n.n(e);const r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function s(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const o={date:s({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:s({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:s({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},a={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function l(t){return(e,n)=>{let i;if("formatting"===(n?.context?String(n.context):"standalone")&&t.formattingValues){const e=t.defaultFormattingWidth||t.defaultWidth,r=n?.width?String(n.width):e;i=t.formattingValues[r]||t.formattingValues[e]}else{const e=t.defaultWidth,r=n?.width?String(n.width):t.defaultWidth;i=t.values[r]||t.values[e]}return i[t.argumentCallback?t.argumentCallback(e):e]}}const c={ordinalNumber:(t,e)=>{const n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:l({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:l({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:t=>t-1}),month:l({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:l({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:l({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function u(t){return(e,n={})=>{const i=n.width,r=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],s=e.match(r);if(!s)return null;const o=s[0],a=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?function(t,e){for(let e=0;e<t.length;e++)if(t[e].test(o))return e}(a):function(t,e){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e].test(o))return e}(a);let c;return c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c,{value:c,rest:e.slice(o.length)}}}const h={ordinalNumber:(d={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:t=>parseInt(t,10)},(t,e={})=>{const n=t.match(d.matchPattern);if(!n)return null;const i=n[0],r=t.match(d.parsePattern);if(!r)return null;let s=d.valueCallback?d.valueCallback(r[0]):r[0];return s=e.valueCallback?e.valueCallback(s):s,{value:s,rest:t.slice(i.length)}}),era:u({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:u({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:t=>t+1}),month:u({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:u({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:u({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var d;const f={code:"en-US",formatDistance:(t,e,n)=>{let i;const s=r[t];return i="string"==typeof s?s:1===e?s.one:s.other.replace("{{count}}",e.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i},formatLong:o,formatRelative:(t,e,n,i)=>a[t],localize:c,match:h,options:{weekStartsOn:0,firstWeekContainsDate:1}};let p={};function g(){return p}Math.pow(10,8);const m=6048e5,y=864e5,v=43200;function b(t){const e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new t.constructor(+t):"number"==typeof t||"[object Number]"===e||"string"==typeof t||"[object String]"===e?new Date(t):new Date(NaN)}function w(t){const e=b(t);return e.setHours(0,0,0,0),e}function E(t){const e=b(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function _(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function q(t){const e=b(t);return function(t,e){const n=w(t),i=w(e),r=+n-E(n),s=+i-E(i);return Math.round((r-s)/y)}(e,function(t){const e=b(t),n=_(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}(e))+1}function k(t,e){const n=g(),i=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=b(t),s=r.getDay(),o=(s<i?7:0)+s-i;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function T(t){return k(t,{weekStartsOn:1})}function x(t){const e=b(t),n=e.getFullYear(),i=_(t,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const r=T(i),s=_(t,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const o=T(s);return e.getTime()>=r.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function I(t){const e=b(t),n=+T(e)-+function(t){const e=x(t),n=_(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),T(n)}(e);return Math.round(n/m)+1}function S(t,e){const n=b(t),i=n.getFullYear(),r=g(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=_(t,0);o.setFullYear(i+1,0,s),o.setHours(0,0,0,0);const a=k(o,e),l=_(t,0);l.setFullYear(i,0,s),l.setHours(0,0,0,0);const c=k(l,e);return n.getTime()>=a.getTime()?i+1:n.getTime()>=c.getTime()?i:i-1}function A(t,e){const n=b(t),i=+k(n,e)-+function(t,e){const n=g(),i=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,r=S(t,e),s=_(t,0);return s.setFullYear(r,0,i),s.setHours(0,0,0,0),k(s,e)}(n,e);return Math.round(i/m)+1}function N(t,e){return(t<0?"-":"")+Math.abs(t).toString().padStart(e,"0")}const C={y(t,e){const n=t.getFullYear(),i=n>0?n:1-n;return N("yy"===e?i%100:i,e.length)},M(t,e){const n=t.getMonth();return"M"===e?String(n+1):N(n+1,2)},d:(t,e)=>N(t.getDate(),e.length),a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(t,e)=>N(t.getHours()%12||12,e.length),H:(t,e)=>N(t.getHours(),e.length),m:(t,e)=>N(t.getMinutes(),e.length),s:(t,e)=>N(t.getSeconds(),e.length),S(t,e){const n=e.length,i=t.getMilliseconds();return N(Math.trunc(i*Math.pow(10,n-3)),e.length)}},O={G:function(t,e,n){const i=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});default:return n.era(i,{width:"wide"})}},y:function(t,e,n){if("yo"===e){const e=t.getFullYear(),i=e>0?e:1-e;return n.ordinalNumber(i,{unit:"year"})}return C.y(t,e)},Y:function(t,e,n,i){const r=S(t,i),s=r>0?r:1-r;return"YY"===e?N(s%100,2):"Yo"===e?n.ordinalNumber(s,{unit:"year"}):N(s,e.length)},R:function(t,e){return N(x(t),e.length)},u:function(t,e){return N(t.getFullYear(),e.length)},Q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return N(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return N(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,e,n){const i=t.getMonth();switch(e){case"M":case"MM":return C.M(t,e);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(t,e,n){const i=t.getMonth();switch(e){case"L":return String(i+1);case"LL":return N(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(t,e,n,i){const r=A(t,i);return"wo"===e?n.ordinalNumber(r,{unit:"week"}):N(r,e.length)},I:function(t,e,n){const i=I(t);return"Io"===e?n.ordinalNumber(i,{unit:"week"}):N(i,e.length)},d:function(t,e,n){return"do"===e?n.ordinalNumber(t.getDate(),{unit:"date"}):C.d(t,e)},D:function(t,e,n){const i=q(t);return"Do"===e?n.ordinalNumber(i,{unit:"dayOfYear"}):N(i,e.length)},E:function(t,e,n){const i=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(t,e,n,i){const r=t.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return N(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,i){const r=t.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return N(s,e.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const i=t.getDay(),r=0===i?7:i;switch(e){case"i":return String(r);case"ii":return N(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(t,e,n){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,n){const i=t.getHours();let r;switch(r=12===i?"noon":0===i?"midnight":i/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const i=t.getHours();let r;switch(r=i>=17?"evening":i>=12?"afternoon":i>=4?"morning":"night",e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if("ho"===e){let e=t.getHours()%12;return 0===e&&(e=12),n.ordinalNumber(e,{unit:"hour"})}return C.h(t,e)},H:function(t,e,n){return"Ho"===e?n.ordinalNumber(t.getHours(),{unit:"hour"}):C.H(t,e)},K:function(t,e,n){const i=t.getHours()%12;return"Ko"===e?n.ordinalNumber(i,{unit:"hour"}):N(i,e.length)},k:function(t,e,n){let i=t.getHours();return 0===i&&(i=24),"ko"===e?n.ordinalNumber(i,{unit:"hour"}):N(i,e.length)},m:function(t,e,n){return"mo"===e?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):C.m(t,e)},s:function(t,e,n){return"so"===e?n.ordinalNumber(t.getSeconds(),{unit:"second"}):C.s(t,e)},S:function(t,e){return C.S(t,e)},X:function(t,e,n){const i=t.getTimezoneOffset();if(0===i)return"Z";switch(e){case"X":return R(i);case"XXXX":case"XX":return D(i);default:return D(i,":")}},x:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"x":return R(i);case"xxxx":case"xx":return D(i);default:return D(i,":")}},O:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+L(i,":");default:return"GMT"+D(i,":")}},z:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+L(i,":");default:return"GMT"+D(i,":")}},t:function(t,e,n){return N(Math.trunc(t.getTime()/1e3),e.length)},T:function(t,e,n){return N(t.getTime(),e.length)}};function L(t,e=""){const n=t>0?"-":"+",i=Math.abs(t),r=Math.trunc(i/60),s=i%60;return 0===s?n+String(r):n+String(r)+e+N(s,2)}function R(t,e){return t%60==0?(t>0?"-":"+")+N(Math.abs(t)/60,2):D(t,e)}function D(t,e=""){const n=t>0?"-":"+",i=Math.abs(t);return n+N(Math.trunc(i/60),2)+e+N(i%60,2)}const M=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}},P=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}},j={p:P,P:(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],i=n[1],r=n[2];if(!r)return M(t,e);let s;switch(i){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;default:s=e.dateTime({width:"full"})}return s.replace("{{date}}",M(i,e)).replace("{{time}}",P(r,e))}},U=/^D+$/,F=/^Y+$/,V=["D","DD","YY","YYYY"];function B(t){if(!(e=t,e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)||"number"==typeof t))return!1;var e;const n=b(t);return!isNaN(Number(n))}const z=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,H=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$=/^'([^]*?)'?$/,W=/''/g,K=/[a-zA-Z]/;function G(t,e,n){const i=g(),r=n?.locale??i.locale??f,s=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,a=b(t);if(!B(a))throw new RangeError("Invalid time value");let l=e.match(H).map((t=>{const e=t[0];return"p"===e||"P"===e?(0,j[e])(t,r.formatLong):t})).join("").match(z).map((t=>{if("''"===t)return{isToken:!1,value:"'"};const e=t[0];if("'"===e)return{isToken:!1,value:Q(t)};if(O[e])return{isToken:!0,value:t};if(e.match(K))throw new RangeError("Format string contains an unescaped latin alphabet character `"+e+"`");return{isToken:!1,value:t}}));r.localize.preprocessor&&(l=r.localize.preprocessor(a,l));const c={firstWeekContainsDate:s,weekStartsOn:o,locale:r};return l.map((i=>{if(!i.isToken)return i.value;const s=i.value;return(!n?.useAdditionalWeekYearTokens&&function(t){return F.test(t)}(s)||!n?.useAdditionalDayOfYearTokens&&function(t){return U.test(t)}(s))&&function(t,e,n){const i=function(t,e,n){const i="Y"===t[0]?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(t,e,n);if(console.warn(i),V.includes(t))throw new RangeError(i)}(s,e,String(t)),(0,O[s[0]])(a,s,r.localize,c)})).join("")}function Q(t){const e=t.match($);return e?e[1].replace(W,"'"):t}function Y(t,e){const n=b(t),i=b(e),r=n.getTime()-i.getTime();return r<0?-1:r>0?1:r}function X(t){const e=b(t);return+function(t){const e=b(t);return e.setHours(23,59,59,999),e}(e)==+function(t){const e=b(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}(e)}function J(t,e){const n=b(t),i=b(e),r=Y(n,i),s=Math.abs(function(t,e){const n=b(t),i=b(e);return 12*(n.getFullYear()-i.getFullYear())+(n.getMonth()-i.getMonth())}(n,i));let o;if(s<1)o=0;else{1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-r*s);let e=Y(n,i)===-r;X(b(t))&&1===s&&1===Y(t,i)&&(e=!1),o=r*(s-Number(e))}return 0===o?0:o}function Z(t,e,n){const i=function(t,e){return+b(t)-+b(e)}(t,e)/1e3;return(r=n?.roundingMethod,t=>{const e=(r?Math[r]:Math.trunc)(t);return 0===e?0:e})(i);var r}const tt=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},et={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,l=a?t[e+2]:0,c=r>>2,u=(3&r)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),i.push(n[c],n[u],n[h],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(tt(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],s=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==s||null==o||null==a)throw new nt;const l=r<<2|s>>4;if(i.push(l),64!==o){const t=s<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class nt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const it=function(t){return function(t){const e=tt(t);return et.encodeByteArray(e,!0)}(t).replace(/\./g,"")},rt=function(t){try{return et.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},st=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&rt(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},ot=t=>{var e,n;return null===(n=null===(e=st())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},at=()=>{var t;return null===(t=st())||void 0===t?void 0:t.config},lt=t=>{var e;return null===(e=st())||void 0===e?void 0:e[`_${t}`]};class ct{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function ut(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ht(){try{return"object"==typeof indexedDB}catch(t){return!1}}class dt extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,dt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ft.prototype.create)}}class ft{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(pt,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new dt(i,o,n)}}const pt=/\{\$([^}]+)}/g;function gt(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(mt(n)&&mt(s)){if(!gt(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function mt(t){return null!==t&&"object"==typeof t}function yt(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function vt(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function bt(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class wt{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=Et),void 0===i.error&&(i.error=Et),void 0===i.complete&&(i.complete=Et);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function Et(){}function _t(t){return t&&t._delegate?t._delegate:t}class qt{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const kt="[DEFAULT]";class Tt{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new ct;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:kt})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=kt){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=kt){return this.instances.has(t)}getOptions(t=kt){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===kt?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=kt){return this.component?this.component.multipleInstances?t:kt:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class xt{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Tt(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const It=[];var St;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(St||(St={}));const At={debug:St.DEBUG,verbose:St.VERBOSE,info:St.INFO,warn:St.WARN,error:St.ERROR,silent:St.SILENT},Nt=St.INFO,Ct={[St.DEBUG]:"log",[St.VERBOSE]:"log",[St.INFO]:"info",[St.WARN]:"warn",[St.ERROR]:"error"},Ot=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=Ct[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class Lt{constructor(t){this.name=t,this._logLevel=Nt,this._logHandler=Ot,this._userLogHandler=null,It.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in St))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?At[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,St.DEBUG,...t),this._logHandler(this,St.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,St.VERBOSE,...t),this._logHandler(this,St.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,St.INFO,...t),this._logHandler(this,St.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,St.WARN,...t),this._logHandler(this,St.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,St.ERROR,...t),this._logHandler(this,St.ERROR,...t)}}const Rt=(t,e)=>e.some((e=>t instanceof e));let Dt,Mt;const Pt=new WeakMap,jt=new WeakMap,Ut=new WeakMap,Ft=new WeakMap,Vt=new WeakMap;let Bt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return jt.get(t);if("objectStoreNames"===e)return t.objectStoreNames||Ut.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ht(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function zt(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Mt||(Mt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply($t(this),t),Ht(Pt.get(this))}:function(...t){return Ht(e.apply($t(this),t))}:function(t,...n){const i=e.call($t(this),t,...n);return Ut.set(i,t.sort?t.sort():[t]),Ht(i)}:(t instanceof IDBTransaction&&function(t){if(jt.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));jt.set(t,e)}(t),Rt(t,Dt||(Dt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Bt):t);var e}function Ht(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(Ht(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&Pt.set(e,t)})).catch((()=>{})),Vt.set(e,t),e}(t);if(Ft.has(t))return Ft.get(t);const e=zt(t);return e!==t&&(Ft.set(t,e),Vt.set(e,t)),e}const $t=t=>Vt.get(t),Wt=["get","getKey","getAll","getAllKeys","count"],Kt=["put","add","delete","clear"],Gt=new Map;function Qt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Gt.get(e))return Gt.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=Kt.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Wt.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return Gt.set(e,s),s}var Yt;Yt=Bt,Bt={...Yt,get:(t,e,n)=>Qt(t,e)||Yt.get(t,e,n),has:(t,e)=>!!Qt(t,e)||Yt.has(t,e)};class Xt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const Jt="@firebase/app",Zt="0.9.28",te=new Lt("@firebase/app"),ee="[DEFAULT]",ne={[Jt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ie=new Map,re=new Map;function se(t,e){try{t.container.addComponent(e)}catch(n){te.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function oe(t){const e=t.name;if(re.has(e))return te.debug(`There were multiple attempts to register component ${e}.`),!1;re.set(e,t);for(const e of ie.values())se(e,t);return!0}function ae(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const le=new ft("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ce{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new qt("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw le.create("app-deleted",{appName:this._name})}}const ue="10.8.1";function he(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:ee,automaticDataCollectionEnabled:!1},e),r=i.name;if("string"!=typeof r||!r)throw le.create("bad-app-name",{appName:String(r)});if(n||(n=at()),!n)throw le.create("no-options");const s=ie.get(r);if(s){if(gt(n,s.options)&&gt(i,s.config))return s;throw le.create("duplicate-app",{appName:r})}const o=new xt(r);for(const t of re.values())o.addComponent(t);const a=new ce(n,i,o);return ie.set(r,a),a}function de(t=ee){const e=ie.get(t);if(!e&&t===ee&&at())return he();if(!e)throw le.create("no-app",{appName:t});return e}function fe(t,e,n){var i;let r=null!==(i=ne[t])&&void 0!==i?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${r}" with version "${e}":`];return s&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void te.warn(t.join(" "))}oe(new qt(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const pe="firebase-heartbeat-database",ge=1,me="firebase-heartbeat-store";let ye=null;function ve(){return ye||(ye=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=Ht(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(Ht(o.result),t.oldVersion,t.newVersion,Ht(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(t=>r(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(pe,ge,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(me)}catch(t){console.warn(t)}}}).catch((t=>{throw le.create("idb-open",{originalErrorMessage:t.message})}))),ye}async function be(t,e){try{const n=(await ve()).transaction(me,"readwrite"),i=n.objectStore(me);await i.put(e,we(t)),await n.done}catch(t){if(t instanceof dt)te.warn(t.message);else{const e=le.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});te.warn(e.message)}}}function we(t){return`${t.name}!${t.options.appId}`}class Ee{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new qe(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=_e();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=_e(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),ke(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),ke(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=it(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function _e(){return(new Date).toISOString().substring(0,10)}class qe{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!ht()&&new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await ve()).transaction(me),n=await e.objectStore(me).get(we(t));return await e.done,n}catch(t){if(t instanceof dt)te.warn(t.message);else{const e=le.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});te.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return be(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return be(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function ke(t){return it(JSON.stringify({version:2,heartbeats:t})).length}oe(new qt("platform-logger",(t=>new Xt(t)),"PRIVATE")),oe(new qt("heartbeat",(t=>new Ee(t)),"PRIVATE")),fe(Jt,Zt,""),fe(Jt,Zt,"esm2017"),fe("fire-js",""),fe("firebase","10.8.1","app"),he({apiKey:"AIzaSyCWCD0fELIxsopuhhfJo1KLymb2krWtHfI",authDomain:"rcsmr-notes-app.firebaseapp.com",projectId:"rcsmr-notes-app",storageBucket:"rcsmr-notes-app.appspot.com",messagingSenderId:"367911567246",appId:"1:367911567246:web:9b062c0ba2bca47fcfeedf"});var Te,xe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ie={},Se=Se||{},Ae=xe||self;function Ne(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Ce(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Oe="closure_uid_"+(1e9*Math.random()>>>0),Le=0;function Re(t,e,n){return t.call.apply(t.bind,arguments)}function De(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Me(t,e,n){return(Me=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Re:De).apply(null,arguments)}function Pe(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function je(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function Ue(){this.s=this.s,this.o=this.o}Ue.prototype.s=!1,Ue.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Oe)&&t[Oe]||(t[Oe]=++Le))},Ue.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Fe=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Ve(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Be(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Ne(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function ze(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ze.prototype.h=function(){this.defaultPrevented=!0};var He=function(){if(!Ae.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};Ae.addEventListener("test",t,e),Ae.removeEventListener("test",t,e)}catch(t){}return t}();function $e(t){return/^[\s\xa0]*$/.test(t)}function We(){var t=Ae.navigator;return t&&(t=t.userAgent)?t:""}function Ke(t){return-1!=We().indexOf(t)}function Ge(t){return Ge[" "](t),t}Ge[" "]=function(){};var Qe,Ye,Xe,Je=Ke("Opera"),Ze=Ke("Trident")||Ke("MSIE"),tn=Ke("Edge"),en=tn||Ze,nn=Ke("Gecko")&&!(-1!=We().toLowerCase().indexOf("webkit")&&!Ke("Edge"))&&!(Ke("Trident")||Ke("MSIE"))&&!Ke("Edge"),rn=-1!=We().toLowerCase().indexOf("webkit")&&!Ke("Edge");function sn(){var t=Ae.document;return t?t.documentMode:void 0}t:{var on="",an=(Ye=We(),nn?/rv:([^\);]+)(\)|;)/.exec(Ye):tn?/Edge\/([\d\.]+)/.exec(Ye):Ze?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ye):rn?/WebKit\/(\S+)/.exec(Ye):Je?/(?:Version)[ \/]?(\S+)/.exec(Ye):void 0);if(an&&(on=an?an[1]:""),Ze){var ln=sn();if(null!=ln&&ln>parseFloat(on)){Qe=String(ln);break t}}Qe=on}Ae.document&&Ze?Xe=sn()||parseInt(Qe,10)||void 0:Xe=void 0;var cn=Xe;function un(t,e){if(ze.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(nn){t:{try{Ge(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:hn[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&un.$.h.call(this)}}je(un,ze);var hn={2:"touch",3:"pen",4:"mouse"};un.prototype.h=function(){un.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var dn="closure_listenable_"+(1e6*Math.random()|0),fn=0;function pn(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=r,this.key=++fn,this.fa=this.ia=!1}function gn(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function mn(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function yn(t){const e={};for(const n in t)e[n]=t[n];return e}const vn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function bn(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<vn.length;e++)n=vn[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function wn(t){this.src=t,this.g={},this.h=0}function En(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=Fe(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(gn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function _n(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==i)return r}return-1}wn.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=_n(t,e,i,r);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new pn(e,this.src,s,!!i,r)).ia=n,t.push(e)),e};var qn="closure_lm_"+(1e6*Math.random()|0),kn={};function Tn(t,e,n,i,r){if(i&&i.once)return In(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Tn(t,e[s],n,i,r);return null}return n=Rn(n),t&&t[dn]?t.O(e,n,Ce(i)?!!i.capture:!!i,r):xn(t,e,n,!1,i,r)}function xn(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=Ce(r)?!!r.capture:!!r,a=On(t);if(a||(t[qn]=a=new wn(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){const t=Cn;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)He||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Nn(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function In(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)In(t,e[s],n,i,r);return null}return n=Rn(n),t&&t[dn]?t.P(e,n,Ce(i)?!!i.capture:!!i,r):xn(t,e,n,!0,i,r)}function Sn(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Sn(t,e[s],n,i,r);else i=Ce(i)?!!i.capture:!!i,n=Rn(n),t&&t[dn]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=_n(s=t.g[e],n,i,r))&&(gn(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=On(t))&&(e=t.g[e.toString()],t=-1,e&&(t=_n(e,n,i,r)),(n=-1<t?e[t]:null)&&An(n))}function An(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[dn])En(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Nn(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=On(e))?(En(n,t),0==n.h&&(n.src=null,e[qn]=null)):gn(t)}}}function Nn(t){return t in kn?kn[t]:kn[t]="on"+t}function Cn(t,e){if(t.fa)t=!0;else{e=new un(e,this);var n=t.listener,i=t.la||t.src;t.ia&&An(t),t=n.call(i,e)}return t}function On(t){return(t=t[qn])instanceof wn?t:null}var Ln="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rn(t){return"function"==typeof t?t:(t[Ln]||(t[Ln]=function(e){return t.handleEvent(e)}),t[Ln])}function Dn(){Ue.call(this),this.i=new wn(this),this.S=this,this.J=null}function Mn(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new ze(e,t);else if(e instanceof ze)e.target=e.target||t;else{var r=e;bn(e=new ze(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Pn(o,i,!0,e)&&r}if(r=Pn(o=e.g=t,i,!0,e)&&r,r=Pn(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Pn(o=e.g=n[s],i,!1,e)&&r}function Pn(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&En(t.i,o),r=!1!==a.call(l,i)&&r}}return r&&!i.defaultPrevented}je(Dn,Ue),Dn.prototype[dn]=!0,Dn.prototype.removeEventListener=function(t,e,n,i){Sn(this,t,e,n,i)},Dn.prototype.N=function(){if(Dn.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)gn(n[i]);delete e.g[t],e.h--}}this.J=null},Dn.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Dn.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var jn=Ae.JSON.stringify;function Un(){var t=Wn;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Fn=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Vn),(t=>t.reset()));class Vn{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Bn(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function zn(t){Ae.setTimeout((()=>{throw t}),0)}let Hn,$n=!1,Wn=new class{constructor(){this.h=this.g=null}add(t,e){const n=Fn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},Kn=()=>{const t=Ae.Promise.resolve(void 0);Hn=()=>{t.then(Gn)}};var Gn=()=>{for(var t;t=Un();){try{t.h.call(t.g)}catch(t){zn(t)}var e=Fn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}$n=!1};function Qn(t,e){Dn.call(this),this.h=t||1,this.g=e||Ae,this.j=Me(this.qb,this),this.l=Date.now()}function Yn(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function Xn(t,e,n){if("function"==typeof t)n&&(t=Me(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Me(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ae.setTimeout(t,e||0)}function Jn(t){t.g=Xn((()=>{t.g=null,t.i&&(t.i=!1,Jn(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}je(Qn,Dn),(Te=Qn.prototype).ga=!1,Te.T=null,Te.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Mn(this,"tick"),this.ga&&(Yn(this),this.start()))}},Te.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Te.N=function(){Qn.$.N.call(this),Yn(this),delete this.g};class Zn extends Ue{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Jn(this)}N(){super.N(),this.g&&(Ae.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ti(t){Ue.call(this),this.h=t,this.g={}}je(ti,Ue);var ei=[];function ni(t,e,n,i){Array.isArray(n)||(n&&(ei[0]=n.toString()),n=ei);for(var r=0;r<n.length;r++){var s=Tn(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function ii(t){mn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&An(t)}),t),t.g={}}function ri(){this.g=!0}function si(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return jn(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}ti.prototype.N=function(){ti.$.N.call(this),ii(this)},ti.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ri.prototype.Ea=function(){this.g=!1},ri.prototype.info=function(){};var oi={},ai=null;function li(){return ai=ai||new Dn}function ci(t){ze.call(this,oi.Ta,t)}function ui(t){const e=li();Mn(e,new ci(e))}function hi(t,e){ze.call(this,oi.STAT_EVENT,t),this.stat=e}function di(t){const e=li();Mn(e,new hi(e,t))}function fi(t,e){ze.call(this,oi.Ua,t),this.size=e}function pi(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ae.setTimeout((function(){t()}),e)}oi.Ta="serverreachability",je(ci,ze),oi.STAT_EVENT="statevent",je(hi,ze),oi.Ua="timingevent",je(fi,ze);var gi={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},mi={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function yi(){}function vi(t){return t.h||(t.h=t.i())}function bi(){}yi.prototype.h=null;var wi,Ei={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function _i(){ze.call(this,"d")}function qi(){ze.call(this,"c")}function ki(){}function Ti(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new ti(this),this.P=Ii,t=en?125:void 0,this.V=new Qn(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new xi}function xi(){this.i=null,this.g="",this.h=!1}je(_i,ze),je(qi,ze),je(ki,yi),ki.prototype.g=function(){return new XMLHttpRequest},ki.prototype.i=function(){return{}},wi=new ki;var Ii=45e3,Si={},Ai={};function Ni(t,e,n){t.L=1,t.A=Qi(Hi(e)),t.u=n,t.S=!0,Ci(t,null)}function Ci(t,e){t.G=Date.now(),Di(t),t.B=Hi(t.A);var n=t.B,i=t.W;Array.isArray(i)||(i=[String(i)]),lr(n.i,"t",i),t.o=0,n=t.l.J,t.h=new xi,t.g=ls(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Zn(Me(t.Pa,t,t.g),t.O)),ni(t.U,t.g,"readystatechange",t.nb),e=t.I?yn(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),ui(),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function Oi(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Li(t,e,n){let i,r=!0;for(;!t.J&&t.o<n.length;){if(i=Ri(t,n),i==Ai){4==e&&(t.s=4,di(14),r=!1),si(t.j,t.m,null,"[Incomplete Response]");break}if(i==Si){t.s=4,di(15),si(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}si(t.j,t.m,i,null),Fi(t,i)}Oi(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,di(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),ts(e),e.M=!0,di(11))):(si(t.j,t.m,n,"[Invalid Chunked Response]"),Ui(t),ji(t))}function Ri(t,e){var n=t.o,i=e.indexOf("\n",n);return-1==i?Ai:(n=Number(e.substring(n,i)),isNaN(n)?Si:(i+=1)+n>e.length?Ai:(e=e.slice(i,i+n),t.o=i+n,e))}function Di(t){t.Y=Date.now()+t.P,Mi(t,t.P)}function Mi(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=pi(Me(t.lb,t),e)}function Pi(t){t.C&&(Ae.clearTimeout(t.C),t.C=null)}function ji(t){0==t.l.H||t.J||is(t.l,t)}function Ui(t){Pi(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,Yn(t.V),ii(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Fi(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||gr(n.i,t)))if(!t.K&&gr(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;ns(n),Wr(n)}Zr(n),di(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=pi(Me(n.ib,n),6e3));if(1>=pr(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else ss(n,11)}else if((t.K||n.g==t)&&ns(n),!$e(e))for(r=n.Ja.g.parse(e),e=0;e<r.length;e++){let c=r[e];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const e=c[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const r=c[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(mr(s,s.h),s.h=null))}if(i.F){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,Gi(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((i=n).wa=as(i,i.J?i.pa:null,i.Y),o.K){yr(i.i,o);var a=o,l=i.L;l&&a.setTimeout(l),a.C&&(Pi(a),Di(a)),i.g=o}else Jr(i);0<n.j.length&&Gr(n)}else"stop"!=c[0]&&"close"!=c[0]||ss(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ss(n,7):$r(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}ui()}catch(t){}}function Vi(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Ne(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Ne(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Ne(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}(Te=Ti.prototype).setTimeout=function(t){this.P=t},Te.nb=function(t){t=t.target;const e=this.M;e&&3==Ur(t)?e.l():this.Pa(t)},Te.Pa=function(t){try{if(t==this.g)t:{const u=Ur(this.g);var e=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||en||this.g&&(this.h.h||this.g.ja()||Fr(this.g)))){this.J||4!=u||7==e||ui(),Pi(this);var n=this.g.da();this.ca=n;e:if(Oi(this)){var i=Fr(this.g);t="";var r=i.length,s=4==Ur(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ui(this),ji(this);var o="";break e}this.h.i=new Ae.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$e(a)){var c=a;break e}}c=null}if(!(n=c)){this.i=!1,this.s=3,di(12),Ui(this),ji(this);break t}si(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fi(this,n)}this.S?(Li(this,u,o),en&&this.i&&3==u&&(ni(this.U,this.V,"tick",this.mb),this.V.start())):(si(this.j,this.m,o,null),Fi(this,o)),4==u&&Ui(this),this.i&&!this.J&&(4==u?is(this.l,this):(this.i=!1,Di(this)))}else(function(t){const e={};t=(t.g&&2<=Ur(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if($e(t[i]))continue;var n=Bn(t[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[r]||[];e[r]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,di(12)):(this.s=0,di(13)),Ui(this),ji(this)}}}catch(t){}},Te.mb=function(){if(this.g){var t=Ur(this.g),e=this.g.ja();this.o<e.length&&(Pi(this),Li(this,t,e),this.i&&4!=t&&Di(this))}},Te.cancel=function(){this.J=!0,Ui(this)},Te.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(ui(),di(17)),Ui(this),this.s=2,ji(this)):Mi(this,this.Y-t)};var Bi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zi(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof zi){this.h=t.h,$i(this,t.j),this.s=t.s,this.g=t.g,Wi(this,t.m),this.l=t.l;var e=t.i,n=new rr;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Ki(this,n),this.o=t.o}else t&&(e=String(t).match(Bi))?(this.h=!1,$i(this,e[1]||"",!0),this.s=Yi(e[2]||""),this.g=Yi(e[3]||"",!0),Wi(this,e[4]),this.l=Yi(e[5]||"",!0),Ki(this,e[6]||"",!0),this.o=Yi(e[7]||"")):(this.h=!1,this.i=new rr(null,this.h))}function Hi(t){return new zi(t)}function $i(t,e,n){t.j=n?Yi(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Wi(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ki(t,e,n){e instanceof rr?(t.i=e,function(t,e){e&&!t.j&&(sr(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(or(this,e),lr(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=Xi(e,nr)),t.i=new rr(e,t.h))}function Gi(t,e,n){t.i.set(e,n)}function Qi(t){return Gi(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Yi(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Xi(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ji),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ji(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}zi.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Xi(e,Zi,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Xi(e,Zi,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Xi(n,"/"==n.charAt(0)?er:tr,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Xi(n,ir)),t.join("")};var Zi=/[#\/\?@]/g,tr=/[#\?:]/g,er=/[#\?]/g,nr=/[#\?@]/g,ir=/#/g;function rr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function sr(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function or(t,e){sr(t),e=cr(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function ar(t,e){return sr(t),e=cr(t,e),t.g.has(e)}function lr(t,e,n){or(t,e),0<n.length&&(t.i=null,t.g.set(cr(t,e),Ve(n)),t.h+=n.length)}function cr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Te=rr.prototype).add=function(t,e){sr(this),this.i=null,t=cr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Te.forEach=function(t,e){sr(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},Te.ta=function(){sr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},Te.Z=function(t){sr(this);let e=[];if("string"==typeof t)ar(this,t)&&(e=e.concat(this.g.get(cr(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},Te.set=function(t,e){return sr(this),this.i=null,ar(this,t=cr(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Te.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},Te.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};var ur=class{constructor(t,e){this.g=t,this.map=e}};function hr(t){this.l=t||dr,t=Ae.PerformanceNavigationTiming?0<(t=Ae.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Ae.g&&Ae.g.Ka&&Ae.g.Ka()&&Ae.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var dr=10;function fr(t){return!!t.h||!!t.g&&t.g.size>=t.j}function pr(t){return t.h?1:t.g?t.g.size:0}function gr(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function mr(t,e){t.g?t.g.add(e):t.h=e}function yr(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function vr(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Ve(t.i)}hr.prototype.cancel=function(){if(this.i=vr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var br=class{stringify(t){return Ae.JSON.stringify(t,void 0)}parse(t){return Ae.JSON.parse(t,void 0)}};function wr(){this.g=new br}function Er(t,e,n){const i=n||"";try{Vi(t,(function(t,n){let r=t;Ce(t)&&(r=jn(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function _r(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function qr(t){this.l=t.ec||null,this.j=t.ob||!1}function kr(t,e){Dn.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Tr,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}je(qr,yi),qr.prototype.g=function(){return new kr(this.l,this.j)},qr.prototype.i=function(t){return function(){return t}}({}),je(kr,Dn);var Tr=0;function xr(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function Ir(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Sr(t)}function Sr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Te=kr.prototype).open=function(t,e){if(this.readyState!=Tr)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Sr(this)},Te.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Ae).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Te.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ir(this)),this.readyState=Tr},Te.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Sr(this)),this.g&&(this.readyState=3,Sr(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Ae.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;xr(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},Te.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ir(this):Sr(this),3==this.readyState&&xr(this)}},Te.Za=function(t){this.g&&(this.response=this.responseText=t,Ir(this))},Te.Ya=function(t){this.g&&(this.response=t,Ir(this))},Te.ka=function(){this.g&&Ir(this)},Te.setRequestHeader=function(t,e){this.v.append(t,e)},Te.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Te.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(kr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Ar=Ae.JSON.parse;function Nr(t){Dn.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Cr,this.L=this.M=!1}je(Nr,Dn);var Cr="",Or=/^https?$/i,Lr=["POST","PUT"];function Rr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Dr(t),Pr(t)}function Dr(t){t.F||(t.F=!0,Mn(t,"complete"),Mn(t,"error"))}function Mr(t){if(t.h&&void 0!==Se&&(!t.C[1]||4!=Ur(t)||2!=t.da()))if(t.v&&4==Ur(t))Xn(t.La,0,t);else if(Mn(t,"readystatechange"),4==Ur(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===o){var r=String(t.I).match(Bi)[1]||null;!r&&Ae.self&&Ae.self.location&&(r=Ae.self.location.protocol.slice(0,-1)),i=!Or.test(r?r.toLowerCase():"")}n=i}if(n)Mn(t,"complete"),Mn(t,"success");else{t.m=6;try{var s=2<Ur(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",Dr(t)}}finally{Pr(t)}}}function Pr(t,e){if(t.g){jr(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Mn(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function jr(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Ae.clearTimeout(t.A),t.A=null)}function Ur(t){return t.g?t.g.readyState:0}function Fr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Cr:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Vr(t){let e="";return mn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Br(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=Vr(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Gi(t,e,n))}function zr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hr(t){this.Ga=0,this.j=[],this.l=new ri,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=zr("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=zr("baseRetryDelayMs",5e3,t),this.hb=zr("retryDelaySeedMs",1e4,t),this.eb=zr("forwardChannelMaxRetries",2,t),this.xa=zr("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new hr(t&&t.concurrentRequestLimit),this.Ja=new wr,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function $r(t){if(Kr(t),3==t.H){var e=t.W++,n=Hi(t.I);if(Gi(n,"SID",t.K),Gi(n,"RID",e),Gi(n,"TYPE","terminate"),Yr(t,n),(e=new Ti(t,t.l,e)).L=2,e.A=Qi(Hi(n)),n=!1,Ae.navigator&&Ae.navigator.sendBeacon)try{n=Ae.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&Ae.Image&&((new Image).src=e.A,n=!0),n||(e.g=ls(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Di(e)}os(t)}function Wr(t){t.g&&(ts(t),t.g.cancel(),t.g=null)}function Kr(t){Wr(t),t.u&&(Ae.clearTimeout(t.u),t.u=null),ns(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Ae.clearTimeout(t.m),t.m=null)}function Gr(t){if(!fr(t.i)&&!t.m){t.m=!0;var e=t.Na;Hn||Kn(),$n||(Hn(),$n=!0),Wn.add(e,t),t.C=0}}function Qr(t,e){var n;n=e?e.m:t.W++;const i=Hi(t.I);Gi(i,"SID",t.K),Gi(i,"RID",n),Gi(i,"AID",t.V),Yr(t,i),t.o&&t.s&&Br(i,t.o,t.s),n=new Ti(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Xr(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),mr(t.i,n),Ni(n,i,e)}function Yr(t,e){t.na&&mn(t.na,(function(t,n){Gi(e,n,t)})),t.h&&Vi({},(function(t,n){Gi(e,n,t)}))}function Xr(t,e,n){n=Math.min(t.j.length,n);var i=t.h?Me(t.h.Va,t.h,t):null;t:{var r=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=e,0>n)e=Math.max(0,r[o].g-100),s=!1;else try{Er(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function Jr(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Hn||Kn(),$n||(Hn(),$n=!0),Wn.add(e,t),t.A=0}}function Zr(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=pi(Me(t.Ma,t),rs(t,t.A)),t.A++,0))}function ts(t){null!=t.B&&(Ae.clearTimeout(t.B),t.B=null)}function es(t){t.g=new Ti(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Hi(t.wa);Gi(e,"RID","rpc"),Gi(e,"SID",t.K),Gi(e,"AID",t.V),Gi(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Gi(e,"TO",t.qa),Gi(e,"TYPE","xmlhttp"),Yr(t,e),t.o&&t.s&&Br(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Qi(Hi(e)),n.u=null,n.S=!0,Ci(n,t)}function ns(t){null!=t.v&&(Ae.clearTimeout(t.v),t.v=null)}function is(t,e){var n=null;if(t.g==e){ns(t),ts(t),t.g=null;var i=2}else{if(!gr(t.i,e))return;n=e.F,yr(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.u?e.u.length:0,e=Date.now()-e.G;var r=t.C;Mn(i=li(),new fi(i,n)),Gr(t)}else Jr(t);else if(3==(r=e.s)||0==r&&0<e.ca||!(1==i&&function(t,e){return!(pr(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=pi(Me(t.Na,t,e),rs(t,t.C)),t.C++,0)))}(t,e)||2==i&&Zr(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:ss(t,5);break;case 4:ss(t,10);break;case 3:ss(t,6);break;default:ss(t,2)}}function rs(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ss(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=Me(t.pb,t);n||(n=new zi("//www.google.com/images/cleardot.gif"),Ae.location&&"http"==Ae.location.protocol||$i(n,"https"),Qi(n)),function(t,e){const n=new ri;if(Ae.Image){const i=new Image;i.onload=Pe(_r,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Pe(_r,n,i,"TestLoadImage: error",!1,e),i.onabort=Pe(_r,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Pe(_r,n,i,"TestLoadImage: timeout",!1,e),Ae.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else di(2);t.H=0,t.h&&t.h.za(e),os(t),Kr(t)}function os(t){if(t.H=0,t.ma=[],t.h){const e=vr(t.i);0==e.length&&0==t.j.length||(Be(t.ma,e),Be(t.ma,t.j),t.i.i.length=0,Ve(t.j),t.j.length=0),t.h.ya()}}function as(t,e,n){var i=n instanceof zi?Hi(n):new zi(n);if(""!=i.g)e&&(i.g=e+"."+i.g),Wi(i,i.m);else{var r=Ae.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new zi(null);i&&$i(s,i),e&&(s.g=e),r&&Wi(s,r),n&&(s.l=n),i=s}return n=t.F,e=t.Da,n&&e&&Gi(i,n,e),Gi(i,"VER",t.ra),Yr(t,i),i}function ls(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Nr(new qr({ob:n})):new Nr(t.va)).Oa(t.J),e}function cs(){}function us(){if(Ze&&!(10<=Number(cn)))throw Error("Environmental error: no available transport.")}function hs(t,e){Dn.call(this),this.g=new Hr(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!$e(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!$e(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new ps(this)}function ds(t){_i.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function fs(){qi.call(this),this.status=1}function ps(t){this.g=t}function gs(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ms(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}function ys(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var s=0|t[r];i&&s==e||(n[r]=s,i=!1)}this.g=n}(Te=Nr.prototype).Oa=function(t){this.M=t},Te.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():wi.g(),this.C=this.u?vi(this.u):vi(wi),this.g.onreadystatechange=Me(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Rr(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),r=Ae.FormData&&t instanceof Ae.FormData,!(0<=Fe(Lr,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{jr(this),0<this.B&&((this.L=function(t){return Ze&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Me(this.ua,this)):this.A=Xn(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Rr(this,t)}},Te.ua=function(){void 0!==Se&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Mn(this,"timeout"),this.abort(8))},Te.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Mn(this,"complete"),Mn(this,"abort"),Pr(this))},Te.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Pr(this,!0)),Nr.$.N.call(this)},Te.La=function(){this.s||(this.G||this.v||this.l?Mr(this):this.kb())},Te.kb=function(){Mr(this)},Te.isActive=function(){return!!this.g},Te.da=function(){try{return 2<Ur(this)?this.g.status:-1}catch(t){return-1}},Te.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Te.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ar(e)}},Te.Ia=function(){return this.m},Te.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Te=Hr.prototype).ra=8,Te.H=1,Te.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new Ti(this,this.l,t);let s=this.s;if(this.U&&(s?(s=yn(s),bn(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Xr(this,r,e),Gi(n=Hi(this.I),"RID",t),Gi(n,"CVER",22),this.F&&Gi(n,"X-HTTP-Session-Id",this.F),Yr(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Vr(s)))+"&"+e:this.o&&Br(n,this.o,s)),mr(this.i,r),this.bb&&Gi(n,"TYPE","init"),this.P?(Gi(n,"$req",e),Gi(n,"SID","null"),r.aa=!0,Ni(r,n,null)):Ni(r,n,e),this.H=2}}else 3==this.H&&(t?Qr(this,t):0==this.j.length||fr(this.i)||Qr(this))},Te.Ma=function(){if(this.u=null,es(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=pi(Me(this.jb,this),t)}},Te.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,di(10),Wr(this),es(this))},Te.ib=function(){null!=this.v&&(this.v=null,Wr(this),Zr(this),di(19))},Te.pb=function(t){t?(this.l.info("Successfully pinged google.com"),di(2)):(this.l.info("Failed to ping google.com"),di(1))},Te.isActive=function(){return!!this.h&&this.h.isActive(this)},(Te=cs.prototype).Ba=function(){},Te.Aa=function(){},Te.za=function(){},Te.ya=function(){},Te.isActive=function(){return!0},Te.Va=function(){},us.prototype.g=function(t,e){return new hs(t,e)},je(hs,Dn),hs.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;di(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=as(t,null,t.Y),Gr(t)},hs.prototype.close=function(){$r(this.g)},hs.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=jn(t),t=n);e.j.push(new ur(e.fb++,t)),3==e.H&&Gr(e)},hs.prototype.N=function(){this.g.h=null,delete this.j,$r(this.g),delete this.g,hs.$.N.call(this)},je(ds,_i),je(fs,qi),je(ps,cs),ps.prototype.Ba=function(){Mn(this.g,"a")},ps.prototype.Aa=function(t){Mn(this.g,new ds(t))},ps.prototype.za=function(t){Mn(this.g,new fs)},ps.prototype.ya=function(){Mn(this.g,"b")},je(gs,(function(){this.blockSize=-1})),gs.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},gs.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=n;)ms(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(i[r++]=t.charCodeAt(s++),r==this.blockSize){ms(this,i),r=0;break}}else for(;s<e;)if(i[r++]=t[s++],r==this.blockSize){ms(this,i),r=0;break}}this.h=r,this.i+=e},gs.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var vs={};function bs(t){return-128<=t&&128>t?function(t,e){var n=vs;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new ys([0|t],0>t?-1:0)}(t)}(t):new ys([0|t],0>t?-1:0)}function ws(t){if(isNaN(t)||!isFinite(t))return _s;if(0>t)return Is(ws(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=Es;return new ys(e,0)}var Es=4294967296,_s=bs(0),qs=bs(1),ks=bs(16777216);function Ts(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function xs(t){return-1==t.h}function Is(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new ys(n,~t.h).add(qs)}function Ss(t,e){return t.add(Is(e))}function As(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ns(t,e){this.g=t,this.h=e}function Cs(t,e){if(Ts(e))throw Error("division by zero");if(Ts(t))return new Ns(_s,_s);if(xs(t))return e=Cs(Is(t),e),new Ns(Is(e.g),Is(e.h));if(xs(e))return e=Cs(t,Is(e)),new Ns(Is(e.g),e.h);if(30<t.g.length){if(xs(t)||xs(e))throw Error("slowDivide_ only works with positive integers.");for(var n=qs,i=e;0>=i.X(t);)n=Os(n),i=Os(i);var r=Ls(n,1),s=Ls(i,1);for(i=Ls(i,2),n=Ls(n,2);!Ts(i);){var o=s.add(i);0>=o.X(t)&&(r=r.add(n),s=o),i=Ls(i,1),n=Ls(n,1)}return e=Ss(t,r.R(e)),new Ns(r,e)}for(r=_s;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=ws(n)).R(e);xs(o)||0<o.X(t);)o=(s=ws(n-=i)).R(e);Ts(s)&&(s=qs),r=r.add(s),t=Ss(t,o)}return new Ns(r,t)}function Os(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new ys(n,t.h)}function Ls(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],s=0;s<i;s++)r[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new ys(r,t.h)}(Te=ys.prototype).ea=function(){if(xs(this))return-Is(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:Es+i)*e,e*=Es}return t},Te.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Ts(this))return"0";if(xs(this))return"-"+Is(this).toString(t);for(var e=ws(Math.pow(t,6)),n=this,i="";;){var r=Cs(n,e).g,s=((0<(n=Ss(n,r.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Ts(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},Te.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},Te.X=function(t){return xs(t=Ss(this,t))?-1:Ts(t)?0:1},Te.abs=function(){return xs(this)?Is(this):this},Te.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&t.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new ys(n,-2147483648&n[n.length-1]?-1:0)},Te.R=function(t){if(Ts(this)||Ts(t))return _s;if(xs(this))return xs(t)?Is(this).R(Is(t)):Is(Is(this).R(t));if(xs(t))return Is(this.R(Is(t)));if(0>this.X(ks)&&0>t.X(ks))return ws(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=t.D(r)>>>16,l=65535&t.D(r);n[2*i+2*r]+=o*l,As(n,2*i+2*r),n[2*i+2*r+1]+=s*l,As(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,As(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,As(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new ys(n,0)},Te.gb=function(t){return Cs(this,t).h},Te.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new ys(n,this.h&t.h)},Te.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new ys(n,this.h|t.h)},Te.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new ys(n,this.h^t.h)},us.prototype.createWebChannel=us.prototype.g,hs.prototype.send=hs.prototype.u,hs.prototype.open=hs.prototype.m,hs.prototype.close=hs.prototype.close,gi.NO_ERROR=0,gi.TIMEOUT=8,gi.HTTP_ERROR=6,mi.COMPLETE="complete",bi.EventType=Ei,Ei.OPEN="a",Ei.CLOSE="b",Ei.ERROR="c",Ei.MESSAGE="d",Dn.prototype.listen=Dn.prototype.O,Nr.prototype.listenOnce=Nr.prototype.P,Nr.prototype.getLastError=Nr.prototype.Sa,Nr.prototype.getLastErrorCode=Nr.prototype.Ia,Nr.prototype.getStatus=Nr.prototype.da,Nr.prototype.getResponseJson=Nr.prototype.Wa,Nr.prototype.getResponseText=Nr.prototype.ja,Nr.prototype.send=Nr.prototype.ha,Nr.prototype.setWithCredentials=Nr.prototype.Oa,gs.prototype.digest=gs.prototype.l,gs.prototype.reset=gs.prototype.reset,gs.prototype.update=gs.prototype.j,ys.prototype.add=ys.prototype.add,ys.prototype.multiply=ys.prototype.R,ys.prototype.modulo=ys.prototype.gb,ys.prototype.compare=ys.prototype.X,ys.prototype.toNumber=ys.prototype.ea,ys.prototype.toString=ys.prototype.toString,ys.prototype.getBits=ys.prototype.D,ys.fromNumber=ws,ys.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return Is(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=ws(Math.pow(n,8)),r=_s,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=ws(Math.pow(n,o)),r=r.R(o).add(ws(a))):r=(r=r.R(i)).add(ws(a))}return r};var Rs=Ie.createWebChannelTransport=function(){return new us},Ds=Ie.getStatEventTarget=function(){return li()},Ms=Ie.ErrorCode=gi,Ps=Ie.EventType=mi,js=Ie.Event=oi,Us=Ie.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Fs=(Ie.FetchXmlHttpFactory=qr,Ie.WebChannel=bi),Vs=Ie.XhrIo=Nr,Bs=Ie.Md5=gs,zs=Ie.Integer=ys;const Hs="@firebase/firestore";class $s{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}$s.UNAUTHENTICATED=new $s(null),$s.GOOGLE_CREDENTIALS=new $s("google-credentials-uid"),$s.FIRST_PARTY=new $s("first-party-uid"),$s.MOCK_USER=new $s("mock-user");let Ws="10.8.1";const Ks=new Lt("@firebase/firestore");function Gs(){return Ks.logLevel}function Qs(t,...e){if(Ks.logLevel<=St.DEBUG){const n=e.map(Js);Ks.debug(`Firestore (${Ws}): ${t}`,...n)}}function Ys(t,...e){if(Ks.logLevel<=St.ERROR){const n=e.map(Js);Ks.error(`Firestore (${Ws}): ${t}`,...n)}}function Xs(t,...e){if(Ks.logLevel<=St.WARN){const n=e.map(Js);Ks.warn(`Firestore (${Ws}): ${t}`,...n)}}function Js(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function Zs(t="Unexpected state"){const e=`FIRESTORE (${Ws}) INTERNAL ASSERTION FAILED: `+t;throw Ys(e),new Error(e)}function to(t,e){t||Zs()}function eo(t,e){return t}const no={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class io extends dt{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ro{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class so{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class oo{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e($s.UNAUTHENTICATED)))}shutdown(){}}class ao{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class lo{constructor(t){this.t=t,this.currentUser=$s.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new ro;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new ro,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Qs("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Qs("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new ro)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Qs("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(to("string"==typeof e.accessToken),new so(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return to(null===t||"string"==typeof t),new $s(t)}}class co{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=$s.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class uo{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new co(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e($s.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ho{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fo{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&Qs("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,Qs("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Qs("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):Qs("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(to("string"==typeof t.token),this.R=t.token,new ho(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function po(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class go{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=po(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function mo(t,e){return t<e?-1:t>e?1:0}function yo(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class vo{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new io(no.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new io(no.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new io(no.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new io(no.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return vo.fromMillis(Date.now())}static fromDate(t){return vo.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new vo(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?mo(this.nanoseconds,t.nanoseconds):mo(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class bo{constructor(t){this.timestamp=t}static fromTimestamp(t){return new bo(t)}static min(){return new bo(new vo(0,0))}static max(){return new bo(new vo(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class wo{constructor(t,e,n){void 0===e?e=0:e>t.length&&Zs(),void 0===n?n=t.length-e:n>t.length-e&&Zs(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===wo.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof wo?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Eo extends wo{construct(t,e,n){return new Eo(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new io(no.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Eo(e)}static emptyPath(){return new Eo([])}}const _o=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qo extends wo{construct(t,e,n){return new qo(t,e,n)}static isValidIdentifier(t){return _o.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qo.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new qo(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new io(no.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new io(no.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new io(no.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new io(no.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new qo(e)}static emptyPath(){return new qo([])}}class ko{constructor(t){this.path=t}static fromPath(t){return new ko(Eo.fromString(t))}static fromName(t){return new ko(Eo.fromString(t).popFirst(5))}static empty(){return new ko(Eo.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Eo.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Eo.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new ko(new Eo(t.slice()))}}function To(t){return new xo(t.readTime,t.key,-1)}class xo{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new xo(bo.min(),ko.empty(),-1)}static max(){return new xo(bo.max(),ko.empty(),-1)}}function Io(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=ko.comparator(t.documentKey,e.documentKey),0!==n?n:mo(t.largestBatchId,e.largestBatchId))}const So="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ao{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function No(t){if(t.code!==no.FAILED_PRECONDITION||t.message!==So)throw t;Qs("LocalStore","Unexpectedly lost primary lease")}class Co{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Zs(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Co(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Co?e:Co.resolve(e)}catch(t){return Co.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Co.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Co.reject(e)}static resolve(t){return new Co(((e,n)=>{e(t)}))}static reject(t){return new Co(((e,n)=>{n(t)}))}static waitFor(t){return new Co(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=Co.resolve(!1);for(const n of t)e=e.next((t=>t?Co.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Co(((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const l=a;e(t[l]).next((t=>{s[l]=t,++o,o===r&&n(s)}),(t=>i(t)))}}))}static doWhile(t,e){return new Co(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}class Oo{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new ro,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Do(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=Fo(e.target.error);this.V.reject(new Do(t,n))}}static open(t,e,n,i){try{return new Oo(e,t.transaction(i,n))}catch(t){throw new Do(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(Qs("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new Po(e)}}class Lo{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===Lo.S(ut())&&Ys("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return Qs("SimpleDb","Removing database:",t),jo(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!ht())return!1;if(Lo.C())return!0;const t=ut(),e=Lo.S(t),n=0<e&&e<10,i=Lo.v(t),r=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||r)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(Qs("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=t=>{const n=t.target.result;e(n)},i.onblocked=()=>{n(new Do(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=e=>{const i=e.target.error;"VersionError"===i.name?n(new io(no.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new io(no.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new Do(t,i))},i.onupgradeneeded=t=>{Qs("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,i.transaction,t.oldVersion,this.version).next((()=>{Qs("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,i){const r="readonly"===e;let s=0;for(;;){++s;try{this.db=await this.O(t);const e=Oo.open(this.db,t,r?"readonly":"readwrite",n),s=i(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),Co.reject(t)))).toPromise();return s.catch((()=>{})),await e.m,s}catch(t){const e=t,n="FirebaseError"!==e.name&&s<3;if(Qs("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Ro{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return jo(this.k.delete())}}class Do extends io{constructor(t,e){super(no.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Mo(t){return"IndexedDbTransactionError"===t.name}class Po{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(Qs("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Qs("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),jo(n)}add(t){return Qs("SimpleDb","ADD",this.store.name,t,t),jo(this.store.add(t))}get(t){return jo(this.store.get(t)).next((e=>(void 0===e&&(e=null),Qs("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return Qs("SimpleDb","DELETE",this.store.name,t),jo(this.store.delete(t))}count(){return Qs("SimpleDb","COUNT",this.store.name),jo(this.store.count())}W(t,e){const n=this.options(t,e),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const t=i.getAll(n.range);return new Co(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new Co(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){Qs("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const i=this.cursor(n);return this.G(i,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const i=this.cursor(n);return this.G(i,e)}Z(t){const e=this.cursor({});return new Co(((n,i)=>{e.onerror=t=>{const e=Fo(t.target.error);i(e)},e.onsuccess=e=>{const i=e.target.result;i?t(i.primaryKey,i.value).next((t=>{t?i.continue():n()})):n()}}))}G(t,e){const n=[];return new Co(((i,r)=>{t.onerror=t=>{r(t.target.error)},t.onsuccess=t=>{const r=t.target.result;if(!r)return void i();const s=new Ro(r),o=e(r.primaryKey,r.value,s);if(o instanceof Co){const t=o.catch((t=>(s.done(),Co.reject(t))));n.push(t)}s.isDone?i():null===s.$?r.continue():r.continue(s.$)}})).next((()=>Co.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function jo(t){return new Co(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=Fo(t.target.error);n(e)}}))}let Uo=!1;function Fo(t){const e=Lo.S(ut());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new io("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Uo||(Uo=!0,setTimeout((()=>{throw t}),0)),t}}return t}class Vo{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function Bo(t){return null==t}function zo(t){return 0===t&&1/t==-1/0}Vo._e=-1;function Ho(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function $o(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Wo(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ko{constructor(t,e){this.comparator=t,this.root=e||Qo.EMPTY}insert(t,e){return new Ko(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Qo.BLACK,null,null))}remove(t){return new Ko(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Qo.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Go(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Go(this.root,t,this.comparator,!1)}getReverseIterator(){return new Go(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Go(this.root,t,this.comparator,!0)}}class Go{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Qo{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Qo.RED,this.left=null!=i?i:Qo.EMPTY,this.right=null!=r?r:Qo.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new Qo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Qo.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return Qo.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Qo.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Qo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Zs();if(this.right.isRed())throw Zs();const t=this.left.check();if(t!==this.right.check())throw Zs();return t+(this.isRed()?0:1)}}Qo.EMPTY=null,Qo.RED=!0,Qo.BLACK=!1,Qo.EMPTY=new class{constructor(){this.size=0}get key(){throw Zs()}get value(){throw Zs()}get color(){throw Zs()}get left(){throw Zs()}get right(){throw Zs()}copy(t,e,n,i,r){return this}insert(t,e,n){return new Qo(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Yo{constructor(t){this.comparator=t,this.data=new Ko(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Xo(this.data.getIterator())}getIteratorFrom(t){return new Xo(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Yo))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Yo(this.comparator);return e.data=t,e}}class Xo{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Jo{constructor(t){this.fields=t,t.sort(qo.comparator)}static empty(){return new Jo([])}unionWith(t){let e=new Yo(qo.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new Jo(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return yo(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class Zo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ta{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Zo("Invalid base64 string: "+t):t}}(t);return new ta(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ta(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return mo(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ta.EMPTY_BYTE_STRING=new ta("");const ea=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function na(t){if(to(!!t),"string"==typeof t){let e=0;const n=ea.exec(t);if(to(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ia(t.seconds),nanos:ia(t.nanos)}}function ia(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ra(t){return"string"==typeof t?ta.fromBase64String(t):ta.fromUint8Array(t)}function sa(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function oa(t){const e=t.mapValue.fields.__previous_value__;return sa(e)?oa(e):e}function aa(t){const e=na(t.mapValue.fields.__local_write_time__.timestampValue);return new vo(e.seconds,e.nanos)}class la{constructor(t,e,n,i,r,s,o,a,l){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class ca{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new ca("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof ca&&t.projectId===this.projectId&&t.database===this.database}}const ua={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ha(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?sa(t)?4:Ta(t)?9007199254740991:10:Zs()}function da(t,e){if(t===e)return!0;const n=ha(t);if(n!==ha(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return aa(t).isEqual(aa(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=na(t.timestampValue),i=na(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ra(t.bytesValue).isEqual(ra(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ia(t.geoPointValue.latitude)===ia(e.geoPointValue.latitude)&&ia(t.geoPointValue.longitude)===ia(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ia(t.integerValue)===ia(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=ia(t.doubleValue),i=ia(e.doubleValue);return n===i?zo(n)===zo(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return yo(t.arrayValue.values||[],e.arrayValue.values||[],da);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Ho(n)!==Ho(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!da(n[t],i[t])))return!1;return!0}(t,e);default:return Zs()}}function fa(t,e){return void 0!==(t.values||[]).find((t=>da(t,e)))}function pa(t,e){if(t===e)return 0;const n=ha(t),i=ha(e);if(n!==i)return mo(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return mo(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=ia(t.integerValue||t.doubleValue),i=ia(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return ga(t.timestampValue,e.timestampValue);case 4:return ga(aa(t),aa(e));case 5:return mo(t.stringValue,e.stringValue);case 6:return function(t,e){const n=ra(t),i=ra(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=mo(n[t],i[t]);if(0!==e)return e}return mo(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=mo(ia(t.latitude),ia(e.latitude));return 0!==n?n:mo(ia(t.longitude),ia(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=pa(n[t],i[t]);if(e)return e}return mo(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===ua.mapValue&&e===ua.mapValue)return 0;if(t===ua.mapValue)return 1;if(e===ua.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=mo(i[t],s[t]);if(0!==e)return e;const o=pa(n[i[t]],r[s[t]]);if(0!==o)return o}return mo(i.length,s.length)}(t.mapValue,e.mapValue);default:throw Zs()}}function ga(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return mo(t,e);const n=na(t),i=na(e),r=mo(n.seconds,i.seconds);return 0!==r?r:mo(n.nanos,i.nanos)}function ma(t){return ya(t)}function ya(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=na(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return ra(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return ko.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=ya(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${ya(t.fields[r])}`;return n+"}"}(t.mapValue):Zs()}function va(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ba(t){return!!t&&"integerValue"in t}function wa(t){return!!t&&"arrayValue"in t}function Ea(t){return!!t&&"nullValue"in t}function _a(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function qa(t){return!!t&&"mapValue"in t}function ka(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return $o(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=ka(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ka(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ta(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class xa{constructor(t){this.value=t}static empty(){return new xa({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!qa(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ka(e)}setAll(t){let e=qo.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=ka(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());qa(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return da(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];qa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){$o(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new xa(ka(this.value))}}function Ia(t){const e=[];return $o(t.fields,((t,n)=>{const i=new qo([t]);if(qa(n)){const t=Ia(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new Jo(e)}class Sa{constructor(t,e,n,i,r,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(t){return new Sa(t,0,bo.min(),bo.min(),bo.min(),xa.empty(),0)}static newFoundDocument(t,e,n,i){return new Sa(t,1,e,bo.min(),n,i,0)}static newNoDocument(t,e){return new Sa(t,2,e,bo.min(),bo.min(),xa.empty(),0)}static newUnknownDocument(t,e){return new Sa(t,3,e,bo.min(),bo.min(),xa.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(bo.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=xa.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=xa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=bo.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Sa&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Sa(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Aa{constructor(t,e){this.position=t,this.inclusive=e}}function Na(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?ko.comparator(ko.fromName(o.referenceValue),n.key):pa(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Ca(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!da(t.position[n],e.position[n]))return!1;return!0}class Oa{constructor(t,e="asc"){this.field=t,this.dir=e}}function La(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Ra{}class Da extends Ra{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Ba(t,e,n):"array-contains"===e?new Wa(t,n):"in"===e?new Ka(t,n):"not-in"===e?new Ga(t,n):"array-contains-any"===e?new Qa(t,n):new Da(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new za(t,n):new Ha(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(pa(e,this.value)):null!==e&&ha(this.value)===ha(e)&&this.matchesComparison(pa(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Zs()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ma extends Ra{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new Ma(t,e)}matches(t){return Pa(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Pa(t){return"and"===t.op}function ja(t){return function(t){for(const e of t.filters)if(e instanceof Ma)return!1;return!0}(t)&&Pa(t)}function Ua(t){if(t instanceof Da)return t.field.canonicalString()+t.op.toString()+ma(t.value);if(ja(t))return t.filters.map((t=>Ua(t))).join(",");{const e=t.filters.map((t=>Ua(t))).join(",");return`${t.op}(${e})`}}function Fa(t,e){return t instanceof Da?function(t,e){return e instanceof Da&&t.op===e.op&&t.field.isEqual(e.field)&&da(t.value,e.value)}(t,e):t instanceof Ma?function(t,e){return e instanceof Ma&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&Fa(n,e.filters[i])),!0)}(t,e):void Zs()}function Va(t){return t instanceof Da?function(t){return`${t.field.canonicalString()} ${t.op} ${ma(t.value)}`}(t):t instanceof Ma?function(t){return t.op.toString()+" {"+t.getFilters().map(Va).join(" ,")+"}"}(t):"Filter"}class Ba extends Da{constructor(t,e,n){super(t,e,n),this.key=ko.fromName(n.referenceValue)}matches(t){const e=ko.comparator(t.key,this.key);return this.matchesComparison(e)}}class za extends Da{constructor(t,e){super(t,"in",e),this.keys=$a(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Ha extends Da{constructor(t,e){super(t,"not-in",e),this.keys=$a(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function $a(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>ko.fromName(t.referenceValue)))}class Wa extends Da{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return wa(e)&&fa(e.arrayValue,this.value)}}class Ka extends Da{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&fa(this.value.arrayValue,e)}}class Ga extends Da{constructor(t,e){super(t,"not-in",e)}matches(t){if(fa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!fa(this.value.arrayValue,e)}}class Qa extends Da{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!wa(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>fa(this.value.arrayValue,t)))}}class Ya{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ce=null}}function Xa(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Ya(t,e,n,i,r,s,o)}function Ja(t){const e=eo(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Ua(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Bo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>ma(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>ma(t))).join(",")),e.ce=t}return e.ce}function Za(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!La(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Fa(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ca(t.startAt,e.startAt)&&Ca(t.endAt,e.endAt)}function tl(t){return ko.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class el{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function nl(t){return new el(t)}function il(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function rl(t){return null!==t.collectionGroup}function sl(t){const e=eo(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new Yo(qo.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.le.push(new Oa(i,n))})),t.has(qo.keyField().canonicalString())||e.le.push(new Oa(qo.keyField(),n))}return e.le}function ol(t){const e=eo(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return Xa(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new Oa(t.field,e)}));const n=t.endAt?new Aa(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Aa(t.startAt.position,t.startAt.inclusive):null;return Xa(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}(e,sl(t))),e.he}function al(t,e){const n=t.filters.concat([e]);return new el(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ll(t,e,n){return new el(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cl(t,e){return Za(ol(t),ol(e))&&t.limitType===e.limitType}function ul(t){return`${Ja(ol(t))}|lt:${t.limitType}`}function hl(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Va(t))).join(", ")}]`),Bo(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>ma(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>ma(t))).join(",")),`Target(${e})`}(ol(t))}; limitType=${t.limitType})`}function dl(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):ko.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of sl(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Na(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,sl(t),e)||t.endAt&&!function(t,e,n){const i=Na(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,sl(t),e))}(t,e)}function fl(t){return(e,n)=>{let i=!1;for(const r of sl(t)){const t=pl(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function pl(t,e,n){const i=t.field.isKeyField()?ko.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?pa(i,r):Zs()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Zs()}}class gl{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){$o(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return Wo(this.inner)}size(){return this.innerSize}}const ml=new Ko(ko.comparator);function yl(){return ml}const vl=new Ko(ko.comparator);function bl(...t){let e=vl;for(const n of t)e=e.insert(n.key,n);return e}function wl(t){let e=vl;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function El(){return ql()}function _l(){return ql()}function ql(){return new gl((t=>t.toString()),((t,e)=>t.isEqual(e)))}const kl=new Ko(ko.comparator),Tl=new Yo(ko.comparator);function xl(...t){let e=Tl;for(const n of t)e=e.add(n);return e}const Il=new Yo(mo);function Sl(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zo(e)?"-0":e}}function Al(t){return{integerValue:""+t}}function Nl(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!zo(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Al(e):Sl(t,e)}class Cl{constructor(){this._=void 0}}function Ol(t,e,n){return t instanceof Dl?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&sa(e)&&(e=oa(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ml?Pl(t,e):t instanceof jl?Ul(t,e):function(t,e){const n=Rl(t,e),i=Vl(n)+Vl(t.Ie);return ba(n)&&ba(t.Ie)?Al(i):Sl(t.serializer,i)}(t,e)}function Ll(t,e,n){return t instanceof Ml?Pl(t,e):t instanceof jl?Ul(t,e):n}function Rl(t,e){return t instanceof Fl?function(t){return ba(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Dl extends Cl{}class Ml extends Cl{constructor(t){super(),this.elements=t}}function Pl(t,e){const n=Bl(e);for(const e of t.elements)n.some((t=>da(t,e)))||n.push(e);return{arrayValue:{values:n}}}class jl extends Cl{constructor(t){super(),this.elements=t}}function Ul(t,e){let n=Bl(e);for(const e of t.elements)n=n.filter((t=>!da(t,e)));return{arrayValue:{values:n}}}class Fl extends Cl{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Vl(t){return ia(t.integerValue||t.doubleValue)}function Bl(t){return wa(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class zl{constructor(t,e){this.version=t,this.transformResults=e}}class Hl{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Hl}static exists(t){return new Hl(void 0,t)}static updateTime(t){return new Hl(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function $l(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Wl{}function Kl(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new ic(t.key,Hl.none()):new Jl(t.key,t.data,Hl.none());{const n=t.data,i=xa.empty();let r=new Yo(qo.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new Zl(t.key,i,new Jo(r.toArray()),Hl.none())}}function Gl(t,e,n){t instanceof Jl?function(t,e,n){const i=t.value.clone(),r=ec(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof Zl?function(t,e,n){if(!$l(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=ec(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(tc(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Ql(t,e,n,i){return t instanceof Jl?function(t,e,n,i){if(!$l(t.precondition,e))return n;const r=t.value.clone(),s=nc(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof Zl?function(t,e,n,i){if(!$l(t.precondition,e))return n;const r=nc(t.fieldTransforms,i,e),s=e.data;return s.setAll(tc(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return $l(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Yl(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=Rl(i.transform,t||null);null!=r&&(null===n&&(n=xa.empty()),n.set(i.field,r))}return n||null}function Xl(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&yo(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ml&&e instanceof Ml||t instanceof jl&&e instanceof jl?yo(t.elements,e.elements,da):t instanceof Fl&&e instanceof Fl?da(t.Ie,e.Ie):t instanceof Dl&&e instanceof Dl}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Jl extends Wl{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Zl extends Wl{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function tc(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function ec(t,e,n){const i=new Map;to(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Ll(o,a,n[r]))}return i}function nc(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Ol(t,s,e))}return i}class ic extends Wl{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class rc extends Wl{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class sc{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&Gl(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Ql(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Ql(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=_l();return this.mutations.forEach((i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=Kl(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(bo.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),xl())}isEqual(t){return this.batchId===t.batchId&&yo(this.mutations,t.mutations,((t,e)=>Xl(t,e)))&&yo(this.baseMutations,t.baseMutations,((t,e)=>Xl(t,e)))}}class oc{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){to(t.mutations.length===n.length);let i=kl;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new oc(t,e,n,i)}}class ac{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class lc{constructor(t,e){this.count=t,this.unchangedNames=e}}var cc,uc;function hc(t){if(void 0===t)return Ys("GRPC error has no .code"),no.UNKNOWN;switch(t){case cc.OK:return no.OK;case cc.CANCELLED:return no.CANCELLED;case cc.UNKNOWN:return no.UNKNOWN;case cc.DEADLINE_EXCEEDED:return no.DEADLINE_EXCEEDED;case cc.RESOURCE_EXHAUSTED:return no.RESOURCE_EXHAUSTED;case cc.INTERNAL:return no.INTERNAL;case cc.UNAVAILABLE:return no.UNAVAILABLE;case cc.UNAUTHENTICATED:return no.UNAUTHENTICATED;case cc.INVALID_ARGUMENT:return no.INVALID_ARGUMENT;case cc.NOT_FOUND:return no.NOT_FOUND;case cc.ALREADY_EXISTS:return no.ALREADY_EXISTS;case cc.PERMISSION_DENIED:return no.PERMISSION_DENIED;case cc.FAILED_PRECONDITION:return no.FAILED_PRECONDITION;case cc.ABORTED:return no.ABORTED;case cc.OUT_OF_RANGE:return no.OUT_OF_RANGE;case cc.UNIMPLEMENTED:return no.UNIMPLEMENTED;case cc.DATA_LOSS:return no.DATA_LOSS;default:return Zs()}}(uc=cc||(cc={}))[uc.OK=0]="OK",uc[uc.CANCELLED=1]="CANCELLED",uc[uc.UNKNOWN=2]="UNKNOWN",uc[uc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",uc[uc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",uc[uc.NOT_FOUND=5]="NOT_FOUND",uc[uc.ALREADY_EXISTS=6]="ALREADY_EXISTS",uc[uc.PERMISSION_DENIED=7]="PERMISSION_DENIED",uc[uc.UNAUTHENTICATED=16]="UNAUTHENTICATED",uc[uc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",uc[uc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",uc[uc.ABORTED=10]="ABORTED",uc[uc.OUT_OF_RANGE=11]="OUT_OF_RANGE",uc[uc.UNIMPLEMENTED=12]="UNIMPLEMENTED",uc[uc.INTERNAL=13]="INTERNAL",uc[uc.UNAVAILABLE=14]="UNAVAILABLE",uc[uc.DATA_LOSS=15]="DATA_LOSS";const dc=new zs([4294967295,4294967295],0);function fc(t){const e=(new TextEncoder).encode(t),n=new Bs;return n.update(e),new Uint8Array(n.digest())}function pc(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new zs([n,i],0),new zs([r,s],0)]}class gc{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new mc(`Invalid padding: ${e}`);if(n<0)throw new mc(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new mc(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new mc(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=zs.fromNumber(this.Te)}de(t,e,n){let i=t.add(e.multiply(zs.fromNumber(n)));return 1===i.compare(dc)&&(i=new zs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return 0!=(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=fc(t),[n,i]=pc(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);if(!this.Ae(e))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),s=new gc(r,i,e);return n.forEach((t=>s.insert(t))),s}insert(t){if(0===this.Te)return;const e=fc(t),[n,i]=pc(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);this.Re(e)}}Re(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class mc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class yc{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,vc.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new yc(bo.min(),i,new Ko(mo),yl(),xl())}}class vc{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new vc(n,e,xl(),xl(),xl())}}class bc{constructor(t,e,n,i){this.Ve=t,this.removedTargetIds=e,this.key=n,this.me=i}}class wc{constructor(t,e){this.targetId=t,this.fe=e}}class Ec{constructor(t,e,n=ta.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class _c{constructor(){this.ge=0,this.pe=Tc(),this.ye=ta.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=xl(),e=xl(),n=xl();return this.pe.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:Zs()}})),new vc(this.ye,this.we,t,e,n)}Fe(){this.Se=!1,this.pe=Tc()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,to(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class qc{constructor(t){this.Le=t,this.ke=new Map,this.qe=yl(),this.Qe=kc(),this.Ke=new Ko(mo)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,(e=>{const n=this.ze(e);switch(t.state){case 0:this.je(e)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(e);break;case 3:this.je(e)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),n.Ce(t.resumeToken));break;default:Zs()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach(((t,n)=>{this.je(n)&&e(n)}))}Je(t){const e=t.targetId,n=t.fe.count,i=this.Ye(e);if(i){const r=i.target;if(tl(r))if(0===n){const t=new ko(r.path);this.We(e,t,Sa.newNoDocument(t,bo.min()))}else to(1===n);else{const i=this.Ze(e);if(i!==n){const n=this.Xe(t),r=n?this.et(n,t,i):1;if(0!==r){this.He(e);const t=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,t)}}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=e;let s,o;try{s=ra(n).toUint8Array()}catch(t){if(t instanceof Zo)return Xs("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new gc(s,i,r)}catch(t){return Xs(t instanceof mc?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.Te?null:o}et(t,e,n){return e.fe.count===n-this.rt(t,e.targetId)?0:2}rt(t,e){const n=this.Le.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const r=this.Le.nt(),s=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;t.mightContain(s)||(this.We(e,n,null),i++)})),i}it(t){const e=new Map;this.ke.forEach(((n,i)=>{const r=this.Ye(i);if(r){if(n.current&&tl(r.target)){const e=new ko(r.target.path);null!==this.qe.get(e)||this.st(i,e)||this.We(i,e,Sa.newNoDocument(e,t))}n.De&&(e.set(i,n.ve()),n.Fe())}}));let n=xl();this.Qe.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Ye(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.qe.forEach(((e,n)=>n.setReadTime(t)));const i=new yc(t,e,this.Ke,this.qe,n);return this.qe=yl(),this.Qe=kc(),this.Ke=new Ko(mo),i}Ue(t,e){if(!this.je(t))return;const n=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,n),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,e)?i.Me(e,1):i.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),n&&(this.qe=this.qe.insert(e,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new _c,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new Yo(mo),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||Qs("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new _c),this.Le.getRemoteKeysForTarget(t).forEach((e=>{this.We(t,e,null)}))}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function kc(){return new Ko(ko.comparator)}function Tc(){return new Ko(ko.comparator)}const xc={asc:"ASCENDING",desc:"DESCENDING"},Ic={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Sc={and:"AND",or:"OR"};class Ac{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Nc(t,e){return t.useProto3Json||Bo(e)?e:{value:e}}function Cc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Oc(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Lc(t,e){return Cc(t,e.toTimestamp())}function Rc(t){return to(!!t),bo.fromTimestamp(function(t){const e=na(t);return new vo(e.seconds,e.nanos)}(t))}function Dc(t,e){return Mc(t,e).canonicalString()}function Mc(t,e){const n=function(t){return new Eo(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Pc(t){const e=Eo.fromString(t);return to(eu(e)),e}function jc(t,e){return Dc(t.databaseId,e.path)}function Uc(t,e){const n=Pc(e);if(n.get(1)!==t.databaseId.projectId)throw new io(no.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new io(no.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ko(Bc(n))}function Fc(t,e){return Dc(t.databaseId,e)}function Vc(t){return new Eo(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Bc(t){return to(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function zc(t,e,n){return{name:jc(t,e),fields:n.value.mapValue.fields}}function Hc(t,e){return{documents:[Fc(t,e.path)]}}function $c(t,e){const n={structuredQuery:{}},i=e.path;let r;null!==e.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Fc(t,r);const s=function(t){if(0!==t.length)return Zc(Ma.create(t,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:Xc(t.field),direction:Gc(t.dir)}}(t)))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Nc(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{ut:n,parent:r}}function Wc(t){let e=function(t){const e=Pc(t);return 4===e.length?Eo.emptyPath():Bc(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){to(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=Kc(t);return e instanceof Ma&&ja(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new Oa(Jc(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Bo(e)?null:e}(n.limit));let l=null;n.startAt&&(l=function(t){const e=!!t.before,n=t.values||[];return new Aa(n,e)}(n.startAt));let c=null;return n.endAt&&(c=function(t){const e=!t.before,n=t.values||[];return new Aa(n,e)}(n.endAt)),function(t,e,n,i,r,s,o,a){return new el(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",l,c)}function Kc(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Jc(t.unaryFilter.field);return Da.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Jc(t.unaryFilter.field);return Da.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Jc(t.unaryFilter.field);return Da.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Jc(t.unaryFilter.field);return Da.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Zs()}}(t):void 0!==t.fieldFilter?function(t){return Da.create(Jc(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Zs()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Ma.create(t.compositeFilter.filters.map((t=>Kc(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Zs()}}(t.compositeFilter.op))}(t):Zs()}function Gc(t){return xc[t]}function Qc(t){return Ic[t]}function Yc(t){return Sc[t]}function Xc(t){return{fieldPath:t.canonicalString()}}function Jc(t){return qo.fromServerFormat(t.fieldPath)}function Zc(t){return t instanceof Da?function(t){if("=="===t.op){if(_a(t.value))return{unaryFilter:{field:Xc(t.field),op:"IS_NAN"}};if(Ea(t.value))return{unaryFilter:{field:Xc(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(_a(t.value))return{unaryFilter:{field:Xc(t.field),op:"IS_NOT_NAN"}};if(Ea(t.value))return{unaryFilter:{field:Xc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xc(t.field),op:Qc(t.op),value:t.value}}}(t):t instanceof Ma?function(t){const e=t.getFilters().map((t=>Zc(t)));return 1===e.length?e[0]:{compositeFilter:{op:Yc(t.op),filters:e}}}(t):Zs()}function tu(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function eu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class nu{constructor(t,e,n,i,r=bo.min(),s=bo.min(),o=ta.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new nu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new nu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new nu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new nu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class iu{constructor(t){this.ct=t}}function ru(t){const e=Wc({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ll(e,e.limit,"L"):e}class su{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(ia(t.integerValue));else if("doubleValue"in t){const n=ia(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),zo(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(ra(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?Ta(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):Zs()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),ko.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}su.bt=new su;class ou{constructor(){this._n=new au}addToCollectionParentIndex(t,e){return this._n.add(e),Co.resolve()}getCollectionParents(t,e){return Co.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return Co.resolve()}deleteFieldIndex(t,e){return Co.resolve()}deleteAllFieldIndexes(t){return Co.resolve()}createTargetIndexes(t,e){return Co.resolve()}getDocumentsMatchingTarget(t,e){return Co.resolve(null)}getIndexType(t,e){return Co.resolve(0)}getFieldIndexes(t,e){return Co.resolve([])}getNextCollectionGroupToUpdate(t){return Co.resolve(null)}getMinOffset(t,e){return Co.resolve(xo.min())}getMinOffsetFromCollectionGroup(t,e){return Co.resolve(xo.min())}updateCollectionGroup(t,e,n){return Co.resolve()}updateIndexEntries(t,e){return Co.resolve()}}class au{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new Yo(Eo.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new Yo(Eo.comparator)).toArray()}}new Uint8Array(0);class lu{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new lu(t,lu.DEFAULT_COLLECTION_PERCENTILE,lu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}lu.DEFAULT_COLLECTION_PERCENTILE=10,lu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lu.DEFAULT=new lu(41943040,lu.DEFAULT_COLLECTION_PERCENTILE,lu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lu.DISABLED=new lu(-1,0,0);class cu{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new cu(0)}static Bn(){return new cu(-1)}}class uu{constructor(){this.changes=new gl((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Sa.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Co.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class hu{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class du{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&Ql(n.mutation,t,Jo.empty(),vo.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,xl()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=xl()){const i=El();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=bl();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=El();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,xl())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=yl();const s=ql(),o=ql();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof Zl)?r=r.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),Ql(o.mutation,e,o.mutation.getFieldMask(),vo.now())):s.set(e.key,Jo.empty())})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new hu(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=ql();let i=new Ko(((t,e)=>t-e)),r=xl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||Jo.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||xl()).add(t);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,l=i.value,c=_l();l.forEach((t=>{if(!r.has(t)){const i=Kl(e.get(t),n.get(t));null!==i&&c.set(t,i),r=r.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,c))}return Co.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return ko.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):rl(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):Co.resolve(El());let o=-1,a=r;return s.next((e=>Co.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?Co.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,a,e,xl()))).next((t=>({batchId:o,changes:wl(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new ko(e)).next((t=>{let e=bl();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const r=e.collectionGroup;let s=bl();return this.indexManager.getCollectionParents(t,r).next((o=>Co.forEach(o,(o=>{const a=function(t,e){return new el(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(r));return this.getDocumentsMatchingCollectionQuery(t,a,n,i).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,r,i)))).next((t=>{r.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,Sa.newInvalidDocument(i)))}));let n=bl();return t.forEach(((t,i)=>{const s=r.get(t);void 0!==s&&Ql(s.mutation,i,Jo.empty(),vo.now()),dl(e,i)&&(n=n.insert(t,i))})),n}))}}class fu{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return Co.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Rc(t.createTime)}}(e)),Co.resolve()}getNamedQuery(t,e){return Co.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:ru(t.bundledQuery),readTime:Rc(t.readTime)}}(e)),Co.resolve()}}class pu{constructor(){this.overlays=new Ko(ko.comparator),this.hr=new Map}getOverlay(t,e){return Co.resolve(this.overlays.get(e))}getOverlays(t,e){const n=El();return Co.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ht(t,e,i)})),Co.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.hr.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),Co.resolve()}getOverlaysForCollection(t,e,n){const i=El(),r=e.length+1,s=new ko(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Co.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new Ko(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=El(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=El(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return Co.resolve(o)}ht(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new ac(e,n));let r=this.hr.get(e);void 0===r&&(r=xl(),this.hr.set(e,r)),this.hr.set(e,r.add(n.key))}}class gu{constructor(){this.Pr=new Yo(mu.Ir),this.Tr=new Yo(mu.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new mu(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new mu(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new ko(new Eo([])),n=new mu(e,t),i=new mu(e,t+1),r=[];return this.Tr.forEachInRange([n,i],(t=>{this.Ar(t),r.push(t.key)})),r}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new ko(new Eo([])),n=new mu(e,t),i=new mu(e,t+1);let r=xl();return this.Tr.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new mu(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class mu{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return ko.comparator(t.key,e.key)||mo(t.pr,e.pr)}static Er(t,e){return mo(t.pr,e.pr)||ko.comparator(t.key,e.key)}}class yu{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new Yo(mu.Ir)}checkEmpty(t){return Co.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new sc(r,e,n,i);this.mutationQueue.push(s);for(const e of i)this.wr=this.wr.add(new mu(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Co.resolve(s)}lookupMutationBatch(t,e){return Co.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.br(n),r=i<0?0:i;return Co.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Co.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return Co.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new mu(e,0),i=new mu(e,Number.POSITIVE_INFINITY),r=[];return this.wr.forEachInRange([n,i],(t=>{const e=this.Sr(t.pr);r.push(e)})),Co.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Yo(mo);return e.forEach((t=>{const e=new mu(t,0),i=new mu(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,i],(t=>{n=n.add(t.pr)}))})),Co.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;ko.isDocumentKey(r)||(r=r.child(""));const s=new mu(new ko(r),0);let o=new Yo(mo);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.pr)),!0)}),s),Co.resolve(this.Dr(o))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){to(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return Co.forEach(e.mutations,(i=>{const r=new mu(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new mu(e,0),i=this.wr.firstAfterOrEqual(n);return Co.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Co.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class vu{constructor(t){this.vr=t,this.docs=new Ko(ko.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Co.resolve(n?n.document.mutableCopy():Sa.newInvalidDocument(e))}getEntries(t,e){let n=yl();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Sa.newInvalidDocument(t))})),Co.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let r=yl();const s=e.path,o=new ko(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||Io(To(o),n)<=0||(i.has(o.key)||dl(e,o))&&(r=r.insert(o.key,o.mutableCopy()))}return Co.resolve(r)}getAllFromCollectionGroup(t,e,n,i){Zs()}Fr(t,e){return Co.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new bu(this)}getSize(t){return Co.resolve(this.size)}}class bu extends uu{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.ar.addEntry(t,i)):this.ar.removeEntry(n)})),Co.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class wu{constructor(t){this.persistence=t,this.Mr=new gl((t=>Ja(t)),Za),this.lastRemoteSnapshotVersion=bo.min(),this.highestTargetId=0,this.Or=0,this.Nr=new gu,this.targetCount=0,this.Br=cu.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),Co.resolve()}getLastRemoteSnapshotVersion(t){return Co.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Co.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),Co.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),Co.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Br=new cu(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,Co.resolve()}updateTargetData(t,e){return this.qn(e),Co.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,Co.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Mr.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Co.waitFor(r).next((()=>i))}getTargetCount(t){return Co.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return Co.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),Co.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),Co.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),Co.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return Co.resolve(n)}containsKey(t,e){return Co.resolve(this.Nr.containsKey(e))}}class Eu{constructor(t,e){this.Lr={},this.overlays={},this.kr=new Vo(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new wu(this),this.indexManager=new ou,this.remoteDocumentCache=function(t){return new vu(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new iu(e),this.$r=new fu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new pu,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Lr[t.toKey()];return n||(n=new yu(e,this.referenceDelegate),this.Lr[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){Qs("MemoryPersistence","Starting transaction:",t);const i=new _u(this.kr.next());return this.referenceDelegate.Ur(),n(i).next((t=>this.referenceDelegate.Wr(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Gr(t,e){return Co.or(Object.values(this.Lr).map((n=>()=>n.containsKey(t,e))))}}class _u extends Ao{constructor(t){super(),this.currentSequenceNumber=t}}class qu{constructor(t){this.persistence=t,this.zr=new gu,this.jr=null}static Hr(t){return new qu(t)}get Jr(){if(this.jr)return this.jr;throw Zs()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),Co.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),Co.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),Co.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Co.forEach(this.Jr,(n=>{const i=ko.fromPath(n);return this.Yr(t,i).next((t=>{t||e.removeEntry(i,bo.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return Co.or([()=>Co.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class ku{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=i}static Ki(t,e){let n=xl(),i=xl();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new ku(t,e.fromCache,n,i)}}class Tu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class xu{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=!function(){var t;const e=null===(t=st())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:Lo.v(ut())>0?6:4}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,i){const r={result:null};return this.ji(t,e).next((t=>{r.result=t})).next((()=>{if(!r.result)return this.Hi(t,e,i,n).next((t=>{r.result=t}))})).next((()=>{if(r.result)return;const n=new Tu;return this.Ji(t,e,n).next((i=>{if(r.result=i,this.Ui)return this.Yi(t,e,n,i.size)}))})).next((()=>r.result))}Yi(t,e,n,i){return n.documentReadCount<this.Wi?(Gs()<=St.DEBUG&&Qs("QueryEngine","SDK will not create cache indexes for query:",hl(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Co.resolve()):(Gs()<=St.DEBUG&&Qs("QueryEngine","Query:",hl(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(Gs()<=St.DEBUG&&Qs("QueryEngine","The SDK decides to create cache indexes for query:",hl(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ol(e))):Co.resolve())}ji(t,e){if(il(e))return Co.resolve(null);let n=ol(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=ll(e,null,"F"),n=ol(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const r=xl(...i);return this.zi.getDocuments(t,r).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Zi(e,i);return this.Xi(e,s,r,n.readTime)?this.ji(t,ll(e,null,"F")):this.es(t,s,e,n)}))))})))))}Hi(t,e,n,i){return il(e)||i.isEqual(bo.min())?Co.resolve(null):this.zi.getDocuments(t,n).next((r=>{const s=this.Zi(e,r);return this.Xi(e,s,n,i)?Co.resolve(null):(Gs()<=St.DEBUG&&Qs("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),hl(e)),this.es(t,s,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=bo.fromTimestamp(1e9===i?new vo(n+1,0):new vo(n,i));return new xo(r,ko.empty(),e)}(i,-1)).next((t=>t)))}))}Zi(t,e){let n=new Yo(fl(t));return e.forEach(((e,i)=>{dl(t,i)&&(n=n.add(i))})),n}Xi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ji(t,e,n){return Gs()<=St.DEBUG&&Qs("QueryEngine","Using full collection scan to execute query:",hl(e)),this.zi.getDocumentsMatchingQuery(t,e,xo.min(),n)}es(t,e,n,i){return this.zi.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Iu{constructor(t,e,n,i){this.persistence=t,this.ts=e,this.serializer=i,this.ns=new Ko(mo),this.rs=new gl((t=>Ja(t)),Za),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new du(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function Su(t,e){const n=eo(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=xl();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({us:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function Au(t){const e=eo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}function Nu(t,e){const n=eo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function Cu(t,e,n){const i=eo(t),r=i.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!Mo(t))throw t;Qs("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.ns=i.ns.remove(e),i.rs.delete(r.target)}function Ou(t,e,n){const i=eo(t);let r=bo.min(),s=xl();return i.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const i=eo(t),r=i.rs.get(n);return void 0!==r?Co.resolve(i.ns.get(r)):i.Qr.getTargetData(e,n)}(i,t,ol(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Qr.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>i.ts.getDocumentsMatchingQuery(t,e,n?r:bo.min(),n?s:xl()))).next((t=>(function(t,e,n){let i=t.ss.get(e)||bo.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.ss.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,hs:s})))))}class Lu{constructor(){this.activeTargetIds=Il}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Ru{constructor(){this.no=new Lu,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new Lu,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Du{io(t){}shutdown(){}}class Mu{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Qs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){Qs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Pu=null;function ju(){return null===Pu?Pu=268435456+Math.round(2147483648*Math.random()):Pu++,"0x"+Pu.toString(16)}const Uu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Fu{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const Vu="WebChannelConnection";class Bu extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${i}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get wo(){return!1}So(t,e,n,i,r){const s=ju(),o=this.bo(t,e.toUriEncodedString());Qs("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,i,r),this.Co(t,o,a,n).then((e=>(Qs("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw Xs("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,i,r,s){return this.So(t,e,n,i,r)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+Ws,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=Uu[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,i){const r=ju();return new Promise(((s,o)=>{const a=new Vs;a.setWithCredentials(!0),a.listenOnce(Ps.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Ms.NO_ERROR:const e=a.getResponseJson();Qs(Vu,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(e)),s(e);break;case Ms.TIMEOUT:Qs(Vu,`RPC '${t}' ${r} timed out`),o(new io(no.DEADLINE_EXCEEDED,"Request time out"));break;case Ms.HTTP_ERROR:const n=a.getStatus();if(Qs(Vu,`RPC '${t}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(no).indexOf(e)>=0?e:no.UNKNOWN}(e.status);o(new io(t,e.message))}else o(new io(no.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new io(no.UNAVAILABLE,"Connection failed."));break;default:Zs()}}finally{Qs(Vu,`RPC '${t}' ${r} completed.`)}}));const l=JSON.stringify(i);Qs(Vu,`RPC '${t}' ${r} sending request:`,i),a.send(e,"POST",l,n,15)}))}Fo(t,e,n){const i=ju(),r=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=Rs(),o=Ds(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const c=r.join("");Qs(Vu,`Creating RPC '${t}' stream ${i}: ${c}`,a);const u=s.createWebChannel(c,a);let h=!1,d=!1;const f=new Fu({lo:e=>{d?Qs(Vu,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(h||(Qs(Vu,`Opening RPC '${t}' stream ${i} transport.`),u.open(),h=!0),Qs(Vu,`RPC '${t}' stream ${i} sending:`,e),u.send(e))},ho:()=>u.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(u,Fs.EventType.OPEN,(()=>{d||Qs(Vu,`RPC '${t}' stream ${i} transport opened.`)})),p(u,Fs.EventType.CLOSE,(()=>{d||(d=!0,Qs(Vu,`RPC '${t}' stream ${i} transport closed`),f.Vo())})),p(u,Fs.EventType.ERROR,(e=>{d||(d=!0,Xs(Vu,`RPC '${t}' stream ${i} transport errored:`,e),f.Vo(new io(no.UNAVAILABLE,"The operation could not be completed")))})),p(u,Fs.EventType.MESSAGE,(e=>{var n;if(!d){const r=e.data[0];to(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Qs(Vu,`RPC '${t}' stream ${i} received error:`,o);const e=o.status;let n=function(t){const e=cc[t];if(void 0!==e)return hc(e)}(e),r=o.message;void 0===n&&(n=no.INTERNAL,r="Unknown error status: "+e+" with message "+o.message),d=!0,f.Vo(new io(n,r)),u.close()}else Qs(Vu,`RPC '${t}' stream ${i} received:`,r),f.mo(r)}})),p(o,js.STAT_EVENT,(e=>{e.stat===Us.PROXY?Qs(Vu,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===Us.NOPROXY&&Qs(Vu,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function zu(){return"undefined"!=typeof document?document:null}function Hu(t){return new Ac(t,!0)}class $u{constructor(t,e,n=1e3,i=1.5,r=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=i,this.Oo=r,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),i=Math.max(0,e-n);i>0&&Qs("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,(()=>(this.Lo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class Wu{constructor(t,e,n,i,r,s,o,a){this.oi=t,this.$o=n,this.Uo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new $u(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===no.RESOURCE_EXHAUSTED?(Ys(e.toString()),Ys("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===no.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new io(no.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return Qs("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(Qs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ku extends Wu{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r}a_(t,e){return this.connection.Fo("Listen",t,e)}onMessage(t){this.jo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Zs()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.useProto3Json?(to(void 0===e||"string"==typeof e),ta.fromBase64String(e||"")):(to(void 0===e||e instanceof Uint8Array),ta.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?no.UNKNOWN:hc(t.code);return new io(e,t.message||"")}(o);n=new Ec(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Uc(t,i.document.name),s=Rc(i.document.updateTime),o=i.document.createTime?Rc(i.document.createTime):bo.min(),a=new xa({mapValue:{fields:i.document.fields}}),l=Sa.newFoundDocument(r,s,o,a),c=i.targetIds||[],u=i.removedTargetIds||[];n=new bc(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Uc(t,i.document),s=i.readTime?Rc(i.readTime):bo.min(),o=Sa.newNoDocument(r,s),a=i.removedTargetIds||[];n=new bc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Uc(t,i.document),s=i.removedTargetIds||[];n=new bc([],s,r,null)}else{if(!("filter"in e))return Zs();{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:r}=t,s=new lc(i,r),o=t.targetId;n=new wc(o,s)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return bo.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?bo.min():e.readTime?Rc(e.readTime):bo.min()}(t);return this.listener.u_(e,n)}c_(t){const e={};e.database=Vc(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=tl(i)?{documents:Hc(t,i)}:{query:$c(t,i).ut},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=Oc(t,e.resumeToken);const i=Nc(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(bo.min())>0){n.readTime=Cc(t,e.snapshotVersion.toTimestamp());const i=Nc(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Zs()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.t_(e)}l_(t){const e={};e.database=Vc(this.serializer),e.removeTarget=t,this.t_(e)}}class Gu extends Wu{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(to(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(to(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Rc(t.updateTime):Rc(e);return n.isEqual(bo.min())&&(n=Rc(e)),new zl(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Rc(t.commitTime);return this.listener.T_(n,e)}return to(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=Vc(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Jl)n={update:zc(t,e.key,e.value)};else if(e instanceof ic)n={delete:jc(t,e.key)};else if(e instanceof Zl)n={update:zc(t,e.key,e.data),updateMask:tu(e.fieldMask)};else{if(!(e instanceof rc))return Zs();n={verify:jc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Dl)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ml)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof jl)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Fl)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw Zs()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Lc(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Zs()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}class Qu extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new io(no.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.So(t,Mc(e,n),i,r,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===no.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new io(no.UNKNOWN,t.toString())}))}vo(t,e,n,i,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(t,Mc(e,n),i,s,o,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===no.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new io(no.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class Yu{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Ys(e),this.g_=!1):Qs("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class Xu{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=r,this.M_.io((t=>{n.enqueueAndForget((async()=>{oh(this)&&(Qs("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=eo(t);e.v_.add(4),await Zu(e),e.x_.set("Unknown"),e.v_.delete(4),await Ju(e)}(this))}))})),this.x_=new Yu(n,i)}}async function Ju(t){if(oh(t))for(const e of t.F_)await e(!0)}async function Zu(t){for(const e of t.F_)await e(!1)}function th(t,e){const n=eo(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),sh(n)?rh(n):qh(n).Jo()&&nh(n,e))}function eh(t,e){const n=eo(t),i=qh(n);n.C_.delete(e),i.Jo()&&ih(n,e),0===n.C_.size&&(i.Jo()?i.Xo():oh(n)&&n.x_.set("Unknown"))}function nh(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(bo.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}qh(t).c_(e)}function ih(t,e){t.O_.Oe(e),qh(t).l_(e)}function rh(t){t.O_=new qc({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),qh(t).start(),t.x_.p_()}function sh(t){return oh(t)&&!qh(t).Ho()&&t.C_.size>0}function oh(t){return 0===eo(t).v_.size}function ah(t){t.O_=void 0}async function lh(t){t.C_.forEach(((e,n)=>{nh(t,e)}))}async function ch(t,e){ah(t),sh(t)?(t.x_.S_(e),rh(t)):t.x_.set("Unknown")}async function uh(t,e,n){if(t.x_.set("Online"),e instanceof Ec&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.C_.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.C_.delete(i),t.O_.removeTarget(i))}(t,e)}catch(n){Qs("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await hh(t,n)}else if(e instanceof bc?t.O_.$e(e):e instanceof wc?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(bo.min()))try{const e=await Au(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.O_.it(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.C_.get(i);r&&t.C_.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const i=t.C_.get(e);if(!i)return;t.C_.set(e,i.withResumeToken(ta.EMPTY_BYTE_STRING,i.snapshotVersion)),ih(t,e);const r=new nu(i.target,e,n,i.sequenceNumber);nh(t,r)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){Qs("RemoteStore","Failed to raise snapshot:",e),await hh(t,e)}}async function hh(t,e,n){if(!Mo(e))throw e;t.v_.add(1),await Zu(t),t.x_.set("Offline"),n||(n=()=>Au(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Qs("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await Ju(t)}))}function dh(t,e){return e().catch((n=>hh(t,n,e)))}async function fh(t){const e=eo(t),n=kh(e);let i=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;ph(e);)try{const t=await Nu(e.localStore,i);if(null===t){0===e.D_.length&&n.Xo();break}i=t.batchId,gh(e,t)}catch(t){await hh(e,t)}mh(e)&&yh(e)}function ph(t){return oh(t)&&t.D_.length<10}function gh(t,e){t.D_.push(e);const n=kh(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function mh(t){return oh(t)&&!kh(t).Ho()&&t.D_.length>0}function yh(t){kh(t).start()}async function vh(t){kh(t).d_()}async function bh(t){const e=kh(t);for(const n of t.D_)e.I_(n.mutations)}async function wh(t,e,n){const i=t.D_.shift(),r=oc.from(i,e,n);await dh(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await fh(t)}async function Eh(t,e){e&&kh(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return Zs();case no.CANCELLED:case no.UNKNOWN:case no.DEADLINE_EXCEEDED:case no.RESOURCE_EXHAUSTED:case no.INTERNAL:case no.UNAVAILABLE:case no.UNAUTHENTICATED:return!1;case no.INVALID_ARGUMENT:case no.NOT_FOUND:case no.ALREADY_EXISTS:case no.PERMISSION_DENIED:case no.FAILED_PRECONDITION:case no.ABORTED:case no.OUT_OF_RANGE:case no.UNIMPLEMENTED:case no.DATA_LOSS:return!0}}(t)&&t!==no.ABORTED}(e.code)){const n=t.D_.shift();kh(t).Zo(),await dh(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await fh(t)}}(t,e),mh(t)&&yh(t)}async function _h(t,e){const n=eo(t);n.asyncQueue.verifyOperationInProgress(),Qs("RemoteStore","RemoteStore received new credentials");const i=oh(n);n.v_.add(3),await Zu(n),i&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await Ju(n)}function qh(t){return t.N_||(t.N_=function(t,e,n){const i=eo(t);return i.R_(),new Ku(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:lh.bind(null,t),To:ch.bind(null,t),u_:uh.bind(null,t)}),t.F_.push((async e=>{e?(t.N_.Zo(),sh(t)?rh(t):t.x_.set("Unknown")):(await t.N_.stop(),ah(t))}))),t.N_}function kh(t){return t.B_||(t.B_=function(t,e,n){const i=eo(t);return i.R_(),new Gu(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:vh.bind(null,t),To:Eh.bind(null,t),E_:bh.bind(null,t),T_:wh.bind(null,t)}),t.F_.push((async e=>{e?(t.B_.Zo(),await fh(t)):(await t.B_.stop(),t.D_.length>0&&(Qs("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}class Th{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new ro,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new Th(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new io(no.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xh(t,e){if(Ys("AsyncQueue",`${e}: ${t}`),Mo(t))return new io(no.UNAVAILABLE,`${e}: ${t}`);throw t}class Ih{constructor(t){this.comparator=t?(e,n)=>t(e,n)||ko.comparator(e.key,n.key):(t,e)=>ko.comparator(t.key,e.key),this.keyedMap=bl(),this.sortedSet=new Ko(this.comparator)}static emptySet(t){return new Ih(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Ih))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new Ih;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class Sh{constructor(){this.L_=new Ko(ko.comparator)}track(t){const e=t.doc.key,n=this.L_.get(e);n?0!==t.type&&3===n.type?this.L_=this.L_.insert(e,t):3===t.type&&1!==n.type?this.L_=this.L_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.L_=this.L_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.L_=this.L_.remove(e):1===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):Zs():this.L_=this.L_.insert(e,t)}k_(){const t=[];return this.L_.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Ah{constructor(t,e,n,i,r,s,o,a,l){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(t,e,n,i,r){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new Ah(t,e,Ih.emptySet(e),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&cl(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Nh{constructor(){this.q_=void 0,this.Q_=[]}}class Ch{constructor(){this.queries=new gl((t=>ul(t)),cl),this.onlineState="Unknown",this.K_=new Set}}function Oh(t,e){const n=eo(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.Q_)e.W_(t)&&(i=!0);r.q_=t}}i&&Rh(n)}function Lh(t,e,n){const i=eo(t),r=i.queries.get(e);if(r)for(const t of r.Q_)t.onError(n);i.queries.delete(e)}function Rh(t){t.K_.forEach((t=>{t.next()}))}class Dh{constructor(t,e,n){this.query=t,this.G_=e,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=n||{}}W_(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Ah(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.z_?this.H_(t)&&(this.G_.next(t),e=!0):this.J_(t,this.onlineState)&&(this.Y_(t),e=!0),this.j_=t,e}onError(t){this.G_.error(t)}U_(t){this.onlineState=t;let e=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),e=!0),e}J_(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Z_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}H_(t){if(t.docChanges.length>0)return!0;const e=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}Y_(t){t=Ah.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}}class Mh{constructor(t){this.key=t}}class Ph{constructor(t){this.key=t}}class jh{constructor(t,e){this.query=t,this.oa=e,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=xl(),this.mutatedKeys=xl(),this.ua=fl(t),this.ca=new Ih(this.ua)}get la(){return this.oa}ha(t,e){const n=e?e.Pa:new Sh,i=e?e.ca:this.ca;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const c=i.get(t),u=dl(this.query,e)?e:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.Ia(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.ua(u,a)>0||l&&this.ua(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{ca:s,Pa:n,Xi:o,mutatedKeys:r}}Ia(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const r=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;const s=t.Pa.k_();s.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Zs()}};return n(t)-n(e)}(t.type,e.type)||this.ua(t.doc,e.doc))),this.Ta(n),i=null!=i&&i;const o=e&&!i?this.Ea():[],a=0===this.aa.size&&this.current&&!i?1:0,l=a!==this._a;return this._a=a,0!==s.length||l?{snapshot:new Ah(this.query,t.ca,r,s,t.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),da:o}:{da:o}}U_(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new Sh,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}Ta(t){t&&(t.addedDocuments.forEach((t=>this.oa=this.oa.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.oa=this.oa.delete(t))),this.current=t.current)}Ea(){if(!this.current)return[];const t=this.aa;this.aa=xl(),this.ca.forEach((t=>{this.Aa(t.key)&&(this.aa=this.aa.add(t.key))}));const e=[];return t.forEach((t=>{this.aa.has(t)||e.push(new Ph(t))})),this.aa.forEach((n=>{t.has(n)||e.push(new Mh(n))})),e}Ra(t){this.oa=t.hs,this.aa=xl();const e=this.ha(t.documents);return this.applyChanges(e,!0)}Va(){return Ah.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}class Uh{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Fh{constructor(t){this.key=t,this.ma=!1}}class Vh{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.fa={},this.ga=new gl((t=>ul(t)),cl),this.pa=new Map,this.ya=new Set,this.wa=new Ko(ko.comparator),this.Sa=new Map,this.ba=new gu,this.Da={},this.Ca=new Map,this.va=cu.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}async function Bh(t,e){const n=function(t){const e=eo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rd.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Wh.bind(null,e),e.fa.u_=Oh.bind(null,e.eventManager),e.fa.xa=Lh.bind(null,e.eventManager),e}(t);let i,r;const s=n.ga.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.Va();else{const t=await function(t,e){const n=eo(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Qr.getTargetData(t,e).next((r=>r?(i=r,Co.resolve(i)):n.Qr.allocateTargetId(t).next((r=>(i=new nu(e,r,"TargetPurposeListen",t.currentSequenceNumber),n.Qr.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.ns.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(t.targetId,t),n.rs.set(e,t.targetId)),t}))}(n.localStore,ol(e)),s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=await async function(t,e,n,i,r){t.Ma=(e,n,i)=>async function(t,e,n,i){let r=e.view.ha(n);r.Xi&&(r=await Ou(t.localStore,e.query,!1).then((({documents:t})=>e.view.ha(t,r))));const s=i&&i.targetChanges.get(e.targetId),o=i&&null!=i.targetMismatches.get(e.targetId),a=e.view.applyChanges(r,t.isPrimaryClient,s,o);return Zh(t,e.targetId,a.da),a.snapshot}(t,e,n,i);const s=await Ou(t.localStore,e,!0),o=new jh(e,s.hs),a=o.ha(s.documents),l=vc.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),c=o.applyChanges(a,t.isPrimaryClient,l);Zh(t,n,c.da);const u=new Uh(e,n,o);return t.ga.set(e,u),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),c.snapshot}(n,e,i,"current"===s,t.resumeToken),n.isPrimaryClient&&th(n.remoteStore,t)}return r}async function zh(t,e){const n=eo(t),i=n.ga.get(e),r=n.pa.get(i.targetId);if(r.length>1)return n.pa.set(i.targetId,r.filter((t=>!cl(t,e)))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Cu(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),eh(n.remoteStore,i.targetId),Xh(n,i.targetId)})).catch(No)):(Xh(n,i.targetId),await Cu(n.localStore,i.targetId,!0))}async function Hh(t,e){const n=eo(t);try{const t=await function(t,e){const n=eo(t),i=e.snapshotVersion;let r=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.os.newChangeBuffer({trackRemovals:!0});r=n.ns;const o=[];e.targetChanges.forEach(((s,a)=>{const l=r.get(a);if(!l)return;o.push(n.Qr.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(t,s.addedDocuments,a))));let c=l.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?c=c.withResumeToken(ta.EMPTY_BYTE_STRING,bo.min()).withLastLimboFreeSnapshotVersion(bo.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,i)),r=r.insert(a,c),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.Qr.updateTargetData(t,c))}));let a=yl(),l=xl();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(function(t,e,n){let i=xl(),r=xl();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=yl();return n.forEach(((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(bo.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):Qs("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{cs:i,ls:r}}))}(t,s,e.documentUpdates).next((t=>{a=t.cs,l=t.ls}))),!i.isEqual(bo.min())){const e=n.Qr.getLastRemoteSnapshotVersion(t).next((e=>n.Qr.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return Co.waitFor(o).next((()=>s.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,l))).next((()=>a))})).then((t=>(n.ns=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.Sa.get(e);i&&(to(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.ma=!0:t.modifiedDocuments.size>0?to(i.ma):t.removedDocuments.size>0&&(to(i.ma),i.ma=!1))})),await nd(n,t,e)}catch(t){await No(t)}}function $h(t,e,n){const i=eo(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ga.forEach(((n,i)=>{const r=i.view.U_(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=eo(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.U_(e)&&(i=!0)})),i&&Rh(n)}(i.eventManager,e),t.length&&i.fa.u_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Wh(t,e,n){const i=eo(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Sa.get(e),s=r&&r.key;if(s){let t=new Ko(ko.comparator);t=t.insert(s,Sa.newNoDocument(s,bo.min()));const n=xl().add(s),r=new yc(bo.min(),new Map,new Ko(mo),t,n);await Hh(i,r),i.wa=i.wa.remove(s),i.Sa.delete(e),ed(i)}else await Cu(i.localStore,e,!1).then((()=>Xh(i,e,n))).catch(No)}async function Kh(t,e){const n=eo(t),i=e.batch.batchId;try{const t=await function(t,e){const n=eo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=Co.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);to(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=xl();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);Yh(n,i,null),Qh(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await nd(n,t)}catch(t){await No(t)}}async function Gh(t,e,n){const i=eo(t);try{const t=await function(t,e){const n=eo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(to(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);Yh(i,e,n),Qh(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await nd(i,t)}catch(n){await No(n)}}function Qh(t,e){(t.Ca.get(e)||[]).forEach((t=>{t.resolve()})),t.Ca.delete(e)}function Yh(t,e,n){const i=eo(t);let r=i.Da[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.Da[i.currentUser.toKey()]=r}}function Xh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.pa.get(e))t.ga.delete(i),n&&t.fa.xa(i,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach((e=>{t.ba.containsKey(e)||Jh(t,e)}))}function Jh(t,e){t.ya.delete(e.path.canonicalString());const n=t.wa.get(e);null!==n&&(eh(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),ed(t))}function Zh(t,e,n){for(const i of n)i instanceof Mh?(t.ba.addReference(i.key,e),td(t,i)):i instanceof Ph?(Qs("SyncEngine","Document no longer in limbo: "+i.key),t.ba.removeReference(i.key,e),t.ba.containsKey(i.key)||Jh(t,i.key)):Zs()}function td(t,e){const n=e.key,i=n.path.canonicalString();t.wa.get(n)||t.ya.has(i)||(Qs("SyncEngine","New document in limbo: "+n),t.ya.add(i),ed(t))}function ed(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){const e=t.ya.values().next().value;t.ya.delete(e);const n=new ko(Eo.fromString(e)),i=t.va.next();t.Sa.set(i,new Fh(n)),t.wa=t.wa.insert(n,i),th(t.remoteStore,new nu(ol(nl(n.path)),i,"TargetPurposeLimboResolution",Vo._e))}}async function nd(t,e,n){const i=eo(t),r=[],s=[],o=[];i.ga.isEmpty()||(i.ga.forEach(((t,a)=>{o.push(i.Ma(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=ku.Ki(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.fa.u_(r),await async function(t,e){const n=eo(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Co.forEach(e,(e=>Co.forEach(e.qi,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Co.forEach(e.Qi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!Mo(t))throw t;Qs("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.ns=n.ns.insert(e,r)}}}(i.localStore,s))}async function id(t,e){const n=eo(t);if(!n.currentUser.isEqual(e)){Qs("SyncEngine","User change. New user:",e.toKey());const t=await Su(n.localStore,e);n.currentUser=e,function(t,e){t.Ca.forEach((t=>{t.forEach((t=>{t.reject(new io(no.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ca.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await nd(n,t.us)}}function rd(t,e){const n=eo(t),i=n.Sa.get(e);if(i&&i.ma)return xl().add(i.key);{let t=xl();const i=n.pa.get(e);if(!i)return t;for(const e of i){const i=n.ga.get(e);t=t.unionWith(i.view.la)}return t}}function sd(t){const e=eo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Kh.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Gh.bind(null,e),e}class od{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Hu(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,i){return new Iu(t,e,n,i)}(this.persistence,new xu,t.initialUser,this.serializer)}createPersistence(t){return new Eu(qu.Hr,this.serializer)}createSharedClientState(t){return new Ru}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ad{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>$h(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=id.bind(null,this.syncEngine),await async function(t,e){const n=eo(t);e?(n.v_.delete(2),await Ju(n)):e||(n.v_.add(2),await Zu(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Ch}createDatastore(t){const e=Hu(t.databaseInfo.databaseId),n=function(t){return new Bu(t)}(t.databaseInfo);return function(t,e,n,i){return new Qu(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,r){return new Xu(t,e,n,i,r)}(this.localStore,this.datastore,t.asyncQueue,(t=>$h(this.syncEngine,t,0)),Mu.D()?new Mu:new Du)}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new Vh(t,e,n,i,r,s);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=eo(t);Qs("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await Zu(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}class ld{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ba(this.observer.next,t)}error(t){this.observer.error?this.Ba(this.observer.error,t):Ys("Uncaught Error in snapshot listener:",t.toString())}La(){this.muted=!0}Ba(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class cd{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=$s.UNAUTHENTICATED,this.clientId=go.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Qs("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Qs("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new io(no.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ro;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=xh(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function ud(t,e){t.asyncQueue.verifyOperationInProgress(),Qs("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Su(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function hd(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Qs("FirestoreClient","Using user provided OfflineComponentProvider");try{await ud(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===no.FAILED_PRECONDITION||t.code===no.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;Xs("Error using user provided cache. Falling back to memory cache: "+n),await ud(t,new od)}}else Qs("FirestoreClient","Using default OfflineComponentProvider"),await ud(t,new od);return t._offlineComponents}(t);Qs("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>_h(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>_h(e.remoteStore,n))),t._onlineComponents=e}async function dd(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Qs("FirestoreClient","Using user provided OnlineComponentProvider"),await hd(t,t._uninitializedComponentsProvider._online)):(Qs("FirestoreClient","Using default OnlineComponentProvider"),await hd(t,new ad))),t._onlineComponents}async function fd(t){const e=await dd(t),n=e.eventManager;return n.onListen=Bh.bind(null,e.syncEngine),n.onUnlisten=zh.bind(null,e.syncEngine),n}function pd(t,e,n={}){const i=new ro;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,r){const s=new ld({next:n=>{e.enqueueAndForget((()=>async function(t,e){const n=eo(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.Q_.indexOf(e);t>=0&&(s.Q_.splice(t,1),r=0===s.Q_.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}(t,o))),n.fromCache&&"server"===i.source?r.reject(new io(no.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:t=>r.reject(t)}),o=new Dh(n,s,{includeMetadataChanges:!0,Z_:!0});return async function(t,e){const n=eo(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new Nh),r)try{s.q_=await n.onListen(i)}catch(t){const n=xh(t,`Initialization of query '${hl(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&Rh(n)}(t,o)}(await fd(t),t.asyncQueue,e,n,i))),i.promise}function gd(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const md=new Map;function yd(t,e,n){if(!n)throw new io(no.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function vd(t){if(!ko.isDocumentKey(t))throw new io(no.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function bd(t){if(ko.isDocumentKey(t))throw new io(no.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function wd(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Zs()}function Ed(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new io(no.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=wd(t);throw new io(no.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class _d{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new io(no.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new io(no.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new io(no.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gd(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new io(no.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new io(no.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new io(no.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class qd{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _d({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new io(no.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new io(no.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _d(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new oo;switch(t.type){case"firstParty":return new uo(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new io(no.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=md.get(t);e&&(Qs("ComponentProvider","Removing Datastore"),md.delete(t),e.terminate())}(this),Promise.resolve()}}class kd{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new kd(this.firestore,t,this._query)}}class Td{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xd(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Td(this.firestore,t,this._key)}}class xd extends kd{constructor(t,e,n){super(t,e,nl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Td(this.firestore,null,new ko(t))}withConverter(t){return new xd(this.firestore,t,this._path)}}function Id(t,e,...n){if(t=_t(t),yd("collection","path",e),t instanceof qd){const i=Eo.fromString(e,...n);return bd(i),new xd(t,null,i)}{if(!(t instanceof Td||t instanceof xd))throw new io(no.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Eo.fromString(e,...n));return bd(i),new xd(t.firestore,null,i)}}class Sd{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new $u(this,"async_queue_retry"),this._u=()=>{const t=zu();t&&Qs("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=zu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const e=zu();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise((()=>{}));const e=new ro;return this.uu((()=>this.tu&&this.su?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.eu.push(t),this.cu())))}async cu(){if(0!==this.eu.length){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!Mo(t))throw t;Qs("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo((()=>this.cu()))}}uu(t){const e=this.Xa.then((()=>(this.iu=!0,t().catch((t=>{this.ru=t,this.iu=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Ys("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.iu=!1,t))))));return this.Xa=e,e}enqueueAfterDelay(t,e,n){this.au(),this.ou.indexOf(t)>-1&&(e=0);const i=Th.createAndSchedule(this,t,e,n,(t=>this.lu(t)));return this.nu.push(i),i}au(){this.ru&&Zs()}verifyOperationInProgress(){}async hu(){let t;do{t=this.Xa,await t}while(t!==this.Xa)}Pu(t){for(const e of this.nu)if(e.timerId===t)return!0;return!1}Iu(t){return this.hu().then((()=>{this.nu.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.nu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.hu()}))}Tu(t){this.ou.push(t)}lu(t){const e=this.nu.indexOf(t);this.nu.splice(e,1)}}class Ad extends qd{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Sd,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Cd(this),this._firestoreClient.terminate()}}function Nd(t){return t._firestoreClient||Cd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Cd(t){var e,n,i;const r=t._freezeSettings(),s=function(t,e,n,i){return new la(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,gd(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new cd(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}class Od{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Od(ta.fromBase64String(t))}catch(t){throw new io(no.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Od(ta.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Ld{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new io(no.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qo(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Rd{constructor(t){this._methodName=t}}class Dd{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new io(no.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new io(no.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return mo(this._lat,t._lat)||mo(this._long,t._long)}}const Md=/^__.*__$/;class Pd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new Zl(t,this.data,this.fieldMask,e,this.fieldTransforms):new Jl(t,this.data,e,this.fieldTransforms)}}class jd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new Zl(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Ud(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Zs()}}class Fd{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Eu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new Fd(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.mu(t),i}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.Eu(),i}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return Jd(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(0===t.length)throw this.pu("Document fields must not be empty");if(Ud(this.du)&&Md.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class Vd{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Hu(t)}Su(t,e,n,i=!1){return new Fd({du:t,methodName:e,wu:n,path:qo.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Bd(t){const e=t._freezeSettings(),n=Hu(t._databaseId);return new Vd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function zd(t,e,n,i,r,s={}){const o=t.Su(s.merge||s.mergeFields?2:0,e,n,r);Gd("Data must be an object, but it was:",o,i);const a=Wd(i,o);let l,c;if(s.merge)l=new Jo(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=Qd(e,i,n);if(!o.contains(r))throw new io(no.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Zd(t,r)||t.push(r)}l=new Jo(t),c=o.fieldTransforms.filter((t=>l.covers(t.field)))}else l=null,c=o.fieldTransforms;return new Pd(new xa(a),l,c)}class Hd extends Rd{_toFieldTransform(t){if(2!==t.du)throw 1===t.du?t.pu(`${this._methodName}() can only appear at the top level of your update data`):t.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Hd}}function $d(t,e){if(Kd(t=_t(t)))return Gd("Unsupported field value:",e,t),Wd(t,e);if(t instanceof Rd)return function(t,e){if(!Ud(e.du))throw e.pu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.pu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&4!==e.du)throw e.pu("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=$d(r,e.gu(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=_t(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Nl(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=vo.fromDate(t);return{timestampValue:Cc(e.serializer,n)}}if(t instanceof vo){const n=new vo(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Cc(e.serializer,n)}}if(t instanceof Dd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Od)return{bytesValue:Oc(e.serializer,t._byteString)};if(t instanceof Td){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.pu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Dc(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.pu(`Unsupported field value: ${wd(t)}`)}(t,e)}function Wd(t,e){const n={};return Wo(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$o(t,((t,i)=>{const r=$d(i,e.Ru(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function Kd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof vo||t instanceof Dd||t instanceof Od||t instanceof Td||t instanceof Rd)}function Gd(t,e,n){if(!Kd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=wd(n);throw"an object"===i?e.pu(t+" a custom object"):e.pu(t+" "+i)}}function Qd(t,e,n){if((e=_t(e))instanceof Ld)return e._internalPath;if("string"==typeof e)return Xd(t,e);throw Jd("Field path arguments must be of type string or ",t,!1,void 0,n)}const Yd=new RegExp("[~\\*/\\[\\]]");function Xd(t,e,n){if(e.search(Yd)>=0)throw Jd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ld(...e.split("."))._internalPath}catch(i){throw Jd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Jd(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new io(no.INVALID_ARGUMENT,a+t+l)}function Zd(t,e){return t.some((t=>t.isEqual(e)))}class tf{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Td(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new ef(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(nf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class ef extends tf{data(){return super.data()}}function nf(t,e){return"string"==typeof e?Xd(t,e):e instanceof Ld?e._internalPath:e._delegate._internalPath}class rf{}class sf extends rf{}function of(t,e,...n){let i=[];e instanceof rf&&i.push(e),i=i.concat(n),function(t){const e=t.filter((t=>t instanceof cf)).length,n=t.filter((t=>t instanceof af)).length;if(e>1||e>0&&n>0)throw new io(no.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const e of i)t=e._apply(t);return t}class af extends sf{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new af(t,e,n)}_apply(t){const e=this._parse(t);return ff(t._query,e),new kd(t.firestore,t.converter,al(t._query,e))}_parse(t){const e=Bd(t.firestore),n=function(t,e,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new io(no.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){df(o,s);const e=[];for(const n of o)e.push(hf(i,t,n));a={arrayValue:{values:e}}}else a=hf(i,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||df(o,s),a=function(t,e,n,i=!1){return $d(n,t.Su(i?4:3,e))}(n,"where",o,"in"===s||"not-in"===s);return Da.create(r,s,a)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value);return n}}function lf(t,e,n){const i=e,r=nf("where",t);return af._create(r,i,n)}class cf extends rf{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new cf(t,e)}_parse(t){const e=this._queryConstraints.map((e=>e._parse(t))).filter((t=>t.getFilters().length>0));return 1===e.length?e[0]:Ma.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const i=e.getFlattenedFilters();for(const t of i)ff(n,t),n=al(n,t)}(t._query,e),new kd(t.firestore,t.converter,al(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class uf extends sf{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new uf(t,e)}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new io(no.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new io(no.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Oa(e,n)}(t._query,this._field,this._direction);return new kd(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new el(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function hf(t,e,n){if("string"==typeof(n=_t(n))){if(""===n)throw new io(no.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rl(e)&&-1!==n.indexOf("/"))throw new io(no.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Eo.fromString(n));if(!ko.isDocumentKey(i))throw new io(no.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return va(t,new ko(i))}if(n instanceof Td)return va(t,n._key);throw new io(no.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wd(n)}.`)}function df(t,e){if(!Array.isArray(t)||0===t.length)throw new io(no.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ff(t,e){const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new io(no.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new io(no.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class pf{convertValue(t,e="none"){switch(ha(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ia(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(ra(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Zs()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return $o(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Dd(ia(t.latitude),ia(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=oa(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(aa(t));default:return null}}convertTimestamp(t){const e=na(t);return new vo(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Eo.fromString(t);to(eu(n));const i=new ca(n.get(1),n.get(3)),r=new ko(n.popFirst(5));return i.isEqual(e)||Ys(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}class gf{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class mf extends tf{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new yf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(nf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class yf extends mf{data(t={}){return super.data(t)}}class vf{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new gf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new yf(this._firestore,this._userDataWriter,n.key,n,new gf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new io(no.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new yf(t._firestore,t._userDataWriter,n.doc.key,n.doc,new gf(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new yf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new gf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:bf(e.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function bf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Zs()}}class wf extends pf{constructor(t){super(),this.firestore=t}convertBytes(t){return new Od(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Td(this.firestore,null,e)}}function Ef(t){t=Ed(t,kd);const e=Ed(t.firestore,Ad),n=Nd(e),i=new wf(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new io(no.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),pd(n,t._query).then((n=>new vf(e,i,t,n)))}function _f(t,e){return function(t,e){const n=new ro;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=sd(t);try{const t=await function(t,e){const n=eo(t),i=vo.now(),r=e.reduce(((t,e)=>t.add(e.key)),xl());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=yl(),l=xl();return n.os.getEntries(t,r).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(l=l.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((r=>{s=r;const o=[];for(const t of e){const e=Yl(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new Zl(t.key,e,Ia(e.value.mapValue),Hl.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:wl(s)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Da[t.currentUser.toKey()];i||(i=new Ko(mo)),i=i.insert(e,n),t.Da[t.currentUser.toKey()]=i}(i,t.batchId,n),await nd(i,t.changes),await fh(i.remoteStore)}catch(t){const e=xh(t,"Failed to persist write");n.reject(e)}}(await function(t){return dd(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Nd(t),e)}function qf(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}new WeakMap,function(t,e=!0){!function(t){Ws=t}(ue),oe(new qt("firestore",((t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new Ad(new lo(t.getProvider("auth-internal")),new fo(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new io(no.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ca(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),fe(Hs,"4.4.3",t),fe(Hs,"4.4.3","esm2017")}(),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const kf=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Tf=new ft("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),xf=new Lt("@firebase/auth");function If(t,...e){xf.logLevel<=St.ERROR&&xf.error(`Auth (${ue}): ${t}`,...e)}function Sf(t,...e){throw Cf(t,...e)}function Af(t,...e){return Cf(t,...e)}function Nf(t,e,n){const i=Object.assign(Object.assign({},kf()),{[e]:n});return new ft("auth","Firebase",i).create(e,{appName:t.name})}function Cf(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return Tf.create(t,...e)}function Of(t,e,...n){if(!t)throw Cf(e,...n)}function Lf(t){const e="INTERNAL ASSERTION FAILED: "+t;throw If(e),new Error(e)}function Rf(t,e){t||Lf(e)}function Df(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function Mf(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function Pf(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Mf()||"https:"===Mf()||function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class jf{constructor(t,e){this.shortDelay=t,this.longDelay=e,Rf(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ut())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return Pf()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Uf(t,e){Rf(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Ff{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Lf("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Lf("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Lf("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Vf={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Bf=new jf(3e4,6e4);function zf(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Hf(t,e,n,i,r={}){return $f(t,r,(async()=>{let r={},s={};i&&("GET"===e?s=i:r={body:JSON.stringify(i)});const o=yt(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),Ff.fetch()(Kf(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function $f(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},Vf),e);try{const e=new Qf(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw Yf(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Yf(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Yf(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw Yf(t,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Nf(t,a,o);Sf(t,a)}}catch(e){if(e instanceof dt)throw e;Sf(t,"network-request-failed",{message:String(e)})}}async function Wf(t,e,n,i,r={}){const s=await Hf(t,e,n,i,r);return"mfaPendingCredential"in s&&Sf(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Kf(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?Uf(t.config,r):`${t.config.apiScheme}://${r}`}function Gf(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Qf{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Af(this.auth,"network-request-failed"))),Bf.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Yf(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Af(t,e,i);return r.customData._tokenResponse=n,r}function Xf(t){return void 0!==t&&void 0!==t.enterprise}class Jf{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return Gf(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}function Zf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function tp(t){return 1e3*Number(t)}function ep(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return If("JWT malformed, contained fewer than 3 sections"),null;try{const t=rt(n);return t?JSON.parse(t):(If("Failed to decode base64 JWT payload"),null)}catch(t){return If("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}async function np(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof dt&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class ip{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class rp{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zf(this.lastLoginAt),this.creationTime=Zf(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function sp(t){var e;const n=t.auth,i=await t.getIdToken(),r=await np(t,async function(t,e){return Hf(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));Of(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=qf(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(l=t.providerData,c=o,[...l.filter((t=>!c.some((e=>e.providerId===t.providerId)))),...c]);var l,c;const u=t.isAnonymous,h=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new rp(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class op{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Of(t.idToken,"internal-error"),Of(void 0!==t.idToken,"internal-error"),Of(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=ep(t);return Of(e,"internal-error"),Of(void 0!==e.exp,"internal-error"),Of(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return Of(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(t,e){const n=await $f(t,{},(async()=>{const n=yt({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,s=Kf(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Ff.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new op;return n&&(Of("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(Of("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(Of("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new op,this.toJSON())}_performRefresh(){return Lf("not implemented")}}function ap(t,e){Of("string"==typeof t||void 0===t,"internal-error",{appName:e})}class lp{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=qf(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ip(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new rp(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await np(this,this.stsTokenManager.getToken(this.auth,t));return Of(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=_t(t),i=await n.getIdToken(e),r=ep(i);Of(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Zf(tp(r.auth_time)),issuedAtTime:Zf(tp(r.iat)),expirationTime:Zf(tp(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=_t(t);await sp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Of(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new lp(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Of(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await sp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await np(this,async function(t,e){return Hf(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,l,c;const u=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=e.createdAt)&&void 0!==l?l:void 0,y=null!==(c=e.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:E,stsTokenManager:_}=e;Of(v&&_,t,"internal-error");const q=op.fromJSON(this.name,_);Of("string"==typeof v,t,"internal-error"),ap(u,t.name),ap(h,t.name),Of("boolean"==typeof b,t,"internal-error"),Of("boolean"==typeof w,t,"internal-error"),ap(d,t.name),ap(f,t.name),ap(p,t.name),ap(g,t.name),ap(m,t.name),ap(y,t.name);const k=new lp({uid:v,auth:t,email:h,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:q,createdAt:m,lastLoginAt:y});return E&&Array.isArray(E)&&(k.providerData=E.map((t=>Object.assign({},t)))),g&&(k._redirectEventId=g),k}static async _fromIdTokenResponse(t,e,n=!1){const i=new op;i.updateFromServerResponse(e);const r=new lp({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await sp(r),r}}const cp=new Map;function up(t){Rf(t instanceof Function,"Expected a class definition");let e=cp.get(t);return e?(Rf(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,cp.set(t,e),e)}class hp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}hp.type="NONE";const dp=hp;function fp(t,e,n){return`firebase:${t}:${e}:${n}`}class pp{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=fp(this.userKey,i.apiKey,r),this.fullPersistenceKey=fp("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?lp._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new pp(up(dp),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||up(dp);const s=fp(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=lp._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new pp(r,t,n)):new pp(r,t,n)}}function gp(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(mp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ep(e))return"Blackberry";if(_p(e))return"Webos";if(yp(e))return"Safari";if((e.includes("chrome/")||vp(e))&&!e.includes("edge/"))return"Chrome";if(wp(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function mp(t=ut()){return/firefox\//i.test(t)}function yp(t=ut()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vp(t=ut()){return/crios\//i.test(t)}function bp(t=ut()){return/iemobile/i.test(t)}function wp(t=ut()){return/android/i.test(t)}function Ep(t=ut()){return/blackberry/i.test(t)}function _p(t=ut()){return/webos/i.test(t)}function qp(t=ut()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function kp(t=ut()){return qp(t)||wp(t)||_p(t)||Ep(t)||/windows phone/i.test(t)||bp(t)}function Tp(t,e=[]){let n;switch(t){case"Browser":n=gp(ut());break;case"Worker":n=`${gp(ut())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ue}/${i}`}class xp{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class Ip{constructor(t){var e,n,i,r;const s=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=s.minPasswordLength)&&void 0!==e?e:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=t.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}class Sp{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Np(this),this.idTokenSubscription=new Np(this),this.beforeStateQueue=new xp(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Tf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=up(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await pp.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Of(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await sp(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?_t(t):null;return e&&Of(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Of(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(up(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return Hf(t,"GET","/v2/passwordPolicy",zf(t,e))}(this),e=new Ip(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new ft("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return Hf(t,"POST","/v2/accounts:revokeToken",zf(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&up(t)||this._popupRedirectResolver;Of(e,this,"argument-error"),this.redirectPersistenceManager=await pp.create(this,[up(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Of(o,this,"internal-error"),o.then((()=>{s||r(this.currentUser)})),"function"==typeof e){const r=t.addObserver(e,n,i);return()=>{s=!0,r()}}{const n=t.addObserver(e);return()=>{s=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Of(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Tp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){xf.logLevel<=St.WARN&&xf.warn(`Auth (${ue}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function Ap(t){return _t(t)}class Np{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new wt(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return Of(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Cp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Op(t){return Cp.loadJS(t)}function Lp(t){return`__${t}${Math.floor(1e6*Math.random())}`}class Rp{constructor(t){this.type="recaptcha-enterprise",this.auth=Ap(t)}async verify(t="verify",e=!1){function n(e,n,i){const r=window.grecaptcha;Xf(r)?r.enterprise.ready((()=>{r.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{(async function(t,e){return Hf(t,"GET","/v2/recaptchaConfig",zf(t,e))})(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new Jf(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((r=>{if(!e&&Xf(window.grecaptcha))n(r,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let e=Cp.recaptchaEnterpriseScript;0!==e.length&&(e+=r),Op(e).then((()=>{n(r,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function Dp(t,e,n,i=!1){const r=new Rp(t);let s;try{s=await r.verify(n)}catch(t){s=await r.verify(n,!0)}const o=Object.assign({},e);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Mp(t,e,n,i){var r;if(null===(r=t._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await Dp(t,e,n,"getOobCode"===n);return i(t,r)}return i(t,e).catch((async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await Dp(t,e,n,"getOobCode"===n);return i(t,r)}return Promise.reject(r)}))}function Pp(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function jp(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Up{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Lf("not implemented")}_getIdTokenResponse(t){return Lf("not implemented")}_linkToIdToken(t,e){return Lf("not implemented")}_getReauthenticationResolver(t){return Lf("not implemented")}}async function Fp(t,e){return Hf(t,"POST","/v1/accounts:signUp",e)}async function Vp(t,e){return Wf(t,"POST","/v1/accounts:signInWithPassword",zf(t,e))}class Bp extends Up{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Bp(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Bp(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return Mp(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Vp);case"emailLink":return async function(t,e){return Wf(t,"POST","/v1/accounts:signInWithEmailLink",zf(t,e))}(t,{email:this._email,oobCode:this._password});default:Sf(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return Mp(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Fp);case"emailLink":return async function(t,e){return Wf(t,"POST","/v1/accounts:signInWithEmailLink",zf(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Sf(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function zp(t,e){return Wf(t,"POST","/v1/accounts:signInWithIdp",zf(t,e))}class Hp extends Up{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Hp(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Sf("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=qf(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Hp(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return zp(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,zp(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,zp(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=yt(e)}return t}}const $p={USER_NOT_FOUND:"user-not-found"};class Wp extends Up{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Wp({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Wp({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Wf(t,"POST","/v1/accounts:signInWithPhoneNumber",zf(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Wf(t,"POST","/v1/accounts:signInWithPhoneNumber",zf(t,e));if(n.temporaryProof)throw Yf(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Wf(t,"POST","/v1/accounts:signInWithPhoneNumber",zf(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),$p)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new Wp({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class Kp{constructor(t){var e,n,i,r,s,o;const a=vt(bt(t)),l=null!==(e=a.apiKey)&&void 0!==e?e:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Of(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=vt(bt(t)).link,n=e?vt(bt(e)).deep_link_id:null,i=vt(bt(t)).deep_link_id;return(i?vt(bt(i)).link:null)||i||n||e||t}(t);try{return new Kp(e)}catch(t){return null}}}class Gp{constructor(){this.providerId=Gp.PROVIDER_ID}static credential(t,e){return Bp._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Kp.parseLink(e);return Of(n,"argument-error"),Bp._fromEmailAndCode(t,n.code,n.tenantId)}}Gp.PROVIDER_ID="password",Gp.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Gp.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Qp{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Yp extends Qp{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Xp extends Yp{constructor(){super("facebook.com")}static credential(t){return Hp._fromParams({providerId:Xp.PROVIDER_ID,signInMethod:Xp.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Xp.credentialFromTaggedObject(t)}static credentialFromError(t){return Xp.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Xp.credential(t.oauthAccessToken)}catch(t){return null}}}Xp.FACEBOOK_SIGN_IN_METHOD="facebook.com",Xp.PROVIDER_ID="facebook.com";class Jp extends Yp{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Hp._fromParams({providerId:Jp.PROVIDER_ID,signInMethod:Jp.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Jp.credentialFromTaggedObject(t)}static credentialFromError(t){return Jp.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return Jp.credential(e,n)}catch(t){return null}}}Jp.GOOGLE_SIGN_IN_METHOD="google.com",Jp.PROVIDER_ID="google.com";class Zp extends Yp{constructor(){super("github.com")}static credential(t){return Hp._fromParams({providerId:Zp.PROVIDER_ID,signInMethod:Zp.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Zp.credentialFromTaggedObject(t)}static credentialFromError(t){return Zp.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Zp.credential(t.oauthAccessToken)}catch(t){return null}}}Zp.GITHUB_SIGN_IN_METHOD="github.com",Zp.PROVIDER_ID="github.com";class tg extends Yp{constructor(){super("twitter.com")}static credential(t,e){return Hp._fromParams({providerId:tg.PROVIDER_ID,signInMethod:tg.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return tg.credentialFromTaggedObject(t)}static credentialFromError(t){return tg.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return tg.credential(e,n)}catch(t){return null}}}tg.TWITTER_SIGN_IN_METHOD="twitter.com",tg.PROVIDER_ID="twitter.com";class eg{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await lp._fromIdTokenResponse(t,n,i),s=ng(n);return new eg({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=ng(n);return new eg({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function ng(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class ig extends dt{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ig.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new ig(t,e,n,i)}}function rg(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw ig._fromErrorAndOperation(t,n,e,i);throw n}))}function sg(t,e,n,i){return _t(t).onAuthStateChanged(e,n,i)}new WeakMap;const og="__sak";class ag{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(og,"1"),this.storage.removeItem(og),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class lg extends ag{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=ut();return yp(t)||qp(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=kp(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);!function(){const t=ut();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||r===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}lg.type="LOCAL";const cg=lg;class ug extends ag{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}ug.type="SESSION";const hg=ug;class dg{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new dg(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function fg(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}dg.receivers=[];class pg{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const l=fg("",20);i.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(c),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(c),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:l,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function gg(){return window}function mg(){return void 0!==gg().WorkerGlobalScope&&"function"==typeof gg().importScripts}const yg="firebaseLocalStorageDb",vg="firebaseLocalStorage",bg="fbase_key";class wg{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function Eg(t,e){return t.transaction([vg],e?"readwrite":"readonly").objectStore(vg)}function _g(){const t=indexedDB.open(yg,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(vg,{keyPath:bg})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(vg)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(yg);return new wg(t).toPromise()}(),e(await _g()))}))}))}async function qg(t,e,n){const i=Eg(t,!0).put({[bg]:e,value:n});return new wg(i).toPromise()}function kg(t,e){const n=Eg(t,!0).delete(e);return new wg(n).toPromise()}class Tg{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await _g()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mg()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dg._getInstance(mg()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new pg(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await _g();return await qg(t,og,"1"),await kg(t,og),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>qg(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=Eg(t,!1).get(e),i=await new wg(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>kg(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=Eg(t,!1).getAll();return new wg(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Tg.type="LOCAL";const xg=Tg;Lp("rcb"),new jf(3e4,6e4);class Ig{constructor(t){this.providerId=Ig.PROVIDER_ID,this.auth=Ap(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(Of("string"==typeof r,t,"argument-error"),Of("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){Of("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Hf(t,"POST","/v2/accounts/mfaEnrollment:start",zf(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Of("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;Of(n,t,"missing-multi-factor-info");const o=await function(t,e){return Hf(t,"POST","/v2/accounts/mfaSignIn:start",zf(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Hf(t,"POST","/v1/accounts:sendVerificationCode",zf(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,_t(e))}static credential(t,e){return Wp._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Ig.credentialFromTaggedObject(e)}static credentialFromError(t){return Ig.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Wp._fromTokenResponse(e,n):null}}function Sg(t,e){return e?up(e):(Of(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}Ig.PROVIDER_ID="phone",Ig.PHONE_SIGN_IN_METHOD="phone";class Ag extends Up{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return zp(t,this._buildIdpRequest())}_linkToIdToken(t,e){return zp(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return zp(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Ng(t){return async function(t,e,n=!1){const i="signIn",r=await rg(t,i,e),s=await eg._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}(t.auth,new Ag(t),t.bypassAuthState)}function Cg(t){const{auth:e,user:n}=t;return Of(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await np(t,rg(i,r,e,t),n);Of(s.idToken,i,"internal-error");const o=ep(s.idToken);Of(o,i,"internal-error");const{sub:a}=o;return Of(t.uid===a,i,"user-mismatch"),eg._forOperation(t,r,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&Sf(i,"user-mismatch"),t}}(n,new Ag(t),t.bypassAuthState)}async function Og(t){const{auth:e,user:n}=t;return Of(n,e,"internal-error"),async function(t,e,n=!1){const i=await np(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return eg._forOperation(t,"link",i)}(n,new Ag(t),t.bypassAuthState)}class Lg{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Ng;case"linkViaPopup":case"linkViaRedirect":return Og;case"reauthViaPopup":case"reauthViaRedirect":return Cg;default:Sf(this.auth,"internal-error")}}resolve(t){Rf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Rf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Rg=new jf(2e3,1e4);class Dg extends Lg{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Dg.currentPopupAction&&Dg.currentPopupAction.cancel(),Dg.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Of(t,this.auth,"internal-error"),t}async onExecution(){Rf(1===this.filter.length,"Popup operations only handle one event");const t=fg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Af(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Af(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dg.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Af(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,Rg.get())};t()}}Dg.currentPopupAction=null;const Mg="pendingRedirect",Pg=new Map;class jg extends Lg{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Pg.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=Vg(e),i=Fg(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}Pg.set(this.auth._key(),t)}return this.bypassAuthState||Pg.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ug(t,e){Pg.set(t._key(),e)}function Fg(t){return up(t._redirectPersistence)}function Vg(t){return fp(Mg,t.config.apiKey,t.name)}function Bg(t,e,n){return async function(t,e,n){const i=Ap(t);(function(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&Sf(t,"argument-error"),Nf(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)})(t,e,Qp),await i._initializationPromise;const r=Sg(i,n);return await async function(t,e){return Fg(t)._set(Vg(e),"true")}(r,i),r._openRedirect(i,e,"signInViaRedirect")}(t,e,n)}async function zg(t,e,n=!1){const i=Ap(t),r=Sg(i,e),s=new jg(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class Hg{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wg(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!Wg(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Af(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has($g(t))}saveEventToCache(t){this.cachedEventUids.add($g(t)),this.lastProcessedEventTime=Date.now()}}function $g(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function Wg({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const Kg=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Gg=/^https?/;function Qg(t){const e=Df(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Gg.test(n))return!1;if(Kg.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Yg=new jf(3e4,6e4);function Xg(){const t=gg().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}function Jg(t){return new Promise(((e,n)=>{var i,r,s;function o(){Xg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Xg(),n(Af(t,"network-request-failed"))},timeout:Yg.get()})}if(null===(r=null===(i=gg().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=gg().gapi)||void 0===s?void 0:s.load)){const e=Lp("iframefcb");return gg()[e]=()=>{gapi.load?o():n(Af(t,"network-request-failed"))},Op(`${Cp.gapiScript}?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw Zg=null,t}))}let Zg=null;const tm=new jf(5e3,15e3),em="__/auth/iframe",nm="emulator/auth/iframe",im={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rm=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sm(t){const e=t.config;Of(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Uf(e,nm):`https://${t.config.authDomain}/${em}`,i={apiKey:e.apiKey,appName:t.name,v:ue},r=rm.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${yt(i).slice(1)}`}const om={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class am{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const lm=encodeURIComponent("fac");async function cm(t,e,n,i,r,s){Of(t.config.authDomain,t,"auth-domain-config-required"),Of(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:ue,eventId:r};if(e instanceof Qp){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof Yp){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const l=await t._getAppCheckToken(),c=l?`#${lm}=${encodeURIComponent(l)}`:"";return`${function({config:t}){return t.emulator?Uf(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${yt(a).slice(1)}${c}`}const um="webStorageSupport",hm=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hg,this._completeRedirectFn=zg,this._overrideRedirectResult=Ug}async _openPopup(t,e,n,i){var r;return Rf(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},om),{width:i.toString(),height:r.toString(),top:s,left:o}),c=ut().toLowerCase();n&&(a=vp(c)?"_blank":n),mp(c)&&(e=e||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=ut()){var e;return qp(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",a),new am(null);const h=window.open(e||"",a,u);Of(h,t,"popup-blocked");try{h.focus()}catch(t){}return new am(h)}(t,await cm(t,e,n,Df(),i),fg())}async _openRedirect(t,e,n,i){return await this._originValidation(t),r=await cm(t,e,n,Df(),i),gg().location.href=r,new Promise((()=>{}));var r}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(Rf(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await function(t){return Zg=Zg||Jg(t),Zg}(t),n=gg().gapi;return Of(n,t,"internal-error"),e.open({where:document.body,url:sm(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:im,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=Af(t,"network-request-failed"),s=gg().setTimeout((()=>{i(r)}),tm.get());function o(){gg().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new Hg(t);return e.register("authEvent",(e=>(Of(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(um,{type:um},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[um];void 0!==r&&e(!!r),Sf(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Hf(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(Qg(t))return}catch(t){}Sf(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return kp()||yp()||qp()}};var dm="@firebase/auth",fm="1.6.1";class pm{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Of(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const gm=lt("authIdTokenMaxAge")||300;let mm=null;function ym(t=de()){const e=ae(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=ae(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(gt(n.getOptions(),null!=e?e:{}))return t;Sf(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:hm,persistence:[xg,cg,hg]}),i=lt("authTokenSyncURL");if(i){const t=(r=i,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>gm)return;const i=null==e?void 0:e.token;mm!==i&&(mm=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,n){_t(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,r){_t(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var r;const s=ot("auth");return s&&function(t,e,n){const i=Ap(t);Of(i._canInitEmulator,i,"emulator-config-failed"),Of(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=Pp(e),{host:o,port:a}=function(t){const e=Pp(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const t=r[1];return{host:t,port:jp(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:jp(e)}}}(e),l=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}var vm;!function(t){Cp=t}({loadJS:t=>new Promise(((e,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=Af("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),vm="Browser",oe(new qt("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;Of(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:vm,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Tp(vm)},l=new Sp(n,i,r,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(up);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(l,e),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),oe(new qt("auth-internal",(t=>(t=>new pm(t))(Ap(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),fe(dm,fm,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(vm)),fe(dm,fm,"esm2017");var bm=n(72),wm=n.n(bm),Em=n(825),_m=n.n(Em),qm=n(659),km=n.n(qm),Tm=n(56),xm=n.n(Tm),Im=n(540),Sm=n.n(Im),Am=n(113),Nm=n.n(Am),Cm=n(497),Om={};Om.styleTagTransform=Nm(),Om.setAttributes=xm(),Om.insert=km().bind(null,"head"),Om.domAPI=_m(),Om.insertStyleElement=Sm(),wm()(Cm.A,Om),Cm.A&&Cm.A.locals&&Cm.A.locals;const Lm=ym(),Rm=new Jp,Dm=document.getElementById("btn-sign-in"),Mm=document.getElementById("btn-sign-out"),Pm=document.getElementById("login-status-msg");Mm.style.display="none",Pm.style.display="none",Dm.onclick=async()=>{Bg(Lm,Rm).then((t=>{t.user})).catch((t=>{t.code,t.message}))},Mm.onclick=async()=>{(function(t){return _t(t).signOut()})(Lm).then((()=>{alert("Sign-out successful"),Mm.style.display="none",Pm.style.display="none"})).catch((t=>{}))};const jm=function(t,e){const n=ae(de(),"firestore").getImmediate({identifier:"(default)"});if(!n._initialized){const t=(t=>{const e=ot("firestore");if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]})();t&&function(t,e,n,i={}){var r;const s=(t=Ed(t,qd))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Xs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=$s.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[it(JSON.stringify({alg:"none",type:"JWT"})),it(JSON.stringify(s)),""].join(".")}(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new io(no.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new $s(s)}t._authCredentials=new ao(new so(e,n))}}(n,...t)}return n}();let Um;Id(jm,"users"),sg(Lm,(t=>{t&&(Um=t.uid,Mm.style.display="inline-block",Pm.style.display="flex")}));const Fm=function(t,e){return t===e||t!=t&&e!=e},Vm=function(t,e){for(var n=t.length;n--;)if(Fm(t[n][0],e))return n;return-1};var Bm=Array.prototype.splice;function zm(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}zm.prototype.clear=function(){this.__data__=[],this.size=0},zm.prototype.delete=function(t){var e=this.__data__,n=Vm(e,t);return!(n<0||(n==e.length-1?e.pop():Bm.call(e,n,1),--this.size,0))},zm.prototype.get=function(t){var e=this.__data__,n=Vm(e,t);return n<0?void 0:e[n][1]},zm.prototype.has=function(t){return Vm(this.__data__,t)>-1},zm.prototype.set=function(t,e){var n=this.__data__,i=Vm(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};const Hm=zm,$m="object"==typeof global&&global&&global.Object===Object&&global;var Wm="object"==typeof self&&self&&self.Object===Object&&self;const Km=$m||Wm||Function("return this")(),Gm=Km.Symbol;var Qm=Object.prototype,Ym=Qm.hasOwnProperty,Xm=Qm.toString,Jm=Gm?Gm.toStringTag:void 0;var Zm=Object.prototype.toString;var ty=Gm?Gm.toStringTag:void 0;const ey=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":ty&&ty in Object(t)?function(t){var e=Ym.call(t,Jm),n=t[Jm];try{t[Jm]=void 0;var i=!0}catch(t){}var r=Xm.call(t);return i&&(e?t[Jm]=n:delete t[Jm]),r}(t):function(t){return Zm.call(t)}(t)},ny=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},iy=function(t){if(!ny(t))return!1;var e=ey(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},ry=Km["__core-js_shared__"];var sy=function(){var t=/[^.]+$/.exec(ry&&ry.keys&&ry.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();var oy=Function.prototype.toString;const ay=function(t){if(null!=t){try{return oy.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var ly=/^\[object .+?Constructor\]$/,cy=Function.prototype,uy=Object.prototype,hy=cy.toString,dy=uy.hasOwnProperty,fy=RegExp("^"+hy.call(dy).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const py=function(t){return!(!ny(t)||(e=t,sy&&sy in e))&&(iy(t)?fy:ly).test(ay(t));var e},gy=function(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return py(n)?n:void 0},my=gy(Km,"Map"),yy=gy(Object,"create");var vy=Object.prototype.hasOwnProperty;var by=Object.prototype.hasOwnProperty;function wy(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}wy.prototype.clear=function(){this.__data__=yy?yy(null):{},this.size=0},wy.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},wy.prototype.get=function(t){var e=this.__data__;if(yy){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return vy.call(e,t)?e[t]:void 0},wy.prototype.has=function(t){var e=this.__data__;return yy?void 0!==e[t]:by.call(e,t)},wy.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=yy&&void 0===e?"__lodash_hash_undefined__":e,this};const Ey=wy,_y=function(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map};function qy(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}qy.prototype.clear=function(){this.size=0,this.__data__={hash:new Ey,map:new(my||Hm),string:new Ey}},qy.prototype.delete=function(t){var e=_y(this,t).delete(t);return this.size-=e?1:0,e},qy.prototype.get=function(t){return _y(this,t).get(t)},qy.prototype.has=function(t){return _y(this,t).has(t)},qy.prototype.set=function(t,e){var n=_y(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};const ky=qy;function Ty(t){var e=this.__data__=new Hm(t);this.size=e.size}Ty.prototype.clear=function(){this.__data__=new Hm,this.size=0},Ty.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Ty.prototype.get=function(t){return this.__data__.get(t)},Ty.prototype.has=function(t){return this.__data__.has(t)},Ty.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Hm){var i=n.__data__;if(!my||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new ky(i)}return n.set(t,e),this.size=n.size,this};const xy=Ty,Iy=function(){try{var t=gy(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Sy=function(t,e,n){"__proto__"==e&&Iy?Iy(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},Ay=function(t,e,n){(void 0!==n&&!Fm(t[e],n)||void 0===n&&!(e in t))&&Sy(t,e,n)},Ny=function(t,e,n){for(var i=-1,r=Object(t),s=n(t),o=s.length;o--;){var a=s[++i];if(!1===e(r[a],a,r))break}return t};var Cy="object"==typeof exports&&exports&&!exports.nodeType&&exports,Oy=Cy&&"object"==typeof module&&module&&!module.nodeType&&module,Ly=Oy&&Oy.exports===Cy?Km.Buffer:void 0,Ry=Ly?Ly.allocUnsafe:void 0;const Dy=function(t,e){if(e)return t.slice();var n=t.length,i=Ry?Ry(n):new t.constructor(n);return t.copy(i),i},My=Km.Uint8Array,Py=function(t){var e=new t.constructor(t.byteLength);return new My(e).set(new My(t)),e},jy=function(t,e){var n=e?Py(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)},Uy=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e};var Fy=Object.create;const Vy=function(){function t(){}return function(e){if(!ny(e))return{};if(Fy)return Fy(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),By=function(t,e){return function(n){return t(e(n))}},zy=By(Object.getPrototypeOf,Object);var Hy=Object.prototype;const $y=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Hy)},Wy=function(t){return"function"!=typeof t.constructor||$y(t)?{}:Vy(zy(t))},Ky=function(t){return null!=t&&"object"==typeof t},Gy=function(t){return Ky(t)&&"[object Arguments]"==ey(t)};var Qy=Object.prototype,Yy=Qy.hasOwnProperty,Xy=Qy.propertyIsEnumerable;const Jy=Gy(function(){return arguments}())?Gy:function(t){return Ky(t)&&Yy.call(t,"callee")&&!Xy.call(t,"callee")},Zy=Array.isArray,tv=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},ev=function(t){return null!=t&&tv(t.length)&&!iy(t)};var nv="object"==typeof exports&&exports&&!exports.nodeType&&exports,iv=nv&&"object"==typeof module&&module&&!module.nodeType&&module,rv=iv&&iv.exports===nv?Km.Buffer:void 0;const sv=(rv?rv.isBuffer:void 0)||function(){return!1};var ov=Function.prototype,av=Object.prototype,lv=ov.toString,cv=av.hasOwnProperty,uv=lv.call(Object);var hv={};hv["[object Float32Array]"]=hv["[object Float64Array]"]=hv["[object Int8Array]"]=hv["[object Int16Array]"]=hv["[object Int32Array]"]=hv["[object Uint8Array]"]=hv["[object Uint8ClampedArray]"]=hv["[object Uint16Array]"]=hv["[object Uint32Array]"]=!0,hv["[object Arguments]"]=hv["[object Array]"]=hv["[object ArrayBuffer]"]=hv["[object Boolean]"]=hv["[object DataView]"]=hv["[object Date]"]=hv["[object Error]"]=hv["[object Function]"]=hv["[object Map]"]=hv["[object Number]"]=hv["[object Object]"]=hv["[object RegExp]"]=hv["[object Set]"]=hv["[object String]"]=hv["[object WeakMap]"]=!1;const dv=function(t){return function(e){return t(e)}};var fv="object"==typeof exports&&exports&&!exports.nodeType&&exports,pv=fv&&"object"==typeof module&&module&&!module.nodeType&&module,gv=pv&&pv.exports===fv&&$m.process;const mv=function(){try{return pv&&pv.require&&pv.require("util").types||gv&&gv.binding&&gv.binding("util")}catch(t){}}();var yv=mv&&mv.isTypedArray;const vv=yv?dv(yv):function(t){return Ky(t)&&tv(t.length)&&!!hv[ey(t)]},bv=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var wv=Object.prototype.hasOwnProperty;const Ev=function(t,e,n){var i=t[e];wv.call(t,e)&&Fm(i,n)&&(void 0!==n||e in t)||Sy(t,e,n)},_v=function(t,e,n,i){var r=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(n[a],t[a],a,n,t):void 0;void 0===l&&(l=t[a]),r?Sy(n,a,l):Ev(n,a,l)}return n};var qv=/^(?:0|[1-9]\d*)$/;const kv=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&qv.test(t))&&t>-1&&t%1==0&&t<e};var Tv=Object.prototype.hasOwnProperty;const xv=function(t,e){var n=Zy(t),i=!n&&Jy(t),r=!n&&!i&&sv(t),s=!n&&!i&&!r&&vv(t),o=n||i||r||s,a=o?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],l=a.length;for(var c in t)!e&&!Tv.call(t,c)||o&&("length"==c||r&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||kv(c,l))||a.push(c);return a};var Iv=Object.prototype.hasOwnProperty;const Sv=function(t){if(!ny(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=$y(t),n=[];for(var i in t)("constructor"!=i||!e&&Iv.call(t,i))&&n.push(i);return n},Av=function(t){return ev(t)?xv(t,!0):Sv(t)},Nv=function(t,e,n,i,r,s,o){var a,l=bv(t,n),c=bv(e,n),u=o.get(c);if(u)Ay(t,n,u);else{var h=s?s(l,c,n+"",t,e,o):void 0,d=void 0===h;if(d){var f=Zy(c),p=!f&&sv(c),g=!f&&!p&&vv(c);h=c,f||p||g?Zy(l)?h=l:Ky(a=l)&&ev(a)?h=Uy(l):p?(d=!1,h=Dy(c,!0)):g?(d=!1,h=jy(c,!0)):h=[]:function(t){if(!Ky(t)||"[object Object]"!=ey(t))return!1;var e=zy(t);if(null===e)return!0;var n=cv.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&lv.call(n)==uv}(c)||Jy(c)?(h=l,Jy(l)?h=function(t){return _v(t,Av(t))}(l):ny(l)&&!iy(l)||(h=Wy(c))):d=!1}d&&(o.set(c,h),r(h,c,i,s,o),o.delete(c)),Ay(t,n,h)}},Cv=function t(e,n,i,r,s){e!==n&&Ny(n,(function(o,a){if(s||(s=new xy),ny(o))Nv(e,n,a,i,t,r,s);else{var l=r?r(bv(e,a),o,a+"",e,n,s):void 0;void 0===l&&(l=o),Ay(e,a,l)}}),Av)},Ov=function(t){return t};var Lv=Math.max;const Rv=Iy?function(t,e){return Iy(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:Ov;var Dv=Date.now;const Mv=(Pv=Rv,jv=0,Uv=0,function(){var t=Dv(),e=16-(t-Uv);if(Uv=t,e>0){if(++jv>=800)return arguments[0]}else jv=0;return Pv.apply(void 0,arguments)});var Pv,jv,Uv;const Fv=function(t,e){return Mv(function(t,e,n){return e=Lv(void 0===e?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=Lv(i.length-e,0),o=Array(s);++r<s;)o[r]=i[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=i[r];return a[e]=n(o),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,a)}}(t,e,Ov),t+"")},Vv=(Bv=function(t,e,n){Cv(t,e,n)},Fv((function(t,e){var n=-1,i=e.length,r=i>1?e[i-1]:void 0,s=i>2?e[2]:void 0;for(r=Bv.length>3&&"function"==typeof r?(i--,r):void 0,s&&function(t,e,n){if(!ny(n))return!1;var i=typeof e;return!!("number"==i?ev(n)&&kv(e,n.length):"string"==i&&e in n)&&Fm(n[e],t)}(e[0],e[1],s)&&(r=i<3?void 0:r,i=1),t=Object(t);++n<i;){var o=e[n];o&&Bv(t,o,n)}return t})));var Bv;const zv=By(Object.keys,Object);var Hv=Object.prototype.hasOwnProperty;const $v=function(t){return ev(t)?xv(t):function(t){if(!$y(t))return zv(t);var e=[];for(var n in Object(t))Hv.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)},Wv=function(){return[]};var Kv=Object.prototype.propertyIsEnumerable,Gv=Object.getOwnPropertySymbols;const Qv=Gv?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[r++]=o)}return s}(Gv(t),(function(e){return Kv.call(t,e)})))}:Wv,Yv=function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t},Xv=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Yv(e,Qv(t)),t=zy(t);return e}:Wv,Jv=function(t,e,n){var i=e(t);return Zy(t)?i:Yv(i,n(t))},Zv=function(t){return Jv(t,$v,Qv)},tb=function(t){return Jv(t,Av,Xv)},eb=gy(Km,"DataView"),nb=gy(Km,"Promise"),ib=gy(Km,"Set"),rb=gy(Km,"WeakMap");var sb="[object Map]",ob="[object Promise]",ab="[object Set]",lb="[object WeakMap]",cb="[object DataView]",ub=ay(eb),hb=ay(my),db=ay(nb),fb=ay(ib),pb=ay(rb),gb=ey;(eb&&gb(new eb(new ArrayBuffer(1)))!=cb||my&&gb(new my)!=sb||nb&&gb(nb.resolve())!=ob||ib&&gb(new ib)!=ab||rb&&gb(new rb)!=lb)&&(gb=function(t){var e=ey(t),n="[object Object]"==e?t.constructor:void 0,i=n?ay(n):"";if(i)switch(i){case ub:return cb;case hb:return sb;case db:return ob;case fb:return ab;case pb:return lb}return e});const mb=gb;var yb=Object.prototype.hasOwnProperty;var vb=/\w*$/;var bb=Gm?Gm.prototype:void 0,wb=bb?bb.valueOf:void 0;const Eb=function(t,e,n){var i,r,s,o=t.constructor;switch(e){case"[object ArrayBuffer]":return Py(t);case"[object Boolean]":case"[object Date]":return new o(+t);case"[object DataView]":return function(t,e){var n=e?Py(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return jy(t,n);case"[object Map]":case"[object Set]":return new o;case"[object Number]":case"[object String]":return new o(t);case"[object RegExp]":return(s=new(r=t).constructor(r.source,vb.exec(r))).lastIndex=r.lastIndex,s;case"[object Symbol]":return i=t,wb?Object(wb.call(i)):{}}};var _b=mv&&mv.isMap;const qb=_b?dv(_b):function(t){return Ky(t)&&"[object Map]"==mb(t)};var kb=mv&&mv.isSet;const Tb=kb?dv(kb):function(t){return Ky(t)&&"[object Set]"==mb(t)};var xb="[object Arguments]",Ib="[object Function]",Sb="[object Object]",Ab={};Ab[xb]=Ab["[object Array]"]=Ab["[object ArrayBuffer]"]=Ab["[object DataView]"]=Ab["[object Boolean]"]=Ab["[object Date]"]=Ab["[object Float32Array]"]=Ab["[object Float64Array]"]=Ab["[object Int8Array]"]=Ab["[object Int16Array]"]=Ab["[object Int32Array]"]=Ab["[object Map]"]=Ab["[object Number]"]=Ab[Sb]=Ab["[object RegExp]"]=Ab["[object Set]"]=Ab["[object String]"]=Ab["[object Symbol]"]=Ab["[object Uint8Array]"]=Ab["[object Uint8ClampedArray]"]=Ab["[object Uint16Array]"]=Ab["[object Uint32Array]"]=!0,Ab["[object Error]"]=Ab[Ib]=Ab["[object WeakMap]"]=!1;const Nb=function t(e,n,i,r,s,o){var a,l=1&n,c=2&n,u=4&n;if(i&&(a=s?i(e,r,s,o):i(e)),void 0!==a)return a;if(!ny(e))return e;var h=Zy(e);if(h){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&yb.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(e),!l)return Uy(e,a)}else{var d=mb(e),f=d==Ib||"[object GeneratorFunction]"==d;if(sv(e))return Dy(e,l);if(d==Sb||d==xb||f&&!s){if(a=c||f?{}:Wy(e),!l)return c?function(t,e){return _v(t,Xv(t),e)}(e,function(t,e){return t&&_v(e,Av(e),t)}(a,e)):function(t,e){return _v(t,Qv(t),e)}(e,function(t,e){return t&&_v(e,$v(e),t)}(a,e))}else{if(!Ab[d])return s?e:{};a=Eb(e,d,l)}}o||(o=new xy);var p=o.get(e);if(p)return p;o.set(e,a),Tb(e)?e.forEach((function(r){a.add(t(r,n,i,r,e,o))})):qb(e)&&e.forEach((function(r,s){a.set(s,t(r,n,i,s,e,o))}));var g=h?void 0:(u?c?tb:Zv:c?Av:$v)(e);return function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););}(g||e,(function(r,s){g&&(r=e[s=r]),Ev(a,s,t(r,n,i,s,e,o))})),a},Cb=function(t){return Nb(t,5)};var Ob=(t=>(t[t.TYPE=3]="TYPE",t[t.LEVEL=12]="LEVEL",t[t.ATTRIBUTE=13]="ATTRIBUTE",t[t.BLOT=14]="BLOT",t[t.INLINE=7]="INLINE",t[t.BLOCK=11]="BLOCK",t[t.BLOCK_BLOT=10]="BLOCK_BLOT",t[t.INLINE_BLOT=6]="INLINE_BLOT",t[t.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",t[t.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",t[t.ANY=15]="ANY",t))(Ob||{});class Lb{constructor(t,e,n={}){this.attrName=t,this.keyName=e;const i=Ob.TYPE&Ob.ATTRIBUTE;this.scope=null!=n.scope?n.scope&Ob.LEVEL|i:Ob.ATTRIBUTE,null!=n.whitelist&&(this.whitelist=n.whitelist)}static keys(t){return Array.from(t.attributes).map((t=>t.name))}add(t,e){return!!this.canAdd(t,e)&&(t.setAttribute(this.keyName,e),!0)}canAdd(t,e){return null==this.whitelist||("string"==typeof e?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1)}remove(t){t.removeAttribute(this.keyName)}value(t){const e=t.getAttribute(this.keyName);return this.canAdd(t,e)&&e?e:""}}class Rb extends Error{constructor(t){super(t="[Parchment] "+t),this.message=t,this.name=this.constructor.name}}const Db=class t{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(t,e=!1){if(null==t)return null;if(this.blots.has(t))return this.blots.get(t)||null;if(e){let n=null;try{n=t.parentNode}catch{return null}return this.find(n,e)}return null}create(e,n,i){const r=this.query(n);if(null==r)throw new Rb(`Unable to create ${n} blot`);const s=r,o=n instanceof Node||n.nodeType===Node.TEXT_NODE?n:s.create(i),a=new s(e,o,i);return t.blots.set(a.domNode,a),a}find(e,n=!1){return t.find(e,n)}query(t,e=Ob.ANY){let n;return"string"==typeof t?n=this.types[t]||this.attributes[t]:t instanceof Text||t.nodeType===Node.TEXT_NODE?n=this.types.text:"number"==typeof t?t&Ob.LEVEL&Ob.BLOCK?n=this.types.block:t&Ob.LEVEL&Ob.INLINE&&(n=this.types.inline):t instanceof Element&&((t.getAttribute("class")||"").split(/\s+/).some((t=>(n=this.classes[t],!!n))),n=n||this.tags[t.tagName]),null==n?null:"scope"in n&&e&Ob.LEVEL&n.scope&&e&Ob.TYPE&n.scope?n:null}register(...t){return t.map((t=>{const e="blotName"in t,n="attrName"in t;if(!e&&!n)throw new Rb("Invalid definition");if(e&&"abstract"===t.blotName)throw new Rb("Cannot register abstract class");const i=e?t.blotName:n?t.attrName:void 0;return this.types[i]=t,n?"string"==typeof t.keyName&&(this.attributes[t.keyName]=t):e&&(t.className&&(this.classes[t.className]=t),t.tagName&&(Array.isArray(t.tagName)?t.tagName=t.tagName.map((t=>t.toUpperCase())):t.tagName=t.tagName.toUpperCase(),(Array.isArray(t.tagName)?t.tagName:[t.tagName]).forEach((e=>{(null==this.tags[e]||null==t.className)&&(this.tags[e]=t)})))),t}))}};Db.blots=new WeakMap;let Mb=Db;function Pb(t,e){return(t.getAttribute("class")||"").split(/\s+/).filter((t=>0===t.indexOf(`${e}-`)))}class jb extends Lb{static keys(t){return(t.getAttribute("class")||"").split(/\s+/).map((t=>t.split("-").slice(0,-1).join("-")))}add(t,e){return!!this.canAdd(t,e)&&(this.remove(t),t.classList.add(`${this.keyName}-${e}`),!0)}remove(t){Pb(t,this.keyName).forEach((e=>{t.classList.remove(e)})),0===t.classList.length&&t.removeAttribute("class")}value(t){const e=(Pb(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,e)?e:""}}function Ub(t){const e=t.split("-"),n=e.slice(1).map((t=>t[0].toUpperCase()+t.slice(1))).join("");return e[0]+n}class Fb extends Lb{static keys(t){return(t.getAttribute("style")||"").split(";").map((t=>t.split(":")[0].trim()))}add(t,e){return!!this.canAdd(t,e)&&(t.style[Ub(this.keyName)]=e,!0)}remove(t){t.style[Ub(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")}value(t){const e=t.style[Ub(this.keyName)];return this.canAdd(t,e)?e:""}}class Vb{constructor(t){this.attributes={},this.domNode=t,this.build()}attribute(t,e){e?t.add(this.domNode,e)&&(null!=t.value(this.domNode)?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])}build(){this.attributes={};const t=Mb.find(this.domNode);if(null==t)return;const e=Lb.keys(this.domNode),n=jb.keys(this.domNode),i=Fb.keys(this.domNode);e.concat(n).concat(i).forEach((e=>{const n=t.scroll.query(e,Ob.ATTRIBUTE);n instanceof Lb&&(this.attributes[n.attrName]=n)}))}copy(t){Object.keys(this.attributes).forEach((e=>{const n=this.attributes[e].value(this.domNode);t.format(e,n)}))}move(t){this.copy(t),Object.keys(this.attributes).forEach((t=>{this.attributes[t].remove(this.domNode)})),this.attributes={}}values(){return Object.keys(this.attributes).reduce(((t,e)=>(t[e]=this.attributes[e].value(this.domNode),t)),{})}}const Bb=class{constructor(t,e){this.scroll=t,this.domNode=e,Mb.blots.set(e,this),this.prev=null,this.next=null}static create(t){if(null==this.tagName)throw new Rb("Blot definition missing tagName");let e,n;return Array.isArray(this.tagName)?("string"==typeof t?(n=t.toUpperCase(),parseInt(n,10).toString()===n&&(n=parseInt(n,10))):"number"==typeof t&&(n=t),e="number"==typeof n?document.createElement(this.tagName[n-1]):n&&this.tagName.indexOf(n)>-1?document.createElement(n):document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e}get statics(){return this.constructor}attach(){}clone(){const t=this.domNode.cloneNode(!1);return this.scroll.create(t)}detach(){null!=this.parent&&this.parent.removeChild(this),Mb.blots.delete(this.domNode)}deleteAt(t,e){this.isolate(t,e).remove()}formatAt(t,e,n,i){const r=this.isolate(t,e);if(null!=this.scroll.query(n,Ob.BLOT)&&i)r.wrap(n,i);else if(null!=this.scroll.query(n,Ob.ATTRIBUTE)){const t=this.scroll.create(this.statics.scope);r.wrap(t),t.format(n,i)}}insertAt(t,e,n){const i=null==n?this.scroll.create("text",e):this.scroll.create(e,n),r=this.split(t);this.parent.insertBefore(i,r||void 0)}isolate(t,e){const n=this.split(t);if(null==n)throw new Error("Attempt to isolate at end");return n.split(e),n}length(){return 1}offset(t=this.parent){return null==this.parent||this===t?0:this.parent.children.offset(this)+this.parent.offset(t)}optimize(t){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(t,e){const n="string"==typeof t?this.scroll.create(t,e):t;return null!=this.parent&&(this.parent.insertBefore(n,this.next||void 0),this.remove()),n}split(t,e){return 0===t?this:this.next}update(t,e){}wrap(t,e){const n="string"==typeof t?this.scroll.create(t,e):t;if(null!=this.parent&&this.parent.insertBefore(n,this.next||void 0),"function"!=typeof n.appendChild)throw new Rb(`Cannot wrap ${t}`);return n.appendChild(this),n}};Bb.blotName="abstract";let zb=Bb;const Hb=class extends zb{static value(t){return!0}index(t,e){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1}position(t,e){let n=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return t>0&&(n+=1),[this.parent.domNode,n]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};Hb.scope=Ob.INLINE_BLOT;let $b=Hb;class Wb{constructor(){this.head=null,this.tail=null,this.length=0}append(...t){if(this.insertBefore(t[0],null),t.length>1){const e=t.slice(1);this.append(...e)}}at(t){const e=this.iterator();let n=e();for(;n&&t>0;)t-=1,n=e();return n}contains(t){const e=this.iterator();let n=e();for(;n;){if(n===t)return!0;n=e()}return!1}indexOf(t){const e=this.iterator();let n=e(),i=0;for(;n;){if(n===t)return i;i+=1,n=e()}return-1}insertBefore(t,e){null!=t&&(this.remove(t),t.next=e,null!=e?(t.prev=e.prev,null!=e.prev&&(e.prev.next=t),e.prev=t,e===this.head&&(this.head=t)):null!=this.tail?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)}offset(t){let e=0,n=this.head;for(;null!=n;){if(n===t)return e;e+=n.length(),n=n.next}return-1}remove(t){this.contains(t)&&(null!=t.prev&&(t.prev.next=t.next),null!=t.next&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)}iterator(t=this.head){return()=>{const e=t;return null!=t&&(t=t.next),e}}find(t,e=!1){const n=this.iterator();let i=n();for(;i;){const r=i.length();if(t<r||e&&t===r&&(null==i.next||0!==i.next.length()))return[i,t];t-=r,i=n()}return[null,0]}forEach(t){const e=this.iterator();let n=e();for(;n;)t(n),n=e()}forEachAt(t,e,n){if(e<=0)return;const[i,r]=this.find(t);let s=t-r;const o=this.iterator(i);let a=o();for(;a&&s<t+e;){const i=a.length();t>s?n(a,t-s,Math.min(e,s+i-t)):n(a,0,Math.min(i,t+e-s)),s+=i,a=o()}}map(t){return this.reduce(((e,n)=>(e.push(t(n)),e)),[])}reduce(t,e){const n=this.iterator();let i=n();for(;i;)e=t(e,i),i=n();return e}}function Kb(t,e){const n=e.find(t);if(n)return n;try{return e.create(t)}catch{const n=e.create(Ob.INLINE);return Array.from(t.childNodes).forEach((t=>{n.domNode.appendChild(t)})),t.parentNode&&t.parentNode.replaceChild(n.domNode,t),n.attach(),n}}const Gb=class t extends zb{constructor(t,e){super(t,e),this.uiNode=null,this.build()}appendChild(t){this.insertBefore(t)}attach(){super.attach(),this.children.forEach((t=>{t.attach()}))}attachUI(e){null!=this.uiNode&&this.uiNode.remove(),this.uiNode=e,t.uiClass&&this.uiNode.classList.add(t.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Wb,Array.from(this.domNode.childNodes).filter((t=>t!==this.uiNode)).reverse().forEach((t=>{try{const e=Kb(t,this.scroll);this.insertBefore(e,this.children.head||void 0)}catch(t){if(t instanceof Rb)return;throw t}}))}deleteAt(t,e){if(0===t&&e===this.length())return this.remove();this.children.forEachAt(t,e,((t,e,n)=>{t.deleteAt(e,n)}))}descendant(e,n=0){const[i,r]=this.children.find(n);return null==e.blotName&&e(i)||null!=e.blotName&&i instanceof e?[i,r]:i instanceof t?i.descendant(e,r):[null,-1]}descendants(e,n=0,i=Number.MAX_VALUE){let r=[],s=i;return this.children.forEachAt(n,i,((n,i,o)=>{(null==e.blotName&&e(n)||null!=e.blotName&&n instanceof e)&&r.push(n),n instanceof t&&(r=r.concat(n.descendants(e,i,s))),s-=o})),r}detach(){this.children.forEach((t=>{t.detach()})),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach((n=>{e||this.statics.allowedChildren.some((t=>n instanceof t))||(n.statics.scope===Ob.BLOCK_BLOT?(null!=n.next&&this.splitAfter(n),null!=n.prev&&this.splitAfter(n.prev),n.parent.unwrap(),e=!0):n instanceof t?n.unwrap():n.remove())}))}formatAt(t,e,n,i){this.children.forEachAt(t,e,((t,e,r)=>{t.formatAt(e,r,n,i)}))}insertAt(t,e,n){const[i,r]=this.children.find(t);if(i)i.insertAt(r,e,n);else{const t=null==n?this.scroll.create("text",e):this.scroll.create(e,n);this.appendChild(t)}}insertBefore(t,e){null!=t.parent&&t.parent.children.remove(t);let n=null;this.children.insertBefore(t,e||null),t.parent=this,null!=e&&(n=e.domNode),(this.domNode.parentNode!==t.domNode||this.domNode.nextSibling!==n)&&this.domNode.insertBefore(t.domNode,n),t.attach()}length(){return this.children.reduce(((t,e)=>t+e.length()),0)}moveChildren(t,e){this.children.forEach((n=>{t.insertBefore(n,e)}))}optimize(t){if(super.optimize(t),this.enforceAllowedChildren(),null!=this.uiNode&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),0===this.children.length)if(null!=this.statics.defaultChild){const t=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(t)}else this.remove()}path(e,n=!1){const[i,r]=this.children.find(e,n),s=[[this,e]];return i instanceof t?s.concat(i.path(r,n)):(null!=i&&s.push([i,r]),s)}removeChild(t){this.children.remove(t)}replaceWith(e,n){const i="string"==typeof e?this.scroll.create(e,n):e;return i instanceof t&&this.moveChildren(i),super.replaceWith(i)}split(t,e=!1){if(!e){if(0===t)return this;if(t===this.length())return this.next}const n=this.clone();return this.parent&&this.parent.insertBefore(n,this.next||void 0),this.children.forEachAt(t,this.length(),((t,i,r)=>{const s=t.split(i,e);null!=s&&n.appendChild(s)})),n}splitAfter(t){const e=this.clone();for(;null!=t.next;)e.appendChild(t.next);return this.parent&&this.parent.insertBefore(e,this.next||void 0),e}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(t,e){const n=[],i=[];t.forEach((t=>{t.target===this.domNode&&"childList"===t.type&&(n.push(...t.addedNodes),i.push(...t.removedNodes))})),i.forEach((t=>{if(null!=t.parentNode&&"IFRAME"!==t.tagName&&document.body.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const e=this.scroll.find(t);null!=e&&(null==e.domNode.parentNode||e.domNode.parentNode===this.domNode)&&e.detach()})),n.filter((t=>t.parentNode===this.domNode&&t!==this.uiNode)).sort(((t,e)=>t===e?0:t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1)).forEach((t=>{let e=null;null!=t.nextSibling&&(e=this.scroll.find(t.nextSibling));const n=Kb(t,this.scroll);(n.next!==e||null==n.next)&&(null!=n.parent&&n.parent.removeChild(this),this.insertBefore(n,e||void 0))})),this.enforceAllowedChildren()}};Gb.uiClass="";let Qb=Gb;const Yb=class t extends Qb{constructor(t,e){super(t,e),this.attributes=new Vb(this.domNode)}static create(t){return super.create(t)}static formats(e,n){const i=n.query(t.blotName);if(null==i||e.tagName!==i.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}format(e,n){if(e!==this.statics.blotName||n){const t=this.scroll.query(e,Ob.INLINE);if(null==t)return;t instanceof Lb?this.attributes.attribute(t,n):n&&(e!==this.statics.blotName||this.formats()[e]!==n)&&this.replaceWith(e,n)}else this.children.forEach((e=>{e instanceof t||(e=e.wrap(t.blotName,!0)),this.attributes.copy(e)})),this.unwrap()}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return null!=e&&(t[this.statics.blotName]=e),t}formatAt(t,e,n,i){null!=this.formats()[n]||this.scroll.query(n,Ob.ATTRIBUTE)?this.isolate(t,e).format(n,i):super.formatAt(t,e,n,i)}optimize(e){super.optimize(e);const n=this.formats();if(0===Object.keys(n).length)return this.unwrap();const i=this.next;i instanceof t&&i.prev===this&&function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}(n,i.formats())&&(i.moveChildren(this),i.remove())}replaceWith(t,e){const n=super.replaceWith(t,e);return this.attributes.copy(n),n}update(t,e){super.update(t,e),t.some((t=>t.target===this.domNode&&"attributes"===t.type))&&this.attributes.build()}wrap(e,n){const i=super.wrap(e,n);return i instanceof t&&this.attributes.move(i),i}};Yb.allowedChildren=[Yb,$b],Yb.blotName="inline",Yb.scope=Ob.INLINE_BLOT,Yb.tagName="SPAN";let Xb=Yb;const Jb=class t extends Qb{constructor(t,e){super(t,e),this.attributes=new Vb(this.domNode)}static create(t){return super.create(t)}static formats(e,n){const i=n.query(t.blotName);if(null==i||e.tagName!==i.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}format(e,n){const i=this.scroll.query(e,Ob.BLOCK);null!=i&&(i instanceof Lb?this.attributes.attribute(i,n):e!==this.statics.blotName||n?n&&(e!==this.statics.blotName||this.formats()[e]!==n)&&this.replaceWith(e,n):this.replaceWith(t.blotName))}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return null!=e&&(t[this.statics.blotName]=e),t}formatAt(t,e,n,i){null!=this.scroll.query(n,Ob.BLOCK)?this.format(n,i):super.formatAt(t,e,n,i)}insertAt(t,e,n){if(null==n||null!=this.scroll.query(e,Ob.INLINE))super.insertAt(t,e,n);else{const i=this.split(t);if(null==i)throw new Error("Attempt to insertAt after block boundaries");{const t=this.scroll.create(e,n);i.parent.insertBefore(t,i)}}}replaceWith(t,e){const n=super.replaceWith(t,e);return this.attributes.copy(n),n}update(t,e){super.update(t,e),t.some((t=>t.target===this.domNode&&"attributes"===t.type))&&this.attributes.build()}};Jb.blotName="block",Jb.scope=Ob.BLOCK_BLOT,Jb.tagName="P",Jb.allowedChildren=[Xb,Jb,$b];let Zb=Jb;const tw=class extends Qb{checkMerge(){return null!==this.next&&this.next.statics.blotName===this.statics.blotName}deleteAt(t,e){super.deleteAt(t,e),this.enforceAllowedChildren()}formatAt(t,e,n,i){super.formatAt(t,e,n,i),this.enforceAllowedChildren()}insertAt(t,e,n){super.insertAt(t,e,n),this.enforceAllowedChildren()}optimize(t){super.optimize(t),this.children.length>0&&null!=this.next&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};tw.blotName="container",tw.scope=Ob.BLOCK_BLOT;let ew=tw;class nw extends $b{static formats(t,e){}format(t,e){super.formatAt(0,this.length(),t,e)}formatAt(t,e,n,i){0===t&&e===this.length()?this.format(n,i):super.formatAt(t,e,n,i)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const iw={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},rw=class extends Qb{constructor(t,e){super(null,e),this.registry=t,this.scroll=this,this.build(),this.observer=new MutationObserver((t=>{this.update(t)})),this.observer.observe(this.domNode,iw),this.attach()}create(t,e){return this.registry.create(this,t,e)}find(t,e=!1){const n=this.registry.find(t,e);return n?n.scroll===this?n:e?this.find(n.scroll.domNode.parentNode,!0):null:null}query(t,e=Ob.ANY){return this.registry.query(t,e)}register(...t){return this.registry.register(...t)}build(){null!=this.scroll&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(t,e){this.update(),0===t&&e===this.length()?this.children.forEach((t=>{t.remove()})):super.deleteAt(t,e)}formatAt(t,e,n,i){this.update(),super.formatAt(t,e,n,i)}insertAt(t,e,n){this.update(),super.insertAt(t,e,n)}optimize(t=[],e={}){super.optimize(e);const n=e.mutationsMap||new WeakMap;let i=Array.from(this.observer.takeRecords());for(;i.length>0;)t.push(i.pop());const r=(t,e=!0)=>{null==t||t===this||null!=t.domNode.parentNode&&(n.has(t.domNode)||n.set(t.domNode,[]),e&&r(t.parent))},s=t=>{n.has(t.domNode)&&(t instanceof Qb&&t.children.forEach(s),n.delete(t.domNode),t.optimize(e))};let o=t;for(let e=0;o.length>0;e+=1){if(e>=100)throw new Error("[Parchment] Maximum optimize iterations reached");for(o.forEach((t=>{const e=this.find(t.target,!0);null!=e&&(e.domNode===t.target&&("childList"===t.type?(r(this.find(t.previousSibling,!1)),Array.from(t.addedNodes).forEach((t=>{const e=this.find(t,!1);r(e,!1),e instanceof Qb&&e.children.forEach((t=>{r(t,!1)}))}))):"attributes"===t.type&&r(e.prev)),r(e))})),this.children.forEach(s),o=Array.from(this.observer.takeRecords()),i=o.slice();i.length>0;)t.push(i.pop())}}update(t,e={}){t=t||this.observer.takeRecords();const n=new WeakMap;t.map((t=>{const e=this.find(t.target,!0);return null==e?null:n.has(e.domNode)?(n.get(e.domNode).push(t),null):(n.set(e.domNode,[t]),e)})).forEach((t=>{null!=t&&t!==this&&n.has(t.domNode)&&t.update(n.get(t.domNode)||[],e)})),e.mutationsMap=n,n.has(this.domNode)&&super.update(n.get(this.domNode),e),this.optimize(t,e)}};rw.blotName="scroll",rw.defaultChild=Zb,rw.allowedChildren=[Zb,ew],rw.scope=Ob.BLOCK_BLOT,rw.tagName="DIV";let sw=rw;const ow=class t extends $b{constructor(t,e){super(t,e),this.text=this.statics.value(this.domNode)}static create(t){return document.createTextNode(t)}static value(t){return t.data}deleteAt(t,e){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+e)}index(t,e){return this.domNode===t?e:-1}insertAt(t,e,n){null==n?(this.text=this.text.slice(0,t)+e+this.text.slice(t),this.domNode.data=this.text):super.insertAt(t,e,n)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof t&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(t,e=!1){return[this.domNode,t]}split(t,e=!1){if(!e){if(0===t)return this;if(t===this.length())return this.next}const n=this.scroll.create(this.domNode.splitText(t));return this.parent.insertBefore(n,this.next||void 0),this.text=this.statics.value(this.domNode),n}update(t,e){t.some((t=>"characterData"===t.type&&t.target===this.domNode))&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};ow.blotName="text",ow.scope=Ob.INLINE_BLOT;let aw=ow;var lw=n(660),cw=n.n(lw);function uw(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new ky;++e<n;)this.add(t[e])}uw.prototype.add=uw.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},uw.prototype.has=function(t){return this.__data__.has(t)};const hw=uw,dw=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1},fw=function(t,e,n,i,r,s){var o=1&n,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var h=-1,d=!0,f=2&n?new hw:void 0;for(s.set(t,e),s.set(e,t);++h<a;){var p=t[h],g=e[h];if(i)var m=o?i(g,p,h,e,t,s):i(p,g,h,t,e,s);if(void 0!==m){if(m)continue;d=!1;break}if(f){if(!dw(e,(function(t,e){if(o=e,!f.has(o)&&(p===t||r(p,t,n,i,s)))return f.push(e);var o}))){d=!1;break}}else if(p!==g&&!r(p,g,n,i,s)){d=!1;break}}return s.delete(t),s.delete(e),d},pw=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n},gw=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n};var mw=Gm?Gm.prototype:void 0,yw=mw?mw.valueOf:void 0;var vw=Object.prototype.hasOwnProperty;var bw="[object Arguments]",ww="[object Array]",Ew="[object Object]",_w=Object.prototype.hasOwnProperty;const qw=function(t,e,n,i,r,s){var o=Zy(t),a=Zy(e),l=o?ww:mb(t),c=a?ww:mb(e),u=(l=l==bw?Ew:l)==Ew,h=(c=c==bw?Ew:c)==Ew,d=l==c;if(d&&sv(t)){if(!sv(e))return!1;o=!0,u=!1}if(d&&!u)return s||(s=new xy),o||vv(t)?fw(t,e,n,i,r,s):function(t,e,n,i,r,s,o){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!s(new My(t),new My(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Fm(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=pw;case"[object Set]":var l=1&i;if(a||(a=gw),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=2,o.set(t,e);var u=fw(a(t),a(e),i,r,s,o);return o.delete(t),u;case"[object Symbol]":if(yw)return yw.call(t)==yw.call(e)}return!1}(t,e,l,n,i,r,s);if(!(1&n)){var f=u&&_w.call(t,"__wrapped__"),p=h&&_w.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,m=p?e.value():e;return s||(s=new xy),r(g,m,n,i,s)}}return!!d&&(s||(s=new xy),function(t,e,n,i,r,s){var o=1&n,a=Zv(t),l=a.length;if(l!=Zv(e).length&&!o)return!1;for(var c=l;c--;){var u=a[c];if(!(o?u in e:vw.call(e,u)))return!1}var h=s.get(t),d=s.get(e);if(h&&d)return h==e&&d==t;var f=!0;s.set(t,e),s.set(e,t);for(var p=o;++c<l;){var g=t[u=a[c]],m=e[u];if(i)var y=o?i(m,g,u,e,t,s):i(g,m,u,t,e,s);if(!(void 0===y?g===m||r(g,m,n,i,s):y)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var v=t.constructor,b=e.constructor;v==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(f=!1)}return s.delete(t),s.delete(e),f}(t,e,n,i,r,s))},kw=function t(e,n,i,r,s){return e===n||(null==e||null==n||!Ky(e)&&!Ky(n)?e!=e&&n!=n:qw(e,n,i,r,t,s))},Tw=function(t,e){return kw(t,e)};class xw extends nw{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}xw.blotName="break",xw.tagName="BR";const Iw=xw;class Sw extends aw{}function Aw(t){return t.replace(/[&<>"']/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[t])))}class Nw extends Xb{static allowedChildren=[Nw,Iw,nw,Sw];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(t,e){const n=Nw.order.indexOf(t),i=Nw.order.indexOf(e);return n>=0||i>=0?n-i:t===e?0:t<e?-1:1}formatAt(t,e,n,i){if(Nw.compare(this.statics.blotName,n)<0&&this.scroll.query(n,Ob.BLOT)){const r=this.isolate(t,e);i&&r.wrap(n,i)}else super.formatAt(t,e,n,i)}optimize(t){if(super.optimize(t),this.parent instanceof Nw&&Nw.compare(this.statics.blotName,this.parent.statics.blotName)>0){const t=this.parent.isolate(this.offset(),this.length());this.moveChildren(t),t.wrap(this)}}}const Cw=Nw;class Ow extends Zb{cache={};delta(){return null==this.cache.delta&&(this.cache.delta=function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.descendants($b).reduce(((t,n)=>0===n.length()?t:t.insert(n.value(),Rw(n,{},e))),new(cw())).insert("\n",Rw(t))}(this)),this.cache.delta}deleteAt(t,e){super.deleteAt(t,e),this.cache={}}formatAt(t,e,n,i){e<=0||(this.scroll.query(n,Ob.BLOCK)?t+e===this.length()&&this.format(n,i):super.formatAt(t,Math.min(e,this.length()-t-1),n,i),this.cache={})}insertAt(t,e,n){if(null!=n)return super.insertAt(t,e,n),void(this.cache={});if(0===e.length)return;const i=e.split("\n"),r=i.shift();r.length>0&&(t<this.length()-1||null==this.children.tail?super.insertAt(Math.min(t,this.length()-1),r):this.children.tail.insertAt(this.children.tail.length(),r),this.cache={});let s=this;i.reduce(((t,e)=>(s=s.split(t,!0),s.insertAt(0,e),e.length)),t+r.length)}insertBefore(t,e){const{head:n}=this.children;super.insertBefore(t,e),n instanceof Iw&&n.remove(),this.cache={}}length(){return null==this.cache.length&&(this.cache.length=super.length()+1),this.cache.length}moveChildren(t,e){super.moveChildren(t,e),this.cache={}}optimize(t){super.optimize(t),this.cache={}}path(t){return super.path(t,!0)}removeChild(t){super.removeChild(t),this.cache={}}split(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&(0===t||t>=this.length()-1)){const e=this.clone();return 0===t?(this.parent.insertBefore(e,this),this):(this.parent.insertBefore(e,this.next),e)}const n=super.split(t,e);return this.cache={},n}}Ow.blotName="block",Ow.tagName="P",Ow.defaultChild=Iw,Ow.allowedChildren=[Iw,Cw,nw,Sw];class Lw extends nw{attach(){super.attach(),this.attributes=new Vb(this.domNode)}delta(){return(new(cw())).insert(this.value(),{...this.formats(),...this.attributes.values()})}format(t,e){const n=this.scroll.query(t,Ob.BLOCK_ATTRIBUTE);null!=n&&this.attributes.attribute(n,e)}formatAt(t,e,n,i){this.format(n,i)}insertAt(t,e,n){if(null!=n)return void super.insertAt(t,e,n);const i=e.split("\n"),r=i.pop(),s=i.map((t=>{const e=this.scroll.create(Ow.blotName);return e.insertAt(0,t),e})),o=this.split(t);s.forEach((t=>{this.parent.insertBefore(t,o)})),r&&this.parent.insertBefore(this.scroll.create("text",r),o)}}function Rw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return null==t?e:("formats"in t&&"function"==typeof t.formats&&(e={...e,...t.formats()},n&&delete e["code-token"]),null==t.parent||"scroll"===t.parent.statics.blotName||t.parent.statics.scope!==t.statics.scope?e:Rw(t.parent,e,n))}Lw.scope=Ob.BLOCK_BLOT;class Dw extends nw{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\ufeff";static value(){}constructor(t,e,n){super(t,e),this.selection=n,this.textNode=document.createTextNode(Dw.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){null!=this.parent&&this.parent.removeChild(this)}format(t,e){if(0!==this.savedLength)return void super.format(t,e);let n=this,i=0;for(;null!=n&&n.statics.scope!==Ob.BLOCK_BLOT;)i+=n.offset(n.parent),n=n.parent;null!=n&&(this.savedLength=Dw.CONTENTS.length,n.optimize(),n.formatAt(i,Dw.CONTENTS.length,t,e),this.savedLength=0)}index(t,e){return t===this.textNode?0:super.index(t,e)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||null==this.parent)return null;const t=this.selection.getNativeRange();for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const e=this.prev instanceof Sw?this.prev:null,n=e?e.length():0,i=this.next instanceof Sw?this.next:null,r=i?i.text:"",{textNode:s}=this,o=s.data.split(Dw.CONTENTS).join("");let a;if(s.data=Dw.CONTENTS,e)a=e,(o||i)&&(e.insertAt(e.length(),o+r),i&&i.remove());else if(i)a=i,i.insertAt(0,o);else{const t=document.createTextNode(o);a=this.scroll.create(t),this.parent.insertBefore(a,this)}if(this.remove(),t){const r=(t,r)=>e&&t===e.domNode?r:t===s?n+r-1:i&&t===i.domNode?n+o.length+r:null,l=r(t.start.node,t.start.offset),c=r(t.end.node,t.end.offset);if(null!==l&&null!==c)return{startNode:a.domNode,startOffset:l,endNode:a.domNode,endOffset:c}}return null}update(t,e){if(t.some((t=>"characterData"===t.type&&t.target===this.textNode))){const t=this.restore();t&&(e.range=t)}}optimize(t){super.optimize(t);let{parent:e}=this;for(;e;){if("A"===e.domNode.tagName){this.savedLength=Dw.CONTENTS.length,e.isolate(this.offset(e),this.length()).unwrap(),this.savedLength=0;break}e=e.parent}}value(){return""}}const Mw=Dw;var Pw=n(697);const jw=new WeakMap,Uw=["error","warn","log","info"];let Fw="warn";function Vw(t){if(Fw&&Uw.indexOf(t)<=Uw.indexOf(Fw)){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];console[t](...n)}}function Bw(t){return Uw.reduce(((e,n)=>(e[n]=Vw.bind(console,n,t),e)),{})}Bw.level=t=>{Fw=t},Vw.level=Bw.level;const zw=Bw,Hw=zw("quill:events");["selectionchange","mousedown","mouseup","click"].forEach((t=>{document.addEventListener(t,(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Array.from(document.querySelectorAll(".ql-container")).forEach((t=>{const n=jw.get(t);n&&n.emitter&&n.emitter.handleDOM(...e)}))}))}));const $w=class extends Pw{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",Hw.error)}emit(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Hw.log.call(Hw,...e),super.emit(...e)}handleDOM(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];(this.domListeners[t.type]||[]).forEach((e=>{let{node:i,handler:r}=e;(t.target===i||i.contains(t.target))&&r(t,...n)}))}listenDOM(t,e,n){this.domListeners[t]||(this.domListeners[t]=[]),this.domListeners[t].push({node:e,handler:n})}},Ww=zw("quill:selection");class Kw{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.index=t,this.length=e}}class Gw{constructor(t,e){this.emitter=e,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new Kw(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,(()=>{this.mouseDown||this.composing||setTimeout(this.update.bind(this,$w.sources.USER),1)})),this.emitter.on($w.events.SCROLL_BEFORE_UPDATE,(()=>{if(!this.hasFocus())return;const t=this.getNativeRange();null!=t&&t.start.node!==this.cursor.textNode&&this.emitter.once($w.events.SCROLL_UPDATE,((e,n)=>{try{this.root.contains(t.start.node)&&this.root.contains(t.end.node)&&this.setNativeRange(t.start.node,t.start.offset,t.end.node,t.end.offset);const i=n.some((t=>"characterData"===t.type||"childList"===t.type||"attributes"===t.type&&t.target===this.root));this.update(i?$w.sources.SILENT:e)}catch(t){}}))})),this.emitter.on($w.events.SCROLL_OPTIMIZE,((t,e)=>{if(e.range){const{startNode:t,startOffset:n,endNode:i,endOffset:r}=e.range;this.setNativeRange(t,n,i,r),this.update($w.sources.SILENT)}})),this.update($w.sources.SILENT)}handleComposition(){this.emitter.on($w.events.COMPOSITION_BEFORE_START,(()=>{this.composing=!0})),this.emitter.on($w.events.COMPOSITION_END,(()=>{if(this.composing=!1,this.cursor.parent){const t=this.cursor.restore();if(!t)return;setTimeout((()=>{this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)}),1)}}))}handleDragging(){this.emitter.listenDOM("mousedown",document.body,(()=>{this.mouseDown=!0})),this.emitter.listenDOM("mouseup",document.body,(()=>{this.mouseDown=!1,this.update($w.sources.USER)}))}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(t,e){this.scroll.update();const n=this.getNativeRange();if(null!=n&&n.native.collapsed&&!this.scroll.query(t,Ob.BLOCK)){if(n.start.node!==this.cursor.textNode){const t=this.scroll.find(n.start.node,!1);if(null==t)return;if(t instanceof $b){const e=t.split(n.start.offset);t.parent.insertBefore(this.cursor,e)}else t.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(t,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.scroll.length();let i;t=Math.min(t,n-1),e=Math.min(t+e,n-1)-t;let[r,s]=this.scroll.leaf(t);if(null==r)return null;if(e>0&&s===r.length()){const[e]=this.scroll.leaf(t+1);if(e){const[n]=this.scroll.line(t),[i]=this.scroll.line(t+1);n===i&&(r=e,s=0)}}[i,s]=r.position(s,!0);const o=document.createRange();if(e>0)return o.setStart(i,s),[r,s]=this.scroll.leaf(t+e),null==r?null:([i,s]=r.position(s,!0),o.setEnd(i,s),o.getBoundingClientRect());let a,l="left";if(i instanceof Text){if(!i.data.length)return null;s<i.data.length?(o.setStart(i,s),o.setEnd(i,s+1)):(o.setStart(i,s-1),o.setEnd(i,s),l="right"),a=o.getBoundingClientRect()}else{if(!(r.domNode instanceof Element))return null;a=r.domNode.getBoundingClientRect(),s>0&&(l="right")}return{bottom:a.top+a.height,height:a.height,left:a[l],right:a[l],top:a.top,width:0}}getNativeRange(){const t=document.getSelection();if(null==t||t.rangeCount<=0)return null;const e=t.getRangeAt(0);if(null==e)return null;const n=this.normalizeNative(e);return Ww.info("getNativeRange",n),n}getRange(){const t=this.scroll.domNode;if("isConnected"in t&&!t.isConnected)return[null,null];const e=this.getNativeRange();return null==e?[null,null]:[this.normalizedToRange(e),e]}hasFocus(){return document.activeElement===this.root||null!=document.activeElement&&Qw(this.root,document.activeElement)}normalizedToRange(t){const e=[[t.start.node,t.start.offset]];t.native.collapsed||e.push([t.end.node,t.end.offset]);const n=e.map((t=>{const[e,n]=t,i=this.scroll.find(e,!0),r=i.offset(this.scroll);return 0===n?r:i instanceof $b?r+i.index(e,n):r+i.length()})),i=Math.min(Math.max(...n),this.scroll.length()-1),r=Math.min(i,...n);return new Kw(r,i-r)}normalizeNative(t){if(!Qw(this.root,t.startContainer)||!t.collapsed&&!Qw(this.root,t.endContainer))return null;const e={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[e.start,e.end].forEach((t=>{let{node:e,offset:n}=t;for(;!(e instanceof Text)&&e.childNodes.length>0;)if(e.childNodes.length>n)e=e.childNodes[n],n=0;else{if(e.childNodes.length!==n)break;e=e.lastChild,n=e instanceof Text?e.data.length:e.childNodes.length>0?e.childNodes.length:e.childNodes.length+1}t.node=e,t.offset=n})),e}rangeToNative(t){const e=this.scroll.length(),n=(t,n)=>{t=Math.min(e-1,t);const[i,r]=this.scroll.leaf(t);return i?i.position(r,n):[null,-1]};return[...n(t.index,!1),...n(t.index+t.length,!0)]}setNativeRange(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Ww.info("setNativeRange",t,e,n,i),null!=t&&(null==this.root.parentNode||null==t.parentNode||null==n.parentNode))return;const s=document.getSelection();if(null!=s)if(null!=t){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:o}=this.getNativeRange()||{};if(null==o||r||t!==o.startContainer||e!==o.startOffset||n!==o.endContainer||i!==o.endOffset){t instanceof Element&&"BR"===t.tagName&&(e=Array.from(t.parentNode.childNodes).indexOf(t),t=t.parentNode),n instanceof Element&&"BR"===n.tagName&&(i=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);const r=document.createRange();r.setStart(t,e),r.setEnd(n,i),s.removeAllRanges(),s.addRange(r)}}else s.removeAllRanges(),this.root.blur()}setRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$w.sources.API;if("string"==typeof e&&(n=e,e=!1),Ww.info("setRange",t),null!=t){const n=this.rangeToNative(t);this.setNativeRange(...n,e)}else this.setNativeRange(null);this.update(n)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$w.sources.USER;const e=this.lastRange,[n,i]=this.getRange();if(this.lastRange=n,this.lastNative=i,null!=this.lastRange&&(this.savedRange=this.lastRange),!Tw(e,this.lastRange)){if(!this.composing&&null!=i&&i.native.collapsed&&i.start.node!==this.cursor.textNode){const t=this.cursor.restore();t&&this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)}const n=[$w.events.SELECTION_CHANGE,Cb(this.lastRange),Cb(e),t];this.emitter.emit($w.events.EDITOR_CHANGE,...n),t!==$w.sources.SILENT&&this.emitter.emit(...n)}}}function Qw(t,e){try{e.parentNode}catch(t){return!1}return t.contains(e)}const Yw=/^[ -~]*$/;function Xw(t,e,n){if(0===t.length){const[t]=tE(n.pop());return e<=0?`</li></${t}>`:`</li></${t}>${Xw([],e-1,n)}`}const[{child:i,offset:r,length:s,indent:o,type:a},...l]=t,[c,u]=tE(a);if(o>e)return n.push(a),o===e+1?`<${c}><li${u}>${Jw(i,r,s)}${Xw(l,o,n)}`:`<${c}><li>${Xw(t,e+1,n)}`;const h=n[n.length-1];if(o===e&&a===h)return`</li><li${u}>${Jw(i,r,s)}${Xw(l,o,n)}`;const[d]=tE(n.pop());return`</li></${d}>${Xw(t,e-1,n)}`}function Jw(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("html"in t&&"function"==typeof t.html)return t.html(e,n);if(t instanceof Sw)return Aw(t.value().slice(e,e+n));if(t instanceof Qb){if("list-container"===t.statics.blotName){const i=[];return t.children.forEachAt(e,n,((t,e,n)=>{const r="formats"in t&&"function"==typeof t.formats?t.formats():{};i.push({child:t,offset:e,length:n,indent:r.indent||0,type:r.list})})),Xw(i,-1,[])}const r=[];if(t.children.forEachAt(e,n,((t,e,n)=>{r.push(Jw(t,e,n))})),i||"list"===t.statics.blotName)return r.join("");const{outerHTML:s,innerHTML:o}=t.domNode,[a,l]=s.split(`>${o}<`);return"<table"===a?`<table style="border: 1px solid #000;">${r.join("")}<${l}`:`${a}>${r.join("")}<${l}`}return t.domNode instanceof Element?t.domNode.outerHTML:""}function Zw(t,e){return Object.keys(e).reduce(((n,i)=>{if(null==t[i])return n;const r=e[i];return r===t[i]?n[i]=r:Array.isArray(r)?r.indexOf(t[i])<0?n[i]=r.concat([t[i]]):n[i]=r:n[i]=[r,t[i]],n}),{})}function tE(t){const e="ordered"===t?"ol":"ul";switch(t){case"checked":return[e,' data-list="checked"'];case"unchecked":return[e,' data-list="unchecked"'];default:return[e,""]}}function eE(t){return t.reduce(((t,e)=>{if("string"==typeof e.insert){const n=e.insert.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return t.insert(n,e.attributes)}return t.push(e)}),new(cw()))}function nE(t,e){let{index:n,length:i}=t;return new Kw(n+e,i)}const iE=class{constructor(t){this.scroll=t,this.delta=this.getDelta()}applyDelta(t){this.scroll.update();let e=this.scroll.length();this.scroll.batchStart();const n=eE(t),i=new(cw());return function(t){const e=[];return t.forEach((t=>{"string"==typeof t.insert?t.insert.split("\n").forEach(((n,i)=>{i&&e.push({insert:"\n",attributes:t.attributes}),n&&e.push({insert:n,attributes:t.attributes})})):e.push(t)})),e}(n.ops.slice()).reduce(((t,n)=>{const r=lw.Op.length(n);let s=n.attributes||{},o=!1,a=!1;if(null!=n.insert){if(i.retain(r),"string"==typeof n.insert){const i=n.insert;a=!i.endsWith("\n")&&(e<=t||!!this.scroll.descendant(Lw,t)[0]),this.scroll.insertAt(t,i);const[r,o]=this.scroll.line(t);let l=Vv({},Rw(r));if(r instanceof Ow){const[t]=r.descendant($b,o);t&&(l=Vv(l,Rw(t)))}s=lw.AttributeMap.diff(l,s)||{}}else if("object"==typeof n.insert){const i=Object.keys(n.insert)[0];if(null==i)return t;const r=null!=this.scroll.query(i,Ob.INLINE);if(r)(e<=t||this.scroll.descendant(Lw,t)[0])&&(a=!0);else if(t>0){const[e,n]=this.scroll.descendant($b,t-1);e instanceof Sw?"\n"!==e.value()[n]&&(o=!0):e instanceof nw&&e.statics.scope===Ob.INLINE_BLOT&&(o=!0)}if(this.scroll.insertAt(t,i,n.insert[i]),r){const[e]=this.scroll.descendant($b,t);if(e){const t=Vv({},Rw(e));s=lw.AttributeMap.diff(t,s)||{}}}}e+=r}else if(i.push(n),null!==n.retain&&"object"==typeof n.retain){const e=Object.keys(n.retain)[0];if(null==e)return t;this.scroll.updateEmbedAt(t,e,n.retain[e])}Object.keys(s).forEach((e=>{this.scroll.formatAt(t,r,e,s[e])}));const l=o?1:0,c=a?1:0;return e+=l+c,i.retain(l),i.delete(c),t+r+l+c}),0),i.reduce(((t,e)=>"number"==typeof e.delete?(this.scroll.deleteAt(t,e.delete),t):t+lw.Op.length(e)),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(n)}deleteText(t,e){return this.scroll.deleteAt(t,e),this.update((new(cw())).retain(t).delete(e))}formatLine(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.scroll.update(),Object.keys(n).forEach((i=>{this.scroll.lines(t,Math.max(e,1)).forEach((t=>{t.format(i,n[i])}))})),this.scroll.optimize();const i=(new(cw())).retain(t).retain(e,Cb(n));return this.update(i)}formatText(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.keys(n).forEach((i=>{this.scroll.formatAt(t,e,i,n[i])}));const i=(new(cw())).retain(t).retain(e,Cb(n));return this.update(i)}getContents(t,e){return this.delta.slice(t,t+e)}getDelta(){return this.scroll.lines().reduce(((t,e)=>t.concat(e.delta())),new(cw()))}getFormat(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],i=[];0===e?this.scroll.path(t).forEach((t=>{const[e]=t;e instanceof Ow?n.push(e):e instanceof $b&&i.push(e)})):(n=this.scroll.lines(t,e),i=this.scroll.descendants($b,t,e));const[r,s]=[n,i].map((t=>{const e=t.shift();if(null==e)return{};let n=Rw(e);for(;Object.keys(n).length>0;){const e=t.shift();if(null==e)return n;n=Zw(Rw(e),n)}return n}));return{...r,...s}}getHTML(t,e){const[n,i]=this.scroll.line(t);if(n){const r=n.length();return n.length()>=i+e?Jw(n,i,e,!(0===i&&e===r)):Jw(this.scroll,t,e,!0)}return""}getText(t,e){return this.getContents(t,e).filter((t=>"string"==typeof t.insert)).map((t=>t.insert)).join("")}insertContents(t,e){const n=eE(e),i=(new(cw())).retain(t).concat(n);return this.scroll.insertContents(t,n),this.update(i)}insertEmbed(t,e,n){return this.scroll.insertAt(t,e,n),this.update((new(cw())).retain(t).insert({[e]:n}))}insertText(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),this.scroll.insertAt(t,e),Object.keys(n).forEach((i=>{this.scroll.formatAt(t,e.length,i,n[i])})),this.update((new(cw())).retain(t).insert(e,Cb(n)))}isBlank(){if(0===this.scroll.children.length)return!0;if(this.scroll.children.length>1)return!1;const t=this.scroll.children.head;if(t?.statics.blotName!==Ow.blotName)return!1;const e=t;return!(e.children.length>1)&&e.children.head instanceof Iw}removeFormat(t,e){const n=this.getText(t,e),[i,r]=this.scroll.line(t+e);let s=0,o=new(cw());null!=i&&(s=i.length()-r,o=i.delta().slice(r,r+s-1).insert("\n"));const a=this.getContents(t,e+s).diff((new(cw())).insert(n).concat(o)),l=(new(cw())).retain(t).concat(a);return this.applyDelta(l)}update(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const i=this.delta;if(1===e.length&&"characterData"===e[0].type&&e[0].target.data.match(Yw)&&this.scroll.find(e[0].target)){const r=this.scroll.find(e[0].target),s=Rw(r),o=r.offset(this.scroll),a=e[0].oldValue.replace(Mw.CONTENTS,""),l=(new(cw())).insert(a),c=(new(cw())).insert(r.value()),u=n&&{oldRange:nE(n.oldRange,-o),newRange:nE(n.newRange,-o)};t=(new(cw())).retain(o).concat(l.diff(c,u)).reduce(((t,e)=>e.insert?t.insert(e.insert,s):t.push(e)),new(cw())),this.delta=i.compose(t)}else this.delta=this.getDelta(),t&&Tw(i.compose(t),this.delta)||(t=i.diff(this.delta,n));return t}},rE=class{static DEFAULTS={};constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.quill=t,this.options=e}},sE="\ufeff",oE=class extends nw{constructor(t,e){super(t,e),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach((t=>{this.contentNode.appendChild(t)})),this.leftGuard=document.createTextNode(sE),this.rightGuard=document.createTextNode(sE),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(t,e){return t===this.leftGuard?0:t===this.rightGuard?1:super.index(t,e)}restore(t){let e,n=null;const i=t.data.split(sE).join("");if(t===this.leftGuard)if(this.prev instanceof Sw){const t=this.prev.length();this.prev.insertAt(t,i),n={startNode:this.prev.domNode,startOffset:t+i.length}}else e=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(e),this),n={startNode:e,startOffset:i.length};else t===this.rightGuard&&(this.next instanceof Sw?(this.next.insertAt(0,i),n={startNode:this.next.domNode,startOffset:i.length}):(e=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(e),this.next),n={startNode:e,startOffset:i.length}));return t.data=sE,n}update(t,e){t.forEach((t=>{if("characterData"===t.type&&(t.target===this.leftGuard||t.target===this.rightGuard)){const n=this.restore(t.target);n&&(e.range=n)}}))}},aE=class{isComposing=!1;constructor(t,e){this.scroll=t,this.emitter=e,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",(t=>{this.isComposing||this.handleCompositionStart(t)})),this.scroll.domNode.addEventListener("compositionend",(t=>{this.isComposing&&queueMicrotask((()=>{this.handleCompositionEnd(t)}))}))}handleCompositionStart(t){const e=t.target instanceof Node?this.scroll.find(t.target,!0):null;!e||e instanceof oE||(this.emitter.emit($w.events.COMPOSITION_BEFORE_START,t),this.scroll.batchStart(),this.emitter.emit($w.events.COMPOSITION_START,t),this.isComposing=!0)}handleCompositionEnd(t){this.emitter.emit($w.events.COMPOSITION_BEFORE_END,t),this.scroll.batchEnd(),this.emitter.emit($w.events.COMPOSITION_END,t),this.isComposing=!1}};class lE{static DEFAULTS={modules:{}};static themes={default:lE};modules={};constructor(t,e){this.quill=t,this.options=e}init(){Object.keys(this.options.modules).forEach((t=>{null==this.modules[t]&&this.addModule(t)}))}addModule(t){const e=this.quill.constructor.import(`modules/${t}`);return this.modules[t]=new e(this.quill,this.options.modules[t]||{}),this.modules[t]}}const cE=lE,uE=t=>{const e=t.getBoundingClientRect(),n="offsetWidth"in t&&Math.abs(e.width)/t.offsetWidth||1,i="offsetHeight"in t&&Math.abs(e.height)/t.offsetHeight||1;return{top:e.top,right:e.left+t.clientWidth*n,bottom:e.top+t.clientHeight*i,left:e.left}},hE=t=>{const e=parseInt(t,10);return Number.isNaN(e)?0:e},dE=(t,e,n,i,r,s)=>t<n&&e>i?0:t<n?-(n-t+r):e>i?e-t>i-n?t+r-n:e-i+s:0,fE=zw("quill"),pE=new Mb;Qb.uiClass="ql-ui";class gE{static DEFAULTS={bounds:null,modules:{},placeholder:"",readOnly:!1,registry:pE,theme:"default"};static events=$w.events;static sources=$w.sources;static version="2.0.0-rc.2";static imports={delta:cw(),parchment:t,"core/module":rE,"core/theme":cE};static debug(t){!0===t&&(t="log"),zw.level(t)}static find(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return jw.get(t)||pE.find(t,e)}static import(t){return null==this.imports[t]&&fE.error(`Cannot import ${t}. Are you sure it was registered?`),this.imports[t]}static register(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!=typeof t){const n="attrName"in t?t.attrName:t.blotName;"string"==typeof n?this.register(`formats/${n}`,t,e):Object.keys(t).forEach((n=>{this.register(n,t[n],e)}))}else null==this.imports[t]||n||fE.warn(`Overwriting ${t} with`,e),this.imports[t]=e,(t.startsWith("blots/")||t.startsWith("formats/"))&&e&&"boolean"!=typeof e&&"abstract"!==e.blotName&&pE.register(e),"function"==typeof e.register&&e.register(pE)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.options=function(t,e){let n=Vv({container:t,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0}},e);if(n.theme&&n.theme!==gE.DEFAULTS.theme){if(n.theme=gE.import(`themes/${n.theme}`),null==n.theme)throw new Error(`Invalid theme ${n.theme}. Did you register it?`)}else n.theme=cE;const i=Cb(n.theme.DEFAULTS);[i,n].forEach((t=>{t.modules=t.modules||{},Object.keys(t.modules).forEach((e=>{!0===t.modules[e]&&(t.modules[e]={})}))}));const r=Object.keys(i.modules).concat(Object.keys(n.modules)).reduce(((t,e)=>{const n=gE.import(`modules/${e}`);return null==n?fE.error(`Cannot load ${e} module. Are you sure you registered it?`):t[e]=n.DEFAULTS||{},t}),{});return null!=n.modules&&n.modules.toolbar&&n.modules.toolbar.constructor!==Object&&(n.modules.toolbar={container:n.modules.toolbar}),n=Vv({},gE.DEFAULTS,{modules:r},i,n),["bounds","container"].forEach((t=>{const e=n[t];"string"==typeof e&&(n[t]=document.querySelector(e))})),n.modules=Object.keys(n.modules).reduce(((t,e)=>(n.modules[e]&&(t[e]=n.modules[e]),t)),{}),n}(t,e),this.container=this.options.container,null==this.container)return void fE.error("Invalid Quill container",t);this.options.debug&&gE.debug(this.options.debug);const n=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",jw.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new $w;const i=sw.blotName,r=this.options.registry.query(i);if(!r||!("blotName"in r))throw new Error(`Cannot initialize Quill without "${i}" blot`);if(this.scroll=new r(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new iE(this.scroll),this.selection=new Gw(this.scroll,this.emitter),this.composition=new aE(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on($w.events.EDITOR_CHANGE,(t=>{t===$w.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())})),this.emitter.on($w.events.SCROLL_UPDATE,((t,e)=>{const n=this.selection.lastRange,[i]=this.selection.getRange(),r=n&&i?{oldRange:n,newRange:i}:void 0;mE.call(this,(()=>this.editor.update(null,e,r)),t)})),this.emitter.on($w.events.SCROLL_EMBED_UPDATE,((t,e)=>{const n=this.selection.lastRange,[i]=this.selection.getRange(),r=n&&i?{oldRange:n,newRange:i}:void 0;mE.call(this,(()=>{const n=(new(cw())).retain(t.offset(this)).retain({[t.statics.blotName]:e});return this.editor.update(n,[],r)}),gE.sources.USER)})),n){const t=this.clipboard.convert({html:`${n}<p><br></p>`,text:"\n"});this.setContents(t)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof t){const e=t;(t=document.createElement("div")).classList.add(e)}return this.container.insertBefore(t,e),t}blur(){this.selection.setRange(null)}deleteText(t,e,n){return[t,e,,n]=yE(t,e,n),mE.call(this,(()=>this.editor.deleteText(t,e)),n,t,-1*e)}disable(){this.enable(!1)}editReadOnly(t){this.allowReadOnlyEdits=!0;const e=t();return this.allowReadOnlyEdits=!1,e}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}focus(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selection.focus(),t.preventScroll||this.scrollSelectionIntoView()}format(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$w.sources.API;return mE.call(this,(()=>{const n=this.getSelection(!0);let i=new(cw());if(null==n)return i;if(this.scroll.query(t,Ob.BLOCK))i=this.editor.formatLine(n.index,n.length,{[t]:e});else{if(0===n.length)return this.selection.format(t,e),i;i=this.editor.formatText(n.index,n.length,{[t]:e})}return this.setSelection(n,$w.sources.SILENT),i}),n)}formatLine(t,e,n,i,r){let s;return[t,e,s,r]=yE(t,e,n,i,r),mE.call(this,(()=>this.editor.formatLine(t,e,s)),r,t,0)}formatText(t,e,n,i,r){let s;return[t,e,s,r]=yE(t,e,n,i,r),mE.call(this,(()=>this.editor.formatText(t,e,s)),r,t,0)}getBounds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=null;if(n="number"==typeof t?this.selection.getBounds(t,e):this.selection.getBounds(t.index,t.length),!n)return null;const i=this.container.getBoundingClientRect();return{bottom:n.bottom-i.top,height:n.height,left:n.left-i.left,right:n.right-i.left,top:n.top-i.top,width:n.width}}getContents(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-t;return[t,e]=yE(t,e),this.editor.getContents(t,e)}getFormat(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection(!0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"==typeof t?this.editor.getFormat(t,e):this.editor.getFormat(t.index,t.length)}getIndex(t){return t.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(t){return this.scroll.leaf(t)}getLine(t){return this.scroll.line(t)}getLines(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return"number"!=typeof t?this.scroll.lines(t.index,t.length):this.scroll.lines(t,e)}getModule(t){return this.theme.modules[t]}getSelection(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return"number"==typeof t&&(e=e??this.getLength()-t),[t,e]=yE(t,e),this.editor.getHTML(t,e)}getText(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return"number"==typeof t&&(e=e??this.getLength()-t),[t,e]=yE(t,e),this.editor.getText(t,e)}hasFocus(){return this.selection.hasFocus()}insertEmbed(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gE.sources.API;return mE.call(this,(()=>this.editor.insertEmbed(t,e,n)),i,t)}insertText(t,e,n,i,r){let s;return[t,,s,r]=yE(t,0,n,i,r),mE.call(this,(()=>this.editor.insertText(t,e,s)),r,t,e.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(){const[t,e,,n]=yE(...arguments);return mE.call(this,(()=>this.editor.removeFormat(t,e)),n,t)}scrollRectIntoView(t){((t,e)=>{const n=t.ownerDocument;let i=e,r=t;for(;r;){const t=r===n.body,e=t?{top:0,right:window.visualViewport?.width??n.documentElement.clientWidth,bottom:window.visualViewport?.height??n.documentElement.clientHeight,left:0}:uE(r),o=getComputedStyle(r),a=dE(i.left,i.right,e.left,e.right,hE(o.scrollPaddingLeft),hE(o.scrollPaddingRight)),l=dE(i.top,i.bottom,e.top,e.bottom,hE(o.scrollPaddingTop),hE(o.scrollPaddingBottom));if(a||l)if(t)n.defaultView?.scrollBy(a,l);else{const{scrollLeft:t,scrollTop:e}=r;l&&(r.scrollTop+=l),a&&(r.scrollLeft+=a);const n=r.scrollLeft-t,s=r.scrollTop-e;i={left:i.left-n,top:i.top-s,right:i.right-n,bottom:i.bottom-s}}r=t||"fixed"===o.position?null:(s=r).parentElement||s.getRootNode().host||null}var s})(this.root,t)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const t=this.selection.lastRange,e=t&&this.selection.getBounds(t.index,t.length);e&&this.scrollRectIntoView(e)}setContents(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$w.sources.API;return mE.call(this,(()=>{t=new(cw())(t);const e=this.getLength(),n=this.editor.deleteText(0,e),i=this.editor.insertContents(0,t),r=this.editor.deleteText(this.getLength()-1,1);return n.compose(i).compose(r)}),e)}setSelection(t,e,n){null==t?this.selection.setRange(null,e||gE.sources.API):([t,e,,n]=yE(t,e,n),this.selection.setRange(new Kw(Math.max(0,t),e),n),n!==$w.sources.SILENT&&this.scrollSelectionIntoView())}setText(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$w.sources.API;const n=(new(cw())).insert(t);return this.setContents(n,e)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$w.sources.USER;const e=this.scroll.update(t);return this.selection.update(t),e}updateContents(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$w.sources.API;return mE.call(this,(()=>(t=new(cw())(t),this.editor.applyDelta(t))),e,!0)}}function mE(t,e,n,i){if(!this.isEnabled()&&e===$w.sources.USER&&!this.allowReadOnlyEdits)return new(cw());let r=null==n?null:this.getSelection();const s=this.editor.delta,o=t();if(null!=r&&(!0===n&&(n=r.index),null==i?r=vE(r,o,e):0!==i&&(r=vE(r,n,i,e)),this.setSelection(r,$w.sources.SILENT)),o.length()>0){const t=[$w.events.TEXT_CHANGE,o,s,e];this.emitter.emit($w.events.EDITOR_CHANGE,...t),e!==$w.sources.SILENT&&this.emitter.emit(...t)}return o}function yE(t,e,n,i,r){let s={};return"number"==typeof t.index&&"number"==typeof t.length?"number"!=typeof e?(r=i,i=n,n=e,e=t.length,t=t.index):(e=t.length,t=t.index):"number"!=typeof e&&(r=i,i=n,n=e,e=0),"object"==typeof n?(s=n,r=i):"string"==typeof n&&(null!=i?s[n]=i:r=n),[t,e,s,r=r||$w.sources.API]}function vE(t,e,n,i){const r="number"==typeof n?n:0;if(null==t)return null;let s,o;return e&&"function"==typeof e.transformPosition?[s,o]=[t.index,t.index+t.length].map((t=>e.transformPosition(t,i!==$w.sources.USER))):[s,o]=[t.index,t.index+t.length].map((t=>t<e||t===e&&i===$w.sources.USER?t:r>=0?t+r:Math.max(e,t+r))),new Kw(s,o-s)}const bE=class extends ew{};function wE(t){return t instanceof Ow||t instanceof Lw}function EE(t){return"function"==typeof t.updateContent}function _E(t,e,n){n.reduce(((e,n)=>{const i=lw.Op.length(n);let r=n.attributes||{};if(null!=n.insert)if("string"==typeof n.insert){const i=n.insert;t.insertAt(e,i);const[s]=t.descendant($b,e),o=Rw(s);r=lw.AttributeMap.diff(o,r)||{}}else if("object"==typeof n.insert){const i=Object.keys(n.insert)[0];if(null==i)return e;if(t.insertAt(e,i,n.insert[i]),null!=t.scroll.query(i,Ob.INLINE)){const[n]=t.descendant($b,e),i=Rw(n);r=lw.AttributeMap.diff(i,r)||{}}}return Object.keys(r).forEach((n=>{t.formatAt(e,i,n,r[n])})),e+i}),e)}const qE={scope:Ob.BLOCK,whitelist:["right","center","justify"]},kE=new Lb("align","align",qE),TE=(new jb("align","ql-align",qE),new Fb("align","text-align",qE));class xE extends Fb{value(t){let e=super.value(t);return e.startsWith("rgb(")?(e=e.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${e.split(",").map((t=>`00${parseInt(t,10).toString(16)}`.slice(-2))).join("")}`):e}}new jb("color","ql-color",{scope:Ob.INLINE});const IE=new xE("color","color",{scope:Ob.INLINE}),SE=(new jb("background","ql-bg",{scope:Ob.INLINE}),new xE("background","background-color",{scope:Ob.INLINE}));class AE extends bE{static create(t){const e=super.create(t);return e.setAttribute("spellcheck","false"),e}code(t,e){return this.children.map((t=>t.length()<=1?"":t.domNode.innerText)).join("\n").slice(t,t+e)}html(t,e){return`<pre>\n${Aw(this.code(t,e))}\n</pre>`}}class NE extends Ow{static TAB="  ";static register(){gE.register(AE)}}class CE extends Cw{}CE.blotName="code",CE.tagName="CODE",NE.blotName="code-block",NE.className="ql-code-block",NE.tagName="DIV",AE.blotName="code-block-container",AE.className="ql-code-block-container",AE.tagName="DIV",AE.allowedChildren=[NE],NE.allowedChildren=[Sw,Iw,Mw],NE.requiredContainer=AE;const OE={scope:Ob.BLOCK,whitelist:["rtl"]},LE=new Lb("direction","dir",OE),RE=(new jb("direction","ql-direction",OE),new Fb("direction","direction",OE)),DE={scope:Ob.INLINE,whitelist:["serif","monospace"]};new jb("font","ql-font",DE);const ME=new class extends Fb{value(t){return super.value(t).replace(/["']/g,"")}}("font","font-family",DE),PE=(new jb("size","ql-size",{scope:Ob.INLINE,whitelist:["small","large","huge"]}),new Fb("size","font-size",{scope:Ob.INLINE,whitelist:["10px","18px","32px"]})),jE=zw("quill:keyboard"),UE=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class FE extends rE{static match(t,e){return!["altKey","ctrlKey","metaKey","shiftKey"].some((n=>!!e[n]!==t[n]&&null!==e[n]))&&(e.key===t.key||e.key===t.which)}constructor(t,e){super(t,e),this.bindings={},Object.keys(this.options.bindings).forEach((t=>{this.options.bindings[t]&&this.addBinding(this.options.bindings[t])})),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},(()=>{})),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=function(t){if("string"==typeof t||"number"==typeof t)t={key:t};else{if("object"!=typeof t)return null;t=Cb(t)}return t.shortKey&&(t[UE]=t.shortKey,delete t.shortKey),t}(t);null!=i?("function"==typeof e&&(e={handler:e}),"function"==typeof n&&(n={handler:n}),(Array.isArray(i.key)?i.key:[i.key]).forEach((t=>{const r={...i,key:t,...e,...n};this.bindings[r.key]=this.bindings[r.key]||[],this.bindings[r.key].push(r)}))):jE.warn("Attempted to add invalid keyboard binding",i)}listen(){this.quill.root.addEventListener("keydown",(t=>{if(t.defaultPrevented||t.isComposing)return;const e=(this.bindings[t.key]||[]).concat(this.bindings[t.which]||[]).filter((e=>FE.match(t,e)));if(0===e.length)return;const n=gE.find(t.target,!0);if(n&&n.scroll!==this.quill.scroll)return;const i=this.quill.getSelection();if(null==i||!this.quill.hasFocus())return;const[r,s]=this.quill.getLine(i.index),[o,a]=this.quill.getLeaf(i.index),[l,c]=0===i.length?[o,a]:this.quill.getLeaf(i.index+i.length),u=o instanceof aw?o.value().slice(0,a):"",h=l instanceof aw?l.value().slice(c):"",d={collapsed:0===i.length,empty:0===i.length&&r.length()<=1,format:this.quill.getFormat(i),line:r,offset:s,prefix:u,suffix:h,event:t};e.some((t=>{if(null!=t.collapsed&&t.collapsed!==d.collapsed)return!1;if(null!=t.empty&&t.empty!==d.empty)return!1;if(null!=t.offset&&t.offset!==d.offset)return!1;if(Array.isArray(t.format)){if(t.format.every((t=>null==d.format[t])))return!1}else if("object"==typeof t.format&&!Object.keys(t.format).every((e=>!0===t.format[e]?null!=d.format[e]:!1===t.format[e]?null==d.format[e]:Tw(t.format[e],d.format[e]))))return!1;return!(null!=t.prefix&&!t.prefix.test(d.prefix)||null!=t.suffix&&!t.suffix.test(d.suffix)||!0===t.handler.call(this,i,d,t))}))&&t.preventDefault()}))}handleBackspace(t,e){const n=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;if(0===t.index||this.quill.getLength()<=1)return;let i={};const[r]=this.quill.getLine(t.index);let s=(new(cw())).retain(t.index-n).delete(n);if(0===e.offset){const[e]=this.quill.getLine(t.index-1);if(e&&!("block"===e.statics.blotName&&e.length()<=1)){const e=r.formats(),n=this.quill.getFormat(t.index-1,1);if(i=lw.AttributeMap.diff(e,n)||{},Object.keys(i).length>0){const e=(new(cw())).retain(t.index+r.length()-2).retain(1,i);s=s.compose(e)}}}this.quill.updateContents(s,gE.sources.USER),this.quill.focus()}handleDelete(t,e){const n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(t.index>=this.quill.getLength()-n)return;let i={};const[r]=this.quill.getLine(t.index);let s=(new(cw())).retain(t.index).delete(n);if(e.offset>=r.length()-1){const[e]=this.quill.getLine(t.index+1);if(e){const n=r.formats(),o=this.quill.getFormat(t.index,1);i=lw.AttributeMap.diff(n,o)||{},Object.keys(i).length>0&&(s=s.retain(e.length()-1).retain(1,i))}}this.quill.updateContents(s,gE.sources.USER),this.quill.focus()}handleDeleteRange(t){WE({range:t,quill:this.quill}),this.quill.focus()}handleEnter(t,e){const n=Object.keys(e.format).reduce(((t,n)=>(this.quill.scroll.query(n,Ob.BLOCK)&&!Array.isArray(e.format[n])&&(t[n]=e.format[n]),t)),{}),i=(new(cw())).retain(t.index).delete(t.length).insert("\n",n);this.quill.updateContents(i,gE.sources.USER),this.quill.setSelection(t.index+1,gE.sources.SILENT),this.quill.focus()}}const VE={bindings:{bold:HE("bold"),italic:HE("italic"),underline:HE("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(t,e){return!(!e.collapsed||0===e.offset)||(this.quill.format("indent","+1",gE.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(t,e){return!(!e.collapsed||0===e.offset)||(this.quill.format("indent","-1",gE.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(t,e){null!=e.format.indent?this.quill.format("indent","-1",gE.sources.USER):null!=e.format.list&&this.quill.format("list",!1,gE.sources.USER)}},"indent code-block":BE(!0),"outdent code-block":BE(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(t){this.quill.deleteText(t.index-1,1,gE.sources.USER)}},tab:{key:"Tab",handler(t,e){if(e.format.table)return!0;this.quill.history.cutoff();const n=(new(cw())).retain(t.index).delete(t.length).insert("\t");return this.quill.updateContents(n,gE.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index+1,gE.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,gE.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(t,e){const n={list:!1};e.format.indent&&(n.indent=!1),this.quill.formatLine(t.index,t.length,n,gE.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(t){const[e,n]=this.quill.getLine(t.index),i={...e.formats(),list:"checked"},r=(new(cw())).retain(t.index).insert("\n",i).retain(e.length()-n-1).retain(1,{list:"unchecked"});this.quill.updateContents(r,gE.sources.USER),this.quill.setSelection(t.index+1,gE.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(t,e){const[n,i]=this.quill.getLine(t.index),r=(new(cw())).retain(t.index).insert("\n",e.format).retain(n.length()-i-1).retain(1,{header:null});this.quill.updateContents(r,gE.sources.USER),this.quill.setSelection(t.index+1,gE.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(t){const e=this.quill.getModule("table");if(e){const[n,i,r,s]=e.getTable(t),o=function(t,e,n,i){return null==e.prev&&null==e.next?null==n.prev&&null==n.next?0===i?-1:1:null==n.prev?-1:1:null==e.prev?-1:null==e.next?1:null}(0,i,r,s);if(null==o)return;let a=n.offset();if(o<0){const e=(new(cw())).retain(a).insert("\n");this.quill.updateContents(e,gE.sources.USER),this.quill.setSelection(t.index+1,t.length,gE.sources.SILENT)}else if(o>0){a+=n.length();const t=(new(cw())).retain(a).insert("\n");this.quill.updateContents(t,gE.sources.USER),this.quill.setSelection(a,gE.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(t,e){const{event:n,line:i}=e,r=i.offset(this.quill.scroll);n.shiftKey?this.quill.setSelection(r-1,gE.sources.USER):this.quill.setSelection(r+i.length(),gE.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(t,e){if(null==this.quill.scroll.query("list"))return!0;const{length:n}=e.prefix,[i,r]=this.quill.getLine(t.index);if(r>n)return!0;let s;switch(e.prefix.trim()){case"[]":case"[ ]":s="unchecked";break;case"[x]":s="checked";break;case"-":case"*":s="bullet";break;default:s="ordered"}this.quill.insertText(t.index," ",gE.sources.USER),this.quill.history.cutoff();const o=(new(cw())).retain(t.index-r).delete(n+1).retain(i.length()-2-r).retain(1,{list:s});return this.quill.updateContents(o,gE.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index-n,gE.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(t){const[e,n]=this.quill.getLine(t.index);let i=2,r=e;for(;null!=r&&r.length()<=1&&r.formats()["code-block"];)if(r=r.prev,i-=1,i<=0){const i=(new(cw())).retain(t.index+e.length()-n-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(i,gE.sources.USER),this.quill.setSelection(t.index-1,gE.sources.SILENT),!1}return!0}},"embed left":zE("ArrowLeft",!1),"embed left shift":zE("ArrowLeft",!0),"embed right":zE("ArrowRight",!1),"embed right shift":zE("ArrowRight",!0),"table down":$E(!1),"table up":$E(!0)}};function BE(t){return{key:"Tab",shiftKey:!t,format:{"code-block":!0},handler(e,n){let{event:i}=n;const r=this.quill.scroll.query("code-block"),{TAB:s}=r;if(0===e.length&&!i.shiftKey)return this.quill.insertText(e.index,s,gE.sources.USER),void this.quill.setSelection(e.index+s.length,gE.sources.SILENT);const o=0===e.length?this.quill.getLines(e.index,1):this.quill.getLines(e);let{index:a,length:l}=e;o.forEach(((e,n)=>{t?(e.insertAt(0,s),0===n?a+=s.length:l+=s.length):e.domNode.textContent.startsWith(s)&&(e.deleteAt(0,s.length),0===n?a-=s.length:l-=s.length)})),this.quill.update(gE.sources.USER),this.quill.setSelection(a,l,gE.sources.SILENT)}}}function zE(t,e){return{key:t,shiftKey:e,altKey:null,["ArrowLeft"===t?"prefix":"suffix"]:/^$/,handler(n){let{index:i}=n;"ArrowRight"===t&&(i+=n.length+1);const[r]=this.quill.getLeaf(i);return!(r instanceof nw&&("ArrowLeft"===t?e?this.quill.setSelection(n.index-1,n.length+1,gE.sources.USER):this.quill.setSelection(n.index-1,gE.sources.USER):e?this.quill.setSelection(n.index,n.length+1,gE.sources.USER):this.quill.setSelection(n.index+n.length+1,gE.sources.USER),1))}}}function HE(t){return{key:t[0],shortKey:!0,handler(e,n){this.quill.format(t,!n.format[t],gE.sources.USER)}}}function $E(t){return{key:t?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(e,n){const i=t?"prev":"next",r=n.line,s=r.parent[i];if(null!=s){if("table-row"===s.statics.blotName){let t=s.children.head,e=r;for(;null!=e.prev;)e=e.prev,t=t.next;const i=t.offset(this.quill.scroll)+Math.min(n.offset,t.length()-1);this.quill.setSelection(i,0,gE.sources.USER)}}else{const e=r.table()[i];null!=e&&(t?this.quill.setSelection(e.offset(this.quill.scroll)+e.length()-1,0,gE.sources.USER):this.quill.setSelection(e.offset(this.quill.scroll),0,gE.sources.USER))}return!1}}}function WE(t){let{quill:e,range:n}=t;const i=e.getLines(n);let r={};if(i.length>1){const t=i[0].formats(),e=i[i.length-1].formats();r=lw.AttributeMap.diff(e,t)||{}}e.deleteText(n,gE.sources.USER),Object.keys(r).length>0&&e.formatLine(n.index,1,r,gE.sources.USER),e.setSelection(n.index,gE.sources.SILENT)}FE.DEFAULTS=VE;const KE=/font-weight:\s*normal/,GE=["P","OL","UL"],QE=t=>t&&GE.includes(t.tagName),YE=/\bmso-list:[^;]*ignore/i,XE=/\bmso-list:[^;]*\bl(\d+)/i,JE=/\bmso-list:[^;]*\blevel(\d+)/i,ZE=[function(t){"urn:schemas-microsoft-com:office:word"===t.documentElement.getAttribute("xmlns:w")&&(t=>{const e=Array.from(t.querySelectorAll("[style*=mso-list]")),n=[],i=[];e.forEach((t=>{(t.getAttribute("style")||"").match(YE)?n.push(t):i.push(t)})),n.forEach((t=>t.parentNode?.removeChild(t)));const r=t.documentElement.innerHTML,s=i.map((t=>((t,e)=>{const n=t.getAttribute("style"),i=n?.match(XE);if(!i)return null;const r=Number(i[1]),s=n?.match(JE),o=s?Number(s[1]):1,a=new RegExp(`@list l${r}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),l=e.match(a);return{id:r,indent:o,type:l&&"bullet"===l[1]?"bullet":"ordered",element:t}})(t,r))).filter((t=>t));for(;s.length;){const t=[];let e=s.shift();for(;e;)t.push(e),e=s.length&&s[0]?.element===e.element.nextElementSibling&&s[0].id===e.id?s.shift():null;const n=document.createElement("ul");t.forEach((t=>{const e=document.createElement("li");e.setAttribute("data-list",t.type),t.indent>1&&e.setAttribute("class","ql-indent-"+(t.indent-1)),e.innerHTML=t.element.innerHTML,n.appendChild(e)}));const i=t[0]?.element,{parentNode:r}=i??{};i&&r?.replaceChild(n,i),t.slice(1).forEach((t=>{let{element:e}=t;r?.removeChild(e)}))}})(t)},function(t){t.querySelector('[id^="docs-internal-guid-"]')&&((t=>{Array.from(t.querySelectorAll('b[style*="font-weight"]')).filter((t=>t.getAttribute("style")?.match(KE))).forEach((e=>{const n=t.createDocumentFragment();n.append(...e.childNodes),e.parentNode?.replaceChild(n,e)}))})(t),(t=>{Array.from(t.querySelectorAll("br")).filter((t=>QE(t.previousElementSibling)&&QE(t.nextElementSibling))).forEach((t=>{t.parentNode?.removeChild(t)}))})(t))}],t_=zw("quill:clipboard"),e_=[[Node.TEXT_NODE,function(t,e,n){let i=t.data;if("O:P"===t.parentElement?.tagName)return e.insert(i.trim());if(!c_(t)){if(0===i.trim().length&&i.includes("\n")&&!function(t,e){return t.previousElementSibling&&t.nextElementSibling&&!a_(t.previousElementSibling,e)&&!a_(t.nextElementSibling,e)}(t,n))return e;const r=(t,e)=>{const n=e.replace(/[^\u00a0]/g,"");return n.length<1&&t?" ":n};i=i.replace(/\r\n/g," ").replace(/\n/g," "),i=i.replace(/\s\s+/g,r.bind(r,!0)),(null==t.previousSibling&&null!=t.parentElement&&a_(t.parentElement,n)||t.previousSibling instanceof Element&&a_(t.previousSibling,n))&&(i=i.replace(/^\s+/,r.bind(r,!1))),(null==t.nextSibling&&null!=t.parentElement&&a_(t.parentElement,n)||t.nextSibling instanceof Element&&a_(t.nextSibling,n))&&(i=i.replace(/\s+$/,r.bind(r,!1)))}return e.insert(i)}],[Node.TEXT_NODE,d_],["br",function(t,e){return o_(e,"\n")||e.insert("\n"),e}],[Node.ELEMENT_NODE,d_],[Node.ELEMENT_NODE,function(t,e,n){const i=n.query(t);if(null==i)return e;if(i.prototype instanceof nw){const e={},r=i.value(t);if(null!=r)return e[i.blotName]=r,(new(cw())).insert(e,i.formats(t,n))}else if(i.prototype instanceof Zb&&!o_(e,"\n")&&e.insert("\n"),"blotName"in i&&"formats"in i&&"function"==typeof i.formats)return s_(e,i.blotName,i.formats(t,n),n);return e}],[Node.ELEMENT_NODE,function(t,e,n){const i=Lb.keys(t),r=jb.keys(t),s=Fb.keys(t),o={};return i.concat(r).concat(s).forEach((e=>{let i=n.query(e,Ob.ATTRIBUTE);null!=i&&(o[i.attrName]=i.value(t),o[i.attrName])||(i=n_[e],null==i||i.attrName!==e&&i.keyName!==e||(o[i.attrName]=i.value(t)||void 0),i=i_[e],null==i||i.attrName!==e&&i.keyName!==e||(i=i_[e],o[i.attrName]=i.value(t)||void 0))})),Object.entries(o).reduce(((t,e)=>{let[i,r]=e;return s_(t,i,r,n)}),e)}],[Node.ELEMENT_NODE,function(t,e,n){const i={},r=t.style||{};return"italic"===r.fontStyle&&(i.italic=!0),"underline"===r.textDecoration&&(i.underline=!0),"line-through"===r.textDecoration&&(i.strike=!0),(r.fontWeight?.startsWith("bold")||parseInt(r.fontWeight,10)>=700)&&(i.bold=!0),e=Object.entries(i).reduce(((t,e)=>{let[i,r]=e;return s_(t,i,r,n)}),e),parseFloat(r.textIndent||0)>0?(new(cw())).insert("\t").concat(e):e}],["li",function(t,e,n){const i=n.query(t);if(null==i||"list"!==i.blotName||!o_(e,"\n"))return e;let r=-1,s=t.parentNode;for(;null!=s;)["OL","UL"].includes(s.tagName)&&(r+=1),s=s.parentNode;return r<=0?e:e.reduce(((t,e)=>e.attributes&&"number"==typeof e.attributes.indent?t.push(e):t.insert(e.insert,{indent:r,...e.attributes||{}})),new(cw()))}],["ol, ul",function(t,e,n){return s_(e,"list","OL"===t.tagName?"ordered":"bullet",n)}],["pre",function(t,e,n){const i=n.query("code-block");return s_(e,"code-block",!i||!("formats"in i)||"function"!=typeof i.formats||i.formats(t,n),n)}],["tr",function(t,e,n){const i="TABLE"===t.parentElement?.tagName?t.parentElement:t.parentElement?.parentElement;return null!=i?s_(e,"table",Array.from(i.querySelectorAll("tr")).indexOf(t)+1,n):e}],["b",h_("bold")],["i",h_("italic")],["strike",h_("strike")],["style",function(){return new(cw())}]],n_=[kE,LE].reduce(((t,e)=>(t[e.keyName]=e,t)),{}),i_=[TE,SE,IE,RE,ME,PE].reduce(((t,e)=>(t[e.keyName]=e,t)),{});class r_ extends rE{constructor(t,e){super(t,e),this.quill.root.addEventListener("copy",(t=>this.onCaptureCopy(t,!1))),this.quill.root.addEventListener("cut",(t=>this.onCaptureCopy(t,!0))),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],e_.concat(this.options.matchers).forEach((t=>{let[e,n]=t;this.addMatcher(e,n)}))}addMatcher(t,e){this.matchers.push([t,e])}convert(t){let{html:e,text:n}=t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i[NE.blotName])return(new(cw())).insert(n||"",{[NE.blotName]:i[NE.blotName]});if(!e)return(new(cw())).insert(n||"",i);const r=this.convertHTML(e);return o_(r,"\n")&&(null==r.ops[r.ops.length-1].attributes||i.table)?r.compose((new(cw())).retain(r.length()-1).delete(1)):r}normalizeHTML(t){(t=>{t.documentElement&&ZE.forEach((e=>{e(t)}))})(t)}convertHTML(t){const e=(new DOMParser).parseFromString(t,"text/html");this.normalizeHTML(e);const n=e.body,i=new WeakMap,[r,s]=this.prepareMatching(n,i);return u_(this.quill.scroll,n,r,s,i)}dangerouslyPasteHTML(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gE.sources.API;if("string"==typeof t){const n=this.convert({html:t,text:""});this.quill.setContents(n,e),this.quill.setSelection(0,gE.sources.SILENT)}else{const i=this.convert({html:e,text:""});this.quill.updateContents((new(cw())).retain(t).concat(i),n),this.quill.setSelection(t+i.length(),gE.sources.SILENT)}}onCaptureCopy(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.defaultPrevented)return;t.preventDefault();const[n]=this.quill.selection.getRange();if(null==n)return;const{html:i,text:r}=this.onCopy(n,e);t.clipboardData?.setData("text/plain",r),t.clipboardData?.setData("text/html",i),e&&WE({range:n,quill:this.quill})}onCapturePaste(t){if(t.defaultPrevented||!this.quill.isEnabled())return;t.preventDefault();const e=this.quill.getSelection(!0);if(null==e)return;const n=t.clipboardData?.getData("text/html"),i=t.clipboardData?.getData("text/plain"),r=Array.from(t.clipboardData?.files||[]);if(!n&&r.length>0)this.quill.uploader.upload(e,r);else{if(n&&r.length>0){const t=(new DOMParser).parseFromString(n,"text/html");if(1===t.body.childElementCount&&"IMG"===t.body.firstElementChild?.tagName)return void this.quill.uploader.upload(e,r)}this.onPaste(e,{html:n,text:i})}}onCopy(t){const e=this.quill.getText(t);return{html:this.quill.getSemanticHTML(t),text:e}}onPaste(t,e){let{text:n,html:i}=e;const r=this.quill.getFormat(t.index),s=this.convert({text:n,html:i},r);t_.log("onPaste",s,{text:n,html:i});const o=(new(cw())).retain(t.index).delete(t.length).concat(s);this.quill.updateContents(o,gE.sources.USER),this.quill.setSelection(o.length()-t.length,gE.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(t,e){const n=[],i=[];return this.matchers.forEach((r=>{const[s,o]=r;switch(s){case Node.TEXT_NODE:i.push(o);break;case Node.ELEMENT_NODE:n.push(o);break;default:Array.from(t.querySelectorAll(s)).forEach((t=>{if(e.has(t)){const n=e.get(t);n?.push(o)}else e.set(t,[o])}))}})),[n,i]}}function s_(t,e,n,i){return i.query(e)?t.reduce(((t,i)=>{if(i.attributes&&i.attributes[e])return t.push(i);const r=n?{[e]:n}:{};return t.insert(i.insert,{...r,...i.attributes})}),new(cw())):t}function o_(t,e){let n="";for(let i=t.ops.length-1;i>=0&&n.length<e.length;--i){const e=t.ops[i];if("string"!=typeof e.insert)break;n=e.insert+n}return n.slice(-1*e.length)===e}function a_(t,e){if(!(t instanceof Element))return!1;const n=e.query(t);return!(n&&n.prototype instanceof nw)&&["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(t.tagName.toLowerCase())}r_.DEFAULTS={matchers:[]};const l_=new WeakMap;function c_(t){return null!=t&&(l_.has(t)||("PRE"===t.tagName?l_.set(t,!0):l_.set(t,c_(t.parentNode))),l_.get(t))}function u_(t,e,n,i,r){return e.nodeType===e.TEXT_NODE?i.reduce(((n,i)=>i(e,n,t)),new(cw())):e.nodeType===e.ELEMENT_NODE?Array.from(e.childNodes||[]).reduce(((s,o)=>{let a=u_(t,o,n,i,r);return o.nodeType===e.ELEMENT_NODE&&(a=n.reduce(((e,n)=>n(o,e,t)),a),a=(r.get(o)||[]).reduce(((e,n)=>n(o,e,t)),a)),s.concat(a)}),new(cw())):new(cw())}function h_(t){return(e,n,i)=>s_(n,t,!0,i)}function d_(t,e,n){if(!o_(e,"\n")){if(a_(t,n))return e.insert("\n");if(e.length()>0&&t.nextSibling){let i=t.nextSibling;for(;null!=i;){if(a_(i,n))return e.insert("\n");const t=n.query(i);if(t&&t.prototype instanceof Lw)return e.insert("\n");i=i.firstChild}}}return e}class f_ extends rE{lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(t,e){super(t,e),this.quill.on(gE.events.EDITOR_CHANGE,((t,e,n,i)=>{t===gE.events.SELECTION_CHANGE?e&&i!==gE.sources.SILENT&&(this.currentRange=e):t===gE.events.TEXT_CHANGE&&(this.ignoreChange||(this.options.userOnly&&i!==gE.sources.USER?this.transform(e):this.record(e,n)),this.currentRange=g_(this.currentRange,e))})),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",(t=>{"historyUndo"===t.inputType?(this.undo(),t.preventDefault()):"historyRedo"===t.inputType&&(this.redo(),t.preventDefault())}))}change(t,e){if(0===this.stack[t].length)return;const n=this.stack[t].pop();if(!n)return;const i=this.quill.getContents(),r=n.delta.invert(i);this.stack[e].push({delta:r,range:g_(n.range,r)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n.delta,gE.sources.USER),this.ignoreChange=!1,this.restoreSelection(n)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(t,e){if(0===t.ops.length)return;this.stack.redo=[];let n=t.invert(e),i=this.currentRange;const r=Date.now();if(this.lastRecorded+this.options.delay>r&&this.stack.undo.length>0){const t=this.stack.undo.pop();t&&(n=n.compose(t.delta),i=t.range)}else this.lastRecorded=r;0!==n.length()&&(this.stack.undo.push({delta:n,range:i}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(t){p_(this.stack.undo,t),p_(this.stack.redo,t)}undo(){this.change("undo","redo")}restoreSelection(t){if(t.range)this.quill.setSelection(t.range,gE.sources.USER);else{const e=function(t,e){const n=e.reduce(((t,e)=>t+(e.delete||0)),0);let i=e.length()-n;return function(t,e){const n=e.ops[e.ops.length-1];return null!=n&&(null!=n.insert?"string"==typeof n.insert&&n.insert.endsWith("\n"):null!=n.attributes&&Object.keys(n.attributes).some((e=>null!=t.query(e,Ob.BLOCK))))}(t,e)&&(i-=1),i}(this.quill.scroll,t.delta);this.quill.setSelection(e,gE.sources.USER)}}}function p_(t,e){let n=e;for(let e=t.length-1;e>=0;e-=1){const i=t[e];t[e]={delta:n.transform(i.delta,!0),range:i.range&&g_(i.range,n)},n=i.delta.transform(n),0===t[e].delta.length()&&t.splice(e,1)}}function g_(t,e){if(!t)return t;const n=e.transformPosition(t.index);return{index:n,length:e.transformPosition(t.index+t.length)-n}}f_.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};class m_ extends rE{constructor(t,e){super(t,e),t.root.addEventListener("drop",(e=>{e.preventDefault();let n=null;if(document.caretRangeFromPoint)n=document.caretRangeFromPoint(e.clientX,e.clientY);else if(document.caretPositionFromPoint){const t=document.caretPositionFromPoint(e.clientX,e.clientY);n=document.createRange(),n.setStart(t.offsetNode,t.offset),n.setEnd(t.offsetNode,t.offset)}const i=n&&t.selection.normalizeNative(n);if(i){const n=t.selection.normalizedToRange(i);e.dataTransfer?.files&&this.upload(n,e.dataTransfer.files)}}))}upload(t,e){const n=[];Array.from(e).forEach((t=>{t&&this.options.mimetypes?.includes(t.type)&&n.push(t)})),n.length>0&&this.options.handler.call(this,t,n)}}m_.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(t,e){const n=e.map((t=>new Promise((e=>{const n=new FileReader;n.onload=t=>{e(t.target.result)},n.readAsDataURL(t)}))));Promise.all(n).then((e=>{const n=e.reduce(((t,e)=>t.insert({image:e})),(new(cw())).retain(t.index).delete(t.length));this.quill.updateContents(n,$w.sources.USER),this.quill.setSelection(t.index+e.length,$w.sources.SILENT)}))}};const y_=m_,v_=["insertText","insertReplacementText"],b_=/Mac/i.test(navigator.platform);gE.register({"blots/block":Ow,"blots/block/embed":Lw,"blots/break":Iw,"blots/container":bE,"blots/cursor":Mw,"blots/embed":oE,"blots/inline":Cw,"blots/scroll":class extends sw{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=Ow;static allowedChildren=[Ow,Lw,bE];constructor(t,e,n){let{emitter:i}=n;super(t,e),this.emitter=i,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",(t=>this.handleDragStart(t)))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const t=this.batch;this.batch=!1,this.update(t)}emitMount(t){this.emitter.emit($w.events.SCROLL_BLOT_MOUNT,t)}emitUnmount(t){this.emitter.emit($w.events.SCROLL_BLOT_UNMOUNT,t)}emitEmbedUpdate(t,e){this.emitter.emit($w.events.SCROLL_EMBED_UPDATE,t,e)}deleteAt(t,e){const[n,i]=this.line(t),[r]=this.line(t+e);if(super.deleteAt(t,e),null!=r&&n!==r&&i>0){if(n instanceof Lw||r instanceof Lw)return void this.optimize();const t=r.children.head instanceof Iw?null:r.children.head;n.moveChildren(r,t),n.remove()}this.optimize()}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.domNode.setAttribute("contenteditable",t?"true":"false")}formatAt(t,e,n,i){super.formatAt(t,e,n,i),this.optimize()}insertAt(t,e,n){if(t>=this.length())if(null==n||null==this.scroll.query(e,Ob.BLOCK)){const t=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(t),null==n&&e.endsWith("\n")?t.insertAt(0,e.slice(0,-1),n):t.insertAt(0,e,n)}else{const t=this.scroll.create(e,n);this.appendChild(t)}else super.insertAt(t,e,n);this.optimize()}insertBefore(t,e){if(t.statics.scope===Ob.INLINE_BLOT){const n=this.scroll.create(this.statics.defaultChild.blotName);n.appendChild(t),super.insertBefore(n,e)}else super.insertBefore(t,e)}insertContents(t,e){const n=this.deltaToRenderBlocks(e.concat((new(cw())).insert("\n"))),i=n.pop();if(null==i)return;this.batchStart();const r=n.shift();if(r){const e="block"===r.type&&(0===r.delta.length()||!this.descendant(Lw,t)[0]&&t<this.length()),n="block"===r.type?r.delta:(new(cw())).insert({[r.key]:r.value});_E(this,t,n);const i="block"===r.type?1:0,s=t+n.length()+i;e&&this.insertAt(s-1,"\n");const o=Rw(this.line(t)[0]),a=lw.AttributeMap.diff(o,r.attributes)||{};Object.keys(a).forEach((t=>{this.formatAt(s-1,1,t,a[t])})),t=s}let[s,o]=this.children.find(t);n.length&&(s&&(s=s.split(o),o=0),n.forEach((t=>{if("block"===t.type)_E(this.createBlock(t.attributes,s||void 0),0,t.delta);else{const e=this.create(t.key,t.value);this.insertBefore(e,s||void 0),Object.keys(t.attributes).forEach((n=>{e.format(n,t.attributes[n])}))}}))),"block"===i.type&&i.delta.length()&&_E(this,s?s.offset(s.scroll)+o:this.length(),i.delta),this.batchEnd(),this.optimize()}isEnabled(){return"true"===this.domNode.getAttribute("contenteditable")}leaf(t){const e=this.path(t).pop();if(!e)return[null,-1];const[n,i]=e;return n instanceof $b?[n,i]:[null,-1]}line(t){return t===this.length()?this.line(t-1):this.descendant(wE,t)}lines(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;const n=(t,e,i)=>{let r=[],s=i;return t.children.forEachAt(e,i,((t,e,i)=>{wE(t)?r.push(t):t instanceof ew&&(r=r.concat(n(t,e,s))),s-=i})),r};return n(this,t,e)}optimize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.batch||(super.optimize(t,e),t.length>0&&this.emitter.emit($w.events.SCROLL_OPTIMIZE,t,e))}path(t){return super.path(t).slice(1)}remove(){}update(t){if(this.batch)return void(Array.isArray(t)&&(this.batch=this.batch.concat(t)));let e=$w.sources.USER;"string"==typeof t&&(e=t),Array.isArray(t)||(t=this.observer.takeRecords()),(t=t.filter((t=>{let{target:e}=t;const n=this.find(e,!0);return n&&!EE(n)}))).length>0&&this.emitter.emit($w.events.SCROLL_BEFORE_UPDATE,e,t),super.update(t.concat([])),t.length>0&&this.emitter.emit($w.events.SCROLL_UPDATE,e,t)}updateEmbedAt(t,e,n){const[i]=this.descendant((t=>t instanceof Lw),t);i&&i.statics.blotName===e&&EE(i)&&i.updateContent(n)}handleDragStart(t){t.preventDefault()}deltaToRenderBlocks(t){const e=[];let n=new(cw());return t.forEach((t=>{const i=t?.insert;if(i)if("string"==typeof i){const r=i.split("\n");r.slice(0,-1).forEach((i=>{n.insert(i,t.attributes),e.push({type:"block",delta:n,attributes:t.attributes??{}}),n=new(cw())}));const s=r[r.length-1];s&&n.insert(s,t.attributes)}else{const r=Object.keys(i)[0];if(!r)return;this.query(r,Ob.INLINE)?n.push(t):(n.length()&&e.push({type:"block",delta:n,attributes:{}}),n=new(cw()),e.push({type:"blockEmbed",key:r,value:i[r],attributes:t.attributes??{}}))}})),n.length()&&e.push({type:"block",delta:n,attributes:{}}),e}createBlock(t,e){let n;const i={};Object.entries(t).forEach((t=>{let[e,r]=t;null!=this.query(e,Ob.BLOCK&Ob.BLOT)?n=e:i[e]=r}));const r=this.create(n||this.statics.defaultChild.blotName,n?t[n]:void 0);this.insertBefore(r,e||void 0);const s=r.length();return Object.entries(i).forEach((t=>{let[e,n]=t;r.formatAt(0,s,e,n)})),r}},"blots/text":Sw,"modules/clipboard":r_,"modules/history":f_,"modules/keyboard":FE,"modules/uploader":y_,"modules/input":class extends rE{constructor(t,e){super(t,e),t.root.addEventListener("beforeinput",(t=>{this.handleBeforeInput(t)})),/Android/i.test(navigator.userAgent)||t.on(gE.events.COMPOSITION_BEFORE_START,(()=>{this.handleCompositionStart()}))}deleteRange(t){WE({range:t,quill:this.quill})}replaceText(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(0===t.length)return!1;if(e){const n=this.quill.getFormat(t.index,1);this.deleteRange(t),this.quill.updateContents((new(cw())).retain(t.index).insert(e,n),gE.sources.USER)}else this.deleteRange(t);return this.quill.setSelection(t.index+e.length,0,gE.sources.SILENT),!0}handleBeforeInput(t){if(this.quill.composition.isComposing||t.defaultPrevented||!v_.includes(t.inputType))return;const e=t.getTargetRanges?t.getTargetRanges()[0]:null;if(!e||!0===e.collapsed)return;const n=function(t){return"string"==typeof t.data?t.data:t.dataTransfer?.types.includes("text/plain")?t.dataTransfer.getData("text/plain"):null}(t);if(null==n)return;const i=this.quill.selection.normalizeNative(e),r=i?this.quill.selection.normalizedToRange(i):null;r&&this.replaceText(r,n)&&t.preventDefault()}handleCompositionStart(){const t=this.quill.getSelection();t&&this.replaceText(t)}},"modules/uiNode":class extends rE{isListening=!1;selectionChangeDeadline=0;constructor(t,e){super(t,e),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(t,e){let{line:n,event:i}=e;if(!(n instanceof Qb&&n.uiNode))return!0;const r="rtl"===getComputedStyle(n.domNode).direction;return!!(r&&"ArrowRight"!==i.key||!r&&"ArrowLeft"!==i.key)||(this.quill.setSelection(t.index-1,t.length+(i.shiftKey?1:0),gE.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",(t=>{!t.defaultPrevented&&(t=>"ArrowLeft"===t.key||"ArrowRight"===t.key||"ArrowUp"===t.key||"ArrowDown"===t.key||"Home"===t.key||!(!b_||"a"!==t.key||!0!==t.ctrlKey))(t)&&this.ensureListeningToSelectionChange()}))}ensureListeningToSelectionChange(){this.selectionChangeDeadline=Date.now()+100,this.isListening||(this.isListening=!0,document.addEventListener("selectionchange",(()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()}),{once:!0}))}handleSelectionChange(){const t=document.getSelection();if(!t)return;const e=t.getRangeAt(0);if(!0!==e.collapsed||0!==e.startOffset)return;const n=this.quill.scroll.find(e.startContainer);if(!(n instanceof Qb&&n.uiNode))return;const i=document.createRange();i.setStartAfter(n.uiNode),i.setEndAfter(n.uiNode),t.removeAllRanges(),t.addRange(i)}}});const w_=gE,E_=zw("quill:toolbar");class __ extends rE{constructor(t,e){if(super(t,e),Array.isArray(this.options.container)){const e=document.createElement("div");e.setAttribute("role","toolbar"),function(t,e){Array.isArray(e[0])||(e=[e]),e.forEach((e=>{const n=document.createElement("span");n.classList.add("ql-formats"),e.forEach((t=>{if("string"==typeof t)q_(n,t);else{const e=Object.keys(t)[0],i=t[e];Array.isArray(i)?function(t,e,n){const i=document.createElement("select");i.classList.add(`ql-${e}`),n.forEach((t=>{const e=document.createElement("option");!1!==t?e.setAttribute("value",String(t)):e.setAttribute("selected","selected"),i.appendChild(e)})),t.appendChild(i)}(n,e,i):q_(n,e,i)}})),t.appendChild(n)}))}(e,this.options.container),t.container?.parentNode?.insertBefore(e,t.container),this.container=e}else"string"==typeof this.options.container?this.container=document.querySelector(this.options.container):this.container=this.options.container;this.container instanceof HTMLElement?(this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach((t=>{const e=this.options.handlers?.[t];e&&this.addHandler(t,e)})),Array.from(this.container.querySelectorAll("button, select")).forEach((t=>{this.attach(t)})),this.quill.on(gE.events.EDITOR_CHANGE,(()=>{const[t]=this.quill.selection.getRange();this.update(t)}))):E_.error("Container required for toolbar",this.options)}addHandler(t,e){this.handlers[t]=e}attach(t){let e=Array.from(t.classList).find((t=>0===t.indexOf("ql-")));if(!e)return;if(e=e.slice(3),"BUTTON"===t.tagName&&t.setAttribute("type","button"),null==this.handlers[e]&&null==this.quill.scroll.query(e))return void E_.warn("ignoring attaching to nonexistent format",e,t);const n="SELECT"===t.tagName?"change":"click";t.addEventListener(n,(n=>{let i;if("SELECT"===t.tagName){if(t.selectedIndex<0)return;const e=t.options[t.selectedIndex];i=!e.hasAttribute("selected")&&(e.value||!1)}else i=!t.classList.contains("ql-active")&&(t.value||!t.hasAttribute("value")),n.preventDefault();this.quill.focus();const[r]=this.quill.selection.getRange();if(null!=this.handlers[e])this.handlers[e].call(this,i);else if(this.quill.scroll.query(e).prototype instanceof nw){if(i=prompt(`Enter ${e}`),!i)return;this.quill.updateContents((new(cw())).retain(r.index).delete(r.length).insert({[e]:i}),gE.sources.USER)}else this.quill.format(e,i,gE.sources.USER);this.update(r)})),this.controls.push([e,t])}update(t){const e=null==t?{}:this.quill.getFormat(t);this.controls.forEach((n=>{const[i,r]=n;if("SELECT"===r.tagName){let n=null;if(null==t)n=null;else if(null==e[i])n=r.querySelector("option[selected]");else if(!Array.isArray(e[i])){let t=e[i];"string"==typeof t&&(t=t.replace(/"/g,'\\"')),n=r.querySelector(`option[value="${t}"]`)}null==n?(r.value="",r.selectedIndex=-1):n.selected=!0}else if(null==t)r.classList.remove("ql-active"),r.setAttribute("aria-pressed","false");else if(r.hasAttribute("value")){const t=e[i],n=t===r.getAttribute("value")||null!=t&&t.toString()===r.getAttribute("value")||null==t&&!r.getAttribute("value");r.classList.toggle("ql-active",n),r.setAttribute("aria-pressed",n.toString())}else{const t=null!=e[i];r.classList.toggle("ql-active",t),r.setAttribute("aria-pressed",t.toString())}}))}}function q_(t,e,n){const i=document.createElement("button");i.setAttribute("type","button"),i.classList.add(`ql-${e}`),i.setAttribute("aria-pressed","false"),null!=n?(i.value=n,i.setAttribute("aria-label",`${e}: ${n}`)):i.setAttribute("aria-label",e),t.appendChild(i)}__.DEFAULTS={},__.DEFAULTS={container:null,handlers:{clean(){const t=this.quill.getSelection();if(null!=t)if(0===t.length){const t=this.quill.getFormat();Object.keys(t).forEach((t=>{null!=this.quill.scroll.query(t,Ob.INLINE)&&this.quill.format(t,!1,gE.sources.USER)}))}else this.quill.removeFormat(t,gE.sources.USER)},direction(t){const{align:e}=this.quill.getFormat();"rtl"===t&&null==e?this.quill.format("align","right",gE.sources.USER):t||"right"!==e||this.quill.format("align",!1,gE.sources.USER),this.quill.format("direction",t,gE.sources.USER)},indent(t){const e=this.quill.getSelection(),n=this.quill.getFormat(e),i=parseInt(n.indent||0,10);if("+1"===t||"-1"===t){let e="+1"===t?1:-1;"rtl"===n.direction&&(e*=-1),this.quill.format("indent",i+e,gE.sources.USER)}},link(t){!0===t&&(t=prompt("Enter link URL:")),this.quill.format("link",t,gE.sources.USER)},list(t){const e=this.quill.getSelection(),n=this.quill.getFormat(e);"check"===t?"checked"===n.list||"unchecked"===n.list?this.quill.format("list",!1,gE.sources.USER):this.quill.format("list","unchecked",gE.sources.USER):this.quill.format("list",t,gE.sources.USER)}}};let k_=0;function T_(t,e){t.setAttribute(e,`${!("true"===t.getAttribute(e))}`)}const x_=class{constructor(t){this.select=t,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",(()=>{this.togglePicker()})),this.label.addEventListener("keydown",(t=>{switch(t.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),t.preventDefault()}})),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),T_(this.label,"aria-expanded"),T_(this.options,"aria-hidden")}buildItem(t){const e=document.createElement("span");e.tabIndex="0",e.setAttribute("role","button"),e.classList.add("ql-picker-item");const n=t.getAttribute("value");return n&&e.setAttribute("data-value",n),t.textContent&&e.setAttribute("data-label",t.textContent),e.addEventListener("click",(()=>{this.selectItem(e,!0)})),e.addEventListener("keydown",(t=>{switch(t.key){case"Enter":this.selectItem(e,!0),t.preventDefault();break;case"Escape":this.escape(),t.preventDefault()}})),e}buildLabel(){const t=document.createElement("span");return t.classList.add("ql-picker-label"),t.innerHTML='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>',t.tabIndex="0",t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),this.container.appendChild(t),t}buildOptions(){const t=document.createElement("span");t.classList.add("ql-picker-options"),t.setAttribute("aria-hidden","true"),t.tabIndex="-1",t.id=`ql-picker-options-${k_}`,k_+=1,this.label.setAttribute("aria-controls",t.id),this.options=t,Array.from(this.select.options).forEach((e=>{const n=this.buildItem(e);t.appendChild(n),!0===e.selected&&this.selectItem(n)})),this.container.appendChild(t)}buildPicker(){Array.from(this.select.attributes).forEach((t=>{this.container.setAttribute(t.name,t.value)})),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout((()=>this.label.focus()),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.container.querySelector(".ql-selected");t!==n&&(null!=n&&n.classList.remove("ql-selected"),null!=t&&(t.classList.add("ql-selected"),this.select.selectedIndex=Array.from(t.parentNode.children).indexOf(t),t.hasAttribute("data-value")?this.label.setAttribute("data-value",t.getAttribute("data-value")):this.label.removeAttribute("data-value"),t.hasAttribute("data-label")?this.label.setAttribute("data-label",t.getAttribute("data-label")):this.label.removeAttribute("data-label"),e&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let t;if(this.select.selectedIndex>-1){const e=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];t=this.select.options[this.select.selectedIndex],this.selectItem(e)}else this.selectItem(null);const e=null!=t&&t!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",e)}},I_=class extends x_{constructor(t,e){super(t),this.label.innerHTML=e,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach((t=>{t.classList.add("ql-primary")}))}buildItem(t){const e=super.buildItem(t);return e.style.backgroundColor=t.getAttribute("value")||"",e}selectItem(t,e){super.selectItem(t,e);const n=this.label.querySelector(".ql-color-label"),i=t&&t.getAttribute("data-value")||"";n&&("line"===n.tagName?n.style.stroke=i:n.style.fill=i)}},S_=class extends x_{constructor(t,e){super(t),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach((t=>{t.innerHTML=e[t.getAttribute("data-value")||""]})),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(t,e){super.selectItem(t,e);const n=t||this.defaultItem;if(null!=n){if(this.label.innerHTML===n.innerHTML)return;this.label.innerHTML=n.innerHTML}}},A_=class{constructor(t,e){this.quill=t,this.boundsContainer=e||document.body,this.root=t.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,(t=>{const{overflowY:e}=getComputedStyle(t,null);return"visible"!==e&&"clip"!==e})(this.quill.root)&&this.quill.root.addEventListener("scroll",(()=>{this.root.style.marginTop=-1*this.quill.root.scrollTop+"px"})),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(t){const e=t.left+t.width/2-this.root.offsetWidth/2,n=t.bottom+this.quill.root.scrollTop;this.root.style.left=`${e}px`,this.root.style.top=`${n}px`,this.root.classList.remove("ql-flip");const i=this.boundsContainer.getBoundingClientRect(),r=this.root.getBoundingClientRect();let s=0;if(r.right>i.right&&(s=i.right-r.right,this.root.style.left=`${e+s}px`),r.left<i.left&&(s=i.left-r.left,this.root.style.left=`${e+s}px`),r.bottom>i.bottom){const e=r.bottom-r.top,i=t.bottom-t.top+e;this.root.style.top=n-i+"px",this.root.classList.add("ql-flip")}return s}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}},N_=[!1,"center","right","justify"],C_=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],O_=[!1,"serif","monospace"],L_=["1","2","3",!1],R_=["small",!1,"large","huge"];class D_ extends cE{constructor(t,e){super(t,e);const n=e=>{document.body.contains(t.root)?(null==this.tooltip||this.tooltip.root.contains(e.target)||document.activeElement===this.tooltip.textbox||this.quill.hasFocus()||this.tooltip.hide(),null!=this.pickers&&this.pickers.forEach((t=>{t.container.contains(e.target)||t.close()}))):document.body.removeEventListener("click",n)};t.emitter.listenDOM("click",document.body,n)}addModule(t){const e=super.addModule(t);return"toolbar"===t&&this.extendToolbar(e),e}buildButtons(t,e){Array.from(t).forEach((t=>{(t.getAttribute("class")||"").split(/\s+/).forEach((n=>{if(n.startsWith("ql-")&&(n=n.slice(3),null!=e[n]))if("direction"===n)t.innerHTML=e[n][""]+e[n].rtl;else if("string"==typeof e[n])t.innerHTML=e[n];else{const i=t.value||"";null!=i&&e[n][i]&&(t.innerHTML=e[n][i])}}))}))}buildPickers(t,e){this.pickers=Array.from(t).map((t=>{if(t.classList.contains("ql-align")&&(null==t.querySelector("option")&&P_(t,N_),"object"==typeof e.align))return new S_(t,e.align);if(t.classList.contains("ql-background")||t.classList.contains("ql-color")){const n=t.classList.contains("ql-background")?"background":"color";return null==t.querySelector("option")&&P_(t,C_,"background"===n?"#ffffff":"#000000"),new I_(t,e[n])}return null==t.querySelector("option")&&(t.classList.contains("ql-font")?P_(t,O_):t.classList.contains("ql-header")?P_(t,L_):t.classList.contains("ql-size")&&P_(t,R_)),new x_(t)})),this.quill.on($w.events.EDITOR_CHANGE,(()=>{this.pickers.forEach((t=>{t.update()}))}))}}D_.DEFAULTS=Vv({},cE.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let t=this.container.querySelector("input.ql-image[type=file]");null==t&&(t=document.createElement("input"),t.setAttribute("type","file"),t.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),t.classList.add("ql-image"),t.addEventListener("change",(()=>{const e=this.quill.getSelection(!0);this.quill.uploader.upload(e,t.files),t.value=""})),this.container.appendChild(t)),t.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class M_ extends A_{constructor(t,e){super(t,e),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",(t=>{"Enter"===t.key?(this.save(),t.preventDefault()):"Escape"===t.key&&(this.cancel(),t.preventDefault())}))}cancel(){this.hide(),this.restoreFocus()}edit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"link",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),null==this.textbox)return;null!=e?this.textbox.value=e:t!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const n=this.quill.getBounds(this.quill.selection.savedRange);null!=n&&this.position(n),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${t}`)||""),this.root.setAttribute("data-mode",t)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:t}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:e}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",t,$w.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",t,$w.sources.USER)),this.quill.root.scrollTop=e;break}case"video":t=function(t){let e=t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return e?`${e[1]||"https"}://www.youtube.com/embed/${e[2]}?showinfo=0`:(e=t.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${e[1]||"https"}://player.vimeo.com/video/${e[2]}/`:t}(t);case"formula":{if(!t)break;const e=this.quill.getSelection(!0);if(null!=e){const n=e.index+e.length;this.quill.insertEmbed(n,this.root.getAttribute("data-mode"),t,$w.sources.USER),"formula"===this.root.getAttribute("data-mode")&&this.quill.insertText(n+1," ",$w.sources.USER),this.quill.setSelection(n+2,$w.sources.USER)}break}}this.textbox.value="",this.hide()}}function P_(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.forEach((e=>{const i=document.createElement("option");e===n?i.setAttribute("selected","selected"):i.setAttribute("value",String(e)),t.appendChild(i)}))}class j_ extends Cw{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(t){const e=super.create(t);return e.setAttribute("href",this.sanitize(t)),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"),e}static formats(t){return t.getAttribute("href")}static sanitize(t){return function(t,e){const n=document.createElement("a");n.href=t;const i=n.href.slice(0,n.href.indexOf(":"));return e.indexOf(i)>-1}(t,this.PROTOCOL_WHITELIST)?t:this.SANITIZED_URL}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("href",this.constructor.sanitize(e)):super.format(t,e)}}const U_='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',F_={align:{"":'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',center:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',right:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',justify:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>'},background:'<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',blockquote:'<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',bold:'<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',clean:'<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',code:U_,"code-block":U_,color:'<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',direction:{"":'<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',rtl:'<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>'},formula:'<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',header:{1:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',2:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>'},italic:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',image:'<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',indent:{"+1":'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',"-1":'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>'},link:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',list:{bullet:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',check:'<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',ordered:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>'},script:{sub:'<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',super:'<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>'},strike:'<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',table:'<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',underline:'<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',video:'<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>'},V_=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class B_ extends M_{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",(t=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),t.preventDefault()})),this.root.querySelector("a.ql-remove").addEventListener("click",(t=>{if(null!=this.linkRange){const t=this.linkRange;this.restoreFocus(),this.quill.formatText(t,"link",!1,$w.sources.USER),delete this.linkRange}t.preventDefault(),this.hide()})),this.quill.on($w.events.SELECTION_CHANGE,((t,e,n)=>{if(null!=t){if(0===t.length&&n===$w.sources.USER){const[e,n]=this.quill.scroll.descendant(j_,t.index);if(null!=e){this.linkRange=new Kw(t.index-n,e.length());const i=j_.formats(e.domNode);this.preview.textContent=i,this.preview.setAttribute("href",i),this.show();const r=this.quill.getBounds(this.linkRange);return void(null!=r&&this.position(r))}}else delete this.linkRange;this.hide()}}))}show(){super.show(),this.root.removeAttribute("data-mode")}}class z_ extends D_{constructor(t,e){null!=e.modules.toolbar&&null==e.modules.toolbar.container&&(e.modules.toolbar.container=V_),super(t,e),this.quill.container.classList.add("ql-snow")}extendToolbar(t){null!=t.container&&(t.container.classList.add("ql-snow"),this.buildButtons(t.container.querySelectorAll("button"),F_),this.buildPickers(t.container.querySelectorAll("select"),F_),this.tooltip=new B_(this.quill,this.options.bounds),t.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},((e,n)=>{t.handlers.link.call(t,!n.format.link)})))}}z_.DEFAULTS=Vv({},D_.DEFAULTS,{modules:{toolbar:{handlers:{link(t){if(t){const t=this.quill.getSelection();if(null==t||0===t.length)return;let e=this.quill.getText(t);/^\S+@\S+\.\S+$/.test(e)&&0!==e.indexOf("mailto:")&&(e=`mailto:${e}`);const{tooltip:n}=this.quill.theme;n.edit("link",e)}else this.quill.format("link",!1)}}}}});const H_=z_,$_=class extends Cw{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(t){super.optimize(t),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}};class W_ extends bE{}W_.blotName="list-container",W_.tagName="OL";class K_ extends Ow{static create(t){const e=super.create();return e.setAttribute("data-list",t),e}static formats(t){return t.getAttribute("data-list")||void 0}static register(){gE.register(W_)}constructor(t,e){super(t,e);const n=e.ownerDocument.createElement("span"),i=n=>{if(!t.isEnabled())return;const i=this.statics.formats(e,t);"checked"===i?(this.format("list","unchecked"),n.preventDefault()):"unchecked"===i&&(this.format("list","checked"),n.preventDefault())};n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),this.attachUI(n)}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("data-list",e):super.format(t,e)}}K_.blotName="list",K_.tagName="LI",W_.allowedChildren=[K_],K_.requiredContainer=W_,j_.PROTOCOL_WHITELIST=["http","https","mailto","tel","radar","rdar","smb","sms"];var G_=n(878),Q_={};Q_.styleTagTransform=Nm(),Q_.setAttributes=xm(),Q_.insert=km().bind(null,"head"),Q_.domAPI=_m(),Q_.insertStyleElement=Sm(),wm()(G_.A,Q_),G_.A&&G_.A.locals&&G_.A.locals;var Y_=n(410),X_={};X_.styleTagTransform=Nm(),X_.setAttributes=xm(),X_.insert=km().bind(null,"head"),X_.domAPI=_m(),X_.insertStyleElement=Sm(),wm()(Y_.A,X_),Y_.A&&Y_.A.locals&&Y_.A.locals,w_.register({"modules/toolbar":__,"themes/snow":H_,"formats/bold":$_,"formats/italic":class extends $_{static blotName="italic";static tagName=["EM","I"]},"formats/underline":class extends Cw{static blotName="underline";static tagName="U"},"formats/strike":class extends $_{static blotName="strike";static tagName=["S","STRIKE"]},"formats/header":class extends Ow{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(t){return this.tagName.indexOf(t.tagName)+1}},"formats/blockquote":class extends Ow{static blotName="blockquote";static tagName="blockquote"},"formats/code":NE,"formats/list":K_,"formats/color":IE,"formats/link":class extends j_{static sanitize(t){const e=super.sanitize(t);return e&&"about:blank"!==e?this.PROTOCOL_WHITELIST.some((function(t){return e.startsWith(t)}))?e:`https://${e}`:e}}}),w_.register("modules/clipboard",class extends r_{onPaste(t,{text:e}){const n=(new(cw())).retain(t.index).delete(t.length).insert(e);this.quill.updateContents(n,w_.sources.USER),this.quill.setSelection(n.length()-t.length,w_.sources.SILENT),this.quill.scrollSelectionIntoView()}},!0);var J_=n(430),Z_={};Z_.styleTagTransform=Nm(),Z_.setAttributes=xm(),Z_.insert=km().bind(null,"head"),Z_.domAPI=_m(),Z_.insertStyleElement=Sm(),wm()(J_.A,Z_),J_.A&&J_.A.locals&&J_.A.locals;var tq=n(523),eq={};eq.styleTagTransform=Nm(),eq.setAttributes=xm(),eq.insert=km().bind(null,"head"),eq.domAPI=_m(),eq.insertStyleElement=Sm(),wm()(tq.A,eq),tq.A&&tq.A.locals&&tq.A.locals;const nq=ym(),iq=document.querySelector(".notes-container"),rq=new(i())(iq,{percentPosition:!0,itemSelector:".note-card",columnWidth:".grid-sizer",horizontalOrder:!0}),sq=function(t){const e=document.getElementById("editor-new-note"),n=new w_(e,{theme:"snow",modules:{toolbar:{container:[["bold","italic","underline","strike"],[{color:[]}],[{list:"ordered"},{list:"bullet"}],["blockquote","code-block","link"],[{header:1},{header:2}],["clean"]]}},placeholder:"What's up?"});return{getEditorContents:()=>n.getContents(),setEditorContents:t=>n.setContents(t),clearEditor:()=>n.setContents([]),getFocus:()=>n.focus(),getEditorContentsHTML:()=>n.getSemanticHTML()}}(),oq=function(){let t=[];return{addNote:e=>t.unshift(e),removeNote:async t=>{const e=of(Id(jm,"users/"+Um+"/notes/"),lf("id","==",t));(await Ef(e)).forEach((t=>{var e;(e=t.ref,_f(Ed(e.firestore,Ad),[new ic(e._key,Hl.none())])).then((()=>{alert("deleted succesfully!")}))}))},findNote:e=>t.find((t=>t.id===e)),updateNote:async(t,e,n,i)=>{const r=of(Id(jm,"users/"+Um+"/notes/"),lf("id","==",t));(await Ef(r)).forEach((t=>{(function(t,e,n,...i){t=Ed(t,Td);const r=Ed(t.firestore,Ad),s=Bd(r);let o;return o="string"==typeof(e=_t(e))||e instanceof Ld?function(t,e,n,i,r,s){const o=t.Su(1,e,n),a=[Qd(e,i,n)],l=[r];if(s.length%2!=0)throw new io(no.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(Qd(e,s[t])),l.push(s[t+1]);const c=[],u=xa.empty();for(let t=a.length-1;t>=0;--t)if(!Zd(c,a[t])){const e=a[t];let n=l[t];n=_t(n);const i=o.fu(e);if(n instanceof Hd)c.push(e);else{const t=$d(n,i);null!=t&&(c.push(e),u.set(e,t))}}const h=new Jo(c);return new jd(u,h,o.fieldTransforms)}(s,"updateDoc",t._key,e,n,i):function(t,e,n,i){const r=t.Su(1,e,n);Gd("Data must be an object, but it was:",r,i);const s=[],o=xa.empty();$o(i,((t,i)=>{const a=Xd(e,t,n);i=_t(i);const l=r.fu(a);if(i instanceof Hd)s.push(a);else{const t=$d(i,l);null!=t&&(s.push(a),o.set(a,t))}}));const a=new Jo(s);return new jd(o,a,r.fieldTransforms)}(s,"updateDoc",t._key,e),_f(r,[o.toMutation(t._key,Hl.exists(!0))])})(t.ref,{title:e,text:{...n},html:i}).then((()=>{alert("updated succesfully!")}))}))},getAllNotes:async()=>{const t=of(Id(jm,"users/"+Um+"/notes/"),function(t,e="asc"){const n=e,i=nf("orderBy","dateTime");return uf._create(i,n)}(0,"desc")),e=await Ef(t);let n=[];return e.forEach((t=>{n.push({...t.data()})})),console.log(n),n},getLatestNote:()=>t[0]}}(),aq=(t,e,n,i,r)=>{const s=document.createElement("div");s.classList.add("note-card"),s.addEventListener("click",(n=>{n.target,hq.showModal();let i=document.createElement("button");i.innerText="Save",i.classList.add("dialog-btn"),i.addEventListener("click",(t=>{t.stopPropagation(),oq.updateNote(r,pq(),sq.getEditorContents(),sq.getEditorContentsHTML().replaceAll("<p></p>","<br/>")),hq.close(),rq.remove(iq.children),lq()})),uq.appendChild(i),document.getElementById("new-note-title").value=t,sq.setEditorContents(e)}));const o=document.createElement("button");o.classList.add("btn-delete-card"),o.innerHTML='<ion-icon name="close-outline"></ion-icon>',o.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),oq.removeNote(r);let e=t.target.parentNode.parentNode;rq.remove(e),rq.layout()}));const a=document.createElement("div");a.classList.add("note-content");const l=document.createElement("h2");l.classList.add("note-title"),l.innerText=t;const c=function(t,e,n){const i=g(),r=n?.locale??i.locale??f,s=Y(t,e);if(isNaN(s))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:s});let a,l;s>0?(a=b(e),l=b(t)):(a=b(t),l=b(e));const c=Z(l,a),u=(E(l)-E(a))/1e3,h=Math.round((c-u)/60);let d;if(h<2)return n?.includeSeconds?c<5?r.formatDistance("lessThanXSeconds",5,o):c<10?r.formatDistance("lessThanXSeconds",10,o):c<20?r.formatDistance("lessThanXSeconds",20,o):c<40?r.formatDistance("halfAMinute",0,o):c<60?r.formatDistance("lessThanXMinutes",1,o):r.formatDistance("xMinutes",1,o):0===h?r.formatDistance("lessThanXMinutes",1,o):r.formatDistance("xMinutes",h,o);if(h<45)return r.formatDistance("xMinutes",h,o);if(h<90)return r.formatDistance("aboutXHours",1,o);if(h<1440){const t=Math.round(h/60);return r.formatDistance("aboutXHours",t,o)}if(h<2520)return r.formatDistance("xDays",1,o);if(h<v){const t=Math.round(h/1440);return r.formatDistance("xDays",t,o)}if(h<86400)return d=Math.round(h/v),r.formatDistance("aboutXMonths",d,o);if(d=J(l,a),d<12){const t=Math.round(h/v);return r.formatDistance("xMonths",t,o)}{const t=d%12,e=Math.trunc(d/12);return t<3?r.formatDistance("aboutXYears",e,o):t<9?r.formatDistance("overXYears",e,o):r.formatDistance("almostXYears",e+1,o)}}(i,G(new Date,"yyyy-MM-dd'T'HH:mm:ss.SSS"),{addSuffix:!0}),u=document.createElement("small");u.innerText=c;const h=document.createElement("div");return h.classList.add("note-text"),h.innerHTML=n,a.appendChild(l),a.appendChild(u),a.appendChild(h),a.appendChild(o),s.appendChild(a),s},lq=async()=>{let t=await oq.getAllNotes();for(let e of t){let t=aq(e.title,e.text,e.html,e.dateTime,e.id);iq.appendChild(t),rq.appended(t),rq.layout()}};sg(nq,(t=>{t?lq():rq.remove(iq.children)}));const cq=document.getElementById("btn-open-newnote-modal"),uq=document.getElementById("dialog-button-options"),hq=document.getElementById("dialog-newnote-form"),dq=document.getElementById("new-note-title"),fq=()=>{oq.addNote(function(t,e,n){(function(t,e){const n=Ed(t.firestore,Ad),i=function(t,e,...n){if(t=_t(t),1===arguments.length&&(e=go.newId()),yd("doc","path",e),t instanceof qd){const i=Eo.fromString(e,...n);return vd(i),new Td(t,null,new ko(i))}{if(!(t instanceof Td||t instanceof xd))throw new io(no.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Eo.fromString(e,...n));return vd(i),new Td(t.firestore,t instanceof xd?t.converter:null,new ko(i))}}(t),r=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return _f(n,[zd(Bd(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,Hl.exists(!1))]).then((()=>i))})(Id(jm,"users/"+Um+"/notes/"),{title:t,text:{...e},html:n,id:crypto.randomUUID(),dateTime:G(new Date,"yyyy-MM-dd'T'HH:mm:ss.SSS")}).then((()=>{alert("added succesfully!")}));let i=t,r=e,s=n.replaceAll("<p></p>","<br/>");const o=crypto.randomUUID();return{title:i,text:r,html:s,dateTime:G(new Date,"yyyy-MM-dd'T'HH:mm:ss.SSS"),id:o}}(pq(),sq.getEditorContents(),sq.getEditorContentsHTML()));let t=aq(oq.getLatestNote().title,oq.getLatestNote().text,oq.getLatestNote().html,oq.getLatestNote().dateTime,oq.getLatestNote().id);iq.appendChild(t),rq.prepended(t),rq.layout(),hq.close()};cq.addEventListener("click",(()=>{hq.showModal(),sq.getFocus();let t=document.createElement("button");t.innerText="Save",t.onclick=fq,t.classList.add("dialog-btn"),uq.appendChild(t)})),hq.addEventListener("close",(t=>{sq.clearEditor(),gq(),uq.innerHTML=""})),hq.addEventListener("mousedown",(t=>{"DIALOG"===t.target.tagName&&hq.close()}));const pq=()=>null===dq||""===dq.value?"Untitled":dq.value,gq=()=>{dq.value=""}})()})();